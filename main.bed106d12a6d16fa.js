(self.webpackChunkface_app=self.webpackChunkface_app||[]).push([[179],{776:(ui,Ns,cr)=>{"use strict";var Wa={};cr.r(Wa),cr.d(Wa,{AdadeltaOptimizer:()=>TI,AdagradOptimizer:()=>RI,AdamOptimizer:()=>MI,AdamaxOptimizer:()=>NI,DataStorage:()=>xE,ENV:()=>kD,Environment:()=>fF,KernelBackend:()=>_E,MomentumOptimizer:()=>FI,Optimizer:()=>Tu,RMSPropOptimizer:()=>kI,Rank:()=>KD,Reduction:()=>Ar,SGDOptimizer:()=>Zw,Tensor:()=>Ut,TensorBuffer:()=>Gf,Variable:()=>qc,abs:()=>VP,acos:()=>UP,acosh:()=>WP,add:()=>rt,addN:()=>IO,addStrict:()=>SO,all:()=>_L,any:()=>CL,argMax:()=>DL,argMin:()=>EL,asin:()=>HP,asinh:()=>jP,atan:()=>zP,atan2:()=>AO,atanh:()=>$P,avgPool:()=>ed,avgPool3d:()=>mL,backend:()=>r5,backend_util:()=>b5,basicLSTMCell:()=>kL,batchNorm:()=>jE,batchNorm2d:()=>xO,batchNorm3d:()=>_O,batchNorm4d:()=>CO,batchNormalization:()=>bO,batchNormalization2d:()=>mO,batchNormalization3d:()=>yO,batchNormalization4d:()=>wO,batchToSpaceND:()=>fE,booleanMaskAsync:()=>QO,broadcastTo:()=>vk,browser:()=>Qw,buffer:()=>Ge,cast:()=>mk,ceil:()=>GP,clipByValue:()=>Ow,clone:()=>yk,complex:()=>ar,concat:()=>Pn,concat1d:()=>fk,concat2d:()=>dk,concat3d:()=>hk,concat4d:()=>pk,conv1d:()=>eL,conv2d:()=>Uo,conv2dTranspose:()=>iL,conv3d:()=>tL,conv3dTranspose:()=>aL,cos:()=>qP,cosh:()=>KP,cumsum:()=>wk,customGrad:()=>Hg,deprecationWarn:()=>sE,depthToSpace:()=>bk,depthwiseConv2d:()=>Jg,diag:()=>jL,disableDeprecationWarnings:()=>zG,dispose:()=>to,disposeVariables:()=>$G,div:()=>si,divNoNan:()=>TO,divStrict:()=>RO,dot:()=>sL,dropout:()=>zL,elu:()=>tI,enableDebugMode:()=>jG,enableProdMode:()=>HG,engine:()=>GG,env:()=>K,equal:()=>KE,equalStrict:()=>VO,erf:()=>XP,exp:()=>Lw,expandDims:()=>Vo,expm1:()=>YP,eye:()=>dE,fft:()=>jw,fill:()=>Xi,findBackend:()=>e5,findBackendFactory:()=>t5,floor:()=>QP,floorDiv:()=>GE,frame:()=>Gw,fused:()=>QL,gather:()=>Ww,gatherND:()=>HL,gather_util:()=>h5,getBackend:()=>ZG,getGradient:()=>dF,getKernel:()=>PD,getKernelsForBackend:()=>OD,grad:()=>v5,grads:()=>m5,greater:()=>UO,greaterEqual:()=>XE,greaterEqualStrict:()=>WO,greaterStrict:()=>HO,hammingWindow:()=>aI,hannWindow:()=>$w,ifft:()=>nv,imag:()=>Ki,image:()=>Kw,inTopKAsync:()=>qL,io:()=>EI,irfft:()=>iI,isFinite:()=>aO,isInf:()=>iO,isNaN:()=>oO,keep:()=>rk,leakyRelu:()=>ML,less:()=>jO,lessEqual:()=>zO,lessEqualStrict:()=>$O,lessStrict:()=>GO,linalg:()=>YL,linspace:()=>lk,localResponseNormalization:()=>FL,log:()=>ZP,log1p:()=>JP,logSigmoid:()=>eO,logSoftmax:()=>Vk,logSumExp:()=>IL,logicalAnd:()=>Qg,logicalNot:()=>DO,logicalOr:()=>zE,logicalXor:()=>EO,losses:()=>KL,matMul:()=>ev,math:()=>Gq,max:()=>tv,maxPool:()=>Kn,maxPool3d:()=>vL,maximum:()=>Uw,maximumStrict:()=>MO,mean:()=>SL,memory:()=>qG,min:()=>AL,minimum:()=>qE,minimumStrict:()=>NO,mod:()=>FO,modStrict:()=>kO,moments:()=>TL,movingAverage:()=>OL,mul:()=>Sr,mulStrict:()=>PO,multiRNNCell:()=>PL,multinomial:()=>xk,neg:()=>Xg,nextFrame:()=>t7,norm:()=>oI,notEqual:()=>qO,notEqualStrict:()=>KO,oneHot:()=>_w,ones:()=>Yc,onesLike:()=>cE,op:()=>V,outerProduct:()=>uL,pad:()=>Cu,pad1d:()=>_k,pad2d:()=>Ck,pad3d:()=>Dk,pad4d:()=>Ek,pool:()=>gL,pow:()=>Zg,powStrict:()=>OO,prelu:()=>nI,print:()=>gk,prod:()=>RL,profile:()=>KG,rand:()=>Ik,randomGamma:()=>Ak,randomNormal:()=>Sk,randomUniform:()=>hE,range:()=>Ug,ready:()=>QG,real:()=>Bo,reciprocal:()=>tO,registerBackend:()=>n5,registerGradient:()=>hF,registerKernel:()=>LD,relu:()=>nn,relu6:()=>rI,removeBackend:()=>JG,reshape:()=>ai,reverse:()=>Jf,reverse1d:()=>cL,reverse2d:()=>lL,reverse3d:()=>fL,reverse4d:()=>dL,rfft:()=>zw,round:()=>nO,rsqrt:()=>WE,scalar:()=>le,scatterND:()=>VL,scatter_util:()=>p5,selu:()=>NL,separableConv2d:()=>Hw,serialization:()=>Kq,setBackend:()=>YG,setPlatform:()=>o5,setdiff1dAsync:()=>Rk,sigmoid:()=>HE,sign:()=>rO,signal:()=>GL,sin:()=>sO,sinh:()=>uO,slice:()=>Qi,slice1d:()=>yL,slice2d:()=>wL,slice3d:()=>JE,slice4d:()=>bL,slice_util:()=>g5,softmax:()=>Na,softplus:()=>cO,spaceToBatchND:()=>pE,sparseToDense:()=>WL,spectral:()=>UL,split:()=>bw,sqrt:()=>lO,square:()=>BP,squaredDifference:()=>UE,squaredDifferenceStrict:()=>LO,squeeze:()=>gE,stack:()=>Co,step:()=>fO,stft:()=>sI,stridedSlice:()=>LL,sub:()=>Bn,subStrict:()=>BO,sum:()=>eI,sumOutType:()=>cw,tan:()=>dO,tanh:()=>hO,tensor:()=>sr,tensor1d:()=>Dn,tensor2d:()=>bs,tensor3d:()=>ww,tensor4d:()=>ro,tensor5d:()=>sk,tensor6d:()=>uk,tensor_util:()=>OG,test_util:()=>Yq,tidy:()=>ge,tile:()=>Jc,time:()=>XG,topk:()=>BL,train:()=>Jq,transpose:()=>Cs,truncatedNormal:()=>Tk,unregisterGradient:()=>RG,unregisterKernel:()=>TG,unsortedSegmentSum:()=>YE,unstack:()=>On,util:()=>MG,valueAndGrad:()=>y5,valueAndGrads:()=>w5,variable:()=>ck,variableGrads:()=>Bk,version_core:()=>Qq,webgl:()=>Zq,where:()=>Eu,whereAsync:()=>$E,zeros:()=>qt,zerosLike:()=>vt});var L={};cr.r(L),cr.d(L,{computeReshapedDimensions:()=>_3,getCenterPoint:()=>tb,isDimensions:()=>LI,isEven:()=>OI,isFloat:()=>x3,isTensor:()=>sd,isTensor1D:()=>r7,isTensor2D:()=>b3,isTensor3D:()=>iv,isTensor4D:()=>Is,isValidNumber:()=>Nu,isValidProbablitiy:()=>nb,range:()=>ud,round:()=>eb});var bd={};cr.r(bd),cr.d(bd,{AnchorPosition:()=>Fa,DrawBox:()=>F3,DrawBoxOptions:()=>N3,DrawFaceLandmarks:()=>Q3,DrawFaceLandmarksOptions:()=>Y3,DrawTextField:()=>$I,DrawTextFieldOptions:()=>zI,drawContour:()=>Ru,drawDetections:()=>d7,drawFaceExpressions:()=>b7,drawFaceLandmarks:()=>x7});var Vu={};function bt(t){return"function"==typeof t}function Tr(t){const e=t(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}cr.r(Vu),cr.d(Vu,{AgeGenderNet:()=>J3,BoundingBox:()=>av,Box:()=>Zi,ComposableTask:()=>pd,ComputeAllFaceDescriptorsTask:()=>Cb,ComputeFaceDescriptorsTaskBase:()=>CS,ComputeSingleFaceDescriptorTask:()=>Db,DetectAllFaceLandmarksTask:()=>gB,DetectAllFacesTask:()=>IS,DetectFaceLandmarksTaskBase:()=>DS,DetectFacesTaskBase:()=>ES,DetectSingleFaceLandmarksTask:()=>vB,DetectSingleFaceTask:()=>mB,Dimensions:()=>Mu,FACE_EXPRESSION_LABELS:()=>ZI,FaceDetection:()=>Eo,FaceDetectionNet:()=>o9,FaceExpressionNet:()=>K3,FaceExpressions:()=>hb,FaceLandmark68Net:()=>tS,FaceLandmark68TinyNet:()=>tB,FaceLandmarkNet:()=>F7,FaceLandmarks:()=>il,FaceLandmarks5:()=>I3,FaceLandmarks68:()=>VI,FaceMatch:()=>UI,FaceMatcher:()=>tK,FaceRecognitionNet:()=>rS,Gender:()=>ku,LabeledBox:()=>WI,LabeledFaceDescriptors:()=>sv,Mtcnn:()=>hS,MtcnnOptions:()=>vb,NetInput:()=>cv,NeuralNetwork:()=>ka,ObjectDetection:()=>BI,Point:()=>Rt,PredictedBox:()=>c7,Rect:()=>ob,SsdMobilenetv1:()=>mb,SsdMobilenetv1Options:()=>al,TinyFaceDetector:()=>pS,TinyFaceDetectorOptions:()=>sB,TinyYolov2:()=>uS,TinyYolov2Options:()=>fv,TinyYolov2SizeType:()=>wb,allFaces:()=>eK,allFacesMtcnn:()=>J9,allFacesSsdMobilenetv1:()=>yB,allFacesTinyYolov2:()=>Z9,awaitMediaLoaded:()=>k3,bufferToImage:()=>P3,computeFaceDescriptor:()=>L9,createCanvas:()=>uv,createCanvasFromMedia:()=>sb,createFaceDetectionNet:()=>r9,createFaceRecognitionNet:()=>U7,createMtcnn:()=>nK,createSsdMobilenetv1:()=>oB,createTinyFaceDetector:()=>rK,createTinyYolov2:()=>g9,detectAllFaces:()=>Eb,detectFaceLandmarks:()=>fB,detectFaceLandmarksTiny:()=>O9,detectLandmarks:()=>Y9,detectSingleFace:()=>Q9,draw:()=>bd,env:()=>ur,euclideanDistance:()=>wB,extendWithAge:()=>iS,extendWithFaceDescriptor:()=>oS,extendWithFaceDetection:()=>dd,extendWithFaceExpressions:()=>JI,extendWithFaceLandmarks:()=>lv,extendWithGender:()=>aS,extractFaceTensors:()=>cb,extractFaces:()=>ub,fetchImage:()=>h7,fetchJson:()=>B3,fetchNetWeights:()=>p7,fetchOrThrow:()=>lb,getContext2dOrThrow:()=>Ji,getMediaDimensions:()=>ab,imageTensorToCanvas:()=>O3,imageToSquare:()=>L3,inverseSigmoid:()=>i7,iou:()=>C3,isMediaElement:()=>qI,isMediaLoaded:()=>GI,isWithAge:()=>W7,isWithFaceDetection:()=>fd,isWithFaceExpressions:()=>X3,isWithFaceLandmarks:()=>pb,isWithGender:()=>H7,loadAgeGenderModel:()=>q9,loadFaceDetectionModel:()=>K9,loadFaceExpressionModel:()=>G9,loadFaceLandmarkModel:()=>j9,loadFaceLandmarkTinyModel:()=>z9,loadFaceRecognitionModel:()=>$9,loadMtcnnModel:()=>W9,loadSsdMobilenetv1Model:()=>dB,loadTinyFaceDetectorModel:()=>U9,loadTinyYolov2Model:()=>H9,loadWeightMap:()=>U3,locateFaces:()=>X9,matchDimensions:()=>g7,minBbox:()=>D3,mtcnn:()=>P9,nets:()=>mt,nonMaxSuppression:()=>cd,normalize:()=>ld,padToSquare:()=>E3,predictAgeAndGender:()=>V9,recognizeFaceExpressions:()=>B9,resizeResults:()=>bB,resolveInput:()=>ib,shuffleArray:()=>o7,sigmoid:()=>rb,ssdMobilenetv1:()=>lB,tf:()=>Wa,tinyFaceDetector:()=>F9,tinyYolov2:()=>k9,toNetInput:()=>Yn,utils:()=>L,validateConfig:()=>iB});const xd=Tr(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,o)=>`${o+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function Fs(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class Hr{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const i of e)i.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(bt(r))try{r()}catch(i){n=i instanceof xd?i.errors:[i]}const{_finalizers:o}=this;if(o){this._finalizers=null;for(const i of o)try{_d(i)}catch(a){n=n??[],a instanceof xd?n=[...n,...a.errors]:n.push(a)}}if(n)throw new xd(n)}}add(n){var e;if(n&&n!==this)if(this.closed)_d(n);else{if(n instanceof Hr){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&Fs(e,n)}remove(n){const{_finalizers:e}=this;e&&Fs(e,n),n instanceof Hr&&n._removeParent(this)}}Hr.EMPTY=(()=>{const t=new Hr;return t.closed=!0,t})();const Uu=Hr.EMPTY;function ci(t){return t instanceof Hr||t&&"closed"in t&&bt(t.remove)&&bt(t.add)&&bt(t.unsubscribe)}function _d(t){bt(t)?t():t.unsubscribe()}const io={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},li={setTimeout(t,n,...e){const{delegate:r}=li;return r?.setTimeout?r.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=li;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Wu(t){li.setTimeout(()=>{const{onUnhandledError:n}=io;if(!n)throw t;n(t)})}function lr(){}const Ha=ta("C",void 0,void 0);function ta(t,n,e){return{kind:t,value:n,error:e}}let Qn=null;function fi(t){if(io.useDeprecatedSynchronousErrorHandling){const n=!Qn;if(n&&(Qn={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:r}=Qn;if(Qn=null,e)throw r}}else t()}class ja extends Hr{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,ci(n)&&n.add(this)):this.destination=Fb}static create(n,e,r){return new Hu(n,e,r)}next(n){this.isStopped?Ed(function zo(t){return ta("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?Ed(function pv(t){return ta("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?Ed(Ha,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Cd=Function.prototype.bind;function Dd(t,n){return Cd.call(t,n)}class Nb{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(r){ul(r)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(r){ul(r)}else ul(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){ul(e)}}}class Hu extends ja{constructor(n,e,r){let o;if(super(),bt(n)||!n)o={next:n??void 0,error:e??void 0,complete:r??void 0};else{let i;this&&io.useDeprecatedNextContext?(i=Object.create(n),i.unsubscribe=()=>this.unsubscribe(),o={next:n.next&&Dd(n.next,i),error:n.error&&Dd(n.error,i),complete:n.complete&&Dd(n.complete,i)}):o=n}this.destination=new Nb(o)}}function ul(t){io.useDeprecatedSynchronousErrorHandling?function di(t){io.useDeprecatedSynchronousErrorHandling&&Qn&&(Qn.errorThrown=!0,Qn.error=t)}(t):Wu(t)}function Ed(t,n){const{onStoppedNotification:e}=io;e&&li.setTimeout(()=>e(t,n))}const Fb={closed:!0,next:lr,error:function gv(t){throw t},complete:lr},hi="function"==typeof Symbol&&Symbol.observable||"@@observable";function Rr(t){return t}function ju(t){return 0===t.length?Rr:1===t.length?t[0]:function(e){return t.reduce((r,o)=>o(r),e)}}let xt=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new t;return r.source=this,r.operator=e,r}subscribe(e,r,o){const i=function Ob(t){return t&&t instanceof ja||function Pb(t){return t&&bt(t.next)&&bt(t.error)&&bt(t.complete)}(t)&&ci(t)}(e)?e:new Hu(e,r,o);return fi(()=>{const{operator:a,source:s}=this;i.add(a?a.call(i,s):s?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=vv(r))((o,i)=>{const a=new Hu({next:s=>{try{e(s)}catch(u){i(u),a.unsubscribe()}},error:i,complete:o});this.subscribe(a)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[hi](){return this}pipe(...e){return ju(e)(this)}toPromise(e){return new(e=vv(e))((r,o)=>{let i;this.subscribe(a=>i=a,a=>o(a),()=>r(i))})}}return t.create=n=>new t(n),t})();function vv(t){var n;return null!==(n=t??io.Promise)&&void 0!==n?n:Promise}const ks=Tr(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let fr=(()=>{class t extends xt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const r=new mv(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new ks}next(e){fi(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(e)}})}error(e){fi(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){fi(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:r,isStopped:o,observers:i}=this;return r||o?Uu:(this.currentObservers=null,i.push(e),new Hr(()=>{this.currentObservers=null,Fs(i,e)}))}_checkFinalizedStatuses(e){const{hasError:r,thrownError:o,isStopped:i}=this;r?e.error(o):i&&e.complete()}asObservable(){const e=new xt;return e.source=this,e}}return t.create=(n,e)=>new mv(n,e),t})();class mv extends fr{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,n)}error(n){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==r?r:Uu}}function Ps(t){return bt(t?.lift)}function Ht(t){return n=>{if(Ps(n))return n.lift(function(e){try{return t(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function yn(t,n,e,r,o){return new cl(t,n,e,r,o)}class cl extends ja{constructor(n,e,r,o,i,a){super(n),this.onFinalize=i,this.shouldUnsubscribe=a,this._next=e?function(s){try{e(s)}catch(u){n.error(u)}}:super._next,this._error=o?function(s){try{o(s)}catch(u){n.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(s){n.error(s)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function Ve(t,n){return Ht((e,r)=>{let o=0;e.subscribe(yn(r,i=>{r.next(t.call(n,i,o++))}))})}function pi(t){return this instanceof pi?(this.v=t,this):new pi(t)}function Sd(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=e.apply(t,n||[]),i=[];return o={},a("next"),a("throw"),a("return"),o[Symbol.asyncIterator]=function(){return this},o;function a(p){r[p]&&(o[p]=function(g){return new Promise(function(m,y){i.push([p,g,m,y])>1||s(p,g)})})}function s(p,g){try{!function u(p){p.value instanceof pi?Promise.resolve(p.value.v).then(c,f):d(i[0][2],p)}(r[p](g))}catch(m){d(i[0][3],m)}}function c(p){s("next",p)}function f(p){s("throw",p)}function d(p,g){p(g),i.shift(),i.length&&s(i[0][0],i[0][1])}}function Ad(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function yv(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],r=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(i){e[i]=t[i]&&function(a){return new Promise(function(s,u){!function o(i,a,s,u){Promise.resolve(u).then(function(c){i({value:c,done:s})},a)}(s,u,(a=t[i](a)).done,a.value)})}}}const Rd=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Md(t){return bt(t?.then)}function Nd(t){return bt(t[hi])}function Dv(t){return Symbol.asyncIterator&&bt(t?.[Symbol.asyncIterator])}function Ev(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Iv=function Bb(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Fd(t){return bt(t?.[Iv])}function Sv(t){return Sd(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:r,done:o}=yield pi(e.read());if(o)return yield pi(void 0);yield yield pi(r)}}finally{e.releaseLock()}})}function Av(t){return bt(t?.getReader)}function ao(t){if(t instanceof xt)return t;if(null!=t){if(Nd(t))return function kd(t){return new xt(n=>{const e=t[hi]();if(bt(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(Rd(t))return function Vb(t){return new xt(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(Md(t))return function Pd(t){return new xt(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,Wu)})}(t);if(Dv(t))return Tv(t);if(Fd(t))return function Ub(t){return new xt(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(Av(t))return function Wb(t){return Tv(Sv(t))}(t)}throw Ev(t)}function Tv(t){return new xt(n=>{(function Hb(t,n){var e,r,o,i;return function zu(t,n,e,r){return new(e||(e=Promise))(function(i,a){function s(f){try{c(r.next(f))}catch(d){a(d)}}function u(f){try{c(r.throw(f))}catch(d){a(d)}}function c(f){f.done?i(f.value):function o(i){return i instanceof e?i:new e(function(a){a(i)})}(f.value).then(s,u)}c((r=r.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=Ad(t);!(r=yield e.next()).done;)if(n.next(r.value),n.closed)return}catch(a){o={error:a}}finally{try{r&&!r.done&&(i=e.return)&&(yield i.call(e))}finally{if(o)throw o.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function gi(t,n,e,r=0,o=!1){const i=n.schedule(function(){e(),o?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(i),!o)return i}function wn(t,n,e=1/0){return bt(n)?wn((r,o)=>Ve((i,a)=>n(r,i,o,a))(ao(t(r,o))),e):("number"==typeof n&&(e=n),Ht((r,o)=>function jb(t,n,e,r,o,i,a,s){const u=[];let c=0,f=0,d=!1;const p=()=>{d&&!u.length&&!c&&n.complete()},g=y=>c<r?m(y):u.push(y),m=y=>{i&&n.next(y),c++;let w=!1;ao(e(y,f++)).subscribe(yn(n,b=>{o?.(b),i?g(b):n.next(b)},()=>{w=!0},void 0,()=>{if(w)try{for(c--;u.length&&c<r;){const b=u.shift();a?gi(n,a,()=>m(b)):m(b)}p()}catch(b){n.error(b)}}))};return t.subscribe(yn(n,g,()=>{d=!0,p()})),()=>{s?.()}}(r,o,t,e)))}function Bs(t=1/0){return wn(Rr,t)}const qo=new xt(t=>t.complete());function Rv(t){return t&&bt(t.schedule)}function Od(t){return t[t.length-1]}function qu(t){return Rv(Od(t))?t.pop():void 0}function Mv(t,n=0){return Ht((e,r)=>{e.subscribe(yn(r,o=>gi(r,t,()=>r.next(o),n),()=>gi(r,t,()=>r.complete(),n),o=>gi(r,t,()=>r.error(o),n)))})}function Ku(t,n=0){return Ht((e,r)=>{r.add(t.schedule(()=>e.subscribe(r),n))})}function Ld(t,n){if(!t)throw new Error("Iterable cannot be null");return new xt(e=>{gi(e,n,()=>{const r=t[Symbol.asyncIterator]();gi(e,n,()=>{r.next().then(o=>{o.done?e.complete():e.next(o.value)})},0,!0)})})}function bn(t,n){return n?function Xb(t,n){if(null!=t){if(Nd(t))return function Gb(t,n){return ao(t).pipe(Ku(n),Mv(n))}(t,n);if(Rd(t))return function Kb(t,n){return new xt(e=>{let r=0;return n.schedule(function(){r===t.length?e.complete():(e.next(t[r++]),e.closed||this.schedule())})})}(t,n);if(Md(t))return function qb(t,n){return ao(t).pipe(Ku(n),Mv(n))}(t,n);if(Dv(t))return Ld(t,n);if(Fd(t))return function Nv(t,n){return new xt(e=>{let r;return gi(e,n,()=>{r=t[Iv](),gi(e,n,()=>{let o,i;try{({value:o,done:i}=r.next())}catch(a){return void e.error(a)}i?e.complete():e.next(o)},0,!0)}),()=>bt(r?.return)&&r.return()})}(t,n);if(Av(t))return function Fv(t,n){return Ld(Sv(t),n)}(t,n)}throw Ev(t)}(t,n):ao(t)}function Bd(...t){const n=qu(t),e=function dl(t,n){return"number"==typeof Od(t)?t.pop():n}(t,1/0),r=t;return r.length?1===r.length?ao(r[0]):Bs(e)(bn(r,n)):qo}function hl(t,n,...e){if(!0===n)return void t();if(!1===n)return;const r=new Hu({next:()=>{r.unsubscribe(),t()}});return n(...e).subscribe(r)}function Bt(t){for(let n in t)if(t[n]===Bt)return n;throw Error("Could not find renamed property on target object.")}function Ft(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Ft).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function Vd(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const kv=Bt({__forward_ref__:Bt});function Vs(t){return t.__forward_ref__=Vs,t.toString=function(){return Ft(this())},t}function Ne(t){return function Ud(t){return"function"==typeof t&&t.hasOwnProperty(kv)&&t.__forward_ref__===Vs}(t)?t():t}function gl(t){return t&&!!t.\u0275providers}class ce extends Error{constructor(n,e){super(function vl(t,n){return`NG0${Math.abs(t)}${n?": "+n.trim():""}`}(n,e)),this.code=n}}function Ue(t){return"string"==typeof t?t:null==t?"":String(t)}function Yu(t,n){throw new ce(-201,!1)}function dr(t,n){null==t&&function Mt(t,n,e,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${e} ${r} ${n} <=Actual]`))}(n,t,null,"!=")}function He(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function ht(t){return{providers:t.providers||[],imports:t.imports||[]}}function ml(t){return Lv(t,Qu)||Lv(t,In)}function Lv(t,n){return t.hasOwnProperty(n)?t[n]:null}function Bv(t){return t&&(t.hasOwnProperty(Hd)||t.hasOwnProperty(Vv))?t[Hd]:null}const Qu=Bt({\u0275prov:Bt}),Hd=Bt({\u0275inj:Bt}),In=Bt({ngInjectableDef:Bt}),Vv=Bt({ngInjectorDef:Bt});var Ae=(()=>((Ae=Ae||{})[Ae.Default=0]="Default",Ae[Ae.Host=1]="Host",Ae[Ae.Self=2]="Self",Ae[Ae.SkipSelf=4]="SkipSelf",Ae[Ae.Optional=8]="Optional",Ae))();let yl;function Xt(t){const n=yl;return yl=t,n}function zd(t,n,e){const r=ml(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:e&Ae.Optional?null:void 0!==n?n:void Yu(Ft(t))}const Vt=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Vn={},$d="__NG_DI_FLAG__",hr="ngTempTokenPath",Uv=/\n/gm,Zu="__source";let za;function kt(t){const n=za;return za=t,n}function oa(t,n=Ae.Default){if(void 0===za)throw new ce(-203,!1);return null===za?zd(t,void 0,n):za.get(t,n&Ae.Optional?null:void 0,n)}function Ie(t,n=Ae.Default){return(function jd(){return yl}()||oa)(Ne(t),n)}function Pt(t,n=Ae.Default){return Ie(t,wl(n))}function wl(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Gd(t){const n=[];for(let e=0;e<t.length;e++){const r=Ne(t[e]);if(Array.isArray(r)){if(0===r.length)throw new ce(900,!1);let o,i=Ae.Default;for(let a=0;a<r.length;a++){const s=r[a],u=Hv(s);"number"==typeof u?-1===u?o=s.token:i|=u:o=s}n.push(Ie(o,i))}else n.push(Ie(r))}return n}function Ju(t,n){return t[$d]=n,t.prototype[$d]=n,t}function Hv(t){return t[$d]}function ia(t){return{toString:t}.toString()}var so=(()=>((so=so||{})[so.OnPush=0]="OnPush",so[so.Default=1]="Default",so))(),uo=(()=>{return(t=uo||(uo={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",uo;var t})();const Xo={},At=[],Ws=Bt({\u0275cmp:Bt}),ec=Bt({\u0275dir:Bt}),qd=Bt({\u0275pipe:Bt}),Kd=Bt({\u0275mod:Bt}),rn=Bt({\u0275fac:Bt}),$a=Bt({__NG_ELEMENT_ID__:Bt});let tc=0;function Hs(t){return ia(()=>{const e=!0===t.standalone,r={},o={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===so.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&t.dependencies||null,getStandaloneInjector:null,selectors:t.selectors||At,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||uo.Emulated,id:"c"+tc++,styles:t.styles||At,_:null,setInput:null,schemas:t.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},i=t.dependencies,a=t.features;return o.inputs=qv(t.inputs,r),o.outputs=qv(t.outputs),a&&a.forEach(s=>s(o)),o.directiveDefs=i?()=>("function"==typeof i?i():i).map($v).filter(Gv):null,o.pipeDefs=i?()=>("function"==typeof i?i():i).map(Zn).filter(Gv):null,o})}function $v(t){return Nt(t)||Sn(t)}function Gv(t){return null!==t}function aa(t){return ia(()=>({type:t.type,bootstrap:t.bootstrap||At,declarations:t.declarations||At,imports:t.imports||At,exports:t.exports||At,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function qv(t,n){if(null==t)return Xo;const e={};for(const r in t)if(t.hasOwnProperty(r)){let o=t[r],i=o;Array.isArray(o)&&(i=o[1],o=o[0]),e[o]=r,n&&(n[o]=i)}return e}const dn=Hs;function Mr(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function Nt(t){return t[Ws]||null}function Sn(t){return t[ec]||null}function Zn(t){return t[qd]||null}function Jn(t,n){const e=t[Kd]||null;if(!e&&!0===n)throw new Error(`Type ${Ft(t)} does not have '\u0275mod' property.`);return e}function Nr(t){return Array.isArray(t)&&"object"==typeof t[1]}function Io(t){return Array.isArray(t)&&!0===t[1]}function Xd(t){return 0!=(4&t.flags)}function Ka(t){return t.componentOffset>-1}function So(t){return 1==(1&t.flags)}function Fr(t){return null!==t.template}function Xv(t){return 0!=(256&t[2])}function la(t,n){return t.hasOwnProperty(rn)?t[rn]:null}class vx{constructor(n,e,r){this.previousValue=n,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}function mi(){return $s}function $s(t){return t.type.prototype.ngOnChanges&&(t.setInput=Gs),th}function th(){const t=Ks(this),n=t?.current;if(n){const e=t.previous;if(e===Xo)t.previous=n;else for(let r in n)e[r]=n[r];t.current=null,this.ngOnChanges(n)}}function Gs(t,n,e,r){const o=this.declaredInputs[e],i=Ks(t)||function Dl(t,n){return t[qs]=n}(t,{previous:Xo,current:null}),a=i.current||(i.current={}),s=i.previous,u=s[o];a[o]=new vx(u&&u.currentValue,n,s===Xo),t[r]=n}mi.ngInherit=!0;const qs="__ngSimpleChanges__";function Ks(t){return t[qs]||null}function an(t){for(;Array.isArray(t);)t=t[0];return t}function Xa(t,n){return an(n[t])}function $t(t,n){return an(n[t.index])}function oh(t,n){return t.data[n]}function $r(t,n){const e=n[t];return Nr(e)?e:e[0]}function Sl(t){return 64==(64&t[2])}function da(t,n){return null==n?null:t[n]}function em(t){t[18]=0}function ih(t,n){t[5]+=n;let e=t,r=t[3];for(;null!==r&&(1===n&&1===e[5]||-1===n&&0===e[5]);)r[5]+=n,e=r,r=r[3]}const Te={lFrame:hh(null),bindingsEnabled:!0};function Yo(){return Te.bindingsEnabled}function oe(){return Te.lFrame.lView}function pt(){return Te.lFrame.tView}function ah(t){return Te.lFrame.contextLView=t,t[8]}function yi(t){return Te.lFrame.contextLView=null,t}function Wn(){let t=nm();for(;null!==t&&64===t.type;)t=t.parent;return t}function nm(){return Te.lFrame.currentTNode}function Qo(t,n){const e=Te.lFrame;e.currentTNode=t,e.isParent=n}function sh(){return Te.lFrame.isParent}function Zo(){return Te.lFrame.bindingIndex++}function Ax(t,n){const e=Te.lFrame;e.bindingIndex=e.bindingRootIndex=t,ic(n)}function ic(t){Te.lFrame.currentDirectiveIndex=t}function Gr(){return Te.lFrame.currentQueryIndex}function fh(t){Te.lFrame.currentQueryIndex=t}function rm(t){const n=t[1];return 2===n.type?n.declTNode:1===n.type?t[6]:null}function dh(t,n,e){if(e&Ae.SkipSelf){let o=n,i=t;for(;!(o=o.parent,null!==o||e&Ae.Host||(o=rm(i),null===o||(i=i[15],10&o.type))););if(null===o)return!1;n=o,t=i}const r=Te.lFrame=_i();return r.currentTNode=n,r.lView=t,!0}function Qa(t){const n=_i(),e=t[1];Te.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function _i(){const t=Te.lFrame,n=null===t?null:t.child;return null===n?hh(t):n}function hh(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function om(){const t=Te.lFrame;return Te.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const ac=om;function ph(){const t=om();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function jn(){return Te.lFrame.selectedIndex}function ha(t){Te.lFrame.selectedIndex=t}function Rl(t,n){for(let e=n.directiveStart,r=n.directiveEnd;e<r;e++){const i=t.data[e].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:s,ngAfterViewInit:u,ngAfterViewChecked:c,ngOnDestroy:f}=i;a&&(t.contentHooks||(t.contentHooks=[])).push(-e,a),s&&((t.contentHooks||(t.contentHooks=[])).push(e,s),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(e,s)),u&&(t.viewHooks||(t.viewHooks=[])).push(-e,u),c&&((t.viewHooks||(t.viewHooks=[])).push(e,c),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(e,c)),null!=f&&(t.destroyHooks||(t.destroyHooks=[])).push(e,f)}}function Ml(t,n,e){sm(t,n,3,e)}function Nl(t,n,e,r){(3&t[2])===e&&sm(t,n,e,r)}function sc(t,n){let e=t[2];(3&e)===n&&(e&=2047,e+=1,t[2]=e)}function sm(t,n,e,r){const i=r??-1,a=n.length-1;let s=0;for(let u=void 0!==r?65535&t[18]:0;u<a;u++)if("number"==typeof n[u+1]){if(s=n[u],null!=r&&s>=r)break}else n[u]<0&&(t[18]+=65536),(s<i||-1==i)&&(uc(t,e,n,u),t[18]=(4294901760&t[18])+u+2),u++}function uc(t,n,e,r){const o=e[r]<0,i=e[r+1],s=t[o?-e[r]:e[r]];if(o){if(t[2]>>11<t[18]>>16&&(3&t[2])===n){t[2]+=2048;try{i.call(s)}finally{}}}else try{i.call(s)}finally{}}class cc{constructor(n,e,r){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}}function wh(t,n,e){let r=0;for(;r<e.length;){const o=e[r];if("number"==typeof o){if(0!==o)break;r++;const i=e[r++],a=e[r++],s=e[r++];t.setAttribute(n,a,s,i)}else{const i=o,a=e[++r];Fl(i)?t.setProperty(n,i,a):t.setAttribute(n,i,a),r++}}return r}function bh(t){return 3===t||4===t||6===t}function Fl(t){return 64===t.charCodeAt(0)}function dc(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let r=0;r<n.length;r++){const o=n[r];"number"==typeof o?e=o:0===e||kl(t,e,o,null,-1===e||2===e?n[++r]:null)}}return t}function kl(t,n,e,r,o){let i=0,a=t.length;if(-1===n)a=-1;else for(;i<t.length;){const s=t[i++];if("number"==typeof s){if(s===n){a=-1;break}if(s>n){a=i-1;break}}}for(;i<t.length;){const s=t[i];if("number"==typeof s)break;if(s===e){if(null===r)return void(null!==o&&(t[i+1]=o));if(r===t[i+1])return void(t[i+2]=o)}i++,null!==r&&i++,null!==o&&i++}-1!==a&&(t.splice(a,0,n),i=a+1),t.splice(i++,0,e),null!==r&&t.splice(i++,0,r),null!==o&&t.splice(i++,0,o)}function xh(t){return-1!==t}function Ja(t){return 32767&t}function Di(t,n){let e=function cm(t){return t>>16}(t),r=n;for(;e>0;)r=r[15],e--;return r}let _h=!0;function hc(t){const n=_h;return _h=t,n}let Mx=0;const ho={};function Ys(t,n){const e=pc(t,n);if(-1!==e)return e;const r=n[1];r.firstCreatePass&&(t.injectorIndex=n.length,Dh(r.data,t),Dh(n,null),Dh(r.blueprint,null));const o=Xe(t,n),i=t.injectorIndex;if(xh(o)){const a=Ja(o),s=Di(o,n),u=s[1].data;for(let c=0;c<8;c++)n[i+c]=s[a+c]|u[a+c]}return n[i+8]=o,i}function Dh(t,n){t.push(0,0,0,0,0,0,0,0,n)}function pc(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function Xe(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,r=null,o=n;for(;null!==o;){if(r=Mh(o),null===r)return-1;if(e++,o=o[15],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return-1}function Eh(t,n,e){!function fm(t,n,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty($a)&&(r=e[$a]),null==r&&(r=e[$a]=Mx++);const o=255&r;n.data[t+(o>>5)]|=1<<o}(t,n,e)}function Qs(t,n,e){if(e&Ae.Optional||void 0!==t)return t;Yu()}function Ih(t,n,e,r){if(e&Ae.Optional&&void 0===r&&(r=null),0==(e&(Ae.Self|Ae.Host))){const o=t[9],i=Xt(void 0);try{return o?o.get(n,r,e&Ae.Optional):zd(n,r,e&Ae.Optional)}finally{Xt(i)}}return Qs(r,0,e)}function dm(t,n,e,r=Ae.Default,o){if(null!==t){if(1024&n[2]){const a=function Ll(t,n,e,r,o){let i=t,a=n;for(;null!==i&&null!==a&&1024&a[2]&&!(256&a[2]);){const s=hm(i,a,e,r|Ae.Self,ho);if(s!==ho)return s;let u=i.parent;if(!u){const c=a[21];if(c){const f=c.get(e,ho,r);if(f!==ho)return f}u=Mh(a),a=a[15]}i=u}return o}(t,n,e,r,ho);if(a!==ho)return a}const i=hm(t,n,e,r,ho);if(i!==ho)return i}return Ih(n,e,r,o)}function hm(t,n,e,r,o){const i=function Sh(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty($a)?t[$a]:void 0;return"number"==typeof n?n>=0?255&n:pa:n}(e);if("function"==typeof i){if(!dh(n,t,r))return r&Ae.Host?Qs(o,0,r):Ih(n,e,r,o);try{const a=i(r);if(null!=a||r&Ae.Optional)return a;Yu()}finally{ac()}}else if("number"==typeof i){let a=null,s=pc(t,n),u=-1,c=r&Ae.Host?n[16][6]:null;for((-1===s||r&Ae.SkipSelf)&&(u=-1===s?Xe(t,n):n[s+8],-1!==u&&Th(r,!1)?(a=n[1],s=Ja(u),n=Di(u,n)):s=-1);-1!==s;){const f=n[1];if(Ah(i,s,f.data)){const d=po(s,n,e,a,r,c);if(d!==ho)return d}u=n[s+8],-1!==u&&Th(r,n[1].data[s+8]===c)&&Ah(i,s,n)?(a=f,s=Ja(u),n=Di(u,n)):s=-1}}return o}function po(t,n,e,r,o,i){const a=n[1],s=a.data[t+8],f=Pl(s,a,e,null==r?Ka(s)&&_h:r!=a&&0!=(3&s.type),o&Ae.Host&&i===s);return null!==f?Ei(n,a,f,s):ho}function Pl(t,n,e,r,o){const i=t.providerIndexes,a=n.data,s=1048575&i,u=t.directiveStart,f=i>>20,p=o?s+f:t.directiveEnd;for(let g=r?s:s+f;g<p;g++){const m=a[g];if(g<u&&e===m||g>=u&&m.type===e)return g}if(o){const g=a[u];if(g&&Fr(g)&&g.type===e)return u}return null}function Ei(t,n,e,r){let o=t[e];const i=n.data;if(function Tx(t){return t instanceof cc}(o)){const a=o;a.resolving&&function Wd(t,n){const e=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new ce(-200,`Circular dependency in DI detected for ${t}${e}`)}(function _t(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Ue(t)}(i[e]));const s=hc(a.canSeeViewProviders);a.resolving=!0;const u=a.injectImpl?Xt(a.injectImpl):null;dh(t,r,Ae.Default);try{o=t[e]=a.factory(void 0,i,t,r),n.firstCreatePass&&e>=r.directiveStart&&function vh(t,n,e){const{ngOnChanges:r,ngOnInit:o,ngDoCheck:i}=n.type.prototype;if(r){const a=$s(n);(e.preOrderHooks||(e.preOrderHooks=[])).push(t,a),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,a)}o&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-t,o),i&&((e.preOrderHooks||(e.preOrderHooks=[])).push(t,i),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,i))}(e,i[e],n)}finally{null!==u&&Xt(u),hc(s),a.resolving=!1,ac()}}return o}function Ah(t,n,e){return!!(e[n+(t>>5)]&1<<t)}function Th(t,n){return!(t&Ae.Self||t&Ae.Host&&n)}class Tn{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,r){return dm(this._tNode,this._lView,n,wl(r),e)}}function pa(){return new Tn(Wn(),oe())}function Mh(t){const n=t[1],e=n.type;return 2===e?n.declTNode:1===e?t[6]:null}const ga="__parameters__";function qr(t,n,e){return ia(()=>{const r=function Nh(t){return function(...e){if(t){const r=t(...e);for(const o in r)this[o]=r[o]}}}(n);function o(...i){if(this instanceof o)return r.apply(this,i),this;const a=new o(...i);return s.annotation=a,s;function s(u,c,f){const d=u.hasOwnProperty(ga)?u[ga]:Object.defineProperty(u,ga,{value:[]})[ga];for(;d.length<=f;)d.push(null);return(d[f]=d[f]||[]).push(a),u}}return e&&(o.prototype=Object.create(e.prototype)),o.prototype.ngMetadataName=t,o.annotationCls=o,o})}class Me{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=He({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function kr(t,n){void 0===n&&(n=t);for(let e=0;e<t.length;e++){let r=t[e];Array.isArray(r)?(n===t&&(n=t.slice(0,e)),kr(r,n)):n!==t&&n.push(r)}return n}function ts(t,n){t.forEach(e=>Array.isArray(e)?ts(e,n):n(e))}function kh(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function Ai(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function yr(t,n,e){let r=tu(t,n);return r>=0?t[1|r]=e:(r=~r,function ym(t,n,e,r){let o=t.length;if(o==n)t.push(e,r);else if(1===o)t.push(r,t[0]),t[0]=e;else{for(o--,t.push(t[o-1],t[o]);o>n;)t[o]=t[o-2],o--;t[n]=e,t[n+1]=r}}(t,r,n,e)),r}function eu(t,n){const e=tu(t,n);if(e>=0)return t[1|e]}function tu(t,n){return function mc(t,n,e){let r=0,o=t.length>>e;for(;o!==r;){const i=r+(o-r>>1),a=t[i<<e];if(n===a)return i<<e;a>n?o=i:r=i+1}return~(o<<e)}(t,n,1)}const yc=Ju(qr("Optional"),8),Xr=Ju(qr("SkipSelf"),4);var nr=(()=>((nr=nr||{})[nr.Important=1]="Important",nr[nr.DashCase=2]="DashCase",nr))();const go=new Map;let is=0;const Gh="__ngContext__";function rr(t,n){Nr(n)?(t[Gh]=n[20],function Mm(t){go.set(t[20],t)}(n)):t[Gh]=n}function Xh(t,n){return undefined(t,n)}function or(t){const n=t[3];return Io(n)?n[3]:n}function Yh(t){return Hm(t[13])}function ql(t){return Hm(t[4])}function Hm(t){for(;null!==t&&!Io(t);)t=t[4];return t}function ru(t,n,e,r,o){if(null!=r){let i,a=!1;Io(r)?i=r:Nr(r)&&(a=!0,r=r[0]);const s=an(r);0===t&&null!==e?null==o?qm(n,e,s):as(n,e,s,o||null,!0):1===t&&null!==e?as(n,e,s,o||null,!0):2===t?function ou(t,n,e){const r=xc(t,n);r&&function l1(t,n,e,r){t.removeChild(n,e,r)}(t,r,n,e)}(n,s,a):3===t&&n.destroyNode(s),null!=i&&function h1(t,n,e,r,o){const i=e[7];i!==an(e)&&ru(n,t,r,i,o);for(let s=10;s<e.length;s++){const u=e[s];_c(u[1],u,t,n,r,i)}}(n,t,i,e,o)}}function Zh(t,n,e){return t.createElement(n,e)}function jm(t,n){const e=t[9],r=e.indexOf(n),o=n[3];512&n[2]&&(n[2]&=-513,ih(o,-1)),e.splice(r,1)}function Jh(t,n){if(t.length<=10)return;const e=10+n,r=t[e];if(r){const o=r[17];null!==o&&o!==t&&jm(o,r),n>0&&(t[e-1][4]=r[4]);const i=Ai(t,10+n);!function n1(t,n){_c(t,n,n[11],2,null,null),n[0]=null,n[6]=null}(r[1],r);const a=i[19];null!==a&&a.detachView(i[1]),r[3]=null,r[4]=null,r[2]&=-65}return r}function zm(t,n){if(!(128&n[2])){const e=n[11];e.destroyNode&&_c(t,n,e,3,null,null),function i1(t){let n=t[13];if(!n)return ep(t[1],t);for(;n;){let e=null;if(Nr(n))e=n[13];else{const r=n[10];r&&(e=r)}if(!e){for(;n&&!n[4]&&n!==t;)Nr(n)&&ep(n[1],n),n=n[3];null===n&&(n=t),Nr(n)&&ep(n[1],n),e=n&&n[4]}n=e}}(n)}}function ep(t,n){if(!(128&n[2])){n[2]&=-65,n[2]|=128,function c1(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let r=0;r<e.length;r+=2){const o=n[e[r]];if(!(o instanceof cc)){const i=e[r+1];if(Array.isArray(i))for(let a=0;a<i.length;a+=2){const s=o[i[a]],u=i[a+1];try{u.call(s)}finally{}}else try{i.call(o)}finally{}}}}(t,n),function u1(t,n){const e=t.cleanup,r=n[7];let o=-1;if(null!==e)for(let i=0;i<e.length-1;i+=2)if("string"==typeof e[i]){const a=e[i+1],s="function"==typeof a?a(n):an(n[a]),u=r[o=e[i+2]],c=e[i+3];"boolean"==typeof c?s.removeEventListener(e[i],u,c):c>=0?r[o=c]():r[o=-c].unsubscribe(),i+=2}else{const a=r[o=e[i+1]];e[i].call(a)}if(null!==r){for(let i=o+1;i<r.length;i++)(0,r[i])();n[7]=null}}(t,n),1===n[1].type&&n[11].destroy();const e=n[17];if(null!==e&&Io(n[3])){e!==n[3]&&jm(e,n);const r=n[19];null!==r&&r.detachView(t)}!function qx(t){go.delete(t[20])}(n)}}function $m(t,n,e){return function Gm(t,n,e){let r=n;for(;null!==r&&40&r.type;)r=(n=r).parent;if(null===r)return e[0];{const{componentOffset:o}=r;if(o>-1){const{encapsulation:i}=t.data[r.directiveStart+o];if(i===uo.None||i===uo.Emulated)return null}return $t(r,e)}}(t,n.parent,e)}function as(t,n,e,r,o){t.insertBefore(n,e,r,o)}function qm(t,n,e){t.appendChild(n,e)}function Km(t,n,e,r,o){null!==r?as(t,n,e,r,o):qm(t,n,e)}function xc(t,n){return t.parentNode(n)}let Zl,Zm=function Qm(t,n,e){return 40&t.type?$t(t,e):null};function Xl(t,n,e,r){const o=$m(t,r,n),i=n[11],s=function Ym(t,n,e){return Zm(t,n,e)}(r.parent||n[6],r,n);if(null!=o)if(Array.isArray(e))for(let u=0;u<e.length;u++)Km(i,o,e[u],s,!1);else Km(i,o,e,s,!1)}function Yl(t,n){if(null!==n){const e=n.type;if(3&e)return $t(n,t);if(4&e)return rp(-1,t[n.index]);if(8&e){const r=n.child;if(null!==r)return Yl(t,r);{const o=t[n.index];return Io(o)?rp(-1,o):an(o)}}if(32&e)return Xh(n,t)()||an(t[n.index]);{const r=np(t,n);return null!==r?Array.isArray(r)?r[0]:Yl(or(t[16]),r):Yl(t,n.next)}}return null}function np(t,n){return null!==n?t[16][6].projection[n.projection]:null}function rp(t,n){const e=10+t+1;if(e<n.length){const r=n[e],o=r[1].firstChild;if(null!==o)return Yl(r,o)}return n[7]}function op(t,n,e,r,o,i,a){for(;null!=e;){const s=r[e.index],u=e.type;if(a&&0===n&&(s&&rr(an(s),r),e.flags|=2),32!=(32&e.flags))if(8&u)op(t,n,e.child,r,o,i,!1),ru(n,t,o,s,i);else if(32&u){const c=Xh(e,r);let f;for(;f=c();)ru(n,t,o,f,i);ru(n,t,o,s,i)}else 16&u?ey(t,n,r,e,o,i):ru(n,t,o,s,i);e=a?e.projectionNext:e.next}}function _c(t,n,e,r,o,i){op(e,r,t.firstChild,n,o,i,!1)}function ey(t,n,e,r,o,i){const a=e[16],u=a[6].projection[r.projection];if(Array.isArray(u))for(let c=0;c<u.length;c++)ru(n,t,o,u[c],i);else op(t,n,u,a[3],o,i,!0)}function ty(t,n,e){""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}function ny(t,n,e){const{mergedAttrs:r,classes:o,styles:i}=e;null!==r&&wh(t,n,r),null!==o&&ty(t,n,o),null!==i&&function g1(t,n,e){t.setAttribute(n,"style",e)}(t,n,i)}class sy{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}const iu=new Me("ENVIRONMENT_INITIALIZER"),yy=new Me("INJECTOR",-1),Jo=new Me("INJECTOR_DEF_TYPES");class fp{get(n,e=Vn){if(e===Vn){const r=new Error(`NullInjectorError: No provider for ${Ft(n)}!`);throw r.name="NullInjectorError",r}return e}}function Qt(...t){return{\u0275providers:Zt(0,t),\u0275fromNgModule:!0}}function Zt(t,...n){const e=[],r=new Set;let o;return ts(n,i=>{const a=i;pp(a,e,[],r)&&(o||(o=[]),o.push(a))}),void 0!==o&&hp(o,e),e}function hp(t,n){for(let e=0;e<t.length;e++){const{providers:o}=t[e];gp(o,i=>{n.push(i)})}}function pp(t,n,e,r){if(!(t=Ne(t)))return!1;let o=null,i=Bv(t);const a=!i&&Nt(t);if(i||a){if(a&&!a.standalone)return!1;o=t}else{const u=t.ngModule;if(i=Bv(u),!i)return!1;o=u}const s=r.has(o);if(a){if(s)return!1;if(r.add(o),a.dependencies){const u="function"==typeof a.dependencies?a.dependencies():a.dependencies;for(const c of u)pp(c,n,e,r)}}else{if(!i)return!1;{if(null!=i.imports&&!s){let c;r.add(o);try{ts(i.imports,f=>{pp(f,n,e,r)&&(c||(c=[]),c.push(f))})}finally{}void 0!==c&&hp(c,n)}if(!s){const c=la(o)||(()=>new o);n.push({provide:o,useFactory:c,deps:At},{provide:Jo,useValue:o,multi:!0},{provide:iu,useValue:()=>Ie(o),multi:!0})}const u=i.providers;null==u||s||gp(u,f=>{n.push(f)})}}return o!==t&&void 0!==t.providers}function gp(t,n){for(let e of t)gl(e)&&(e=e.\u0275providers),Array.isArray(e)?gp(e,n):n(e)}const O1=Bt({provide:String,useValue:Bt});function vp(t){return null!==t&&"object"==typeof t&&O1 in t}function To(t){return"function"==typeof t}const wp=new Me("Set Injector scope."),Tc={},nf={};let xr;function Ni(){return void 0===xr&&(xr=new fp),xr}class _a{}class by extends _a{constructor(n,e,r,o){super(),this.parent=e,this.source=r,this.scopes=o,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,rf(n,a=>this.processProvider(a)),this.records.set(yy,Pr(void 0,this)),o.has("environment")&&this.records.set(_a,Pr(void 0,this));const i=this.records.get(wp);null!=i&&"string"==typeof i.value&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(Jo.multi,At,Ae.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();for(const n of this._onDestroyHooks)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(n){this._onDestroyHooks.push(n)}runInContext(n){this.assertNotDestroyed();const e=kt(this),r=Xt(void 0);try{return n()}finally{kt(e),Xt(r)}}get(n,e=Vn,r=Ae.Default){this.assertNotDestroyed(),r=wl(r);const o=kt(this),i=Xt(void 0);try{if(!(r&Ae.SkipSelf)){let s=this.records.get(n);if(void 0===s){const u=function vo(t){return"function"==typeof t||"object"==typeof t&&t instanceof Me}(n)&&ml(n);s=u&&this.injectableDefInScope(u)?Pr(bp(n),Tc):null,this.records.set(n,s)}if(null!=s)return this.hydrate(n,s)}return(r&Ae.Self?Ni():this.parent).get(n,e=r&Ae.Optional&&e===Vn?null:e)}catch(a){if("NullInjectorError"===a.name){if((a[hr]=a[hr]||[]).unshift(Ft(n)),o)throw a;return function bl(t,n,e,r){const o=t[hr];throw n[Zu]&&o.unshift(n[Zu]),t.message=function Us(t,n,e,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let o=Ft(n);if(Array.isArray(n))o=n.map(Ft).join(" -> ");else if("object"==typeof n){let i=[];for(let a in n)if(n.hasOwnProperty(a)){let s=n[a];i.push(a+":"+("string"==typeof s?JSON.stringify(s):Ft(s)))}o=`{${i.join(", ")}}`}return`${e}${r?"("+r+")":""}[${o}]: ${t.replace(Uv,"\n  ")}`}("\n"+t.message,o,e,r),t.ngTokenPath=o,t[hr]=null,t}(a,n,"R3InjectorError",this.source)}throw a}finally{Xt(i),kt(o)}}resolveInjectorInitializers(){const n=kt(this),e=Xt(void 0);try{const r=this.get(iu.multi,At,Ae.Self);for(const o of r)o()}finally{kt(n),Xt(e)}}toString(){const n=[],e=this.records;for(const r of e.keys())n.push(Ft(r));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ce(205,!1)}processProvider(n){let e=To(n=Ne(n))?n:Ne(n&&n.provide);const r=function B1(t){return vp(t)?Pr(void 0,t.useValue):Pr(function xp(t,n,e){let r;if(To(t)){const o=Ne(t);return la(o)||bp(o)}if(vp(t))r=()=>Ne(t.useValue);else if(function mp(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...Gd(t.deps||[]));else if(function wy(t){return!(!t||!t.useExisting)}(t))r=()=>Ie(Ne(t.useExisting));else{const o=Ne(t&&(t.useClass||t.provide));if(!function Ye(t){return!!t.deps}(t))return la(o)||bp(o);r=()=>new o(...Gd(t.deps))}return r}(t),Tc)}(n);if(To(n)||!0!==n.multi)this.records.get(e);else{let o=this.records.get(e);o||(o=Pr(void 0,Tc,!0),o.factory=()=>Gd(o.multi),this.records.set(e,o)),e=n,o.multi.push(n)}this.records.set(e,r)}hydrate(n,e){return e.value===Tc&&(e.value=nf,e.value=e.factory()),"object"==typeof e.value&&e.value&&function xy(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(n){if(!n.providedIn)return!1;const e=Ne(n.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function bp(t){const n=ml(t),e=null!==n?n.factory:la(t);if(null!==e)return e;if(t instanceof Me)throw new ce(204,!1);if(t instanceof Function)return function L1(t){const n=t.length;if(n>0)throw function Ti(t,n){const e=[];for(let r=0;r<t;r++)e.push(n);return e}(n,"?"),new ce(204,!1);const e=function ox(t){const n=t&&(t[Qu]||t[In]);if(n){const e=function ix(t){if(t.hasOwnProperty("name"))return t.name;const n=(""+t).match(/^function\s*([^\s(]+)/);return null===n?"":n[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),n}return null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new ce(204,!1)}function Pr(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function rf(t,n){for(const e of t)Array.isArray(e)?rf(e,n):e&&gl(e)?rf(e.\u0275providers,n):n(e)}class V1{}class Tt{}class W1{resolveComponentFactory(n){throw function U1(t){const n=Error(`No component factory found for ${Ft(t)}. Did you add it to @NgModule.entryComponents?`);return n.ngComponent=t,n}(n)}}let Rc=(()=>{class t{}return t.NULL=new W1,t})();function H1(){return au(Wn(),oe())}function au(t,n){return new Fi($t(t,n))}let Fi=(()=>{class t{constructor(e){this.nativeElement=e}}return t.__NG_ELEMENT_ID__=H1,t})();function j1(t){return t instanceof Fi?t.nativeElement:t}class _y{}let su=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function z1(){const t=oe(),e=$r(Wn().index,t);return(Nr(e)?e:t)[11]}(),t})(),$1=(()=>{class t{}return t.\u0275prov=He({token:t,providedIn:"root",factory:()=>null}),t})();class af{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const G1=new af("15.0.0"),Mc={};function Ip(t){return t.ngOriginalError}class uu{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n);this._console.error("ERROR",n),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&Ip(n);for(;e&&Ip(e);)e=Ip(e);return e||null}}function ki(t){return t instanceof Function?t():t}function Sp(t,n,e){let r=t.length;for(;;){const o=t.indexOf(n,e);if(-1===o)return o;if(0===o||t.charCodeAt(o-1)<=32){const i=n.length;if(o+i===r||t.charCodeAt(o+i)<=32)return o}e=o+1}}const Iy="ng-template";function J1(t,n,e){let r=0;for(;r<t.length;){let o=t[r++];if(e&&"class"===o){if(o=t[r],-1!==Sp(o.toLowerCase(),n,0))return!0}else if(1===o){for(;r<t.length&&"string"==typeof(o=t[r++]);)if(o.toLowerCase()===n)return!0;return!1}}return!1}function Sy(t){return 4===t.type&&t.value!==Iy}function lu(t,n,e){return n===(4!==t.type||e?t.value:Iy)}function e_(t,n,e){let r=4;const o=t.attrs||[],i=function Ty(t){for(let n=0;n<t.length;n++)if(bh(t[n]))return n;return t.length}(o);let a=!1;for(let s=0;s<n.length;s++){const u=n[s];if("number"!=typeof u){if(!a)if(4&r){if(r=2|1&r,""!==u&&!lu(t,u,e)||""===u&&1===n.length){if(Ro(r))return!1;a=!0}}else{const c=8&r?u:n[++s];if(8&r&&null!==t.attrs){if(!J1(t.attrs,c,e)){if(Ro(r))return!1;a=!0}continue}const d=t_(8&r?"class":u,o,Sy(t),e);if(-1===d){if(Ro(r))return!1;a=!0;continue}if(""!==c){let p;p=d>i?"":o[d+1].toLowerCase();const g=8&r?p:null;if(g&&-1!==Sp(g,c,0)||2&r&&c!==p){if(Ro(r))return!1;a=!0}}}}else{if(!a&&!Ro(r)&&!Ro(u))return!1;if(a&&Ro(u))continue;a=!1,r=u|1&r}}return Ro(r)||a}function Ro(t){return 0==(1&t)}function t_(t,n,e,r){if(null===n)return-1;let o=0;if(r||!e){let i=!1;for(;o<n.length;){const a=n[o];if(a===t)return o;if(3===a||6===a)i=!0;else{if(1===a||2===a){let s=n[++o];for(;"string"==typeof s;)s=n[++o];continue}if(4===a)break;if(0===a){o+=4;continue}}o+=i?1:2}return-1}return function Ry(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const r=t[e];if("number"==typeof r)return-1;if(r===n)return e;e++}return-1}(n,t)}function Ay(t,n,e=!1){for(let r=0;r<n.length;r++)if(e_(t,n[r],e))return!0;return!1}function My(t,n){return t?":not("+n.trim()+")":n}function o_(t){let n=t[0],e=1,r=2,o="",i=!1;for(;e<t.length;){let a=t[e];if("string"==typeof a)if(2&r){const s=t[++e];o+="["+a+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?o+="."+a:4&r&&(o+=" "+a);else""!==o&&!Ro(a)&&(n+=My(i,o),o=""),r=a,i=i||!Ro(r);e++}return""!==o&&(n+=My(i,o)),n}const ze={};function fu(t){Ny(pt(),oe(),jn()+t,!1)}function Ny(t,n,e,r){if(!r)if(3==(3&n[2])){const i=t.preOrderCheckHooks;null!==i&&Ml(n,i,e)}else{const i=t.preOrderHooks;null!==i&&Nl(n,i,0,e)}ha(e)}function Oy(t,n=null,e=null,r){const o=Ly(t,n,e,r);return o.resolveInjectorInitializers(),o}function Ly(t,n=null,e=null,r,o=new Set){const i=[e||At,Qt(t)];return r=r||("object"==typeof t?void 0:Ft(t)),new by(i,n||Ni(),r||null,o)}let mo=(()=>{class t{static create(e,r){if(Array.isArray(e))return Oy({name:""},r,e,"");{const o=e.name??"";return Oy({name:o},e.parent,e.providers,o)}}}return t.THROW_IF_NOT_FOUND=Vn,t.NULL=new fp,t.\u0275prov=He({token:t,providedIn:"any",factory:()=>Ie(yy)}),t.__NG_ELEMENT_ID__=-1,t})();function Se(t,n=Ae.Default){const e=oe();return null===e?Ie(t,n):dm(Wn(),e,Ne(t),n)}function Nc(){throw new Error("invalid")}function ff(t,n){return t<<17|n<<2}function Mo(t){return t>>17&32767}function Fp(t){return 2|t}function Pi(t){return(131068&t)>>2}function kp(t,n){return-131069&t|n<<2}function Pp(t){return 1|t}function L2(t,n){const e=t.contentQueries;if(null!==e)for(let r=0;r<e.length;r+=2){const o=e[r],i=e[r+1];if(-1!==i){const a=t.data[i];fh(o),a.contentQueries(2,n[i],i)}}}function Ky(t,n,e,r,o,i,a,s,u,c,f){const d=n.blueprint.slice();return d[0]=o,d[2]=76|r,(null!==f||t&&1024&t[2])&&(d[2]|=1024),em(d),d[3]=d[15]=t,d[8]=e,d[10]=a||t&&t[10],d[11]=s||t&&t[11],d[12]=u||t&&t[12]||null,d[9]=c||t&&t[9]||null,d[6]=i,d[20]=function Gx(){return is++}(),d[21]=f,d[16]=2==n.type?t[16]:d,d}function gf(t,n,e,r,o){let i=t.data[n];if(null===i)i=function I_(t,n,e,r,o){const i=nm(),a=sh(),u=t.data[n]=function BB(t,n,e,r,o,i){return{type:e,index:r,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:o,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?i:i&&i.parent,e,n,r,o);return null===t.firstChild&&(t.firstChild=u),null!==i&&(a?null==i.child&&null!==u.parent&&(i.child=u):null===i.next&&(i.next=u)),u}(t,n,e,r,o),function Sx(){return Te.lFrame.inI18n}()&&(i.flags|=32);else if(64&i.type){i.type=e,i.value=r,i.attrs=o;const a=function gr(){const t=Te.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();i.injectorIndex=null===a?-1:a.injectorIndex}return Qo(i,!0),i}function Vp(t,n,e,r){if(0===e)return-1;const o=n.length;for(let i=0;i<e;i++)n.push(r),t.blueprint.push(r),t.data.push(null);return o}function S_(t,n,e){Qa(n);try{const r=t.viewQuery;null!==r&&L_(1,r,e);const o=t.template;null!==o&&B2(t,n,o,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&L2(t,n),t.staticViewQueries&&L_(2,t.viewQuery,e);const i=t.components;null!==i&&function PB(t,n){for(let e=0;e<n.length;e++)r4(t,n[e])}(n,i)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{n[2]&=-5,ph()}}function Xy(t,n,e,r){const o=n[2];if(128!=(128&o)){Qa(n);try{em(n),function Al(t){return Te.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&B2(t,n,e,2,r);const a=3==(3&o);if(a){const c=t.preOrderCheckHooks;null!==c&&Ml(n,c,null)}else{const c=t.preOrderHooks;null!==c&&Nl(n,c,0,null),sc(n,0)}if(function t4(t){for(let n=Yh(t);null!==n;n=ql(n)){if(!n[2])continue;const e=n[9];for(let r=0;r<e.length;r++){const o=e[r],i=o[3];0==(512&o[2])&&ih(i,1),o[2]|=512}}}(n),function e4(t){for(let n=Yh(t);null!==n;n=ql(n))for(let e=10;e<n.length;e++){const r=n[e],o=r[1];Sl(r)&&Xy(o,r,o.template,r[8])}}(n),null!==t.contentQueries&&L2(t,n),a){const c=t.contentCheckHooks;null!==c&&Ml(n,c)}else{const c=t.contentHooks;null!==c&&Nl(n,c,1),sc(n,1)}!function FB(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const o=e[r];if(o<0)ha(~o);else{const i=o,a=e[++r],s=e[++r];Ax(a,i),s(2,n[i])}}}finally{ha(-1)}}(t,n);const s=t.components;null!==s&&function kB(t,n){for(let e=0;e<n.length;e++)n4(t,n[e])}(n,s);const u=t.viewQuery;if(null!==u&&L_(2,u,r),a){const c=t.viewCheckHooks;null!==c&&Ml(n,c)}else{const c=t.viewHooks;null!==c&&Nl(n,c,2),sc(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[2]&=-41,512&n[2]&&(n[2]&=-513,ih(n[3],-1))}finally{ph()}}}function B2(t,n,e,r,o){const i=jn(),a=2&r;try{ha(-1),a&&n.length>22&&Ny(t,n,22,!1),e(r,o)}finally{ha(i)}}function A_(t,n,e){if(Xd(n)){const o=n.directiveEnd;for(let i=n.directiveStart;i<o;i++){const a=t.data[i];a.contentQueries&&a.contentQueries(1,e[i],i)}}}function T_(t,n,e){!Yo()||(function zB(t,n,e,r){const o=e.directiveStart,i=e.directiveEnd;t.firstCreatePass||Ys(e,n),rr(r,n);const a=e.initialInputs;for(let s=o;s<i;s++){const u=t.data[s],c=Fr(u);c&&QB(n,e,u);const f=Ei(n,t,s,e);rr(f,n),null!==a&&ZB(0,s-o,f,u,0,a),c&&($r(e.index,n)[8]=f)}}(t,n,e,$t(e,n)),64==(64&e.flags)&&$2(t,n,e))}function R_(t,n,e=$t){const r=n.localNames;if(null!==r){let o=n.index+1;for(let i=0;i<r.length;i+=2){const a=r[i+1],s=-1===a?e(n,t):t[a];t[o++]=s}}}function V2(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=M_(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function M_(t,n,e,r,o,i,a,s,u,c){const f=22+r,d=f+o,p=function OB(t,n){const e=[];for(let r=0;r<n;r++)e.push(r<t?null:ze);return e}(f,d),g="function"==typeof c?c():c;return p[1]={type:t,blueprint:p,template:e,queries:null,viewQuery:s,declTNode:n,data:p.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:u,consts:g,incompleteFirstPass:!1}}function U2(t,n,e,r){const o=q2(n);null===e?o.push(r):(o.push(e),t.firstCreatePass&&K2(t).push(r,o.length-1))}function W2(t,n,e,r){for(let o in t)if(t.hasOwnProperty(o)){e=null===e?{}:e;const i=t[o];null===r?H2(e,n,o,i):r.hasOwnProperty(o)&&H2(e,n,r[o],i)}return e}function H2(t,n,e,r){t.hasOwnProperty(e)?t[e].push(n,r):t[e]=[n,r]}function j2(t,n){const e=$r(n,t);16&e[2]||(e[2]|=32)}function N_(t,n,e,r){let o=!1;if(Yo()){const i=null===r?null:{"":-1},a=function GB(t,n){const e=t.directiveRegistry;let r=null,o=null;if(e)for(let i=0;i<e.length;i++){const a=e[i];if(Ay(n,a.selectors,!1))if(r||(r=[]),Fr(a))if(null!==a.findHostDirectiveDefs){const s=[];o=o||new Map,a.findHostDirectiveDefs(a,s,o),r.unshift(...s,a),F_(t,n,s.length)}else r.unshift(a),F_(t,n,0);else o=o||new Map,a.findHostDirectiveDefs?.(a,r,o),r.push(a)}return null===r?null:[r,o]}(t,e);let s,u;null===a?s=u=null:[s,u]=a,null!==s&&(o=!0,z2(t,n,e,s,i,u)),i&&function qB(t,n,e){if(n){const r=t.localNames=[];for(let o=0;o<n.length;o+=2){const i=e[n[o+1]];if(null==i)throw new ce(-301,!1);r.push(n[o],i)}}}(e,r,i)}return e.mergedAttrs=dc(e.mergedAttrs,e.attrs),o}function z2(t,n,e,r,o,i){for(let c=0;c<r.length;c++)Eh(Ys(e,n),t,r[c].type);!function XB(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}(e,t.data.length,r.length);for(let c=0;c<r.length;c++){const f=r[c];f.providersResolver&&f.providersResolver(f)}let a=!1,s=!1,u=Vp(t,n,r.length,null);for(let c=0;c<r.length;c++){const f=r[c];e.mergedAttrs=dc(e.mergedAttrs,f.hostAttrs),YB(t,e,n,u,f),KB(u,f,o),null!==f.contentQueries&&(e.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(e.flags|=64);const d=f.type.prototype;!a&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(e.index),a=!0),!s&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(e.index),s=!0),u++}!function VB(t,n,e){const o=n.directiveEnd,i=t.data,a=n.attrs,s=[];let u=null,c=null;for(let f=n.directiveStart;f<o;f++){const d=i[f],p=e?e.get(d):null,m=p?p.outputs:null;u=W2(d.inputs,f,u,p?p.inputs:null),c=W2(d.outputs,f,c,m);const y=null===u||null===a||Sy(n)?null:JB(u,f,a);s.push(y)}null!==u&&(u.hasOwnProperty("class")&&(n.flags|=8),u.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=s,n.inputs=u,n.outputs=c}(t,e,i)}function $2(t,n,e){const r=e.directiveStart,o=e.directiveEnd,i=e.index,a=function bi(){return Te.lFrame.currentDirectiveIndex}();try{ha(i);for(let s=r;s<o;s++){const u=t.data[s],c=n[s];ic(s),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&$B(u,c)}}finally{ha(-1),ic(a)}}function $B(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function F_(t,n,e){n.componentOffset=e,(t.components||(t.components=[])).push(n.index)}function KB(t,n,e){if(e){if(n.exportAs)for(let r=0;r<n.exportAs.length;r++)e[n.exportAs[r]]=t;Fr(n)&&(e[""]=t)}}function YB(t,n,e,r,o){t.data[r]=o;const i=o.factory||(o.factory=la(o.type)),a=new cc(i,Fr(o),Se);t.blueprint[r]=a,e[r]=a,function HB(t,n,e,r,o){const i=o.hostBindings;if(i){let a=t.hostBindingOpCodes;null===a&&(a=t.hostBindingOpCodes=[]);const s=~n.index;(function jB(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(a)!=s&&a.push(s),a.push(e,r,i)}}(t,n,r,Vp(t,e,o.hostVars,ze),o)}function QB(t,n,e){const r=$t(n,t),o=V2(e),i=t[10],a=Yy(t,Ky(t,o,null,e.onPush?32:16,r,n,i,i.createRenderer(r,e),null,null,null));t[n.index]=a}function ZB(t,n,e,r,o,i){const a=i[n];if(null!==a){const s=r.setInput;for(let u=0;u<a.length;){const c=a[u++],f=a[u++],d=a[u++];null!==s?r.setInput(e,d,c,f):e[f]=d}}}function JB(t,n,e){let r=null,o=0;for(;o<e.length;){const i=e[o];if(0!==i)if(5!==i){if("number"==typeof i)break;if(t.hasOwnProperty(i)){null===r&&(r=[]);const a=t[i];for(let s=0;s<a.length;s+=2)if(a[s]===n){r.push(i,a[s+1],e[o+1]);break}}o+=2}else o+=2;else o+=4}return r}function G2(t,n,e,r){return new Array(t,!0,!1,n,null,0,r,e,null,null)}function n4(t,n){const e=$r(n,t);if(Sl(e)){const r=e[1];48&e[2]?Xy(r,e,r.template,e[8]):e[5]>0&&P_(e)}}function P_(t){for(let r=Yh(t);null!==r;r=ql(r))for(let o=10;o<r.length;o++){const i=r[o];if(Sl(i))if(512&i[2]){const a=i[1];Xy(a,i,a.template,i[8])}else i[5]>0&&P_(i)}const e=t[1].components;if(null!==e)for(let r=0;r<e.length;r++){const o=$r(e[r],t);Sl(o)&&o[5]>0&&P_(o)}}function r4(t,n){const e=$r(n,t),r=e[1];(function o4(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])})(r,e),S_(r,e,e[8])}function Yy(t,n){return t[13]?t[14][4]=n:t[13]=n,t[14]=n,n}function O_(t){for(;t;){t[2]|=32;const n=or(t);if(Xv(t)&&!n)return t;t=n}return null}function Qy(t,n,e,r=!0){const o=n[10];o.begin&&o.begin();try{Xy(t,n,t.template,e)}catch(a){throw r&&Y2(n,a),a}finally{o.end&&o.end()}}function L_(t,n,e){fh(0),n(t,e)}function q2(t){return t[7]||(t[7]=[])}function K2(t){return t.cleanup||(t.cleanup=[])}function Y2(t,n){const e=t[9],r=e?e.get(uu,null):null;r&&r.handleError(n)}function B_(t,n,e,r,o){for(let i=0;i<e.length;){const a=e[i++],s=e[i++],u=n[a],c=t.data[a];null!==c.setInput?c.setInput(u,o,r,s):u[s]=o}}function Zy(t,n,e){let r=e?t.styles:null,o=e?t.classes:null,i=0;if(null!==n)for(let a=0;a<n.length;a++){const s=n[a];"number"==typeof s?i=s:1==i?o=Vd(o,s):2==i&&(r=Vd(r,s+": "+n[++a]+";"))}e?t.styles=r:t.stylesWithoutHost=r,e?t.classes=o:t.classesWithoutHost=o}function Jy(t,n,e,r,o=!1){for(;null!==e;){const i=n[e.index];if(null!==i&&r.push(an(i)),Io(i))for(let s=10;s<i.length;s++){const u=i[s],c=u[1].firstChild;null!==c&&Jy(u[1],u,c,r)}const a=e.type;if(8&a)Jy(t,n,e.child,r);else if(32&a){const s=Xh(e,n);let u;for(;u=s();)r.push(u)}else if(16&a){const s=np(n,e);if(Array.isArray(s))r.push(...s);else{const u=or(n[16]);Jy(u[1],u,s,r,!0)}}e=o?e.projectionNext:e.next}return r}class Up{constructor(n,e){this._lView=n,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const n=this._lView,e=n[1];return Jy(e,n,e.firstChild,[])}get context(){return this._lView[8]}set context(n){this._lView[8]=n}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[3];if(Io(n)){const e=n[8],r=e?e.indexOf(this):-1;r>-1&&(Jh(n,r),Ai(e,r))}this._attachedToViewContainer=!1}zm(this._lView[1],this._lView)}onDestroy(n){U2(this._lView[1],this._lView,null,n)}markForCheck(){O_(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){Qy(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ce(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function o1(t,n){_c(t,n,n[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new ce(902,!1);this._appRef=n}}class i4 extends Up{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;Qy(n[1],n,n[8],!1)}checkNoChanges(){}get context(){return null}}class V_ extends Rc{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=Nt(n);return new Wp(e,this.ngModule)}}function Q2(t){const n=[];for(let e in t)t.hasOwnProperty(e)&&n.push({propName:t[e],templateName:e});return n}class s4{constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,r){r=wl(r);const o=this.injector.get(n,Mc,r);return o!==Mc||e===Mc?o:this.parentInjector.get(n,e,r)}}class Wp extends Tt{constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function i_(t){return t.map(o_).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return Q2(this.componentDef.inputs)}get outputs(){return Q2(this.componentDef.outputs)}create(n,e,r,o){let i=(o=o||this.ngModule)instanceof _a?o:o?.injector;i&&null!==this.componentDef.getStandaloneInjector&&(i=this.componentDef.getStandaloneInjector(i)||i);const a=i?new s4(n,i):n,s=a.get(_y,null);if(null===s)throw new ce(407,!1);const u=a.get($1,null),c=s.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",d=r?function LB(t,n,e){return t.selectRootElement(n,e===uo.ShadowDom)}(c,r,this.componentDef.encapsulation):Zh(c,f,function a4(t){const n=t.toLowerCase();return"svg"===n?"svg":"math"===n?"math":null}(f)),p=this.componentDef.onPush?288:272,g=M_(0,null,null,1,0,null,null,null,null,null),m=Ky(null,g,null,p,null,null,s,c,u,a,null);let y,w;Qa(m);try{const b=this.componentDef;let C,_=null;b.findHostDirectiveDefs?(C=[],_=new Map,b.findHostDirectiveDefs(b,C,_),C.push(b)):C=[b];const D=function l4(t,n){const e=t[1];return t[22]=n,gf(e,22,2,"#host",null)}(m,d),E=function f4(t,n,e,r,o,i,a,s){const u=o[1];!function d4(t,n,e,r){for(const o of t)n.mergedAttrs=dc(n.mergedAttrs,o.hostAttrs);null!==n.mergedAttrs&&(Zy(n,n.mergedAttrs,!0),null!==e&&ny(r,e,n))}(r,t,n,a);const c=i.createRenderer(n,e),f=Ky(o,V2(e),null,e.onPush?32:16,o[t.index],t,i,c,s||null,null,null);return u.firstCreatePass&&F_(u,t,r.length-1),Yy(o,f),o[t.index]=f}(D,d,b,C,m,s,c);w=oh(g,22),d&&function p4(t,n,e,r){if(r)wh(t,e,["ng-version",G1.full]);else{const{attrs:o,classes:i}=function a_(t){const n=[],e=[];let r=1,o=2;for(;r<t.length;){let i=t[r];if("string"==typeof i)2===o?""!==i&&n.push(i,t[++r]):8===o&&e.push(i);else{if(!Ro(o))break;o=i}r++}return{attrs:n,classes:e}}(n.selectors[0]);o&&wh(t,e,o),i&&i.length>0&&ty(t,e,i.join(" "))}}(c,b,d,r),void 0!==e&&function g4(t,n,e){const r=t.projection=[];for(let o=0;o<n.length;o++){const i=e[o];r.push(null!=i?Array.from(i):null)}}(w,this.ngContentSelectors,e),y=function h4(t,n,e,r,o,i){const a=Wn(),s=o[1],u=$t(a,o);z2(s,o,a,e,null,r);for(let f=0;f<e.length;f++)rr(Ei(o,s,a.directiveStart+f,a),o);$2(s,o,a),u&&rr(u,o);const c=Ei(o,s,a.directiveStart+a.componentOffset,a);if(t[8]=o[8]=c,null!==i)for(const f of i)f(c,n);return A_(s,a,t),c}(E,b,C,_,m,[v4]),S_(g,m,null)}finally{ph()}return new c4(this.componentType,y,au(w,m),m,w)}}class c4 extends V1{constructor(n,e,r,o,i){super(),this.location=r,this._rootLView=o,this._tNode=i,this.instance=e,this.hostView=this.changeDetectorRef=new i4(o),this.componentType=n}setInput(n,e){const r=this._tNode.inputs;let o;if(null!==r&&(o=r[n])){const i=this._rootLView;B_(i[1],i,o,n,e),j2(i,this._tNode.index)}}get injector(){return new Tn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function v4(){const t=Wn();Rl(oe()[1],t)}let e0=null;function Fc(){if(!e0){const t=Vt.Symbol;if(t&&t.iterator)e0=t.iterator;else{const n=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<n.length;++e){const r=n[e];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(e0=r)}}}return e0}function Hp(t){return!!function W_(t){return null!==t&&("function"==typeof t||"object"==typeof t)}(t)&&(Array.isArray(t)||!(t instanceof Map)&&Fc()in t)}function Br(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function n0(t,n,e,r,o,i,a,s){const u=oe(),c=pt(),f=t+22,d=c.firstCreatePass?function R4(t,n,e,r,o,i,a,s,u){const c=n.consts,f=gf(n,t,4,a||null,da(c,s));N_(n,e,f,da(c,u)),Rl(n,f);const d=f.tViews=M_(2,f,r,o,i,n.directiveRegistry,n.pipeRegistry,null,n.schemas,c);return null!==n.queries&&(n.queries.template(n,f),d.queries=n.queries.embeddedTView(f)),f}(f,c,u,n,e,r,o,i,a):c.data[f];Qo(d,!1);const p=u[11].createComment("");Xl(c,u,p,d),rr(p,u),Yy(u,u[f]=G2(p,u,p,d)),So(d)&&T_(c,u,d),null!=a&&R_(u,d,s)}function Pc(t,n,e){const r=oe();return Br(r,Zo(),n)&&function No(t,n,e,r,o,i,a,s){const u=$t(n,e);let f,c=n.inputs;!s&&null!=c&&(f=c[r])?(B_(t,e,f,r,o),Ka(n)&&j2(e,n.index)):3&n.type&&(r=function UB(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),o=null!=a?a(o,n.value||"",r):o,i.setProperty(u,r,o))}(pt(),function Dt(){const t=Te.lFrame;return oh(t.tView,t.selectedIndex)}(),r,t,n,r[11],e,!1),Pc}function j_(t,n,e,r,o){const a=o?"class":"style";B_(t,e,n.inputs[a],a,r)}function Fo(t,n,e,r){const o=oe(),i=pt(),a=22+t,s=o[11],u=o[a]=Zh(s,n,function mr(){return Te.lFrame.currentNamespace}()),c=i.firstCreatePass?function F4(t,n,e,r,o,i,a){const s=n.consts,c=gf(n,t,2,o,da(s,i));return N_(n,e,c,da(s,a)),null!==c.attrs&&Zy(c,c.attrs,!1),null!==c.mergedAttrs&&Zy(c,c.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,c),c}(a,i,o,0,n,e,r):i.data[a];return Qo(c,!0),ny(s,u,c),32!=(32&c.flags)&&Xl(i,o,u,c),0===function bx(){return Te.lFrame.elementDepthCount}()&&rr(u,o),function xx(){Te.lFrame.elementDepthCount++}(),So(c)&&(T_(i,o,c),A_(i,c,o)),null!==r&&R_(o,c),Fo}function ni(){let t=Wn();sh()?function uh(){Te.lFrame.isParent=!1}():(t=t.parent,Qo(t,!1));const n=t;!function _x(){Te.lFrame.elementDepthCount--}();const e=pt();return e.firstCreatePass&&(Rl(e,t),Xd(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function yh(t){return 0!=(8&t.flags)}(n)&&j_(e,n,oe(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function um(t){return 0!=(16&t.flags)}(n)&&j_(e,n,oe(),n.stylesWithoutHost,!1),ni}function zp(t,n,e,r){return Fo(t,n,e,r),ni(),zp}function r0(t){return!!t&&"function"==typeof t.then}const gA=function pA(t){return!!t&&"function"==typeof t.subscribe};function o0(t,n,e,r){const o=oe(),i=pt(),a=Wn();return function mA(t,n,e,r,o,i,a,s){const u=So(r),f=t.firstCreatePass&&K2(t),d=n[8],p=q2(n);let g=!0;if(3&r.type||s){const w=$t(r,n),b=s?s(w):w,C=p.length,_=s?E=>s(an(E[r.index])):r.index;let D=null;if(!s&&u&&(D=function P4(t,n,e,r){const o=t.cleanup;if(null!=o)for(let i=0;i<o.length-1;i+=2){const a=o[i];if(a===e&&o[i+1]===r){const s=n[7],u=o[i+2];return s.length>u?s[u]:null}"string"==typeof a&&(i+=2)}return null}(t,n,o,r.index)),null!==D)(D.__ngLastListenerFn__||D).__ngNextListenerFn__=i,D.__ngLastListenerFn__=i,g=!1;else{i=wA(r,n,d,i,!1);const E=e.listen(b,o,i);p.push(i,E),f&&f.push(o,_,C,C+1)}}else i=wA(r,n,d,i,!1);const m=r.outputs;let y;if(g&&null!==m&&(y=m[o])){const w=y.length;if(w)for(let b=0;b<w;b+=2){const A=n[y[b]][y[b+1]].subscribe(i),P=p.length;p.push(i,A),f&&f.push(o,r.index,P,-(P+1))}}}(i,o,o[11],a,t,n,0,r),o0}function yA(t,n,e,r){try{return!1!==e(r)}catch(o){return Y2(t,o),!1}}function wA(t,n,e,r,o){return function i(a){if(a===Function)return r;O_(t.componentOffset>-1?$r(t.index,n):n);let u=yA(n,0,r,a),c=i.__ngNextListenerFn__;for(;c;)u=yA(n,0,c,a)&&u,c=c.__ngNextListenerFn__;return o&&!1===u&&(a.preventDefault(),a.returnValue=!1),u}}function $p(t=1){return function im(t){return(Te.lFrame.contextLView=function Hn(t,n){for(;t>0;)n=n[15],t--;return n}(t,Te.lFrame.contextLView))[8]}(t)}function TA(t,n,e,r,o){const i=t[e+1],a=null===n;let s=r?Mo(i):Pi(i),u=!1;for(;0!==s&&(!1===u||a);){const f=t[s+1];W4(t[s],n)&&(u=!0,t[s+1]=r?Pp(f):Fp(f)),s=r?Mo(f):Pi(f)}u&&(t[e+1]=r?Fp(i):Pp(i))}function W4(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&tu(t,n)>=0}function q_(t,n,e){return function Oi(t,n,e,r){const o=oe(),i=pt(),a=function fo(t){const n=Te.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}(2);i.firstUpdatePass&&function BA(t,n,e,r){const o=t.data;if(null===o[e+1]){const i=o[jn()],a=function LA(t,n){return n>=t.expandoStartIndex}(t,e);(function HA(t,n){return 0!=(t.flags&(n?8:16))})(i,r)&&null===n&&!a&&(n=!1),n=function Y4(t,n,e,r){const o=function xi(t){const n=Te.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let i=r?n.residualClasses:n.residualStyles;if(null===o)0===(r?n.classBindings:n.styleBindings)&&(e=Gp(e=K_(null,t,n,e,r),n.attrs,r),i=null);else{const a=n.directiveStylingLast;if(-1===a||t[a]!==o)if(e=K_(o,t,n,e,r),null===i){let u=function Q4(t,n,e){const r=e?n.classBindings:n.styleBindings;if(0!==Pi(r))return t[Mo(r)]}(t,n,r);void 0!==u&&Array.isArray(u)&&(u=K_(null,t,n,u[1],r),u=Gp(u,n.attrs,r),function Z4(t,n,e,r){t[Mo(e?n.classBindings:n.styleBindings)]=r}(t,n,r,u))}else i=function J4(t,n,e){let r;const o=n.directiveEnd;for(let i=1+n.directiveStylingLast;i<o;i++)r=Gp(r,t[i].hostAttrs,e);return Gp(r,n.attrs,e)}(t,n,r)}return void 0!==i&&(r?n.residualClasses=i:n.residualStyles=i),e}(o,i,n,r),function V4(t,n,e,r,o,i){let a=i?n.classBindings:n.styleBindings,s=Mo(a),u=Pi(a);t[r]=e;let f,c=!1;if(Array.isArray(e)){const d=e;f=d[1],(null===f||tu(d,f)>0)&&(c=!0)}else f=e;if(o)if(0!==u){const p=Mo(t[s+1]);t[r+1]=ff(p,s),0!==p&&(t[p+1]=kp(t[p+1],r)),t[s+1]=function __(t,n){return 131071&t|n<<17}(t[s+1],r)}else t[r+1]=ff(s,0),0!==s&&(t[s+1]=kp(t[s+1],r)),s=r;else t[r+1]=ff(u,0),0===s?s=r:t[u+1]=kp(t[u+1],r),u=r;c&&(t[r+1]=Fp(t[r+1])),TA(t,f,r,!0),TA(t,f,r,!1),function U4(t,n,e,r,o){const i=o?t.residualClasses:t.residualStyles;null!=i&&"string"==typeof n&&tu(i,n)>=0&&(e[r+1]=Pp(e[r+1]))}(n,f,t,r,i),a=ff(s,u),i?n.classBindings=a:n.styleBindings=a}(o,i,n,e,a,r)}}(i,t,a,r),n!==ze&&Br(o,a,n)&&function UA(t,n,e,r,o,i,a,s){if(!(3&n.type))return;const u=t.data,c=u[s+1];a0(function Gy(t){return 1==(1&t)}(c)?WA(u,n,e,o,Pi(c),a):void 0)||(a0(i)||function $y(t){return 2==(2&t)}(c)&&(i=WA(u,null,e,o,s,a)),function p1(t,n,e,r,o){if(n)o?t.addClass(e,r):t.removeClass(e,r);else{let i=-1===r.indexOf("-")?void 0:nr.DashCase;null==o?t.removeStyle(e,r,i):("string"==typeof o&&o.endsWith("!important")&&(o=o.slice(0,-10),i|=nr.Important),t.setStyle(e,r,o,i))}}(r,a,Xa(jn(),e),o,i))}(i,i.data[jn()],o,o[11],t,o[a+1]=function nV(t,n){return null==t||("string"==typeof n?t+=n:"object"==typeof t&&(t=Ft(function ba(t){return t instanceof sy?t.changingThisBreaksApplicationSecurity:t}(t)))),t}(n,e),r,a)}(t,n,e,!1),q_}function K_(t,n,e,r,o){let i=null;const a=e.directiveEnd;let s=e.directiveStylingLast;for(-1===s?s=e.directiveStart:s++;s<a&&(i=n[s],r=Gp(r,i.hostAttrs,o),i!==t);)s++;return null!==t&&(e.directiveStylingLast=s),r}function Gp(t,n,e){const r=e?1:2;let o=-1;if(null!==n)for(let i=0;i<n.length;i++){const a=n[i];"number"==typeof a?o=a:o===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),yr(t,a,!!e||n[++i]))}return void 0===t?null:t}function WA(t,n,e,r,o,i){const a=null===n;let s;for(;o>0;){const u=t[o],c=Array.isArray(u),f=c?u[1]:u,d=null===f;let p=e[o+1];p===ze&&(p=d?At:void 0);let g=d?eu(p,r):f===r?p:void 0;if(c&&!a0(g)&&(g=eu(u,r)),a0(g)&&(s=g,a))return s;const m=t[o+1];o=a?Mo(m):Pi(m)}if(null!==n){let u=i?n.residualClasses:n.residualStyles;null!=u&&(s=eu(u,r))}return s}function a0(t){return void 0!==t}function If(t,n=""){const e=oe(),r=pt(),o=t+22,i=r.firstCreatePass?gf(r,o,1,n,null):r.data[o],a=e[o]=function Qh(t,n){return t.createText(n)}(e[11],n);Xl(r,e,a,i),Qo(i,!1)}function X_(t){return s0("",t,""),X_}function s0(t,n,e){const r=oe(),o=function mf(t,n,e,r){return Br(t,Zo(),e)?n+Ue(e)+r:ze}(r,t,n,e);return o!==ze&&function cs(t,n,e){const r=Xa(n,t);!function Kl(t,n,e){t.setValue(n,e)}(t[11],r,e)}(r,jn(),o),s0}const Oc=void 0;var _V=["en",[["a","p"],["AM","PM"],Oc],[["AM","PM"],Oc,Oc],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Oc,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Oc,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Oc,"{1} 'at' {0}",Oc],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function xV(t){const e=Math.floor(Math.abs(t)),r=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===r?1:5}];let Sf={};function Jr(t){const n=function CV(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=cT(n);if(e)return e;const r=n.split("-")[0];if(e=cT(r),e)return e;if("en"===r)return _V;throw new ce(701,!1)}function cT(t){return t in Sf||(Sf[t]=Vt.ng&&Vt.ng.common&&Vt.ng.common.locales&&Vt.ng.common.locales[t]),Sf[t]}var pe=(()=>((pe=pe||{})[pe.LocaleId=0]="LocaleId",pe[pe.DayPeriodsFormat=1]="DayPeriodsFormat",pe[pe.DayPeriodsStandalone=2]="DayPeriodsStandalone",pe[pe.DaysFormat=3]="DaysFormat",pe[pe.DaysStandalone=4]="DaysStandalone",pe[pe.MonthsFormat=5]="MonthsFormat",pe[pe.MonthsStandalone=6]="MonthsStandalone",pe[pe.Eras=7]="Eras",pe[pe.FirstDayOfWeek=8]="FirstDayOfWeek",pe[pe.WeekendRange=9]="WeekendRange",pe[pe.DateFormat=10]="DateFormat",pe[pe.TimeFormat=11]="TimeFormat",pe[pe.DateTimeFormat=12]="DateTimeFormat",pe[pe.NumberSymbols=13]="NumberSymbols",pe[pe.NumberFormats=14]="NumberFormats",pe[pe.CurrencyCode=15]="CurrencyCode",pe[pe.CurrencySymbol=16]="CurrencySymbol",pe[pe.CurrencyName=17]="CurrencyName",pe[pe.Currencies=18]="Currencies",pe[pe.Directionality=19]="Directionality",pe[pe.PluralCase=20]="PluralCase",pe[pe.ExtraData=21]="ExtraData",pe))();const Af="en-US";let lT=Af;class Lc{}class OT{}class LT extends Lc{constructor(n,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new V_(this);const r=Jn(n);this._bootstrapComponents=ki(r.bootstrap),this._r3Injector=Ly(n,e,[{provide:Lc,useValue:this},{provide:Rc,useValue:this.componentFactoryResolver}],Ft(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class nC extends OT{constructor(n){super(),this.moduleType=n}create(n){return new LT(this.moduleType,n)}}class CU extends Lc{constructor(n,e,r){super(),this.componentFactoryResolver=new V_(this),this.instance=null;const o=new by([...n,{provide:Lc,useValue:this},{provide:Rc,useValue:this.componentFactoryResolver}],e||Ni(),r,new Set(["environment"]));this.injector=o,o.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function d0(t,n,e=null){return new CU(t,n,e).injector}let DU=(()=>{class t{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const r=Zt(0,e.type),o=r.length>0?d0([r],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,o)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return t.\u0275prov=He({token:t,providedIn:"environment",factory:()=>new t(Ie(_a))}),t})();function BT(t){t.getStandaloneInjector=n=>n.get(DU).getOrCreateStandaloneInjector(t)}function $T(t,n,e,r,o,i){const a=n+e;return Br(t,a,o)?function Ea(t,n,e){return t[n]=e}(t,a+1,i?r.call(i,o):r(o)):function Zp(t,n){const e=t[n];return e===ze?void 0:e}(t,a+1)}function QT(t,n,e){const r=t+22,o=oe(),i=function Xs(t,n){return t[n]}(o,r);return function Jp(t,n){return t[1].data[n].pure}(o,r)?$T(o,function vr(){const t=Te.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}(),n,i.transform,e,i):i.transform(e)}function oC(t){return n=>{setTimeout(t,void 0,n)}}const _r=class KU extends fr{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,e,r){let o=n,i=e||(()=>null),a=r;if(n&&"object"==typeof n){const u=n;o=u.next?.bind(u),i=u.error?.bind(u),a=u.complete?.bind(u)}this.__isAsync&&(i=oC(i),o&&(o=oC(o)),a&&(a=oC(a)));const s=super.subscribe({next:o,error:i,complete:a});return n instanceof Hr&&n.add(s),s}};function XU(){return this._results[Fc()]()}class iC{constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Fc(),r=iC.prototype;r[e]||(r[e]=XU)}get changes(){return this._changes||(this._changes=new _r)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){const r=this;r.dirty=!1;const o=kr(n);(this._changesDetected=!function gm(t,n,e){if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++){let o=t[r],i=n[r];if(e&&(o=e(o),i=e(i)),i!==o)return!1}return!0}(r._results,o,e))&&(r._results=o,r.length=o.length,r.last=o[this.length-1],r.first=o[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let ls=(()=>{class t{}return t.__NG_ELEMENT_ID__=ZU,t})();const YU=ls,QU=class extends YU{constructor(n,e,r){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=r}createEmbeddedView(n,e){const r=this._declarationTContainer.tViews,o=Ky(this._declarationLView,r,n,16,null,r.declTNode,null,null,null,null,e||null);o[17]=this._declarationLView[this._declarationTContainer.index];const a=this._declarationLView[19];return null!==a&&(o[19]=a.createEmbeddedView(r)),S_(r,o,n),new Up(o)}};function ZU(){return h0(Wn(),oe())}function h0(t,n){return 4&t.type?new QU(n,t,au(t,n)):null}let Bi=(()=>{class t{}return t.__NG_ELEMENT_ID__=JU,t})();function JU(){return eR(Wn(),oe())}const eW=Bi,ZT=class extends eW{constructor(n,e,r){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=r}get element(){return au(this._hostTNode,this._hostLView)}get injector(){return new Tn(this._hostTNode,this._hostLView)}get parentInjector(){const n=Xe(this._hostTNode,this._hostLView);if(xh(n)){const e=Di(n,this._hostLView),r=Ja(n);return new Tn(e[1].data[r+8],e)}return new Tn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=JT(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-10}createEmbeddedView(n,e,r){let o,i;"number"==typeof r?o=r:null!=r&&(o=r.index,i=r.injector);const a=n.createEmbeddedView(e||{},i);return this.insert(a,o),a}createComponent(n,e,r,o,i){const a=n&&!function ma(t){return"function"==typeof t}(n);let s;if(a)s=e;else{const d=e||{};s=d.index,r=d.injector,o=d.projectableNodes,i=d.environmentInjector||d.ngModuleRef}const u=a?n:new Wp(Nt(n)),c=r||this.parentInjector;if(!i&&null==u.ngModule){const p=(a?c:this.parentInjector).get(_a,null);p&&(i=p)}const f=u.create(c,o,void 0,i);return this.insert(f.hostView,s),f}insert(n,e){const r=n._lView,o=r[1];if(function wx(t){return Io(t[3])}(r)){const f=this.indexOf(n);if(-1!==f)this.detach(f);else{const d=r[3],p=new ZT(d,d[6],d[3]);p.detach(p.indexOf(n))}}const i=this._adjustIndex(e),a=this._lContainer;!function a1(t,n,e,r){const o=10+r,i=e.length;r>0&&(e[o-1][4]=n),r<i-10?(n[4]=e[o],kh(e,10+r,n)):(e.push(n),n[4]=null),n[3]=e;const a=n[17];null!==a&&e!==a&&function s1(t,n){const e=t[9];n[16]!==n[3][3][16]&&(t[2]=!0),null===e?t[9]=[n]:e.push(n)}(a,n);const s=n[19];null!==s&&s.insertView(t),n[2]|=64}(o,r,a,i);const s=rp(i,a),u=r[11],c=xc(u,a[7]);return null!==c&&function r1(t,n,e,r,o,i){r[0]=o,r[6]=n,_c(t,r,e,1,o,i)}(o,a[6],u,r,c,s),n.attachToViewContainerRef(),kh(aC(a),i,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=JT(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),r=Jh(this._lContainer,e);r&&(Ai(aC(this._lContainer),e),zm(r[1],r))}detach(n){const e=this._adjustIndex(n,-1),r=Jh(this._lContainer,e);return r&&null!=Ai(aC(this._lContainer),e)?new Up(r):null}_adjustIndex(n,e=0){return n??this.length+e}};function JT(t){return t[8]}function aC(t){return t[8]||(t[8]=[])}function eR(t,n){let e;const r=n[t.index];if(Io(r))e=r;else{let o;if(8&t.type)o=an(r);else{const i=n[11];o=i.createComment("");const a=$t(t,n);as(i,xc(i,a),o,function f1(t,n){return t.nextSibling(n)}(i,a),!1)}n[t.index]=e=G2(r,n,o,t),Yy(n,e)}return new ZT(e,t,n)}class sC{constructor(n){this.queryList=n,this.matches=null}clone(){return new sC(this.queryList)}setDirty(){this.queryList.setDirty()}}class uC{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const r=null!==n.contentQueries?n.contentQueries[0]:e.length,o=[];for(let i=0;i<r;i++){const a=e.getByIndex(i);o.push(this.queries[a.indexInDeclarationView].clone())}return new uC(o)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==sR(n,e).matches&&this.queries[e].setDirty()}}class tR{constructor(n,e,r=null){this.predicate=n,this.flags=e,this.read=r}}class cC{constructor(n=[]){this.queries=n}elementStart(n,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let r=0;r<this.length;r++){const o=null!==e?e.length:0,i=this.getByIndex(r).embeddedTView(n,o);i&&(i.indexInDeclarationView=r,null!==e?e.push(i):e=[i])}return null!==e?new cC(e):null}template(n,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class lC{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new lC(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let r=n.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let o=0;o<r.length;o++){const i=r[o];this.matchTNodeWithReadOption(n,e,rW(e,i)),this.matchTNodeWithReadOption(n,e,Pl(e,n,i,!1,!1))}else r===ls?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,Pl(e,n,r,!1,!1))}matchTNodeWithReadOption(n,e,r){if(null!==r){const o=this.metadata.read;if(null!==o)if(o===Fi||o===Bi||o===ls&&4&e.type)this.addMatch(e.index,-2);else{const i=Pl(e,n,o,!1,!1);null!==i&&this.addMatch(e.index,i)}else this.addMatch(e.index,r)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function rW(t,n){const e=t.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===n)return e[r+1];return null}function iW(t,n,e,r){return-1===e?function oW(t,n){return 11&t.type?au(t,n):4&t.type?h0(t,n):null}(n,t):-2===e?function aW(t,n,e){return e===Fi?au(n,t):e===ls?h0(n,t):e===Bi?eR(n,t):void 0}(t,n,r):Ei(t,t[1],e,n)}function nR(t,n,e,r){const o=n[19].queries[r];if(null===o.matches){const i=t.data,a=e.matches,s=[];for(let u=0;u<a.length;u+=2){const c=a[u];s.push(c<0?null:iW(n,i[c],a[u+1],e.metadata.read))}o.matches=s}return o.matches}function fC(t,n,e,r){const o=t.queries.getByIndex(e),i=o.matches;if(null!==i){const a=nR(t,n,o,e);for(let s=0;s<i.length;s+=2){const u=i[s];if(u>0)r.push(a[s/2]);else{const c=i[s+1],f=n[-u];for(let d=10;d<f.length;d++){const p=f[d];p[17]===p[3]&&fC(p[1],p,c,r)}if(null!==f[9]){const d=f[9];for(let p=0;p<d.length;p++){const g=d[p];fC(g[1],g,c,r)}}}}}return r}function dC(t){const n=oe(),e=pt(),r=Gr();fh(r+1);const o=sR(e,r);if(t.dirty&&function Ya(t){return 4==(4&t[2])}(n)===(2==(2&o.metadata.flags))){if(null===o.matches)t.reset([]);else{const i=o.crossesNgTemplate?fC(e,n,r,[]):nR(e,n,o,r);t.reset(i,j1),t.notifyOnChanges()}return!0}return!1}function rR(t,n,e){const r=pt();r.firstCreatePass&&(function aR(t,n,e){null===t.queries&&(t.queries=new cC),t.queries.track(new lC(n,e))}(r,new tR(t,n,e),-1),2==(2&n)&&(r.staticViewQueries=!0)),function iR(t,n,e){const r=new iC(4==(4&e));U2(t,n,r,r.destroy),null===n[19]&&(n[19]=new uC),n[19].queries.push(new sC(r))}(r,oe(),n)}function sR(t,n){return t.queries.getByIndex(n)}function g0(...t){}const tg=new Me("Application Initializer");let v0=(()=>{class t{constructor(e){this.appInits=e,this.resolve=g0,this.reject=g0,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,o)=>{this.resolve=r,this.reject=o})}runInitializers(){if(this.initialized)return;const e=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let o=0;o<this.appInits.length;o++){const i=this.appInits[o]();if(r0(i))e.push(i);else if(gA(i)){const a=new Promise((s,u)=>{i.subscribe({complete:s,error:u})});e.push(a)}}Promise.all(e).then(()=>{r()}).catch(o=>{this.reject(o)}),0===e.length&&r(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(Ie(tg,8))},t.\u0275prov=He({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const ng=new Me("AppId",{providedIn:"root",factory:function IR(){return`${yC()}${yC()}${yC()}`}});function yC(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const SR=new Me("Platform Initializer"),m0=new Me("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),AR=new Me("appBootstrapListener");let TW=(()=>{class t{log(e){console.log(e)}warn(e){console.warn(e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=He({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();const fs=new Me("LocaleId",{providedIn:"root",factory:()=>Pt(fs,Ae.Optional|Ae.SkipSelf)||function RW(){return typeof $localize<"u"&&$localize.locale||Af}()});class NW{constructor(n,e){this.ngModuleFactory=n,this.componentFactories=e}}let wC=(()=>{class t{compileModuleSync(e){return new nC(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const r=this.compileModuleSync(e),i=ki(Jn(e).declarations).reduce((a,s)=>{const u=Nt(s);return u&&a.push(new Wp(u)),a},[]);return new NW(r,i)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=He({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const PW=(()=>Promise.resolve(0))();function bC(t){typeof Zone>"u"?PW.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class _n{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new _r(!1),this.onMicrotaskEmpty=new _r(!1),this.onStable=new _r(!1),this.onError=new _r(!1),typeof Zone>"u")throw new ce(908,!1);Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&e,o.shouldCoalesceRunChangeDetection=r,o.lastRequestAnimationFrameId=-1,o.nativeRequestAnimationFrame=function OW(){let t=Vt.requestAnimationFrame,n=Vt.cancelAnimationFrame;if(typeof Zone<"u"&&t&&n){const e=t[Zone.__symbol__("OriginalDelegate")];e&&(t=e);const r=n[Zone.__symbol__("OriginalDelegate")];r&&(n=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function VW(t){const n=()=>{!function BW(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Vt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,_C(t),t.isCheckStableRunning=!0,xC(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),_C(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,r,o,i,a,s)=>{try{return MR(t),e.invokeTask(o,i,a,s)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===i.type||t.shouldCoalesceRunChangeDetection)&&n(),NR(t)}},onInvoke:(e,r,o,i,a,s,u)=>{try{return MR(t),e.invoke(o,i,a,s,u)}finally{t.shouldCoalesceRunChangeDetection&&n(),NR(t)}},onHasTask:(e,r,o,i)=>{e.hasTask(o,i),r===o&&("microTask"==i.change?(t._hasPendingMicrotasks=i.microTask,_C(t),xC(t)):"macroTask"==i.change&&(t.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,r,o,i)=>(e.handleError(o,i),t.runOutsideAngular(()=>t.onError.emit(i)),!1)})}(o)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!_n.isInAngularZone())throw new ce(909,!1)}static assertNotInAngularZone(){if(_n.isInAngularZone())throw new ce(909,!1)}run(n,e,r){return this._inner.run(n,e,r)}runTask(n,e,r,o){const i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+o,n,LW,g0,g0);try{return i.runTask(a,e,r)}finally{i.cancelTask(a)}}runGuarded(n,e,r){return this._inner.runGuarded(n,e,r)}runOutsideAngular(n){return this._outer.run(n)}}const LW={};function xC(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function _C(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function MR(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function NR(t){t._nesting--,xC(t)}class UW{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new _r,this.onMicrotaskEmpty=new _r,this.onStable=new _r,this.onError=new _r}run(n,e,r){return n.apply(e,r)}runGuarded(n,e,r){return n.apply(e,r)}runOutsideAngular(n){return n()}runTask(n,e,r,o){return n.apply(e,r)}}const FR=new Me(""),y0=new Me("");let EC,CC=(()=>{class t{constructor(e,r,o){this._ngZone=e,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,EC||(function WW(t){EC=t}(o),o.addToWindow(r)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{_n.assertNotInAngularZone(),bC(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())bC(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(e)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,o){let i=-1;r&&r>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==i),e(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:o})}whenStable(e,r,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,o),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,r,o){return[]}}return t.\u0275fac=function(e){return new(e||t)(Ie(_n),Ie(DC),Ie(y0))},t.\u0275prov=He({token:t,factory:t.\u0275fac}),t})(),DC=(()=>{class t{constructor(){this._applications=new Map}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return EC?.findTestabilityInTree(this,e,r)??null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=He({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})(),hu=null;const kR=new Me("AllowMultipleToken"),IC=new Me("PlatformDestroyListeners");class PR{constructor(n,e){this.name=n,this.token=e}}function LR(t,n,e=[]){const r=`Platform: ${n}`,o=new Me(r);return(i=[])=>{let a=SC();if(!a||a.injector.get(kR,!1)){const s=[...e,...i,{provide:o,useValue:!0}];t?t(s):function zW(t){if(hu&&!hu.get(kR,!1))throw new ce(400,!1);hu=t;const n=t.get(VR);(function OR(t){const n=t.get(SR,null);n&&n.forEach(e=>e())})(t)}(function BR(t=[],n){return mo.create({name:n,providers:[{provide:wp,useValue:"platform"},{provide:IC,useValue:new Set([()=>hu=null])},...t]})}(s,r))}return function GW(t){const n=SC();if(!n)throw new ce(401,!1);return n}()}}function SC(){return hu?.get(VR)??null}let VR=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){const o=function WR(t,n){let e;return e="noop"===t?new UW:("zone.js"===t?void 0:t)||new _n(n),e}(r?.ngZone,function UR(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!t||!t.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!t||!t.ngZoneRunCoalescing)||!1}}(r)),i=[{provide:_n,useValue:o}];return o.run(()=>{const a=mo.create({providers:i,parent:this.injector,name:e.moduleType.name}),s=e.create(a),u=s.injector.get(uu,null);if(!u)throw new ce(402,!1);return o.runOutsideAngular(()=>{const c=o.onError.subscribe({next:f=>{u.handleError(f)}});s.onDestroy(()=>{w0(this._modules,s),c.unsubscribe()})}),function HR(t,n,e){try{const r=e();return r0(r)?r.catch(o=>{throw n.runOutsideAngular(()=>t.handleError(o)),o}):r}catch(r){throw n.runOutsideAngular(()=>t.handleError(r)),r}}(u,o,()=>{const c=s.injector.get(v0);return c.runInitializers(),c.donePromise.then(()=>(function fT(t){dr(t,"Expected localeId to be defined"),"string"==typeof t&&(lT=t.toLowerCase().replace(/_/g,"-"))}(s.injector.get(fs,Af)||Af),this._moduleDoBootstrap(s),s))})})}bootstrapModule(e,r=[]){const o=jR({},r);return function HW(t,n,e){const r=new nC(e);return Promise.resolve(r)}(0,0,e).then(i=>this.bootstrapModuleFactory(i,o))}_moduleDoBootstrap(e){const r=e.injector.get(rg);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(o=>r.bootstrap(o));else{if(!e.instance.ngDoBootstrap)throw new ce(403,!1);e.instance.ngDoBootstrap(r)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ce(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const e=this._injector.get(IC,null);e&&(e.forEach(r=>r()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(Ie(mo))},t.\u0275prov=He({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();function jR(t,n){return Array.isArray(n)?n.reduce(jR,t):{...t,...n}}let rg=(()=>{class t{constructor(e,r,o){this._zone=e,this._injector=r,this._exceptionHandler=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const i=new xt(s=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{s.next(this._stable),s.complete()})}),a=new xt(s=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{_n.assertNotInAngularZone(),bC(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,s.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{_n.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{s.next(!1)}))});return()=>{u.unsubscribe(),c.unsubscribe()}});this.isStable=Bd(i,a.pipe(function Yb(t={}){const{connector:n=(()=>new fr),resetOnError:e=!0,resetOnComplete:r=!0,resetOnRefCountZero:o=!0}=t;return i=>{let a,s,u,c=0,f=!1,d=!1;const p=()=>{s?.unsubscribe(),s=void 0},g=()=>{p(),a=u=void 0,f=d=!1},m=()=>{const y=a;g(),y?.unsubscribe()};return Ht((y,w)=>{c++,!d&&!f&&p();const b=u=u??n();w.add(()=>{c--,0===c&&!d&&!f&&(s=hl(m,o))}),b.subscribe(w),!a&&c>0&&(a=new Hu({next:C=>b.next(C),error:C=>{d=!0,p(),s=hl(g,e,C),b.error(C)},complete:()=>{f=!0,p(),s=hl(g,r),b.complete()}}),ao(y).subscribe(a))})(i)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,r){const o=e instanceof Tt;if(!this._injector.get(v0).done)throw!o&&function zr(t){const n=Nt(t)||Sn(t)||Zn(t);return null!==n&&n.standalone}(e),new ce(405,false);let a;a=o?e:this._injector.get(Rc).resolveComponentFactory(e),this.componentTypes.push(a.componentType);const s=function jW(t){return t.isBoundToModule}(a)?void 0:this._injector.get(Lc),c=a.create(mo.NULL,[],r||a.selector,s),f=c.location.nativeElement,d=c.injector.get(FR,null);return d?.registerApplication(f),c.onDestroy(()=>{this.detachView(c.hostView),w0(this.components,c),d?.unregisterApplication(f)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new ce(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;w0(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(AR,[]).concat(this._bootstrapListeners).forEach(o=>o(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>w0(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new ce(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return t.\u0275fac=function(e){return new(e||t)(Ie(_n),Ie(_a),Ie(uu))},t.\u0275prov=He({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function w0(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}let AC=(()=>{class t{}return t.__NG_ELEMENT_ID__=XW,t})();function XW(t){return function YW(t,n,e){if(Ka(t)&&!e){const r=$r(t.index,n);return new Up(r,r)}return 47&t.type?new Up(n[16],n):null}(Wn(),oe(),16==(16&t))}class KR{constructor(){}supports(n){return Hp(n)}create(n){return new nH(n)}}const tH=(t,n)=>n;class nH{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||tH}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,r=this._removalsHead,o=0,i=null;for(;e||r;){const a=!r||e&&e.currentIndex<YR(r,o,i)?e:r,s=YR(a,o,i),u=a.currentIndex;if(a===r)o--,r=r._nextRemoved;else if(e=e._next,null==a.previousIndex)o++;else{i||(i=[]);const c=s-o,f=u-o;if(c!=f){for(let p=0;p<c;p++){const g=p<i.length?i[p]:i[p]=0,m=g+p;f<=m&&m<c&&(i[p]=g+1)}i[a.previousIndex]=f-c}}s!==u&&n(a,s,u)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!Hp(n))throw new ce(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let o,i,a,e=this._itHead,r=!1;if(Array.isArray(n)){this.length=n.length;for(let s=0;s<this.length;s++)i=n[s],a=this._trackByFn(s,i),null!==e&&Object.is(e.trackById,a)?(r&&(e=this._verifyReinsertion(e,i,a,s)),Object.is(e.item,i)||this._addIdentityChange(e,i)):(e=this._mismatch(e,i,a,s),r=!0),e=e._next}else o=0,function S4(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[Fc()]();let r;for(;!(r=e.next()).done;)n(r.value)}}(n,s=>{a=this._trackByFn(o,s),null!==e&&Object.is(e.trackById,a)?(r&&(e=this._verifyReinsertion(e,s,a,o)),Object.is(e.item,s)||this._addIdentityChange(e,s)):(e=this._mismatch(e,s,a,o),r=!0),e=e._next,o++}),this.length=o;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,r,o){let i;return null===n?i=this._itTail:(i=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,i,o)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(r,o))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,i,o)):n=this._addAfter(new rH(e,r),i,o),n}_verifyReinsertion(n,e,r,o){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==i?n=this._reinsertAfter(i,n._prev,o):n.currentIndex!=o&&(n.currentIndex=o,this._addToMoves(n,o)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const o=n._prevRemoved,i=n._nextRemoved;return null===o?this._removalsHead=i:o._nextRemoved=i,null===i?this._removalsTail=o:i._prevRemoved=o,this._insertAfter(n,e,r),this._addToMoves(n,r),n}_moveAfter(n,e,r){return this._unlink(n),this._insertAfter(n,e,r),this._addToMoves(n,r),n}_addAfter(n,e,r){return this._insertAfter(n,e,r),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,r){const o=null===e?this._itHead:e._next;return n._next=o,n._prev=e,null===o?this._itTail=n:o._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new XR),this._linkedRecords.put(n),n.currentIndex=r,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,r=n._next;return null===e?this._itHead=r:e._next=r,null===r?this._itTail=e:r._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new XR),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class rH{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class oH{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===e||e<=r.currentIndex)&&Object.is(r.trackById,n))return r;return null}remove(n){const e=n._prevDup,r=n._nextDup;return null===e?this._head=r:e._nextDup=r,null===r?this._tail=e:r._prevDup=e,null===this._head}}class XR{constructor(){this.map=new Map}put(n){const e=n.trackById;let r=this.map.get(e);r||(r=new oH,this.map.set(e,r)),r.add(n)}get(n,e){const o=this.map.get(n);return o?o.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function YR(t,n,e){const r=t.previousIndex;if(null===r)return r;let o=0;return e&&r<e.length&&(o=e[r]),r+n+o}function ZR(){return new _0([new KR])}let _0=(()=>{class t{constructor(e){this.factories=e}static create(e,r){if(null!=r){const o=r.factories.slice();e=e.concat(o)}return new t(e)}static extend(e){return{provide:t,useFactory:r=>t.create(e,r||ZR()),deps:[[t,new Xr,new yc]]}}find(e){const r=this.factories.find(o=>o.supports(e));if(null!=r)return r;throw new ce(901,!1)}}return t.\u0275prov=He({token:t,providedIn:"root",factory:ZR}),t})();const cH=LR(null,"core",[]);let lH=(()=>{class t{constructor(e){}}return t.\u0275fac=function(e){return new(e||t)(Ie(rg))},t.\u0275mod=aa({type:t}),t.\u0275inj=ht({}),t})(),C0=null;function pu(){return C0}class hH{}const yo=new Me("DocumentToken");let kC=(()=>{class t{historyGo(e){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=He({token:t,factory:function(){return function pH(){return Ie(eM)}()},providedIn:"platform"}),t})();const gH=new Me("Location Initialized");let eM=(()=>{class t extends kC{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return pu().getBaseHref(this._doc)}onPopState(e){const r=pu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=pu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,r,o){tM()?this._history.pushState(e,r,o):this.location.hash=o}replaceState(e,r,o){tM()?this._history.replaceState(e,r,o):this.location.hash=o}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(Ie(yo))},t.\u0275prov=He({token:t,factory:function(){return function vH(){return new eM(Ie(yo))}()},providedIn:"platform"}),t})();function tM(){return!!window.history.pushState}function PC(t,n){if(0==t.length)return n;if(0==n.length)return t;let e=0;return t.endsWith("/")&&e++,n.startsWith("/")&&e++,2==e?t+n.substring(1):1==e?t+n:t+"/"+n}function nM(t){const n=t.match(/#|\?|$/),e=n&&n.index||t.length;return t.slice(0,e-("/"===t[e-1]?1:0))+t.slice(e)}function hs(t){return t&&"?"!==t[0]?"?"+t:t}let Vc=(()=>{class t{historyGo(e){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=He({token:t,factory:function(){return Pt(oM)},providedIn:"root"}),t})();const rM=new Me("appBaseHref");let oM=(()=>{class t extends Vc{constructor(e,r){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Pt(yo).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return PC(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+hs(this._platformLocation.search),o=this._platformLocation.hash;return o&&e?`${r}${o}`:r}pushState(e,r,o,i){const a=this.prepareExternalUrl(o+hs(i));this._platformLocation.pushState(e,r,a)}replaceState(e,r,o,i){const a=this.prepareExternalUrl(o+hs(i));this._platformLocation.replaceState(e,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return t.\u0275fac=function(e){return new(e||t)(Ie(kC),Ie(rM,8))},t.\u0275prov=He({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),mH=(()=>{class t extends Vc{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=PC(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,o,i){let a=this.prepareExternalUrl(o+hs(i));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(e,r,a)}replaceState(e,r,o,i){let a=this.prepareExternalUrl(o+hs(i));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return t.\u0275fac=function(e){return new(e||t)(Ie(kC),Ie(rM,8))},t.\u0275prov=He({token:t,factory:t.\u0275fac}),t})(),OC=(()=>{class t{constructor(e){this._subject=new _r,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const r=this._locationStrategy.getBaseHref();this._baseHref=nM(iM(r)),this._locationStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+hs(r))}normalize(e){return t.stripTrailingSlash(function wH(t,n){return t&&n.startsWith(t)?n.substring(t.length):n}(this._baseHref,iM(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",o=null){this._locationStrategy.pushState(o,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+hs(r)),o)}replaceState(e,r="",o=null){this._locationStrategy.replaceState(o,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+hs(r)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(o=>o(e,r))}subscribe(e,r,o){return this._subject.subscribe({next:e,error:r,complete:o})}}return t.normalizeQueryParams=hs,t.joinWithSlash=PC,t.stripTrailingSlash=nM,t.\u0275fac=function(e){return new(e||t)(Ie(Vc))},t.\u0275prov=He({token:t,factory:function(){return function yH(){return new OC(Ie(Vc))}()},providedIn:"root"}),t})();function iM(t){return t.replace(/\/index.html$/,"")}var wo=(()=>((wo=wo||{})[wo.Decimal=0]="Decimal",wo[wo.Percent=1]="Percent",wo[wo.Currency=2]="Currency",wo[wo.Scientific=3]="Scientific",wo))(),Le=(()=>((Le=Le||{})[Le.Decimal=0]="Decimal",Le[Le.Group=1]="Group",Le[Le.List=2]="List",Le[Le.PercentSign=3]="PercentSign",Le[Le.PlusSign=4]="PlusSign",Le[Le.MinusSign=5]="MinusSign",Le[Le.Exponential=6]="Exponential",Le[Le.SuperscriptingExponent=7]="SuperscriptingExponent",Le[Le.PerMille=8]="PerMille",Le[Le.Infinity=9]="Infinity",Le[Le.NaN=10]="NaN",Le[Le.TimeSeparator=11]="TimeSeparator",Le[Le.CurrencyDecimal=12]="CurrencyDecimal",Le[Le.CurrencyGroup=13]="CurrencyGroup",Le))();function ri(t,n){const e=Jr(t),r=e[pe.NumberSymbols][n];if(typeof r>"u"){if(n===Le.CurrencyDecimal)return e[pe.NumberSymbols][Le.Decimal];if(n===Le.CurrencyGroup)return e[pe.NumberSymbols][Le.Group]}return r}const $H=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function zC(t){const n=parseInt(t);if(isNaN(n))throw new Error("Invalid integer literal when parsing "+t);return n}class ij{constructor(n,e,r,o){this.$implicit=n,this.ngForOf=e,this.index=r,this.count=o}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let vM=(()=>{class t{constructor(e,r,o){this._viewContainer=e,this._template=r,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const r=this._viewContainer;e.forEachOperation((o,i,a)=>{if(null==o.previousIndex)r.createEmbeddedView(this._template,new ij(o.item,this._ngForOf,-1,-1),null===a?void 0:a);else if(null==a)r.remove(null===i?void 0:i);else if(null!==i){const s=r.get(i);r.move(s,a),mM(s,o)}});for(let o=0,i=r.length;o<i;o++){const s=r.get(o).context;s.index=o,s.count=i,s.ngForOf=this._ngForOf}e.forEachIdentityChange(o=>{mM(r.get(o.currentIndex),o)})}static ngTemplateContextGuard(e,r){return!0}}return t.\u0275fac=function(e){return new(e||t)(Se(Bi),Se(ls),Se(_0))},t.\u0275dir=dn({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),t})();function mM(t,n){t.context.$implicit=n.item}let yM=(()=>{class t{constructor(e,r){this._viewContainer=e,this._context=new sj,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){wM("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){wM("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}}return t.\u0275fac=function(e){return new(e||t)(Se(Bi),Se(ls))},t.\u0275dir=dn({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),t})();class sj{constructor(){this.$implicit=null,this.ngIf=null}}function wM(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Ft(n)}'.`)}let _M=(()=>{class t{constructor(e){this._locale=e}transform(e,r,o){if(!function KC(t){return!(null==t||""===t||t!=t)}(e))return null;o=o||this._locale;try{return function QH(t,n,e){return function HC(t,n,e,r,o,i,a=!1){let s="",u=!1;if(isFinite(t)){let c=function JH(t){let r,o,i,a,s,n=Math.abs(t)+"",e=0;for((o=n.indexOf("."))>-1&&(n=n.replace(".","")),(i=n.search(/e/i))>0?(o<0&&(o=i),o+=+n.slice(i+1),n=n.substring(0,i)):o<0&&(o=n.length),i=0;"0"===n.charAt(i);i++);if(i===(s=n.length))r=[0],o=1;else{for(s--;"0"===n.charAt(s);)s--;for(o-=i,r=[],a=0;i<=s;i++,a++)r[a]=Number(n.charAt(i))}return o>22&&(r=r.splice(0,21),e=o-1,o=1),{digits:r,exponent:e,integerLen:o}}(t);a&&(c=function ZH(t){if(0===t.digits[0])return t;const n=t.digits.length-t.integerLen;return t.exponent?t.exponent+=2:(0===n?t.digits.push(0,0):1===n&&t.digits.push(0),t.integerLen+=2),t}(c));let f=n.minInt,d=n.minFrac,p=n.maxFrac;if(i){const C=i.match($H);if(null===C)throw new Error(`${i} is not a valid digit info`);const _=C[1],D=C[3],E=C[5];null!=_&&(f=zC(_)),null!=D&&(d=zC(D)),null!=E?p=zC(E):null!=D&&d>p&&(p=d)}!function ej(t,n,e){if(n>e)throw new Error(`The minimum number of digits after fraction (${n}) is higher than the maximum (${e}).`);let r=t.digits,o=r.length-t.integerLen;const i=Math.min(Math.max(n,o),e);let a=i+t.integerLen,s=r[a];if(a>0){r.splice(Math.max(t.integerLen,a));for(let d=a;d<r.length;d++)r[d]=0}else{o=Math.max(0,o),t.integerLen=1,r.length=Math.max(1,a=i+1),r[0]=0;for(let d=1;d<a;d++)r[d]=0}if(s>=5)if(a-1<0){for(let d=0;d>a;d--)r.unshift(0),t.integerLen++;r.unshift(1),t.integerLen++}else r[a-1]++;for(;o<Math.max(0,i);o++)r.push(0);let u=0!==i;const c=n+t.integerLen,f=r.reduceRight(function(d,p,g,m){return m[g]=(p+=d)<10?p:p-10,u&&(0===m[g]&&g>=c?m.pop():u=!1),p>=10?1:0},0);f&&(r.unshift(f),t.integerLen++)}(c,d,p);let g=c.digits,m=c.integerLen;const y=c.exponent;let w=[];for(u=g.every(C=>!C);m<f;m++)g.unshift(0);for(;m<0;m++)g.unshift(0);m>0?w=g.splice(m,g.length):(w=g,g=[0]);const b=[];for(g.length>=n.lgSize&&b.unshift(g.splice(-n.lgSize,g.length).join(""));g.length>n.gSize;)b.unshift(g.splice(-n.gSize,g.length).join(""));g.length&&b.unshift(g.join("")),s=b.join(ri(e,r)),w.length&&(s+=ri(e,o)+w.join("")),y&&(s+=ri(e,Le.Exponential)+"+"+y)}else s=ri(e,Le.Infinity);return s=t<0&&!u?n.negPre+s+n.negSuf:n.posPre+s+n.posSuf,s}(t,function jC(t,n="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=t.split(";"),o=r[0],i=r[1],a=-1!==o.indexOf(".")?o.split("."):[o.substring(0,o.lastIndexOf("0")+1),o.substring(o.lastIndexOf("0")+1)],s=a[0],u=a[1]||"";e.posPre=s.substring(0,s.indexOf("#"));for(let f=0;f<u.length;f++){const d=u.charAt(f);"0"===d?e.minFrac=e.maxFrac=f+1:"#"===d?e.maxFrac=f+1:e.posSuf+=d}const c=s.split(",");if(e.gSize=c[1]?c[1].length:0,e.lgSize=c[2]||c[1]?(c[2]||c[1]).length:0,i){const f=o.length-e.posPre.length-e.posSuf.length,d=i.indexOf("#");e.negPre=i.substring(0,d).replace(/'/g,""),e.negSuf=i.slice(d+f).replace(/'/g,"")}else e.negPre=n+e.posPre,e.negSuf=e.posSuf;return e}(function LC(t,n){return Jr(t)[pe.NumberFormats][n]}(n,wo.Decimal),ri(n,Le.MinusSign)),n,Le.Group,Le.Decimal,e)}(function XC(t){if("string"==typeof t&&!isNaN(Number(t)-parseFloat(t)))return Number(t);if("number"!=typeof t)throw new Error(`${t} is not a number`);return t}(e),o,r)}catch(i){throw function Wi(t,n){return new ce(2100,!1)}()}}}return t.\u0275fac=function(e){return new(e||t)(Se(fs,16))},t.\u0275pipe=Mr({name:"number",type:t,pure:!0,standalone:!0}),t})();let Pj=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=aa({type:t}),t.\u0275inj=ht({}),t})();const CM="browser";function DM(t){return t===CM}let Vj=(()=>{class t{}return t.\u0275prov=He({token:t,providedIn:"root",factory:()=>new Uj(Ie(yo),window)}),t})();class Uj{constructor(n,e){this.document=n,this.window=e,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const e=function Wj(t,n){const e=t.getElementById(n)||t.getElementsByName(n)[0];if(e)return e;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let o=r.currentNode;for(;o;){const i=o.shadowRoot;if(i){const a=i.getElementById(n)||i.querySelector(`[name="${n}"]`);if(a)return a}o=r.nextNode()}}return null}(this.document,n);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(n){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=n)}}scrollToElement(n){const e=n.getBoundingClientRect(),r=e.left+this.window.pageXOffset,o=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(r-i[0],o-i[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const n=EM(this.window.history)||EM(Object.getPrototypeOf(this.window.history));return!(!n||!n.writable&&!n.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function EM(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class gz extends hH{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class ZC extends gz{static makeCurrent(){!function dH(t){C0||(C0=t)}(new ZC)}onAndCancel(n,e,r){return n.addEventListener(e,r,!1),()=>{n.removeEventListener(e,r,!1)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function vz(){return ug=ug||document.querySelector("base"),ug?ug.getAttribute("href"):null}();return null==e?null:function mz(t){k0=k0||document.createElement("a"),k0.setAttribute("href",t);const n=k0.pathname;return"/"===n.charAt(0)?n:`/${n}`}(e)}resetBaseElement(){ug=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return function nj(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const r=e.indexOf("="),[o,i]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(o.trim()===n)return decodeURIComponent(i)}return null}(document.cookie,n)}}let k0,ug=null;const MM=new Me("TRANSITION_ID"),wz=[{provide:tg,useFactory:function yz(t,n,e){return()=>{e.get(v0).donePromise.then(()=>{const r=pu(),o=n.querySelectorAll(`style[ng-transition="${t}"]`);for(let i=0;i<o.length;i++)r.remove(o[i])})}},deps:[MM,yo,mo],multi:!0}];let xz=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=He({token:t,factory:t.\u0275fac}),t})();const P0=new Me("EventManagerPlugins");let O0=(()=>{class t{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(o=>o.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,r,o){return this._findPluginFor(r).addEventListener(e,r,o)}addGlobalEventListener(e,r,o){return this._findPluginFor(r).addGlobalEventListener(e,r,o)}getZone(){return this._zone}_findPluginFor(e){const r=this._eventNameToPlugin.get(e);if(r)return r;const o=this._plugins;for(let i=0;i<o.length;i++){const a=o[i];if(a.supports(e))return this._eventNameToPlugin.set(e,a),a}throw new Error(`No event manager plugin found for event ${e}`)}}return t.\u0275fac=function(e){return new(e||t)(Ie(P0),Ie(_n))},t.\u0275prov=He({token:t,factory:t.\u0275fac}),t})();class NM{constructor(n){this._doc=n}addGlobalEventListener(n,e,r){const o=pu().getGlobalEventTarget(this._doc,n);if(!o)throw new Error(`Unsupported event target ${o} for event ${e}`);return this.addEventListener(o,e,r)}}let FM=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(e){const r=new Set;e.forEach(o=>{this._stylesSet.has(o)||(this._stylesSet.add(o),r.add(o))}),this.onStylesAdded(r)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=He({token:t,factory:t.\u0275fac}),t})(),cg=(()=>{class t extends FM{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,r,o){e.forEach(i=>{const a=this._doc.createElement("style");a.textContent=i,o.push(r.appendChild(a))})}addHost(e){const r=[];this._addStylesToHost(this._stylesSet,e,r),this._hostNodes.set(e,r)}removeHost(e){const r=this._hostNodes.get(e);r&&r.forEach(kM),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((r,o)=>{this._addStylesToHost(e,o,r)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(kM))}}return t.\u0275fac=function(e){return new(e||t)(Ie(yo))},t.\u0275prov=He({token:t,factory:t.\u0275fac}),t})();function kM(t){pu().remove(t)}const JC={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},eD=/%COMP%/g;function L0(t,n,e){for(let r=0;r<n.length;r++){let o=n[r];Array.isArray(o)?L0(t,o,e):(o=o.replace(eD,t),e.push(o))}return e}function LM(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&(n.preventDefault(),n.returnValue=!1)}}let tD=(()=>{class t{constructor(e,r,o){this.eventManager=e,this.sharedStylesHost=r,this.appId=o,this.rendererByCompId=new Map,this.defaultRenderer=new nD(e)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;switch(r.encapsulation){case uo.Emulated:{let o=this.rendererByCompId.get(r.id);return o||(o=new Sz(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,o)),o.applyToHost(e),o}case 1:case uo.ShadowDom:return new Az(this.eventManager,this.sharedStylesHost,e,r);default:if(!this.rendererByCompId.has(r.id)){const o=L0(r.id,r.styles,[]);this.sharedStylesHost.addStyles(o),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(Ie(O0),Ie(cg),Ie(ng))},t.\u0275prov=He({token:t,factory:t.\u0275fac}),t})();class nD{constructor(n){this.eventManager=n,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,e){return e?document.createElementNS(JC[e]||e,n):document.createElement(n)}createComment(n){return document.createComment(n)}createText(n){return document.createTextNode(n)}appendChild(n,e){(VM(n)?n.content:n).appendChild(e)}insertBefore(n,e,r){n&&(VM(n)?n.content:n).insertBefore(e,r)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let r="string"==typeof n?document.querySelector(n):n;if(!r)throw new Error(`The selector "${n}" did not match any elements`);return e||(r.textContent=""),r}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,r,o){if(o){e=o+":"+e;const i=JC[o];i?n.setAttributeNS(i,e,r):n.setAttribute(e,r)}else n.setAttribute(e,r)}removeAttribute(n,e,r){if(r){const o=JC[r];o?n.removeAttributeNS(o,e):n.removeAttribute(`${r}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,r,o){o&(nr.DashCase|nr.Important)?n.style.setProperty(e,r,o&nr.Important?"important":""):n.style[e]=r}removeStyle(n,e,r){r&nr.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,r){n[e]=r}setValue(n,e){n.nodeValue=e}listen(n,e,r){return"string"==typeof n?this.eventManager.addGlobalEventListener(n,e,LM(r)):this.eventManager.addEventListener(n,e,LM(r))}}function VM(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class Sz extends nD{constructor(n,e,r,o){super(n),this.component=r;const i=L0(o+"-"+r.id,r.styles,[]);e.addStyles(i),this.contentAttr=function Dz(t){return"_ngcontent-%COMP%".replace(eD,t)}(o+"-"+r.id),this.hostAttr=function Ez(t){return"_nghost-%COMP%".replace(eD,t)}(o+"-"+r.id)}applyToHost(n){super.setAttribute(n,this.hostAttr,"")}createElement(n,e){const r=super.createElement(n,e);return super.setAttribute(r,this.contentAttr,""),r}}class Az extends nD{constructor(n,e,r,o){super(n),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=L0(o.id,o.styles,[]);for(let a=0;a<i.length;a++){const s=document.createElement("style");s.textContent=i[a],this.shadowRoot.appendChild(s)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,r){return super.insertBefore(this.nodeOrShadowRoot(n),e,r)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}}let Tz=(()=>{class t extends NM{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,o){return e.addEventListener(r,o,!1),()=>this.removeEventListener(e,r,o)}removeEventListener(e,r,o){return e.removeEventListener(r,o)}}return t.\u0275fac=function(e){return new(e||t)(Ie(yo))},t.\u0275prov=He({token:t,factory:t.\u0275fac}),t})();const UM=["alt","control","meta","shift"],Rz={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Mz={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let Nz=(()=>{class t extends NM{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,r,o){const i=t.parseEventName(r),a=t.eventCallback(i.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>pu().onAndCancel(e,i.domEventName,a))}static parseEventName(e){const r=e.toLowerCase().split("."),o=r.shift();if(0===r.length||"keydown"!==o&&"keyup"!==o)return null;const i=t._normalizeKey(r.pop());let a="",s=r.indexOf("code");if(s>-1&&(r.splice(s,1),a="code."),UM.forEach(c=>{const f=r.indexOf(c);f>-1&&(r.splice(f,1),a+=c+".")}),a+=i,0!=r.length||0===i.length)return null;const u={};return u.domEventName=o,u.fullKey=a,u}static matchEventFullKeyCode(e,r){let o=Rz[e.key]||e.key,i="";return r.indexOf("code.")>-1&&(o=e.code,i="code."),!(null==o||!o)&&(o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),UM.forEach(a=>{a!==o&&(0,Mz[a])(e)&&(i+=a+".")}),i+=o,i===r)}static eventCallback(e,r,o){return i=>{t.matchEventFullKeyCode(i,e)&&o.runGuarded(()=>r(i))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return t.\u0275fac=function(e){return new(e||t)(Ie(yo))},t.\u0275prov=He({token:t,factory:t.\u0275fac}),t})();const HM=[{provide:m0,useValue:CM},{provide:SR,useValue:function Fz(){ZC.makeCurrent()},multi:!0},{provide:yo,useFactory:function Pz(){return function ry(t){Zl=t}(document),document},deps:[]}],Oz=LR(cH,"browser",HM),jM=new Me(""),zM=[{provide:y0,useClass:class bz{addToWindow(n){Vt.getAngularTestability=(r,o=!0)=>{const i=n.findTestabilityInTree(r,o);if(null==i)throw new Error("Could not find testability for element.");return i},Vt.getAllAngularTestabilities=()=>n.getAllTestabilities(),Vt.getAllAngularRootElements=()=>n.getAllRootElements(),Vt.frameworkStabilizers||(Vt.frameworkStabilizers=[]),Vt.frameworkStabilizers.push(r=>{const o=Vt.getAllAngularTestabilities();let i=o.length,a=!1;const s=function(u){a=a||u,i--,0==i&&r(a)};o.forEach(function(u){u.whenStable(s)})})}findTestabilityInTree(n,e,r){return null==e?null:n.getTestability(e)??(r?pu().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},deps:[]},{provide:FR,useClass:CC,deps:[_n,DC,y0]},{provide:CC,useClass:CC,deps:[_n,DC,y0]}],$M=[{provide:wp,useValue:"root"},{provide:uu,useFactory:function kz(){return new uu},deps:[]},{provide:P0,useClass:Tz,multi:!0,deps:[yo,_n,m0]},{provide:P0,useClass:Nz,multi:!0,deps:[yo]},{provide:tD,useClass:tD,deps:[O0,cg,ng]},{provide:_y,useExisting:tD},{provide:FM,useExisting:cg},{provide:cg,useClass:cg,deps:[yo]},{provide:O0,useClass:O0,deps:[P0,_n]},{provide:class Hj{},useClass:xz,deps:[]},[]];let Lz=(()=>{class t{constructor(e){}static withServerTransition(e){return{ngModule:t,providers:[{provide:ng,useValue:e.appId},{provide:MM,useExisting:ng},wz]}}}return t.\u0275fac=function(e){return new(e||t)(Ie(jM,12))},t.\u0275mod=aa({type:t}),t.\u0275inj=ht({providers:[...$M,...zM],imports:[Pj,lH]}),t})(),GM=(()=>{class t{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return t.\u0275fac=function(e){return new(e||t)(Ie(yo))},t.\u0275prov=He({token:t,factory:function(e){let r=null;return r=e?new e:function Vz(){return new GM(Ie(yo))}(),r},providedIn:"root"}),t})();function Re(...t){return bn(t,qu(t))}typeof window<"u"&&window;class Hi extends fr{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:r}=this;if(n)throw e;return this._throwIfClosed(),r}next(n){super.next(this._value=n)}}const B0=Tr(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:qz}=Array,{getPrototypeOf:Kz,prototype:Xz,keys:Yz}=Object;const{isArray:Jz}=Array;function XM(t){return Ve(n=>function e$(t,n){return Jz(n)?t(...n):t(n)}(t,n))}function YM(...t){const n=qu(t),e=function $b(t){return bt(Od(t))?t.pop():void 0}(t),{args:r,keys:o}=function Qz(t){if(1===t.length){const n=t[0];if(qz(n))return{args:n,keys:null};if(function Zz(t){return t&&"object"==typeof t&&Kz(t)===Xz}(n)){const e=Yz(n);return{args:e.map(r=>n[r]),keys:e}}}return{args:t,keys:null}}(t);if(0===r.length)return bn([],n);const i=new xt(function n$(t,n,e=Rr){return r=>{QM(n,()=>{const{length:o}=t,i=new Array(o);let a=o,s=o;for(let u=0;u<o;u++)QM(n,()=>{const c=bn(t[u],n);let f=!1;c.subscribe(yn(r,d=>{i[u]=d,f||(f=!0,s--),s||r.next(e(i.slice()))},()=>{--a||r.complete()}))},r)},r)}}(r,n,o?a=>function t$(t,n){return t.reduce((e,r,o)=>(e[r]=n[o],e),{})}(o,a):Rr));return e?i.pipe(XM(e)):i}function QM(t,n,e){t?gi(e,t,n):n()}function lg(...t){return function r$(){return Bs(1)}()(bn(t,qu(t)))}function V0(t){return new xt(n=>{ao(t()).subscribe(n)})}function Mf(t,n){const e=bt(t)?t:()=>t,r=o=>o.error(e());return new xt(n?o=>n.schedule(r,0,o):r)}function iD(){return Ht((t,n)=>{let e=null;t._refCount++;const r=yn(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(e=null);const o=t._connection,i=e;e=null,o&&(!i||o===i)&&o.unsubscribe(),n.unsubscribe()});t.subscribe(r),r.closed||(e=t.connect())})}class aD extends xt{constructor(n,e){super(),this.source=n,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,Ps(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new Hr;const e=this.getSubject();n.add(this.source.subscribe(yn(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),n.closed&&(this._connection=null,n=Hr.EMPTY)}return n}refCount(){return iD()(this)}}function bo(t,n){return Ht((e,r)=>{let o=null,i=0,a=!1;const s=()=>a&&!o&&r.complete();e.subscribe(yn(r,u=>{o?.unsubscribe();let c=0;const f=i++;ao(t(u,f)).subscribe(o=yn(r,d=>r.next(n?n(u,d,f,c++):d),()=>{o=null,s()}))},()=>{a=!0,s()}))})}function ko(t){return t<=0?()=>qo:Ht((n,e)=>{let r=0;n.subscribe(yn(e,o=>{++r<=t&&(e.next(o),t<=r&&e.complete())}))})}function xo(t,n){return Ht((e,r)=>{let o=0;e.subscribe(yn(r,i=>t.call(n,i,o++)&&r.next(i)))})}function U0(t){return Ht((n,e)=>{let r=!1;n.subscribe(yn(e,o=>{r=!0,e.next(o)},()=>{r||e.next(t),e.complete()}))})}function ZM(t=i$){return Ht((n,e)=>{let r=!1;n.subscribe(yn(e,o=>{r=!0,e.next(o)},()=>r?e.complete():e.error(t())))})}function i$(){return new B0}function vu(t,n){const e=arguments.length>=2;return r=>r.pipe(t?xo((o,i)=>t(o,i,r)):Rr,ko(1),e?U0(n):ZM(()=>new B0))}function Uc(t,n){return bt(n)?wn(t,n,1):wn(t,1)}function Cr(t,n,e){const r=bt(t)||n||e?{next:t,error:n,complete:e}:t;return r?Ht((o,i)=>{var a;null===(a=r.subscribe)||void 0===a||a.call(r);let s=!0;o.subscribe(yn(i,u=>{var c;null===(c=r.next)||void 0===c||c.call(r,u),i.next(u)},()=>{var u;s=!1,null===(u=r.complete)||void 0===u||u.call(r),i.complete()},u=>{var c;s=!1,null===(c=r.error)||void 0===c||c.call(r,u),i.error(u)},()=>{var u,c;s&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(c=r.finalize)||void 0===c||c.call(r)}))}):Rr}function mu(t){return Ht((n,e)=>{let i,r=null,o=!1;r=n.subscribe(yn(e,void 0,void 0,a=>{i=ao(t(a,mu(t)(n))),r?(r.unsubscribe(),r=null,i.subscribe(e)):o=!0})),o&&(r.unsubscribe(),r=null,i.subscribe(e))})}function a$(t,n,e,r,o){return(i,a)=>{let s=e,u=n,c=0;i.subscribe(yn(a,f=>{const d=c++;u=s?t(u,f,d):(s=!0,f),r&&a.next(u)},o&&(()=>{s&&a.next(u),a.complete()})))}}function JM(t,n){return Ht(a$(t,n,arguments.length>=2,!0))}function sD(t){return t<=0?()=>qo:Ht((n,e)=>{let r=[];n.subscribe(yn(e,o=>{r.push(o),t<r.length&&r.shift()},()=>{for(const o of r)e.next(o);e.complete()},void 0,()=>{r=null}))})}function eN(t,n){const e=arguments.length>=2;return r=>r.pipe(t?xo((o,i)=>t(o,i,r)):Rr,sD(1),e?U0(n):ZM(()=>new B0))}function tN(t){return Ve(()=>t)}function uD(t){return Ht((n,e)=>{try{n.subscribe(e)}finally{e.add(t)}})}const nt="primary",fg=Symbol("RouteTitle");class u${constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e[0]:e}return null}getAll(n){if(this.has(n)){const e=this.params[n];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function Nf(t){return new u$(t)}function c$(t,n,e){const r=e.path.split("/");if(r.length>t.length||"full"===e.pathMatch&&(n.hasChildren()||r.length<t.length))return null;const o={};for(let i=0;i<r.length;i++){const a=r[i],s=t[i];if(a.startsWith(":"))o[a.substring(1)]=s;else if(a!==s.path)return null}return{consumed:t.slice(0,r.length),posParams:o}}function Aa(t,n){const e=t?Object.keys(t):void 0,r=n?Object.keys(n):void 0;if(!e||!r||e.length!=r.length)return!1;let o;for(let i=0;i<e.length;i++)if(o=e[i],!nN(t[o],n[o]))return!1;return!0}function nN(t,n){if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return!1;const e=[...t].sort(),r=[...n].sort();return e.every((o,i)=>r[i]===o)}return t===n}function rN(t){return Array.prototype.concat.apply([],t)}function oN(t){return t.length>0?t[t.length-1]:null}function Dr(t,n){for(const e in t)t.hasOwnProperty(e)&&n(t[e],e)}function yu(t){return gA(t)?t:r0(t)?bn(Promise.resolve(t)):Re(t)}const W0=!1,f$={exact:function sN(t,n,e){if(!Hc(t.segments,n.segments)||!H0(t.segments,n.segments,e)||t.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children)if(!t.children[r]||!sN(t.children[r],n.children[r],e))return!1;return!0},subset:uN},iN={exact:function d$(t,n){return Aa(t,n)},subset:function h$(t,n){return Object.keys(n).length<=Object.keys(t).length&&Object.keys(n).every(e=>nN(t[e],n[e]))},ignored:()=>!0};function aN(t,n,e){return f$[e.paths](t.root,n.root,e.matrixParams)&&iN[e.queryParams](t.queryParams,n.queryParams)&&!("exact"===e.fragment&&t.fragment!==n.fragment)}function uN(t,n,e){return cN(t,n,n.segments,e)}function cN(t,n,e,r){if(t.segments.length>e.length){const o=t.segments.slice(0,e.length);return!(!Hc(o,e)||n.hasChildren()||!H0(o,e,r))}if(t.segments.length===e.length){if(!Hc(t.segments,e)||!H0(t.segments,e,r))return!1;for(const o in n.children)if(!t.children[o]||!uN(t.children[o],n.children[o],r))return!1;return!0}{const o=e.slice(0,t.segments.length),i=e.slice(t.segments.length);return!!(Hc(t.segments,o)&&H0(t.segments,o,r)&&t.children[nt])&&cN(t.children[nt],n,i,r)}}function H0(t,n,e){return n.every((r,o)=>iN[e](t[o].parameters,r.parameters))}class Wc{constructor(n=new ut([],{}),e={},r=null){this.root=n,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Nf(this.queryParams)),this._queryParamMap}toString(){return v$.serialize(this)}}class ut{constructor(n,e){this.segments=n,this.children=e,this.parent=null,Dr(e,(r,o)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return j0(this)}}class dg{constructor(n,e){this.path=n,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=Nf(this.parameters)),this._parameterMap}toString(){return hN(this)}}function Hc(t,n){return t.length===n.length&&t.every((e,r)=>e.path===n[r].path)}let lN=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=He({token:t,factory:function(){return new cD},providedIn:"root"}),t})();class cD{parse(n){const e=new E$(n);return new Wc(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(n){const e=`/${hg(n.root,!0)}`,r=function w$(t){const n=Object.keys(t).map(e=>{const r=t[e];return Array.isArray(r)?r.map(o=>`${z0(e)}=${z0(o)}`).join("&"):`${z0(e)}=${z0(r)}`}).filter(e=>!!e);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${e}${r}${"string"==typeof n.fragment?`#${function m$(t){return encodeURI(t)}(n.fragment)}`:""}`}}const v$=new cD;function j0(t){return t.segments.map(n=>hN(n)).join("/")}function hg(t,n){if(!t.hasChildren())return j0(t);if(n){const e=t.children[nt]?hg(t.children[nt],!1):"",r=[];return Dr(t.children,(o,i)=>{i!==nt&&r.push(`${i}:${hg(o,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function g$(t,n){let e=[];return Dr(t.children,(r,o)=>{o===nt&&(e=e.concat(n(r,o)))}),Dr(t.children,(r,o)=>{o!==nt&&(e=e.concat(n(r,o)))}),e}(t,(r,o)=>o===nt?[hg(t.children[nt],!1)]:[`${o}:${hg(r,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[nt]?`${j0(t)}/${e[0]}`:`${j0(t)}/(${e.join("//")})`}}function fN(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function z0(t){return fN(t).replace(/%3B/gi,";")}function lD(t){return fN(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function $0(t){return decodeURIComponent(t)}function dN(t){return $0(t.replace(/\+/g,"%20"))}function hN(t){return`${lD(t.path)}${function y$(t){return Object.keys(t).map(n=>`;${lD(n)}=${lD(t[n])}`).join("")}(t.parameters)}`}const b$=/^[^\/()?;=#]+/;function G0(t){const n=t.match(b$);return n?n[0]:""}const x$=/^[^=?&#]+/,C$=/^[^&#]+/;class E${constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ut([],{}):new ut([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(n.length>0||Object.keys(e).length>0)&&(r[nt]=new ut(n,e)),r}parseSegment(){const n=G0(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new ce(4009,W0);return this.capture(n),new dg($0(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const e=G0(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const o=G0(this.remaining);o&&(r=o,this.capture(r))}n[$0(e)]=$0(r)}parseQueryParam(n){const e=function _$(t){const n=t.match(x$);return n?n[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const a=function D$(t){const n=t.match(C$);return n?n[0]:""}(this.remaining);a&&(r=a,this.capture(r))}const o=dN(e),i=dN(r);if(n.hasOwnProperty(o)){let a=n[o];Array.isArray(a)||(a=[a],n[o]=a),a.push(i)}else n[o]=i}parseParens(n){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=G0(this.remaining),o=this.remaining[r.length];if("/"!==o&&")"!==o&&";"!==o)throw new ce(4010,W0);let i;r.indexOf(":")>-1?(i=r.slice(0,r.indexOf(":")),this.capture(i),this.capture(":")):n&&(i=nt);const a=this.parseChildren();e[i]=1===Object.keys(a).length?a[nt]:new ut([],a),this.consumeOptional("//")}return e}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new ce(4011,W0)}}function fD(t){return t.segments.length>0?new ut([],{[nt]:t}):t}function q0(t){const n={};for(const r of Object.keys(t.children)){const i=q0(t.children[r]);(i.segments.length>0||i.hasChildren())&&(n[r]=i)}return function I$(t){if(1===t.numberOfChildren&&t.children[nt]){const n=t.children[nt];return new ut(t.segments.concat(n.segments),n.children)}return t}(new ut(t.segments,n))}function jc(t){return t instanceof Wc}function T$(t,n,e,r,o){if(0===e.length)return Ff(n.root,n.root,n.root,r,o);const i=function vN(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new gN(!0,0,t);let n=0,e=!1;const r=t.reduce((o,i,a)=>{if("object"==typeof i&&null!=i){if(i.outlets){const s={};return Dr(i.outlets,(u,c)=>{s[c]="string"==typeof u?u.split("/"):u}),[...o,{outlets:s}]}if(i.segmentPath)return[...o,i.segmentPath]}return"string"!=typeof i?[...o,i]:0===a?(i.split("/").forEach((s,u)=>{0==u&&"."===s||(0==u&&""===s?e=!0:".."===s?n++:""!=s&&o.push(s))}),o):[...o,i]},[]);return new gN(e,n,r)}(e);return i.toRoot()?Ff(n.root,n.root,new ut([],{}),r,o):function a(u){const c=function M$(t,n,e,r){if(t.isAbsolute)return new kf(n.root,!0,0);if(-1===r)return new kf(e,e===n.root,0);return function mN(t,n,e){let r=t,o=n,i=e;for(;i>o;){if(i-=o,r=r.parent,!r)throw new ce(4005,!1);o=r.segments.length}return new kf(r,!1,o-i)}(e,r+(pg(t.commands[0])?0:1),t.numberOfDoubleDots)}(i,n,t.snapshot?._urlSegment,u),f=c.processChildren?vg(c.segmentGroup,c.index,i.commands):hD(c.segmentGroup,c.index,i.commands);return Ff(n.root,c.segmentGroup,f,r,o)}(t.snapshot?._lastPathIndex)}function pg(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function gg(t){return"object"==typeof t&&null!=t&&t.outlets}function Ff(t,n,e,r,o){let a,i={};r&&Dr(r,(u,c)=>{i[c]=Array.isArray(u)?u.map(f=>`${f}`):`${u}`}),a=t===n?e:pN(t,n,e);const s=fD(q0(a));return new Wc(s,i,o)}function pN(t,n,e){const r={};return Dr(t.children,(o,i)=>{r[i]=o===n?e:pN(o,n,e)}),new ut(t.segments,r)}class gN{constructor(n,e,r){if(this.isAbsolute=n,this.numberOfDoubleDots=e,this.commands=r,n&&r.length>0&&pg(r[0]))throw new ce(4003,!1);const o=r.find(gg);if(o&&o!==oN(r))throw new ce(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class kf{constructor(n,e,r){this.segmentGroup=n,this.processChildren=e,this.index=r}}function hD(t,n,e){if(t||(t=new ut([],{})),0===t.segments.length&&t.hasChildren())return vg(t,n,e);const r=function F$(t,n,e){let r=0,o=n;const i={match:!1,pathIndex:0,commandIndex:0};for(;o<t.segments.length;){if(r>=e.length)return i;const a=t.segments[o],s=e[r];if(gg(s))break;const u=`${s}`,c=r<e.length-1?e[r+1]:null;if(o>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!wN(u,c,a))return i;r+=2}else{if(!wN(u,{},a))return i;r++}o++}return{match:!0,pathIndex:o,commandIndex:r}}(t,n,e),o=e.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const i=new ut(t.segments.slice(0,r.pathIndex),{});return i.children[nt]=new ut(t.segments.slice(r.pathIndex),t.children),vg(i,0,o)}return r.match&&0===o.length?new ut(t.segments,{}):r.match&&!t.hasChildren()?pD(t,n,e):r.match?vg(t,0,o):pD(t,n,e)}function vg(t,n,e){if(0===e.length)return new ut(t.segments,{});{const r=function N$(t){return gg(t[0])?t[0].outlets:{[nt]:t}}(e),o={};return Dr(r,(i,a)=>{"string"==typeof i&&(i=[i]),null!==i&&(o[a]=hD(t.children[a],n,i))}),Dr(t.children,(i,a)=>{void 0===r[a]&&(o[a]=i)}),new ut(t.segments,o)}}function pD(t,n,e){const r=t.segments.slice(0,n);let o=0;for(;o<e.length;){const i=e[o];if(gg(i)){const u=k$(i.outlets);return new ut(r,u)}if(0===o&&pg(e[0])){r.push(new dg(t.segments[n].path,yN(e[0]))),o++;continue}const a=gg(i)?i.outlets[nt]:`${i}`,s=o<e.length-1?e[o+1]:null;a&&s&&pg(s)?(r.push(new dg(a,yN(s))),o+=2):(r.push(new dg(a,{})),o++)}return new ut(r,{})}function k$(t){const n={};return Dr(t,(e,r)=>{"string"==typeof e&&(e=[e]),null!==e&&(n[r]=pD(new ut([],{}),0,e))}),n}function yN(t){const n={};return Dr(t,(e,r)=>n[r]=`${e}`),n}function wN(t,n,e){return t==e.path&&Aa(n,e.parameters)}class gs{constructor(n,e){this.id=n,this.url=e}}class gD extends gs{constructor(n,e,r="imperative",o=null){super(n,e),this.type=0,this.navigationTrigger=r,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class zc extends gs{constructor(n,e,r){super(n,e),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class K0 extends gs{constructor(n,e,r,o){super(n,e),this.reason=r,this.code=o,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class bN extends gs{constructor(n,e,r,o){super(n,e),this.error=r,this.target=o,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class P$ extends gs{constructor(n,e,r,o){super(n,e),this.urlAfterRedirects=r,this.state=o,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class O$ extends gs{constructor(n,e,r,o){super(n,e),this.urlAfterRedirects=r,this.state=o,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class L$ extends gs{constructor(n,e,r,o,i){super(n,e),this.urlAfterRedirects=r,this.state=o,this.shouldActivate=i,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class B$ extends gs{constructor(n,e,r,o){super(n,e),this.urlAfterRedirects=r,this.state=o,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class V$ extends gs{constructor(n,e,r,o){super(n,e),this.urlAfterRedirects=r,this.state=o,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class U${constructor(n){this.route=n,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class W${constructor(n){this.route=n,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class H${constructor(n){this.snapshot=n,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class j${constructor(n){this.snapshot=n,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class z${constructor(n){this.snapshot=n,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $${constructor(n){this.snapshot=n,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class xN{constructor(n,e,r){this.routerEvent=n,this.position=e,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class _N{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const e=this.pathFromRoot(n);return e.length>1?e[e.length-2]:null}children(n){const e=vD(n,this._root);return e?e.children.map(r=>r.value):[]}firstChild(n){const e=vD(n,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(n){const e=mD(n,this._root);return e.length<2?[]:e[e.length-2].children.map(o=>o.value).filter(o=>o!==n)}pathFromRoot(n){return mD(n,this._root).map(e=>e.value)}}function vD(t,n){if(t===n.value)return n;for(const e of n.children){const r=vD(t,e);if(r)return r}return null}function mD(t,n){if(t===n.value)return[n];for(const e of n.children){const r=mD(t,e);if(r.length)return r.unshift(n),r}return[]}class vs{constructor(n,e){this.value=n,this.children=e}toString(){return`TreeNode(${this.value})`}}function Pf(t){const n={};return t&&t.children.forEach(e=>n[e.value.outlet]=e),n}class CN extends _N{constructor(n,e){super(n),this.snapshot=e,yD(this,n)}toString(){return this.snapshot.toString()}}function DN(t,n){const e=function q$(t,n){const a=new X0([],{},{},"",{},nt,n,null,t.root,-1,{});return new IN("",new vs(a,[]))}(t,n),r=new Hi([new dg("",{})]),o=new Hi({}),i=new Hi({}),a=new Hi({}),s=new Hi(""),u=new Of(r,o,a,s,i,nt,n,e.root);return u.snapshot=e.root,new CN(new vs(u,[]),e)}class Of{constructor(n,e,r,o,i,a,s,u){this.url=n,this.params=e,this.queryParams=r,this.fragment=o,this.data=i,this.outlet=a,this.component=s,this.title=this.data?.pipe(Ve(c=>c[fg]))??Re(void 0),this._futureSnapshot=u}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Ve(n=>Nf(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Ve(n=>Nf(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function EN(t,n="emptyOnly"){const e=t.pathFromRoot;let r=0;if("always"!==n)for(r=e.length-1;r>=1;){const o=e[r],i=e[r-1];if(o.routeConfig&&""===o.routeConfig.path)r--;else{if(i.component)break;r--}}return function K$(t){return t.reduce((n,e)=>({params:{...n.params,...e.params},data:{...n.data,...e.data},resolve:{...e.data,...n.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(r))}class X0{constructor(n,e,r,o,i,a,s,u,c,f,d){this.url=n,this.params=e,this.queryParams=r,this.fragment=o,this.data=i,this.outlet=a,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=f,this._resolve=d}get title(){return this.data?.[fg]}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Nf(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Nf(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class IN extends _N{constructor(n,e){super(e),this.url=n,yD(this,e)}toString(){return SN(this._root)}}function yD(t,n){n.value._routerState=t,n.children.forEach(e=>yD(t,e))}function SN(t){const n=t.children.length>0?` { ${t.children.map(SN).join(", ")} } `:"";return`${t.value}${n}`}function wD(t){if(t.snapshot){const n=t.snapshot,e=t._futureSnapshot;t.snapshot=e,Aa(n.queryParams,e.queryParams)||t.queryParams.next(e.queryParams),n.fragment!==e.fragment&&t.fragment.next(e.fragment),Aa(n.params,e.params)||t.params.next(e.params),function l$(t,n){if(t.length!==n.length)return!1;for(let e=0;e<t.length;++e)if(!Aa(t[e],n[e]))return!1;return!0}(n.url,e.url)||t.url.next(e.url),Aa(n.data,e.data)||t.data.next(e.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function bD(t,n){const e=Aa(t.params,n.params)&&function p$(t,n){return Hc(t,n)&&t.every((e,r)=>Aa(e.parameters,n[r].parameters))}(t.url,n.url);return e&&!(!t.parent!=!n.parent)&&(!t.parent||bD(t.parent,n.parent))}function mg(t,n,e){if(e&&t.shouldReuseRoute(n.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=n.value;const o=function Y$(t,n,e){return n.children.map(r=>{for(const o of e.children)if(t.shouldReuseRoute(r.value,o.value.snapshot))return mg(t,r,o);return mg(t,r)})}(t,n,e);return new vs(r,o)}{if(t.shouldAttach(n.value)){const i=t.retrieve(n.value);if(null!==i){const a=i.route;return a.value._futureSnapshot=n.value,a.children=n.children.map(s=>mg(t,s)),a}}const r=function Q$(t){return new Of(new Hi(t.url),new Hi(t.params),new Hi(t.queryParams),new Hi(t.fragment),new Hi(t.data),t.outlet,t.component,t)}(n.value),o=n.children.map(i=>mg(t,i));return new vs(r,o)}}const xD="ngNavigationCancelingError";function AN(t,n){const{redirectTo:e,navigationBehaviorOptions:r}=jc(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,o=TN(!1,0,n);return o.url=e,o.navigationBehaviorOptions=r,o}function TN(t,n,e){const r=new Error("NavigationCancelingError: "+(t||""));return r[xD]=!0,r.cancellationCode=n,e&&(r.url=e),r}function RN(t){return MN(t)&&jc(t.url)}function MN(t){return t&&t[xD]}class Z${constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new yg,this.attachRef=null}}let yg=(()=>{class t{constructor(){this.contexts=new Map}onChildOutletCreated(e,r){const o=this.getOrCreateContext(e);o.outlet=r,this.contexts.set(e,o)}onChildOutletDestroyed(e){const r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new Z$,this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=He({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Y0=!1;let NN=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=nt,this.activateEvents=new _r,this.deactivateEvents=new _r,this.attachEvents=new _r,this.detachEvents=new _r,this.parentContexts=Pt(yg),this.location=Pt(Bi),this.changeDetector=Pt(AC),this.environmentInjector=Pt(_a)}ngOnChanges(e){if(e.name){const{firstChange:r,previousValue:o}=e.name;if(r)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ce(4012,Y0);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ce(4012,Y0);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ce(4012,Y0);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new ce(4013,Y0);this._activatedRoute=e;const o=this.location,a=e._futureSnapshot.component,s=this.parentContexts.getOrCreateContext(this.name).children,u=new J$(e,s,o.injector);if(r&&function e6(t){return!!t.resolveComponentFactory}(r)){const c=r.resolveComponentFactory(a);this.activated=o.createComponent(c,o.length,u)}else this.activated=o.createComponent(a,{index:o.length,injector:u,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=dn({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[mi]}),t})();class J${constructor(n,e,r){this.route=n,this.childContexts=e,this.parent=r}get(n,e){return n===Of?this.route:n===yg?this.childContexts:this.parent.get(n,e)}}let _D=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Hs({type:t,selectors:[["ng-component"]],standalone:!0,features:[BT],decls:1,vars:0,template:function(e,r){1&e&&zp(0,"router-outlet")},dependencies:[NN],encapsulation:2}),t})();function FN(t,n){return t.providers&&!t._injector&&(t._injector=d0(t.providers,n,`Route: ${t.path}`)),t._injector??n}function DD(t){const n=t.children&&t.children.map(DD),e=n?{...t,children:n}:{...t};return!e.component&&!e.loadComponent&&(n||e.loadChildren)&&e.outlet&&e.outlet!==nt&&(e.component=_D),e}function ii(t){return t.outlet||nt}function kN(t,n){const e=t.filter(r=>ii(r)===n);return e.push(...t.filter(r=>ii(r)!==n)),e}function wg(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let n=t.parent;n;n=n.parent){const e=n.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class i6{constructor(n,e,r,o){this.routeReuseStrategy=n,this.futureState=e,this.currState=r,this.forwardEvent=o}activate(n){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,n),wD(this.futureState.root),this.activateChildRoutes(e,r,n)}deactivateChildRoutes(n,e,r){const o=Pf(e);n.children.forEach(i=>{const a=i.value.outlet;this.deactivateRoutes(i,o[a],r),delete o[a]}),Dr(o,(i,a)=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(n,e,r){const o=n.value,i=e?e.value:null;if(o===i)if(o.component){const a=r.getContext(o.outlet);a&&this.deactivateChildRoutes(n,e,a.children)}else this.deactivateChildRoutes(n,e,r);else i&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(n,e){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,e):this.deactivateRouteAndOutlet(n,e)}detachAndStoreRouteSubtree(n,e){const r=e.getContext(n.value.outlet),o=r&&n.value.component?r.children:e,i=Pf(n);for(const a of Object.keys(i))this.deactivateRouteAndItsChildren(i[a],o);if(r&&r.outlet){const a=r.outlet.detach(),s=r.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:a,route:n,contexts:s})}}deactivateRouteAndOutlet(n,e){const r=e.getContext(n.value.outlet),o=r&&n.value.component?r.children:e,i=Pf(n);for(const a of Object.keys(i))this.deactivateRouteAndItsChildren(i[a],o);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(n,e,r){const o=Pf(e);n.children.forEach(i=>{this.activateRoutes(i,o[i.value.outlet],r),this.forwardEvent(new $$(i.value.snapshot))}),n.children.length&&this.forwardEvent(new j$(n.value.snapshot))}activateRoutes(n,e,r){const o=n.value,i=e?e.value:null;if(wD(o),o===i)if(o.component){const a=r.getOrCreateContext(o.outlet);this.activateChildRoutes(n,e,a.children)}else this.activateChildRoutes(n,e,r);else if(o.component){const a=r.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){const s=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),a.children.onOutletReAttached(s.contexts),a.attachRef=s.componentRef,a.route=s.route.value,a.outlet&&a.outlet.attach(s.componentRef,s.route.value),wD(s.route.value),this.activateChildRoutes(n,null,a.children)}else{const s=wg(o.snapshot),u=s?.get(Rc)??null;a.attachRef=null,a.route=o,a.resolver=u,a.injector=s,a.outlet&&a.outlet.activateWith(o,a.injector),this.activateChildRoutes(n,null,a.children)}}else this.activateChildRoutes(n,null,r)}}class PN{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class Q0{constructor(n,e){this.component=n,this.route=e}}function a6(t,n,e){const r=t._root;return bg(r,n?n._root:null,e,[r.value])}function Lf(t,n){const e=Symbol(),r=n.get(t,e);return r===e?"function"!=typeof t||function rx(t){return null!==ml(t)}(t)?n.get(t):t:r}function bg(t,n,e,r,o={canDeactivateChecks:[],canActivateChecks:[]}){const i=Pf(n);return t.children.forEach(a=>{(function u6(t,n,e,r,o={canDeactivateChecks:[],canActivateChecks:[]}){const i=t.value,a=n?n.value:null,s=e?e.getContext(t.value.outlet):null;if(a&&i.routeConfig===a.routeConfig){const u=function c6(t,n,e){if("function"==typeof e)return e(t,n);switch(e){case"pathParamsChange":return!Hc(t.url,n.url);case"pathParamsOrQueryParamsChange":return!Hc(t.url,n.url)||!Aa(t.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!bD(t,n)||!Aa(t.queryParams,n.queryParams);default:return!bD(t,n)}}(a,i,i.routeConfig.runGuardsAndResolvers);u?o.canActivateChecks.push(new PN(r)):(i.data=a.data,i._resolvedData=a._resolvedData),bg(t,n,i.component?s?s.children:null:e,r,o),u&&s&&s.outlet&&s.outlet.isActivated&&o.canDeactivateChecks.push(new Q0(s.outlet.component,a))}else a&&xg(n,s,o),o.canActivateChecks.push(new PN(r)),bg(t,null,i.component?s?s.children:null:e,r,o)})(a,i[a.value.outlet],e,r.concat([a.value]),o),delete i[a.value.outlet]}),Dr(i,(a,s)=>xg(a,e.getContext(s),o)),o}function xg(t,n,e){const r=Pf(t),o=t.value;Dr(r,(i,a)=>{xg(i,o.component?n?n.children.getContext(a):null:n,e)}),e.canDeactivateChecks.push(new Q0(o.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,o))}function _g(t){return"function"==typeof t}function ED(t){return t instanceof B0||"EmptyError"===t?.name}const Z0=Symbol("INITIAL_VALUE");function Bf(){return bo(t=>YM(t.map(n=>n.pipe(ko(1),function o$(...t){const n=qu(t);return Ht((e,r)=>{(n?lg(t,e,n):lg(t,e)).subscribe(r)})}(Z0)))).pipe(Ve(n=>{for(const e of n)if(!0!==e){if(e===Z0)return Z0;if(!1===e||e instanceof Wc)return e}return!0}),xo(n=>n!==Z0),ko(1)))}function ON(t){return function kb(...t){return ju(t)}(Cr(n=>{if(jc(n))throw AN(0,n)}),Ve(n=>!0===n))}const ID={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function LN(t,n,e,r,o){const i=SD(t,n,e);return i.matched?function I6(t,n,e,r){const o=n.canMatch;return o&&0!==o.length?Re(o.map(a=>{const s=Lf(a,t);return yu(function g6(t){return t&&_g(t.canMatch)}(s)?s.canMatch(n,e):t.runInContext(()=>s(n,e)))})).pipe(Bf(),ON()):Re(!0)}(r=FN(n,r),n,e).pipe(Ve(a=>!0===a?i:{...ID})):Re(i)}function SD(t,n,e){if(""===n.path)return"full"===n.pathMatch&&(t.hasChildren()||e.length>0)?{...ID}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const o=(n.matcher||c$)(e,t,n);if(!o)return{...ID};const i={};Dr(o.posParams,(s,u)=>{i[u]=s.path});const a=o.consumed.length>0?{...i,...o.consumed[o.consumed.length-1].parameters}:i;return{matched:!0,consumedSegments:o.consumed,remainingSegments:e.slice(o.consumed.length),parameters:a,positionalParamSegments:o.posParams??{}}}function J0(t,n,e,r){if(e.length>0&&function T6(t,n,e){return e.some(r=>ew(t,n,r)&&ii(r)!==nt)}(t,e,r)){const i=new ut(n,function A6(t,n,e,r){const o={};o[nt]=r,r._sourceSegment=t,r._segmentIndexShift=n.length;for(const i of e)if(""===i.path&&ii(i)!==nt){const a=new ut([],{});a._sourceSegment=t,a._segmentIndexShift=n.length,o[ii(i)]=a}return o}(t,n,r,new ut(e,t.children)));return i._sourceSegment=t,i._segmentIndexShift=n.length,{segmentGroup:i,slicedSegments:[]}}if(0===e.length&&function R6(t,n,e){return e.some(r=>ew(t,n,r))}(t,e,r)){const i=new ut(t.segments,function S6(t,n,e,r,o){const i={};for(const a of r)if(ew(t,e,a)&&!o[ii(a)]){const s=new ut([],{});s._sourceSegment=t,s._segmentIndexShift=n.length,i[ii(a)]=s}return{...o,...i}}(t,n,e,r,t.children));return i._sourceSegment=t,i._segmentIndexShift=n.length,{segmentGroup:i,slicedSegments:e}}const o=new ut(t.segments,t.children);return o._sourceSegment=t,o._segmentIndexShift=n.length,{segmentGroup:o,slicedSegments:e}}function ew(t,n,e){return(!(t.hasChildren()||n.length>0)||"full"!==e.pathMatch)&&""===e.path}function BN(t,n,e,r){return!!(ii(t)===r||r!==nt&&ew(n,e,t))&&("**"===t.path||SD(n,t,e).matched)}function VN(t,n,e){return 0===n.length&&!t.children[e]}const tw=!1;class nw{constructor(n){this.segmentGroup=n||null}}class UN{constructor(n){this.urlTree=n}}function Cg(t){return Mf(new nw(t))}function WN(t){return Mf(new UN(t))}class k6{constructor(n,e,r,o,i){this.injector=n,this.configLoader=e,this.urlSerializer=r,this.urlTree=o,this.config=i,this.allowRedirects=!0}apply(){const n=J0(this.urlTree.root,[],[],this.config).segmentGroup,e=new ut(n.segments,n.children);return this.expandSegmentGroup(this.injector,this.config,e,nt).pipe(Ve(i=>this.createUrlTree(q0(i),this.urlTree.queryParams,this.urlTree.fragment))).pipe(mu(i=>{if(i instanceof UN)return this.allowRedirects=!1,this.match(i.urlTree);throw i instanceof nw?this.noMatchError(i):i}))}match(n){return this.expandSegmentGroup(this.injector,this.config,n.root,nt).pipe(Ve(o=>this.createUrlTree(q0(o),n.queryParams,n.fragment))).pipe(mu(o=>{throw o instanceof nw?this.noMatchError(o):o}))}noMatchError(n){return new ce(4002,tw)}createUrlTree(n,e,r){const o=fD(n);return new Wc(o,e,r)}expandSegmentGroup(n,e,r,o){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(n,e,r).pipe(Ve(i=>new ut([],i))):this.expandSegment(n,r,e,r.segments,o,!0)}expandChildren(n,e,r){const o=[];for(const i of Object.keys(r.children))"primary"===i?o.unshift(i):o.push(i);return bn(o).pipe(Uc(i=>{const a=r.children[i],s=kN(e,i);return this.expandSegmentGroup(n,s,a,i).pipe(Ve(u=>({segment:u,outlet:i})))}),JM((i,a)=>(i[a.outlet]=a.segment,i),{}),eN())}expandSegment(n,e,r,o,i,a){return bn(r).pipe(Uc(s=>this.expandSegmentAgainstRoute(n,e,r,s,o,i,a).pipe(mu(c=>{if(c instanceof nw)return Re(null);throw c}))),vu(s=>!!s),mu((s,u)=>{if(ED(s))return VN(e,o,i)?Re(new ut([],{})):Cg(e);throw s}))}expandSegmentAgainstRoute(n,e,r,o,i,a,s){return BN(o,e,i,a)?void 0===o.redirectTo?this.matchSegmentAgainstRoute(n,e,o,i,a):s&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,e,r,o,i,a):Cg(e):Cg(e)}expandSegmentAgainstRouteUsingRedirect(n,e,r,o,i,a){return"**"===o.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,r,o,a):this.expandRegularSegmentAgainstRouteUsingRedirect(n,e,r,o,i,a)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,e,r,o){const i=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?WN(i):this.lineralizeSegments(r,i).pipe(wn(a=>{const s=new ut(a,{});return this.expandSegment(n,s,e,a,o,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,e,r,o,i,a){const{matched:s,consumedSegments:u,remainingSegments:c,positionalParamSegments:f}=SD(e,o,i);if(!s)return Cg(e);const d=this.applyRedirectCommands(u,o.redirectTo,f);return o.redirectTo.startsWith("/")?WN(d):this.lineralizeSegments(o,d).pipe(wn(p=>this.expandSegment(n,e,r,p.concat(c),a,!1)))}matchSegmentAgainstRoute(n,e,r,o,i){return"**"===r.path?(n=FN(r,n),r.loadChildren?(r._loadedRoutes?Re({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(n,r)).pipe(Ve(s=>(r._loadedRoutes=s.routes,r._loadedInjector=s.injector,new ut(o,{})))):Re(new ut(o,{}))):LN(e,r,o,n).pipe(bo(({matched:a,consumedSegments:s,remainingSegments:u})=>a?this.getChildConfig(n=r._injector??n,r,o).pipe(wn(f=>{const d=f.injector??n,p=f.routes,{segmentGroup:g,slicedSegments:m}=J0(e,s,u,p),y=new ut(g.segments,g.children);if(0===m.length&&y.hasChildren())return this.expandChildren(d,p,y).pipe(Ve(_=>new ut(s,_)));if(0===p.length&&0===m.length)return Re(new ut(s,{}));const w=ii(r)===i;return this.expandSegment(d,y,p,m,w?nt:i,!0).pipe(Ve(C=>new ut(s.concat(C.segments),C.children)))})):Cg(e)))}getChildConfig(n,e,r){return e.children?Re({routes:e.children,injector:n}):e.loadChildren?void 0!==e._loadedRoutes?Re({routes:e._loadedRoutes,injector:e._loadedInjector}):function E6(t,n,e,r){const o=n.canLoad;return void 0===o||0===o.length?Re(!0):Re(o.map(a=>{const s=Lf(a,t);return yu(function f6(t){return t&&_g(t.canLoad)}(s)?s.canLoad(n,e):t.runInContext(()=>s(n,e)))})).pipe(Bf(),ON())}(n,e,r).pipe(wn(o=>o?this.configLoader.loadChildren(n,e).pipe(Cr(i=>{e._loadedRoutes=i.routes,e._loadedInjector=i.injector})):function N6(t){return Mf(TN(tw,3))}())):Re({routes:[],injector:n})}lineralizeSegments(n,e){let r=[],o=e.root;for(;;){if(r=r.concat(o.segments),0===o.numberOfChildren)return Re(r);if(o.numberOfChildren>1||!o.children[nt])return Mf(new ce(4e3,tw));o=o.children[nt]}}applyRedirectCommands(n,e,r){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),n,r)}applyRedirectCreateUrlTree(n,e,r,o){const i=this.createSegmentGroup(n,e.root,r,o);return new Wc(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(n,e){const r={};return Dr(n,(o,i)=>{if("string"==typeof o&&o.startsWith(":")){const s=o.substring(1);r[i]=e[s]}else r[i]=o}),r}createSegmentGroup(n,e,r,o){const i=this.createSegments(n,e.segments,r,o);let a={};return Dr(e.children,(s,u)=>{a[u]=this.createSegmentGroup(n,s,r,o)}),new ut(i,a)}createSegments(n,e,r,o){return e.map(i=>i.path.startsWith(":")?this.findPosParam(n,i,o):this.findOrReturn(i,r))}findPosParam(n,e,r){const o=r[e.path.substring(1)];if(!o)throw new ce(4001,tw);return o}findOrReturn(n,e){let r=0;for(const o of e){if(o.path===n.path)return e.splice(r),o;r++}return n}}class O6{}class V6{constructor(n,e,r,o,i,a,s){this.injector=n,this.rootComponentType=e,this.config=r,this.urlTree=o,this.url=i,this.paramsInheritanceStrategy=a,this.urlSerializer=s}recognize(){const n=J0(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,n,nt).pipe(Ve(e=>{if(null===e)return null;const r=new X0([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},nt,this.rootComponentType,null,this.urlTree.root,-1,{}),o=new vs(r,e),i=new IN(this.url,o);return this.inheritParamsAndData(i._root),i}))}inheritParamsAndData(n){const e=n.value,r=EN(e,this.paramsInheritanceStrategy);e.params=Object.freeze(r.params),e.data=Object.freeze(r.data),n.children.forEach(o=>this.inheritParamsAndData(o))}processSegmentGroup(n,e,r,o){return 0===r.segments.length&&r.hasChildren()?this.processChildren(n,e,r):this.processSegment(n,e,r,r.segments,o)}processChildren(n,e,r){return bn(Object.keys(r.children)).pipe(Uc(o=>{const i=r.children[o],a=kN(e,o);return this.processSegmentGroup(n,a,i,o)}),JM((o,i)=>o&&i?(o.push(...i),o):null),function s$(t,n=!1){return Ht((e,r)=>{let o=0;e.subscribe(yn(r,i=>{const a=t(i,o++);(a||n)&&r.next(i),!a&&r.complete()}))})}(o=>null!==o),U0(null),eN(),Ve(o=>{if(null===o)return null;const i=jN(o);return function U6(t){t.sort((n,e)=>n.value.outlet===nt?-1:e.value.outlet===nt?1:n.value.outlet.localeCompare(e.value.outlet))}(i),i}))}processSegment(n,e,r,o,i){return bn(e).pipe(Uc(a=>this.processSegmentAgainstRoute(a._injector??n,a,r,o,i)),vu(a=>!!a),mu(a=>{if(ED(a))return VN(r,o,i)?Re([]):Re(null);throw a}))}processSegmentAgainstRoute(n,e,r,o,i){if(e.redirectTo||!BN(e,r,o,i))return Re(null);let a;if("**"===e.path){const s=o.length>0?oN(o).parameters:{},u=$N(r)+o.length;a=Re({snapshot:new X0(o,s,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,GN(e),ii(e),e.component??e._loadedComponent??null,e,zN(r),u,qN(e)),consumedSegments:[],remainingSegments:[]})}else a=LN(r,e,o,n).pipe(Ve(({matched:s,consumedSegments:u,remainingSegments:c,parameters:f})=>{if(!s)return null;const d=$N(r)+u.length;return{snapshot:new X0(u,f,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,GN(e),ii(e),e.component??e._loadedComponent??null,e,zN(r),d,qN(e)),consumedSegments:u,remainingSegments:c}}));return a.pipe(bo(s=>{if(null===s)return Re(null);const{snapshot:u,consumedSegments:c,remainingSegments:f}=s;n=e._injector??n;const d=e._loadedInjector??n,p=function W6(t){return t.children?t.children:t.loadChildren?t._loadedRoutes:[]}(e),{segmentGroup:g,slicedSegments:m}=J0(r,c,f,p.filter(w=>void 0===w.redirectTo));if(0===m.length&&g.hasChildren())return this.processChildren(d,p,g).pipe(Ve(w=>null===w?null:[new vs(u,w)]));if(0===p.length&&0===m.length)return Re([new vs(u,[])]);const y=ii(e)===i;return this.processSegment(d,p,g,m,y?nt:i).pipe(Ve(w=>null===w?null:[new vs(u,w)]))}))}}function H6(t){const n=t.value.routeConfig;return n&&""===n.path&&void 0===n.redirectTo}function jN(t){const n=[],e=new Set;for(const r of t){if(!H6(r)){n.push(r);continue}const o=n.find(i=>r.value.routeConfig===i.value.routeConfig);void 0!==o?(o.children.push(...r.children),e.add(o)):n.push(r)}for(const r of e){const o=jN(r.children);n.push(new vs(r.value,o))}return n.filter(r=>!e.has(r))}function zN(t){let n=t;for(;n._sourceSegment;)n=n._sourceSegment;return n}function $N(t){let n=t,e=n._segmentIndexShift??0;for(;n._sourceSegment;)n=n._sourceSegment,e+=n._segmentIndexShift??0;return e-1}function GN(t){return t.data||{}}function qN(t){return t.resolve||{}}function KN(t){return"string"==typeof t.title||null===t.title}function AD(t){return bo(n=>{const e=t(n);return e?bn(e).pipe(Ve(()=>n)):Re(n)})}let XN=(()=>{class t{buildTitle(e){let r,o=e.root;for(;void 0!==o;)r=this.getResolvedTitleForRoute(o)??r,o=o.children.find(i=>i.outlet===nt);return r}getResolvedTitleForRoute(e){return e.data[fg]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=He({token:t,factory:function(){return Pt(YN)},providedIn:"root"}),t})(),YN=(()=>{class t extends XN{constructor(e){super(),this.title=e}updateTitle(e){const r=this.buildTitle(e);void 0!==r&&this.title.setTitle(r)}}return t.\u0275fac=function(e){return new(e||t)(Ie(GM))},t.\u0275prov=He({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class Y6{}class Q6{shouldDetach(n){return!1}store(n,e){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,e){return n.routeConfig===e.routeConfig}}class Z6 extends Q6{}const rw=new Me("",{providedIn:"root",factory:()=>({})}),Vf=new Me("ROUTES");let TD=(()=>{class t{constructor(e,r){this.injector=e,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Re(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const r=yu(e.loadComponent()).pipe(Ve(ZN),Cr(i=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=i}),uD(()=>{this.componentLoaders.delete(e)})),o=new aD(r,()=>new fr).pipe(iD());return this.componentLoaders.set(e,o),o}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Re({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const i=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(Ve(s=>{this.onLoadEndListener&&this.onLoadEndListener(r);let u,c,f=!1;Array.isArray(s)?c=s:(u=s.create(e).injector,c=rN(u.get(Vf,[],Ae.Self|Ae.Optional)));return{routes:c.map(DD),injector:u}}),uD(()=>{this.childrenLoaders.delete(r)})),a=new aD(i,()=>new fr).pipe(iD());return this.childrenLoaders.set(r,a),a}loadModuleFactoryOrRoutes(e){return yu(e()).pipe(Ve(ZN),wn(o=>o instanceof OT||Array.isArray(o)?Re(o):bn(this.compiler.compileModuleAsync(o))))}}return t.\u0275fac=function(e){return new(e||t)(Ie(mo),Ie(wC))},t.\u0275prov=He({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function ZN(t){return function tG(t){return t&&"object"==typeof t&&"default"in t}(t)?t.default:t}class nG{}class rG{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,e){return n}}function oG(t){throw t}function iG(t,n,e){return n.parse("/")}const aG={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},sG={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function JN(){const t=Pt(lN),n=Pt(yg),e=Pt(OC),r=Pt(mo),o=Pt(wC),i=Pt(Vf,{optional:!0})??[],a=Pt(rw,{optional:!0})??{},s=Pt(YN),u=Pt(XN,{optional:!0}),c=Pt(nG,{optional:!0}),f=Pt(Y6,{optional:!0}),d=new Vr(null,t,n,e,r,o,rN(i));return c&&(d.urlHandlingStrategy=c),f&&(d.routeReuseStrategy=f),d.titleStrategy=u??s,function uG(t,n){t.errorHandler&&(n.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(n.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(n.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(n.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.urlUpdateStrategy&&(n.urlUpdateStrategy=t.urlUpdateStrategy),t.canceledNavigationResolution&&(n.canceledNavigationResolution=t.canceledNavigationResolution)}(a,d),d}let Vr=(()=>{class t{constructor(e,r,o,i,a,s,u){this.rootComponentType=e,this.urlSerializer=r,this.rootContexts=o,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new fr,this.errorHandler=oG,this.malformedUriErrorHandler=iG,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Re(void 0),this.urlHandlingStrategy=new rG,this.routeReuseStrategy=new Z6,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.canceledNavigationResolution="replace",this.configLoader=a.get(TD),this.configLoader.onLoadEndListener=p=>this.triggerEvent(new W$(p)),this.configLoader.onLoadStartListener=p=>this.triggerEvent(new U$(p)),this.ngModule=a.get(Lc),this.console=a.get(TW);const d=a.get(_n);this.isNgZoneEnabled=d instanceof _n&&_n.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=new Wc,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=DN(this.currentUrlTree,this.rootComponentType),this.transitions=new Hi({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(e){const r=this.events;return e.pipe(xo(o=>0!==o.id),Ve(o=>({...o,extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),bo(o=>{let i=!1,a=!1;return Re(o).pipe(Cr(s=>{this.currentNavigation={id:s.id,initialUrl:s.rawUrl,extractedUrl:s.extractedUrl,trigger:s.source,extras:s.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),bo(s=>{const u=this.browserUrlTree.toString(),c=!this.navigated||s.extractedUrl.toString()!==u||u!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||c)&&this.urlHandlingStrategy.shouldProcessUrl(s.rawUrl))return eF(s.source)&&(this.browserUrlTree=s.extractedUrl),Re(s).pipe(bo(d=>{const p=this.transitions.getValue();return r.next(new gD(d.id,this.serializeUrl(d.extractedUrl),d.source,d.restoredState)),p!==this.transitions.getValue()?qo:Promise.resolve(d)}),function P6(t,n,e,r){return bo(o=>function F6(t,n,e,r,o){return new k6(t,n,e,r,o).apply()}(t,n,e,o.extractedUrl,r).pipe(Ve(i=>({...o,urlAfterRedirects:i}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Cr(d=>{this.currentNavigation={...this.currentNavigation,finalUrl:d.urlAfterRedirects},o.urlAfterRedirects=d.urlAfterRedirects}),function z6(t,n,e,r,o){return wn(i=>function B6(t,n,e,r,o,i,a="emptyOnly"){return new V6(t,n,e,r,o,a,i).recognize().pipe(bo(s=>null===s?function L6(t){return new xt(n=>n.error(t))}(new O6):Re(s)))}(t,n,e,i.urlAfterRedirects,r.serialize(i.urlAfterRedirects),r,o).pipe(Ve(a=>({...i,targetSnapshot:a}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy),Cr(d=>{if(o.targetSnapshot=d.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!d.extras.skipLocationChange){const g=this.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);this.setBrowserUrl(g,d)}this.browserUrlTree=d.urlAfterRedirects}const p=new P$(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot);r.next(p)}));if(c&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:p,extractedUrl:g,source:m,restoredState:y,extras:w}=s,b=new gD(p,this.serializeUrl(g),m,y);r.next(b);const C=DN(g,this.rootComponentType).snapshot;return Re(o={...s,targetSnapshot:C,urlAfterRedirects:g,extras:{...w,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=s.rawUrl,s.resolve(null),qo}),Cr(s=>{const u=new O$(s.id,this.serializeUrl(s.extractedUrl),this.serializeUrl(s.urlAfterRedirects),s.targetSnapshot);this.triggerEvent(u)}),Ve(s=>o={...s,guards:a6(s.targetSnapshot,s.currentSnapshot,this.rootContexts)}),function m6(t,n){return wn(e=>{const{targetSnapshot:r,currentSnapshot:o,guards:{canActivateChecks:i,canDeactivateChecks:a}}=e;return 0===a.length&&0===i.length?Re({...e,guardsResult:!0}):function y6(t,n,e,r){return bn(t).pipe(wn(o=>function D6(t,n,e,r,o){const i=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return i&&0!==i.length?Re(i.map(s=>{const u=wg(n)??o,c=Lf(s,u);return yu(function p6(t){return t&&_g(t.canDeactivate)}(c)?c.canDeactivate(t,n,e,r):u.runInContext(()=>c(t,n,e,r))).pipe(vu())})).pipe(Bf()):Re(!0)}(o.component,o.route,e,n,r)),vu(o=>!0!==o,!0))}(a,r,o,t).pipe(wn(s=>s&&function l6(t){return"boolean"==typeof t}(s)?function w6(t,n,e,r){return bn(n).pipe(Uc(o=>lg(function x6(t,n){return null!==t&&n&&n(new H$(t)),Re(!0)}(o.route.parent,r),function b6(t,n){return null!==t&&n&&n(new z$(t)),Re(!0)}(o.route,r),function C6(t,n,e){const r=n[n.length-1],i=n.slice(0,n.length-1).reverse().map(a=>function s6(t){const n=t.routeConfig?t.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:t,guards:n}:null}(a)).filter(a=>null!==a).map(a=>V0(()=>Re(a.guards.map(u=>{const c=wg(a.node)??e,f=Lf(u,c);return yu(function h6(t){return t&&_g(t.canActivateChild)}(f)?f.canActivateChild(r,t):c.runInContext(()=>f(r,t))).pipe(vu())})).pipe(Bf())));return Re(i).pipe(Bf())}(t,o.path,e),function _6(t,n,e){const r=n.routeConfig?n.routeConfig.canActivate:null;if(!r||0===r.length)return Re(!0);const o=r.map(i=>V0(()=>{const a=wg(n)??e,s=Lf(i,a);return yu(function d6(t){return t&&_g(t.canActivate)}(s)?s.canActivate(n,t):a.runInContext(()=>s(n,t))).pipe(vu())}));return Re(o).pipe(Bf())}(t,o.route,e))),vu(o=>!0!==o,!0))}(r,i,t,n):Re(s)),Ve(s=>({...e,guardsResult:s})))})}(this.ngModule.injector,s=>this.triggerEvent(s)),Cr(s=>{if(o.guardsResult=s.guardsResult,jc(s.guardsResult))throw AN(0,s.guardsResult);const u=new L$(s.id,this.serializeUrl(s.extractedUrl),this.serializeUrl(s.urlAfterRedirects),s.targetSnapshot,!!s.guardsResult);this.triggerEvent(u)}),xo(s=>!!s.guardsResult||(this.restoreHistory(s),this.cancelNavigationTransition(s,"",3),!1)),AD(s=>{if(s.guards.canActivateChecks.length)return Re(s).pipe(Cr(u=>{const c=new B$(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(c)}),bo(u=>{let c=!1;return Re(u).pipe(function $6(t,n){return wn(e=>{const{targetSnapshot:r,guards:{canActivateChecks:o}}=e;if(!o.length)return Re(e);let i=0;return bn(o).pipe(Uc(a=>function G6(t,n,e,r){const o=t.routeConfig,i=t._resolve;return void 0!==o?.title&&!KN(o)&&(i[fg]=o.title),function q6(t,n,e,r){const o=function K6(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}(t);if(0===o.length)return Re({});const i={};return bn(o).pipe(wn(a=>function X6(t,n,e,r){const o=wg(n)??r,i=Lf(t,o);return yu(i.resolve?i.resolve(n,e):o.runInContext(()=>i(n,e)))}(t[a],n,e,r).pipe(vu(),Cr(s=>{i[a]=s}))),sD(1),tN(i),mu(a=>ED(a)?qo:Mf(a)))}(i,t,n,r).pipe(Ve(a=>(t._resolvedData=a,t.data=EN(t,e).resolve,o&&KN(o)&&(t.data[fg]=o.title),null)))}(a.route,r,t,n)),Cr(()=>i++),sD(1),wn(a=>i===o.length?Re(e):qo))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Cr({next:()=>c=!0,complete:()=>{c||(this.restoreHistory(u),this.cancelNavigationTransition(u,"",2))}}))}),Cr(u=>{const c=new V$(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(c)}))}),AD(s=>{const u=c=>{const f=[];c.routeConfig?.loadComponent&&!c.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(c.routeConfig).pipe(Cr(d=>{c.component=d}),Ve(()=>{})));for(const d of c.children)f.push(...u(d));return f};return YM(u(s.targetSnapshot.root)).pipe(U0(),ko(1))}),AD(()=>this.afterPreactivation()),Ve(s=>{const u=function X$(t,n,e){const r=mg(t,n._root,e?e._root:void 0);return new CN(r,n)}(this.routeReuseStrategy,s.targetSnapshot,s.currentRouterState);return o={...s,targetRouterState:u}}),Cr(s=>{this.currentUrlTree=s.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(s.urlAfterRedirects,s.rawUrl),this.routerState=s.targetRouterState,"deferred"===this.urlUpdateStrategy&&(s.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,s),this.browserUrlTree=s.urlAfterRedirects)}),((t,n,e)=>Ve(r=>(new i6(n,r.targetRouterState,r.currentRouterState,e).activate(t),r)))(this.rootContexts,this.routeReuseStrategy,s=>this.triggerEvent(s)),Cr({next(){i=!0},complete(){i=!0}}),uD(()=>{i||a||this.cancelNavigationTransition(o,"",1),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),mu(s=>{if(a=!0,MN(s)){RN(s)||(this.navigated=!0,this.restoreHistory(o,!0));const u=new K0(o.id,this.serializeUrl(o.extractedUrl),s.message,s.cancellationCode);if(r.next(u),RN(s)){const c=this.urlHandlingStrategy.merge(s.url,this.rawUrlTree),f={skipLocationChange:o.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||eF(o.source)};this.scheduleNavigation(c,"imperative",null,f,{resolve:o.resolve,reject:o.reject,promise:o.promise})}else o.resolve(!1)}else{this.restoreHistory(o,!0);const u=new bN(o.id,this.serializeUrl(o.extractedUrl),s,o.targetSnapshot??void 0);r.next(u);try{o.resolve(this.errorHandler(s))}catch(c){o.reject(c)}}return qo}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next({...this.transitions.value,...e})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const r="popstate"===e.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const o={replaceUrl:!0},i=e.state?.navigationId?e.state:null;if(i){const s={...i};delete s.navigationId,delete s.\u0275routerPageId,0!==Object.keys(s).length&&(o.state=s)}const a=this.parseUrl(e.url);this.scheduleNavigation(a,r,i,o)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){this.config=e.map(DD),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,r={}){const{relativeTo:o,queryParams:i,fragment:a,queryParamsHandling:s,preserveFragment:u}=r,c=o||this.routerState.root,f=u?this.currentUrlTree.fragment:a;let d=null;switch(s){case"merge":d={...this.currentUrlTree.queryParams,...i};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=i||null}return null!==d&&(d=this.removeEmptyProps(d)),T$(c,this.currentUrlTree,e,d,f??null)}navigateByUrl(e,r={skipLocationChange:!1}){const o=jc(e)?e:this.parseUrl(e),i=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(i,"imperative",null,r)}navigate(e,r={skipLocationChange:!1}){return function cG(t){for(let n=0;n<t.length;n++){if(null==t[n])throw new ce(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let r;try{r=this.urlSerializer.parse(e)}catch(o){r=this.malformedUriErrorHandler(o,this.urlSerializer,e)}return r}isActive(e,r){let o;if(o=!0===r?{...aG}:!1===r?{...sG}:r,jc(e))return aN(this.currentUrlTree,e,o);const i=this.parseUrl(e);return aN(this.currentUrlTree,i,o)}removeEmptyProps(e){return Object.keys(e).reduce((r,o)=>{const i=e[o];return null!=i&&(r[o]=i),r},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new zc(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,r,o,i,a){if(this.disposed)return Promise.resolve(!1);let s,u,c;a?(s=a.resolve,u=a.reject,c=a.promise):c=new Promise((p,g)=>{s=p,u=g});const f=++this.navigationId;let d;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(o=this.location.getState()),d=o&&o.\u0275routerPageId?o.\u0275routerPageId:i.replaceUrl||i.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):d=0,this.setTransition({id:f,targetPageId:d,source:r,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:i,resolve:s,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(p=>Promise.reject(p))}setBrowserUrl(e,r){const o=this.urlSerializer.serialize(e),i={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(o)||r.extras.replaceUrl?this.location.replaceState(o,"",i):this.location.go(o,"",i)}restoreHistory(e,r=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===o?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===o&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(o)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,r,o){const i=new K0(e.id,this.serializeUrl(e.extractedUrl),r,o);this.triggerEvent(i),e.resolve(!1)}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}}return t.\u0275fac=function(e){Nc()},t.\u0275prov=He({token:t,factory:function(){return JN()},providedIn:"root"}),t})();function eF(t){return"imperative"!==t}class tF{}let dG=(()=>{class t{constructor(e,r,o,i,a){this.router=e,this.injector=o,this.preloadingStrategy=i,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(xo(e=>e instanceof zc),Uc(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){const o=[];for(const i of r){i.providers&&!i._injector&&(i._injector=d0(i.providers,e,`Route: ${i.path}`));const a=i._injector??e,s=i._loadedInjector??a;i.loadChildren&&!i._loadedRoutes&&void 0===i.canLoad||i.loadComponent&&!i._loadedComponent?o.push(this.preloadConfig(a,i)):(i.children||i._loadedRoutes)&&o.push(this.processRoutes(s,i.children??i._loadedRoutes))}return bn(o).pipe(Bs())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let o;o=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(e,r):Re(null);const i=o.pipe(wn(a=>null===a?Re(void 0):(r._loadedRoutes=a.routes,r._loadedInjector=a.injector,this.processRoutes(a.injector??e,a.routes))));return r.loadComponent&&!r._loadedComponent?bn([i,this.loader.loadComponent(r)]).pipe(Bs()):i})}}return t.\u0275fac=function(e){return new(e||t)(Ie(Vr),Ie(wC),Ie(_a),Ie(tF),Ie(TD))},t.\u0275prov=He({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const MD=new Me("");let nF=(()=>{class t{constructor(e,r,o,i={}){this.router=e,this.viewportScroller=r,this.zone=o,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof gD?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof zc&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof xN&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.router.triggerEvent(new xN(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(e){Nc()},t.\u0275prov=He({token:t,factory:t.\u0275fac}),t})();function Wf(t,n){return{\u0275kind:t,\u0275providers:n}}function oF(){const t=Pt(mo);return n=>{const e=t.get(rg);if(n!==e.components[0])return;const r=t.get(Vr),o=t.get(iF);1===t.get(FD)&&r.initialNavigation(),t.get(aF,null,Ae.Optional)?.setUpPreloading(),t.get(MD,null,Ae.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),o.next(),o.complete()}}const iF=new Me("",{factory:()=>new fr}),FD=new Me("",{providedIn:"root",factory:()=>1});const aF=new Me("");function mG(t){return Wf(0,[{provide:aF,useExisting:dG},{provide:tF,useExisting:t}])}const sF=new Me("ROUTER_FORROOT_GUARD"),yG=[OC,{provide:lN,useClass:cD},{provide:Vr,useFactory:JN},yg,{provide:Of,useFactory:function rF(t){return t.routerState.root},deps:[Vr]},TD,[]];function wG(){return new PR("Router",Vr)}let uF=(()=>{class t{constructor(e){}static forRoot(e,r){return{ngModule:t,providers:[yG,[],{provide:Vf,multi:!0,useValue:e},{provide:sF,useFactory:CG,deps:[[Vr,new yc,new Xr]]},{provide:rw,useValue:r||{}},r?.useHash?{provide:Vc,useClass:mH}:{provide:Vc,useClass:oM},{provide:MD,useFactory:()=>{const t=Pt(Vr),n=Pt(Vj),e=Pt(_n),r=Pt(rw);return r.scrollOffset&&n.setOffset(r.scrollOffset),new nF(t,n,e,r)}},r?.preloadingStrategy?mG(r.preloadingStrategy).\u0275providers:[],{provide:PR,multi:!0,useFactory:wG},r?.initialNavigation?DG(r):[],[{provide:cF,useFactory:oF},{provide:AR,multi:!0,useExisting:cF}]]}}static forChild(e){return{ngModule:t,providers:[{provide:Vf,multi:!0,useValue:e}]}}}return t.\u0275fac=function(e){return new(e||t)(Ie(sF,8))},t.\u0275mod=aa({type:t}),t.\u0275inj=ht({imports:[_D]}),t})();function CG(t){return"guarded"}function DG(t){return["disabled"===t.initialNavigation?Wf(3,[{provide:tg,multi:!0,useFactory:()=>{const n=Pt(Vr);return()=>{n.setUpLocationChangeListener()}}},{provide:FD,useValue:2}]).\u0275providers:[],"enabledBlocking"===t.initialNavigation?Wf(2,[{provide:FD,useValue:0},{provide:tg,multi:!0,deps:[mo],useFactory:n=>{const e=n.get(gH,Promise.resolve());let r=!1;return()=>e.then(()=>new Promise(i=>{const a=n.get(Vr),s=n.get(iF);(function o(i){n.get(Vr).events.pipe(xo(s=>s instanceof zc||s instanceof K0||s instanceof bN),Ve(s=>s instanceof zc||s instanceof K0&&(0===s.code||1===s.code)&&null),xo(s=>null!==s),ko(1)).subscribe(()=>{i()})})(()=>{i(!0),r=!0}),a.afterPreactivation=()=>(i(!0),r||s.closed?Re(void 0):s),a.initialNavigation()}))}}]).\u0275providers:[]]}const cF=new Me(""),IG=[];class iw{static#e=this.\u0275fac=function(e){return new(e||iw)};static#t=this.\u0275mod=aa({type:iw});static#n=this.\u0275inj=ht({imports:[uF.forRoot(IG),uF]})}var SG=cr(489),lF=function(t,n){return(lF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o])})(t,n)};function ji(t,n){function e(){this.constructor=t}lF(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}function be(t,n,e,r){return new(e||(e=Promise))(function(o,i){function a(c){try{u(r.next(c))}catch(f){i(f)}}function s(c){try{u(r.throw(c))}catch(f){i(f)}}function u(c){c.done?o(c.value):new e(function(f){f(c.value)}).then(a,s)}u((r=r.apply(t,n||[])).next())})}function xe(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(c){return function(f){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&f[0]?r.return:f[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,f[1])).done)return o;switch(r=0,o&&(f=[2&f[0],o.value]),f[0]){case 0:case 1:o=f;break;case 4:return a.label++,{value:f[1],done:!1};case 5:a.label++,r=f[1],f=[0];continue;case 7:f=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===f[0]||2===f[0])){a=0;continue}if(3===f[0]&&(!o||f[1]>o[0]&&f[1]<o[3])){a.label=f[1];break}if(6===f[0]&&a.label<o[1]){a.label=o[1],o=f;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(f);break}o[2]&&a.ops.pop(),a.trys.pop();continue}f=n.call(t,a)}catch(d){f=[6,d],r=0}finally{e=o=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}([u,c])}}}var fF=function(){function t(n){this.global=n,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(n,e){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=n,this.platform=e},t.prototype.registerFlag=function(n,e,r){if(this.flagRegistry[n]={evaluationFn:e,setHook:r},null!=this.urlFlags[n]){var o=this.urlFlags[n];console.warn("Setting feature override from URL "+n+": "+o+"."),this.set(n,o)}},t.prototype.get=function(n){return n in this.flags||(this.flags[n]=this.evaluateFlag(n)),this.flags[n]},t.prototype.getNumber=function(n){return this.get(n)},t.prototype.getBool=function(n){return this.get(n)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(n,e){if(null==this.flagRegistry[n])throw new Error("Cannot set flag "+n+" as it has not been registered.");this.flags[n]=e,null!=this.flagRegistry[n].setHook&&this.flagRegistry[n].setHook(e)},t.prototype.evaluateFlag=function(n){if(null==this.flagRegistry[n])throw new Error("Cannot evaluate flag '"+n+"': no evaluation function found.");return this.flagRegistry[n].evaluationFn()},t.prototype.setFlags=function(n){this.flags=Object.assign({},n)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var n=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var r,o=(r={},this.global.location.search.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return AG(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in o&&o.tfjsflags.split(",").forEach(function(i){var a=i.split(":"),s=a[0];n.urlFlags[s]=function(c,f){if("true"===(f=f.toLowerCase())||"false"===f)return"true"===f;if(""+ +f===f)return+f;throw new Error("Could not parse value flag value "+f+" for flag "+c+".")}(s,a[1])})}},t}();function AG(t,n,e){t[decodeURIComponent(n)]=decodeURIComponent(e||"")}function K(){return kD}var kD=null,Hf=new Map,Eg=new Map;function PD(t,n){var e=BD(t,n);return Hf.get(e)}function dF(t){return Eg.get(t)}function OD(t){for(var n=Hf.entries(),e=[];;){var r=n.next(),i=r.value;if(r.done)break;var s=i[1];i[0].split("_")[0]===t&&e.push(s)}return e}function LD(t){var n=t.kernelName,e=t.backendName,r=BD(n,e);if(Hf.has(r))throw new Error("The kernel '"+n+"' for backend '"+e+"' is already registered");Hf.set(r,t)}function hF(t){var n=t.kernelName;Eg.has(n)&&console.warn("Overriding the gradient for '"+n+"'"),Eg.set(n,t)}function TG(t,n){var e=BD(t,n);if(!Hf.has(e))throw new Error("The kernel '"+t+"' for backend '"+n+"' is not registered");Hf.delete(e)}function RG(t){if(!Eg.has(t))throw new Error("The gradient '"+t+"' for backend is not registered");Eg.delete(t)}function BD(t,n){return n+"_"+t}function pF(t){for(var n=t.length,e=0,r=0;n>0;)r=Math.random()*n|0,e=t[--n],t[n]=t[r],t[r]=e}function aw(t,n,e){return Math.max(t,Math.min(n,e))}function VD(t){return t%2==0?t:t+1}function gF(t){for(var n=0,e=0;e<t.length;e++)n+=t[e];return n}function M(t,n){if(!t)throw new Error("string"==typeof n?n:n())}function Et(t,n,e){void 0===e&&(e=""),M(Fn(t,n),function(){return e+" Shapes "+t+" and "+n+" must match"})}function $c(t){M(null!=t,function(){return"The input to the tensor constructor must be a non-null value."})}function ms(t,n,e){if(void 0===n&&(n=[]),void 0===e&&(e=!1),null==n&&(n=[]),Array.isArray(t)||Er(t)&&!e)for(var r=0;r<t.length;++r)ms(t[r],n,e);else n.push(t);return n}function _e(t){if(0===t.length)return 1;for(var n=t[0],e=1;e<t.length;e++)n*=t[e];return n}function Fn(t,n){if(t===n)return!0;if(null==t||null==n||t.length!==n.length)return!1;for(var e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}function cn(t){return t%1==0}function vF(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var n=Math.exp(2*t);return(n-1)/(n+1)}function sw(t){var n=Math.ceil(Math.sqrt(t));return[n,Math.ceil(t/n)]}function Gc(t,n){return n<=t.length?t:t+" ".repeat(n-t.length)}function UD(t,n,e){return void 0===n&&(n=function(r){return 0}),new Promise(function(r,o){var i=0,a=function(){if(t())r();else{i++;var s=n(i);null!=e&&i>=e?o():setTimeout(a,s)}};a()})}function mF(t,n){for(var e=1,r=-1,o=0;o<t.length;++o)if(t[o]>=0)e*=t[o];else if(-1===t[o]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(t[o]<0)throw Error("Shapes can not be < 0. Found "+t[o]+" at dim "+o);if(-1===r){if(n>0&&n!==e)throw Error("Size("+n+") must match the product of shape "+t);return t}if(0===e)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(n%e!=0)throw Error("The implicit shape can't be a fractional number. Got "+n+" / "+e);var i=t.slice();return i[r]=n/e,i}function kn(t,n){var e=n.length;return M((t=null==t?n.map(function(r,o){return o}):[].concat(t)).every(function(r){return r>=-e&&r<e}),function(){return"All values in axis param must be in range [-"+e+", "+e+") but got axis "+t}),M(t.every(function(r){return cn(r)}),function(){return"All values in axis param must be integers but got axis "+t}),t.map(function(r){return r<0?e+r:r})}function wu(t,n){for(var e=[],r=[],o=null!=n&&Array.isArray(n)&&0===n.length,i=null==n||o?null:kn(n,t).sort(),a=0,s=0;s<t.length;++s){if(null!=i){if(i[a]===s&&1!==t[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(null==i[a]||i[a]>s)&&1===t[s]&&(e.push(t[s]),r.push(s)),i[a]<=s&&a++}1!==t[s]&&(e.push(t[s]),r.push(s))}return{newShape:e,keptDims:r}}function jf(t,n){var e=null;if(null==t||"float32"===t)e=new Float32Array(n);else if("int32"===t)e=new Int32Array(n);else{if("bool"!==t)throw new Error("Unknown data type "+t);e=new Uint8Array(n)}return e}function Ig(t,n){var e=null;if(null==t||"float32"===t)e=new Float32Array(n);else if("int32"===t)e=new Int32Array(n);else if("bool"===t)e=new Uint8Array(n);else{if("string"!==t)throw new Error("Unknown data type "+t);e=new Array(n)}return e}function yF(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+n+" being uploaded contains "+r+".")}}function wF(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function bF(t,n){return!("complex64"===n||"float32"===n&&"complex64"!==t||"int32"===n&&"float32"!==t&&"complex64"!==t||"bool"===n&&"bool"===t)}function Er(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function WD(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function xF(t){if(null==t)return 0;var n=0;return t.forEach(function(e){return n+=e.length}),n}function bu(t){return"string"==typeof t||t instanceof String}function _F(t){return"boolean"==typeof t}function CF(t){return"number"==typeof t}function zf(t){return Array.isArray(t)?zf(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":CF(t)?"float32":bu(t)?"string":_F(t)?"bool":"float32"}function xu(t){return!!(t&&t.constructor&&t.call&&t.apply)}function uw(t,n){for(var e=n;e<t;++e)if(t%e==0)return e;return t}function zi(t){var n=t.length;if(n<2)return[];var e=new Array(n-1);e[n-2]=t[n-1];for(var r=n-3;r>=0;--r)e[r]=e[r+1]*t[r+1];return e}function HD(t,n,e){if("string"===n)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=ms(t)),e&&yF(t,n),a=n,(i=t)instanceof Float32Array&&"float32"===a||i instanceof Int32Array&&"int32"===a||i instanceof Uint8Array&&"bool"===a)return t;var i,a;if(null==n||"float32"===n||"complex64"===n)return new Float32Array(t);if("int32"===n)return new Int32Array(t);if("bool"===n){for(var r=new Uint8Array(t.length),o=0;o<r.length;++o)0!==Math.round(t[o])&&(r[o]=1);return r}throw new Error("Unknown data type "+n)}function jD(t,n){if(0===t.length)return n[0];var e=t.reduce(function(r,o){return r*o});if(0===e)return[];if(e!==n.length)throw new Error("["+t+"] does not match the input size.");return function r(o,i,a){var s=new Array;if(1===i.length)for(var u=i[0],c=0;c<u;c++)s[c]=a[o+c];else{u=i[0];var f=i.slice(1),d=f.reduce(function(p,g){return p*g});for(c=0;c<u;c++)s[c]=r(o+c*d,f,a)}return s}(0,t,n)}function zD(t,n){for(var e=$f(t,n),r=0;r<e.length;r++)e[r]=1;return e}function $f(t,n){if(null==n||"float32"===n||"complex64"===n)return new Float32Array(t);if("int32"===n)return new Int32Array(t);if("bool"===n)return new Uint8Array(t);throw new Error("Unknown data type "+n)}function $i(){return K().platform.now()}function $D(t){t.forEach(function(n){M(Number.isInteger(n)&&n>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."})})}function DF(t,n){return void 0===n&&(n="utf-8"),n=n||"utf-8",K().platform.encode(t,n)}function Sg(t,n){return void 0===n&&(n="utf-8"),n=n||"utf-8",K().platform.decode(t,n)}function GD(t,n,e){if(0===n)return 0;if(1===n)return t[0];for(var r=t[t.length-1],o=0;o<t.length-1;++o)r+=e[o]*t[o];return r}function EF(t,n,e){if(0===n)return[];if(1===n)return[t];for(var r=new Array(n),o=0;o<r.length-1;++o)r[o]=Math.floor(t/e[o]),t-=r[o]*e[o];return r[r.length-1]=t,r}var MG=Object.freeze({shuffle:pF,clamp:aw,nearestLargerEven:VD,sum:gF,randUniform:function(t,n){var e=Math.random();return n*e+(1-e)*t},distSquared:function(t,n){for(var e=0,r=0;r<t.length;r++){var o=Number(t[r])-Number(n[r]);e+=o*o}return e},assert:M,assertShapesMatch:Et,assertNonNull:$c,flatten:ms,sizeFromShape:_e,isScalarShape:function(t){return 0===t.length},arraysEqual:Fn,isInt:cn,tanh:vF,sizeToSquarishShape:sw,createShuffledIndices:function(t){for(var n=new Uint32Array(t),e=0;e<t;++e)n[e]=e;return pF(n),n},rightPad:Gc,repeatedTry:UD,inferFromImplicitShape:mF,parseAxisParam:kn,squeezeShape:wu,getTypedArrayFromDType:jf,getArrayFromDType:Ig,checkConversionForErrors:yF,isValidDtype:wF,hasEncodingLoss:bF,isTypedArray:Er,bytesPerElement:WD,bytesFromStringArray:xF,isString:bu,isBoolean:_F,isNumber:CF,inferDtype:zf,isFunction:xu,nearestDivisor:uw,computeStrides:zi,toTypedArray:HD,toNestedArray:jD,makeOnesTypedArray:zD,makeZerosTypedArray:$f,now:$i,assertNonNegativeIntegerDimensions:$D,fetch:function(t,n){return K().platform.fetch(t,n)},encodeString:DF,decodeString:Sg,locToIndex:GD,indexToLoc:EF}),NG=function(){function t(n,e){this.backendTimer=n,this.logger=e,null==e&&(this.logger=new FG)}return t.prototype.profileKernel=function(n,e,r){var o,i=this,a=this.backendTimer.time(function(){o=r()});return o.forEach(function(s){s.data().then(function(u){(function(c,f,d){if("float32"!==f)return!1;for(var p=0;p<c.length;p++){var g=c[p];if(isNaN(g)||!isFinite(g))return console.warn("Found "+g+" in the result of '"+d+"'"),!0}})(u,s.dtype,n),a.then(function(c){var f="";null!=c.getExtraProfileInfo&&(f=c.getExtraProfileInfo()),i.logger.logKernelProfile(n,s,u,c.kernelMs,e,f)})})}),o},t}(),FG=function(){function t(){}return t.prototype.logKernelProfile=function(n,e,r,o,i,a){var s="number"==typeof o?Gc(o+"ms",9):o.error,u=Gc(n,25),c=e.rank,f=e.size,d=Gc(e.shape.toString(),14),p="";for(var g in i){var m=i[g].shape||e.shape,y=m.length;p+=g+": "+y+"D "+(y>0?m:"")+" "}console.log("%c"+u+"\t%c"+s+"\t%c"+c+"D "+d+"\t%c"+f+"\t%c"+p+"\t%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}();function Tg(t,n,e){return Gc(Array.isArray(t)?parseFloat(t[0].toFixed(7))+" + "+parseFloat(t[1].toFixed(7))+"j":bu(t)?"'"+t+"'":"bool"===e?SF(t):parseFloat(t.toFixed(7)).toString(),n)}function SF(t){return 0===t?"false":"true"}function Rg(t){for(var n=[],e=0;e<t.length;e+=2)n.push([t[e],t[e+1]]);return n}var Gf=function(){function t(n,e,r){var o=this;if(this.dtype=e,this.shape=n.slice(),this.size=_e(n),null!=r){var i=r.length;M(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+o.size+"'."})}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Ig(e,this.size),this.strides=zi(n)}return t.prototype.set=function(n){for(var e=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];0===r.length&&(r=[0]),M(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+e.rank+")"});var i=this.locToIndex(r);this.values[i]=n},t.prototype.get=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];0===n.length&&(n=[0]);for(var r=0,o=0,i=n;o<i.length;o++){var a=i[o];if(a<0||a>=this.shape[r]){var s="Requested out of range element at "+n+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=n[n.length-1],c=0;c<n.length-1;++c)u+=this.strides[c]*n[c];return this.values[u]},t.prototype.locToIndex=function(n){if(0===this.rank)return 0;if(1===this.rank)return n[0];for(var e=n[n.length-1],r=0;r<n.length-1;++r)e+=this.strides[r]*n[r];return e},t.prototype.indexToLoc=function(n){if(0===this.rank)return[];if(1===this.rank)return[n];for(var e=new Array(this.shape.length),r=0;r<e.length-1;++r)e[r]=Math.floor(n/this.strides[r]),n-=e[r]*this.strides[r];return e[e.length-1]=n,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return Ta().makeTensor(this.values,this.shape,this.dtype)},t}(),Ta=null,q=null,AF=null,Ut=function(){function t(n,e,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=n.slice(),this.dtype=e||"float32",this.size=_e(n),this.strides=zi(n),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),M(1===this.size,function(){return"The array must have only 1 element."}),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(n,e){return this.throwIfDisposed(),this.reshape([n,e])},t.prototype.as3D=function(n,e,r){return this.throwIfDisposed(),this.reshape([n,e,r])},t.prototype.as4D=function(n,e,r,o){return this.throwIfDisposed(),this.reshape([n,e,r,o])},t.prototype.as5D=function(n,e,r,o,i){return this.throwIfDisposed(),this.reshape([n,e,r,o,i])},t.prototype.asType=function(n){return this.throwIfDisposed(),q.cast(this,n)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return be(this,void 0,void 0,function(){var n;return xe(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return n=e.sent(),[2,q.buffer(this.shape,this.dtype,n)]}})})},t.prototype.bufferSync=function(){return q.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return be(this,void 0,void 0,function(){var n;return xe(this,function(e){switch(e.label){case 0:return[4,this.data()];case 1:return n=e.sent(),[2,jD(this.shape,n)]}})})},t.prototype.arraySync=function(){return jD(this.shape,this.dataSync())},t.prototype.data=function(){return be(this,void 0,void 0,function(){var n,e;return xe(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),n=Ta().read(this.dataId),"string"!==this.dtype?[3,2]:[4,n];case 1:e=r.sent();try{return[2,e.map(function(o){return Sg(o)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,n]}})})},t.prototype.dataSync=function(){this.throwIfDisposed();var n=Ta().readSync(this.dataId);if("string"===this.dtype)try{return n.map(function(e){return Sg(e)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return n},t.prototype.bytes=function(){return be(this,void 0,void 0,function(){var n;return xe(this,function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,Ta().read(this.dataId)];case 1:return n=e.sent(),"string"===this.dtype?[2,n]:[2,new Uint8Array(n.buffer)]}})})},t.prototype.dispose=function(){this.isDisposed||(Ta().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(n){return void 0===n&&(n=!1),q.print(this,n)},t.prototype.reshape=function(n){return this.throwIfDisposed(),q.reshape(this,n)},t.prototype.reshapeAs=function(n){return this.throwIfDisposed(),this.reshape(n.shape)},t.prototype.expandDims=function(n){return void 0===n&&(n=0),q.expandDims(this,n)},t.prototype.cumsum=function(n,e,r){return void 0===n&&(n=0),void 0===e&&(e=!1),void 0===r&&(r=!1),q.cumsum(this,n,e,r)},t.prototype.squeeze=function(n){return this.throwIfDisposed(),q.squeeze(this,n)},t.prototype.clone=function(){return this.throwIfDisposed(),q.clone(this)},t.prototype.oneHot=function(n,e,r){return this.throwIfDisposed(),q.oneHot(this,n,e,r)},t.prototype.toString=function(n){return void 0===n&&(n=!1),function kG(t,n,e,r){var o=zi(n),i=function(c,f,d,p){var g=_e(f),m=p[p.length-1],y=new Array(m).fill(0),w=f.length,b="complex64"===d?Rg(c):c;if(w>1)for(var C=0;C<g/m;C++)for(var _=C*m,D=0;D<m;D++)y[D]=Math.max(y[D],Tg(b[_+D],0,d).length);return y}(t,n,e,o),a=n.length,s=function c(f,d,p,g,m,y){void 0===y&&(y=!0);var w="complex64"===p?2:1,b=d[0],C=d.length;if(0===C)return"complex64"===p?[Tg(Rg(f)[0],0,p)]:"bool"===p?[SF(f[0])]:[f[0].toString()];if(1===C){if(b>20){var D=Array.from(f.slice(0,3*w)),E=Array.from(f.slice((b-3)*w,b*w));return"complex64"===p&&(D=Rg(D),E=Rg(E)),["["+D.map(function(Q,re){return Tg(Q,m[re],p)}).join(", ")+", ..., "+E.map(function(Q,re){return Tg(Q,m[b-3+re],p)}).join(", ")+"]"]}return["["+("complex64"===p?Rg(f):Array.from(f)).map(function(Q,re){return Tg(Q,m[re],p)}).join(", ")+"]"]}var A=d.slice(1),P=g.slice(1),k=g[0]*w,N=[];if(b>20){for(var F=0;F<3;F++){var H=(W=F*k)+k;N.push.apply(N,c(f.slice(W,H),A,p,P,m,!1))}for(N.push("..."),F=b-3;F<b;F++)H=(W=F*k)+k,N.push.apply(N,c(f.slice(W,H),A,p,P,m,F===b-1))}else for(F=0;F<b;F++){var W;H=(W=F*k)+k,N.push.apply(N,c(f.slice(W,H),A,p,P,m,F===b-1))}var Z=2===C?",":"";for(N[0]="["+N[0]+Z,F=1;F<N.length-1;F++)N[F]=" "+N[F]+Z;var Y=",\n";for(F=2;F<C;F++)Y+="\n";return N[N.length-1]=" "+N[N.length-1]+"]"+(y?"":Y),N}(t,n,e,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+e),u.push("  rank: "+a),u.push("  shape: ["+n+"]"),u.push("  values:")),u.push(s.map(function(c){return"    "+c}).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,n)},t.prototype.tile=function(n){return this.throwIfDisposed(),q.tile(this,n)},t.prototype.gather=function(n,e){return void 0===e&&(e=0),this.throwIfDisposed(),q.gather(this,n,e)},t.prototype.matMul=function(n,e,r){return void 0===e&&(e=!1),void 0===r&&(r=!1),this.throwIfDisposed(),q.matMul(this,n,e,r)},t.prototype.dot=function(n){return this.throwIfDisposed(),q.dot(this,n)},t.prototype.norm=function(n,e,r){return void 0===n&&(n="euclidean"),void 0===e&&(e=null),void 0===r&&(r=!1),this.throwIfDisposed(),q.norm(this,n,e,r)},t.prototype.slice=function(n,e){return this.throwIfDisposed(),q.slice(this,n,e)},t.prototype.reverse=function(n){return this.throwIfDisposed(),q.reverse(this,n)},t.prototype.concat=function(n,e){return void 0===e&&(e=0),this.throwIfDisposed(),n instanceof t&&(n=[n]),q.concat([this].concat(n),e)},t.prototype.split=function(n,e){return void 0===e&&(e=0),this.throwIfDisposed(),q.split(this,n,e)},t.prototype.stack=function(n,e){return void 0===e&&(e=0),q.stack([this,n],e)},t.prototype.unstack=function(n){return void 0===n&&(n=0),q.unstack(this,n)},t.prototype.pad=function(n,e){return void 0===e&&(e=0),q.pad(this,n,e)},t.prototype.batchNormalization=function(n,e,r,o,i){return void 0===r&&(r=.001),AF("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(n,e,i,o,r)},t.prototype.batchNorm=function(n,e,r,o,i){return void 0===i&&(i=.001),this.throwIfDisposed(),q.batchNorm(this,n,e,r,o,i)},t.prototype.all=function(n,e){return void 0===n&&(n=null),void 0===e&&(e=!1),this.throwIfDisposed(),q.all(this,n,e)},t.prototype.any=function(n,e){return void 0===n&&(n=null),void 0===e&&(e=!1),this.throwIfDisposed(),q.any(this,n,e)},t.prototype.logSumExp=function(n,e){return void 0===n&&(n=null),void 0===e&&(e=!1),this.throwIfDisposed(),q.logSumExp(this,n,e)},t.prototype.sum=function(n,e){return void 0===n&&(n=null),void 0===e&&(e=!1),this.throwIfDisposed(),q.sum(this,n,e)},t.prototype.prod=function(n,e){return void 0===n&&(n=null),void 0===e&&(e=!1),this.throwIfDisposed(),q.prod(this,n,e)},t.prototype.mean=function(n,e){return void 0===n&&(n=null),void 0===e&&(e=!1),this.throwIfDisposed(),q.mean(this,n,e)},t.prototype.min=function(n,e){return void 0===n&&(n=null),void 0===e&&(e=!1),this.throwIfDisposed(),q.min(this,n,e)},t.prototype.max=function(n,e){return void 0===n&&(n=null),void 0===e&&(e=!1),this.throwIfDisposed(),q.max(this,n,e)},t.prototype.argMin=function(n){return void 0===n&&(n=null),this.throwIfDisposed(),q.argMin(this,n)},t.prototype.argMax=function(n){return void 0===n&&(n=null),this.throwIfDisposed(),q.argMax(this,n)},t.prototype.cast=function(n){return this.throwIfDisposed(),q.cast(this,n)},t.prototype.add=function(n){return this.throwIfDisposed(),q.add(this,n)},t.prototype.addStrict=function(n){return this.throwIfDisposed(),q.addStrict(this,n)},t.prototype.atan2=function(n){return this.throwIfDisposed(),q.atan2(this,n)},t.prototype.sub=function(n){return this.throwIfDisposed(),q.sub(this,n)},t.prototype.subStrict=function(n){return this.throwIfDisposed(),q.subStrict(this,n)},t.prototype.pow=function(n){return this.throwIfDisposed(),q.pow(this,n)},t.prototype.powStrict=function(n){return this.throwIfDisposed(),q.powStrict(this,n)},t.prototype.mul=function(n){return this.throwIfDisposed(),q.mul(this,n)},t.prototype.mulStrict=function(n){return this.throwIfDisposed(),q.mulStrict(this,n)},t.prototype.div=function(n){return this.throwIfDisposed(),q.div(this,n)},t.prototype.divNoNan=function(n){return this.throwIfDisposed(),q.divNoNan(this,n)},t.prototype.floorDiv=function(n){return this.throwIfDisposed(),q.floorDiv(this,n)},t.prototype.divStrict=function(n){return this.throwIfDisposed(),q.divStrict(this,n)},t.prototype.minimum=function(n){return this.throwIfDisposed(),q.minimum(this,n)},t.prototype.minimumStrict=function(n){return this.throwIfDisposed(),q.minimumStrict(this,n)},t.prototype.maximum=function(n){return this.throwIfDisposed(),q.maximum(this,n)},t.prototype.maximumStrict=function(n){return this.throwIfDisposed(),q.maximumStrict(this,n)},t.prototype.mod=function(n){return this.throwIfDisposed(),q.mod(this,n)},t.prototype.modStrict=function(n){return this.throwIfDisposed(),q.modStrict(this,n)},t.prototype.squaredDifferenceStrict=function(n){return this.throwIfDisposed(),q.squaredDifferenceStrict(this,n)},t.prototype.transpose=function(n){return this.throwIfDisposed(),q.transpose(this,n)},t.prototype.notEqual=function(n){return this.throwIfDisposed(),q.notEqual(this,n)},t.prototype.notEqualStrict=function(n){return this.throwIfDisposed(),q.notEqualStrict(this,n)},t.prototype.less=function(n){return this.throwIfDisposed(),q.less(this,n)},t.prototype.lessStrict=function(n){return this.throwIfDisposed(),q.lessStrict(this,n)},t.prototype.equal=function(n){return this.throwIfDisposed(),q.equal(this,n)},t.prototype.equalStrict=function(n){return this.throwIfDisposed(),q.equalStrict(this,n)},t.prototype.lessEqual=function(n){return this.throwIfDisposed(),q.lessEqual(this,n)},t.prototype.lessEqualStrict=function(n){return this.throwIfDisposed(),q.lessEqualStrict(this,n)},t.prototype.greater=function(n){return this.throwIfDisposed(),q.greater(this,n)},t.prototype.greaterStrict=function(n){return this.throwIfDisposed(),q.greaterStrict(this,n)},t.prototype.greaterEqual=function(n){return this.throwIfDisposed(),q.greaterEqual(this,n)},t.prototype.greaterEqualStrict=function(n){return this.throwIfDisposed(),q.greaterEqualStrict(this,n)},t.prototype.logicalAnd=function(n){return this.throwIfDisposed(),q.logicalAnd(this,n)},t.prototype.logicalOr=function(n){return this.throwIfDisposed(),q.logicalOr(this,n)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),q.logicalNot(this)},t.prototype.logicalXor=function(n){return this.throwIfDisposed(),q.logicalXor(this,n)},t.prototype.where=function(n,e){return this.throwIfDisposed(),q.where(n,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),q.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),q.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),q.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),q.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),q.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),q.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),q.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),q.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),q.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),q.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),q.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),q.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),q.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),q.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),q.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),q.abs(this)},t.prototype.clipByValue=function(n,e){return this.throwIfDisposed(),q.clipByValue(this,n,e)},t.prototype.relu=function(){return this.throwIfDisposed(),q.relu(this)},t.prototype.relu6=function(){return this.throwIfDisposed(),q.relu6(this)},t.prototype.elu=function(){return this.throwIfDisposed(),q.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),q.selu(this)},t.prototype.leakyRelu=function(n){return void 0===n&&(n=.2),this.throwIfDisposed(),q.leakyRelu(this,n)},t.prototype.prelu=function(n){return this.throwIfDisposed(),q.prelu(this,n)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),q.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),q.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),q.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),q.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),q.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),q.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),q.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),q.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),q.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),q.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),q.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),q.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),q.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),q.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),q.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),q.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),q.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),q.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),q.round(this)},t.prototype.step=function(n){return void 0===n&&(n=0),this.throwIfDisposed(),q.step(this,n)},t.prototype.softmax=function(n){return void 0===n&&(n=-1),this.throwIfDisposed(),q.softmax(this,n)},t.prototype.logSoftmax=function(n){return void 0===n&&(n=-1),this.throwIfDisposed(),q.logSoftmax(this,n)},t.prototype.resizeBilinear=function(n,e){return void 0===e&&(e=!1),this.throwIfDisposed(),q.image.resizeBilinear(this,n,e)},t.prototype.resizeNearestNeighbor=function(n,e){return void 0===e&&(e=!1),this.throwIfDisposed(),q.image.resizeNearestNeighbor(this,n,e)},t.prototype.conv1d=function(n,e,r,o,i,a){return void 0===o&&(o="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),q.conv1d(this,n,e,r,o,i,a)},t.prototype.conv2d=function(n,e,r,o,i,a){return void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),q.conv2d(this,n,e,r,o,i,a)},t.prototype.conv2dTranspose=function(n,e,r,o,i){return this.throwIfDisposed(),q.conv2dTranspose(this,n,e,r,o,i)},t.prototype.depthwiseConv2D=function(n,e,r,o,i,a){return void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),q.depthwiseConv2d(this,n,e,r,o,i,a)},t.prototype.separableConv2d=function(n,e,r,o,i,a){return void 0===i&&(i=[1,1]),void 0===a&&(a="NHWC"),this.throwIfDisposed(),q.separableConv2d(this,n,e,r,o,i,a)},t.prototype.avgPool=function(n,e,r,o){return this.throwIfDisposed(),q.avgPool(this,n,e,r,o)},t.prototype.maxPool=function(n,e,r,o){return this.throwIfDisposed(),q.maxPool(this,n,e,r,o)},t.prototype.localResponseNormalization=function(n,e,r,o){return void 0===n&&(n=5),void 0===e&&(e=1),void 0===r&&(r=1),void 0===o&&(o=.5),q.localResponseNormalization(this,n,e,r,o)},t.prototype.pool=function(n,e,r,o,i){return this.throwIfDisposed(),q.pool(this,n,e,r,o,i)},t.prototype.variable=function(n,e,r){return void 0===n&&(n=!0),this.throwIfDisposed(),Ta().makeVariable(this,n,e,r)},t.prototype.unsortedSegmentSum=function(n,e){return this.throwIfDisposed(),q.unsortedSegmentSum(this,n,e)},t.prototype.batchToSpaceND=function(n,e){return this.throwIfDisposed(),q.batchToSpaceND(this,n,e)},t.prototype.spaceToBatchND=function(n,e){return this.throwIfDisposed(),q.spaceToBatchND(this,n,e)},t.prototype.topk=function(n,e){return void 0===n&&(n=1),void 0===e&&(e=!0),this.throwIfDisposed(),q.topk(this,n,e)},t.prototype.stridedSlice=function(n,e,r,o,i,a,s,u){return void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),this.throwIfDisposed(),q.stridedSlice(this,n,e,r,o,i,a,s,u)},t.prototype.depthToSpace=function(n,e){return this.throwIfDisposed(),q.depthToSpace(this,n,e)},t.prototype.fft=function(){return this.throwIfDisposed(),q.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),q.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),q.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),q.spectral.irfft(this)},t}();Object.defineProperty(Ut,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var KD,XD,YD,QD,ZD,t,qc=function(t){function n(e,r,o,i){var a=t.call(this,e.shape,e.dtype,e.dataId,i)||this;return a.trainable=r,a.name=o,a}return ji(n,t),n.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!Fn(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");Ta().disposeTensor(this),this.dataId=e.dataId,Ta().incRef(this,null)},n.prototype.dispose=function(){Ta().disposeVariable(this),this.isDisposedInternal=!0},n}(Ut);Object.defineProperty(qc,Symbol.hasInstance,{value:function(t){return t instanceof Ut&&null!=t.assign&&t.assign instanceof Function}}),(t=KD||(KD={})).R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6",function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(XD||(XD={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(YD||(YD={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(QD||(QD={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(ZD||(ZD={}));var PG={float32:QD,int32:XD,bool:YD,complex64:ZD};function ir(t,n){if("string"===t||"string"===n){if("string"===t&&"string"===n)return"string";throw new Error("Can not upcast "+t+" with "+n)}return PG[t][n]}function cw(t){return ir(t,"int32")}function tn(t,n){if(t.dtype===n.dtype)return[t,n];var e=ir(t.dtype,n.dtype);return[t.cast(e),n.cast(e)]}function TF(t,n){M(t.dtype===n.dtype,function(){return"The dtypes of the first("+t.dtype+") and second("+n.dtype+") input must match"})}function JD(t){var n=[];return function e(r,o,i){if(null!=r){if(r instanceof Ut)return void o.push(r);if(a=r,Array.isArray(a)||"object"==typeof a){var a,s=r;for(var u in s){var c=s[u];i.has(c)||(i.add(c),e(c,o,i))}}}}(t,n,new Set),n}var eE,OG=Object.freeze({makeTypesMatch:tn,assertTypesMatch:TF,isTensorInList:function(t,n){return n.some(function(e){return e.id===t.id})},getTensorsInContainer:JD}),RF=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var n in this.registeredVariables)this.registeredVariables[n].dispose()},t}(),LG=function(){function t(n){this.ENV=n,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new RF}return t.prototype.ready=function(){return be(this,void 0,void 0,function(){var n,e,r;return xe(this,function(o){switch(o.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then(function(){})];if(null!=this.backendInstance)return[2];n=this.getSortedBackends(),e=0,o.label=1;case 1:return e<n.length?[4,this.initializeBackend(r=n[e]).success]:[3,5];case 2:return o.sent()?[4,this.setBackend(r)]:[3,4];case 3:return o.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var n=this.initializeBackendsAndReturnBest(),e=n.name;if(n.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(n){return n in this.registry||n in this.registryFactory&&!this.initializeBackend(n).asyncInit?this.registry[n]:null},t.prototype.findBackendFactory=function(n){return n in this.registryFactory?this.registryFactory[n].factory:null},t.prototype.registerBackend=function(n,e,r){return void 0===r&&(r=1),n in this.registryFactory?(console.warn(n+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[n]={factory:e,priority:r},!0)},t.prototype.setBackend=function(n){return be(this,void 0,void 0,function(){var e,r,o;return xe(this,function(i){switch(i.label){case 0:if(null==this.registryFactory[n])throw new Error("Backend name '"+n+"' not found in registry");return this.backendName=n,null!=this.registry[n]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(n),r=e.success,e.asyncInit?[4,r]:[3,2]);case 1:return o=i.sent(),[3,3];case 2:o=r,i.label=3;case 3:if(!o)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[n],this.setupRegisteredKernels(),this.profiler=new NG(this.backendInstance),[2,!0]}})})},t.prototype.setupRegisteredKernels=function(){var n=this;OD(this.backendName).forEach(function(e){null!=e.setupFunc&&e.setupFunc(n.backendInstance)})},t.prototype.disposeRegisteredKernels=function(n){var e=this;OD(n).forEach(function(r){null!=r.disposeFunc&&r.disposeFunc(e.registry[n])})},t.prototype.initializeBackend=function(n){var e=this,r=this.registryFactory[n];if(null==r)throw new Error("Cannot initialize backend "+n+", no registration found.");try{var o=r.factory();if(Promise.resolve(o)===o){var i=++this.pendingBackendInitId,a=o.then(function(s){return!(i<e.pendingBackendInitId||(e.registry[n]=s,e.pendingBackendInit=null,0))}).catch(function(s){return!(i<e.pendingBackendInitId||(e.pendingBackendInit=null,console.warn("Initialization of backend "+n+" failed"),console.warn(s.stack||s.message),1))});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[n]=o,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+n+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(n){if(!(n in this.registryFactory))throw new Error(n+" backend not found in registry");this.backendName===n&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,n in this.registry&&(this.disposeRegisteredKernels(n),this.registry[n].dispose(),delete this.registry[n]),delete this.registryFactory[n],this.backendName===n&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var n=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(e,r){return n.registryFactory[r].priority-n.registryFactory[e].priority})},t.prototype.initializeBackendsAndReturnBest=function(){for(var n=this.getSortedBackends(),e=0;e<n.length;e++){var r=n[e],o=this.initializeBackend(r),a=o.asyncInit;if(a||o.success)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(n,e){var r=this.state.tensorInfo.get(e),o=r.backend,i=this.readSync(e);o.disposeData(e),r.backend=n,n.move(e,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(n,e){var r,o=this,i=null;if(null==e){if("function"!=typeof n)throw new Error("Please provide a function to tidy()");e=n}else{if("string"!=typeof n&&!(n instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=n}return this.scopedRun(function(){return o.startScope(i)},function(){return o.endScope(r)},function(){return(r=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},t.prototype.scopedRun=function(n,e,r){n();try{var o=r();return e(),o}catch(i){throw e(),i}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(n){var e=this.makeTensorFromDataId(n.dataId,n.shape,n.dtype);return this.addTapeNode(this.state.activeScope.name,{x:n},[e],function(o){return{x:function(){return o.toFloat()}}},[]),e},t.prototype.runKernel=function(n,e,r,o,i){return this.runKernelFunc(null,e,null,n,r,o,i)},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(n,e,r){var o=this.backend.numDataIds(),i=0;r.forEach(function(u){i+="complex64"===u.dtype?3:1});var s=o-e-i-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+n+"'")},t.prototype.runKernelFunc=function(n,e,r,o,i,a,s){var u,c=this;void 0===a&&(a=[]),void 0===s&&(s=[]);var f=[],d=this.isTapeOn();null==o&&(o=null!=this.state.activeScope?this.state.activeScope.name:"");var p,g=function(C){d&&(f=C.map(function(_){return c.keep(c.clone(_))}))},m=this.state.numBytes,y=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var w,b=PD(o,this.backendName);return p=null!=b?function(){var C=c.backend.numDataIds();w=b.kernelFunc({inputs:e,attrs:i,backend:c.backend});var _=Array.isArray(w)?w:[w];c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(o,C,_);var D=_.map(function(A){return c.makeTensorFromDataId(A.dataId,A.shape,A.dtype)}),E=D.filter(function(A,P){return s[P]});return g((a||[]).slice().concat(E)),D}:function(){var C=c.backend.numDataIds();w=c.tidy(function(){return n(c.backend,g)});var _=Array.isArray(w)?w:[w];return c.shouldCheckForMemLeaks()&&c.checkKernelForMemLeak(o,C,_),_},this.scopedRun(function(){return c.state.kernelDepth++},function(){return c.state.kernelDepth--},function(){u=c.ENV.getBool("DEBUG")?c.profiler.profileKernel(o,e,function(){return p()}):p()}),d&&this.addTapeNode(o,e,u,r,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:o,bytesAdded:this.state.numBytes-m,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-y,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(function(C){return e[C].shape}),outputShapes:u.map(function(C){return C.shape})}),Array.isArray(w)?u:u[0]},t.prototype.makeTensor=function(n,e,r,o){if(null==n)throw new Error("Values passed to engine.makeTensor() are null");o=o||this.backend;var i=n;"string"===(r=r||"float32")&&bu(n[0])&&(i=n.map(function(f){return DF(f)}));var a=o.write(i,e,r),s=new Ut(e,r,a,this.nextTensorId());if(this.incRef(s,o),"string"===r){var u=this.state.tensorInfo.get(a),c=xF(i);this.state.numBytes+=c-u.bytes,u.bytes=c}return s},t.prototype.makeTensorFromDataId=function(n,e,r,o){var i=new Ut(e,r=r||"float32",n,this.nextTensorId());return this.incRef(i,o),i},t.prototype.makeVariable=function(n,e,r,o){void 0===e&&(e=!0),r=r||this.nextVariableId().toString(),null!=o&&o!==n.dtype&&(n=n.asType(o));var i=new qc(n,e,r,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},t.prototype.incRef=function(n,e){var r=this.state.tensorInfo.has(n.dataId)?this.state.tensorInfo.get(n.dataId).refCount:0;if(this.state.numTensors++,"string"===n.dtype&&this.state.numStringTensors++,0===r){this.state.numDataBuffers++;var o=0;"complex64"!==n.dtype&&"string"!==n.dtype&&(o=n.size*WD(n.dtype)),this.state.tensorInfo.set(n.dataId,{backend:e||this.backend,dtype:n.dtype,shape:n.shape,bytes:o,refCount:0}),this.state.numBytes+=o}this.state.tensorInfo.get(n.dataId).refCount++,n instanceof qc||this.track(n)},t.prototype.disposeTensor=function(n){if(this.state.tensorInfo.has(n.dataId)){this.state.numTensors--,"string"===n.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(n.dataId);e.refCount<=1?("complex64"!==n.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(n.dataId),this.state.tensorInfo.delete(n.dataId)):this.state.tensorInfo.get(n.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var n in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[n])},t.prototype.disposeVariable=function(n){this.disposeTensor(n),null!=this.state.registeredVariables[n.name]&&delete this.state.registeredVariables[n.name]},t.prototype.memory=function(){var n=this.backend.memory();return n.numTensors=this.state.numTensors,n.numDataBuffers=this.state.numDataBuffers,n.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(n.unreliable=!0,null==n.reasons&&(n.reasons=[]),n.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),n},t.prototype.profile=function(n){return be(this,void 0,void 0,function(){var e,r;return xe(this,function(o){return this.state.profiling=!0,e=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=n(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(n,e,r,o,i){var a=this,s={id:this.state.nextTapeNodeId++,kernelName:n,inputs:e,outputs:r,saved:i},u=dF(n);null!=u&&(o=u.gradFunc),null!=o&&(s.gradient=function(c){return c=c.map(function(f,d){if(null==f){var p=r[d],g=$f(p.size,p.dtype);return a.makeTensor(g,p.shape,p.dtype)}return f}),o(c.length>1?c:c[0],i)}),this.state.activeTape.push(s)},t.prototype.keep=function(n){return n.kept=!0,n},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(n){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};n&&(e.name=n),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(n){for(var e=this,r=JD(n),o=new Set(r.map(function(u){return u.id})),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||o.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||e.track(u)})},t.prototype.gradients=function(n,e,r,o){var i=this;if(void 0===o&&(o=!1),M(e.length>0,function(){return"gradients() received an empty list of xs."}),null!=r&&"float32"!==r.dtype)throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",n)});M(a instanceof Ut,function(){return"The result y returned by f() must be a tensor."});var s=function(u,c,f){for(var d={},p={},g=0;g<c.length;g++)d[c[g].id]=!0;for(g=0;g<u.length;g++){var m=(A=u[g]).inputs;for(var y in m){for(var w=m[y],b=!1,C=0;C<c.length;C++)if(d[w.id]){A.outputs.forEach(function(F){return d[F.id]=!0}),b=!0,p[A.id]=!0;break}if(b)break}}var _={};_[f.id]=!0;var D={};for(g=u.length-1;g>=0;g--)for(m=(A=u[g]).inputs,C=0;C<A.outputs.length;C++)if(_[A.outputs[C].id]){for(var y in m)_[m[y].id]=!0,D[A.id]=!0;break}var E=[];for(g=0;g<u.length;g++){var A;if(p[(A=u[g]).id]&&D[A.id]){var P={};for(var y in A.inputs){var k=A.inputs[y];d[k.id]&&(P[y]=k)}var N=Object.assign({},A);N.inputs=P,N.outputs=A.outputs,E.push(N)}}return E}(this.state.activeTape,e,a);if(!o&&0===s.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,c,f={};f[a.id]=r??(c=zD(_e(u=a.shape),"float32"),B.makeTensor(c,u,"float32")),function(p,g,m){for(var y=function(b){var C=g[b],_=[];if(C.outputs.forEach(function(P){var k=p[P.id];_.push(null!=k?k:null)}),null==C.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+C.kernelName+".");var D=C.gradient(_),E=function(P){if(!(P in D))throw new Error("Cannot backprop through input "+P+". Available gradients found: "+Object.keys(D)+".");var k=i.tidy(function(){return D[P]()});if("float32"!==k.dtype)throw new Error("Error in gradient for op "+C.kernelName+". The gradient of input "+P+" must have 'float32' dtype, but has '"+k.dtype+"'");var N=C.inputs[P];if(!Fn(k.shape,N.shape))throw new Error("Error in gradient for op "+C.kernelName+". The gradient of input '"+P+"' has shape '"+k.shape+"', which does not match the shape of the input '"+N.shape+"'");if(null==p[N.id])p[N.id]=k;else{var F=p[N.id];p[N.id]=F.add(k),F.dispose()}};for(var A in C.inputs)E(A)},w=g.length-1;w>=0;w--)y(w)}(f,s);var d=e.map(function(p){return f[p.id]});return 0===i.state.gradientDepth&&(i.state.activeTape.forEach(function(p){for(var g=0,m=p.saved;g<m.length;g++)m[g].dispose()}),i.state.activeTape=null),{value:a,grads:d}})},t.prototype.customGrad=function(n){var e=this;return M(xu(n),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];M(o.every(function(s){return s instanceof Ut}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return o.forEach(function(s,u){a[u]=s}),e.runKernelFunc(function(s,u){return M((r=n.apply(void 0,o.concat([u]))).value instanceof Ut,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),M(xu(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,u){var c=r.gradFunc(s,u),f=Array.isArray(c)?c:[c];M(f.length===o.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),M(f.every(function(p){return p instanceof Ut}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var d={};return f.forEach(function(p,g){d[g]=function(){return p}}),d})}},t.prototype.readSync=function(n){return this.state.tensorInfo.get(n).backend.readSync(n)},t.prototype.read=function(n){return this.state.tensorInfo.get(n).backend.read(n)},t.prototype.time=function(n){return be(this,void 0,void 0,function(){var e,r;return xe(this,function(o){switch(o.label){case 0:return e=$i(),[4,this.backend.time(n)];case 1:return(r=o.sent()).wallMs=$i()-e,[2,r]}})})},t.prototype.track=function(n){return null!=this.state.activeScope&&(n.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(n)),n},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var n in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new RF,this.registry)this.disposeRegisteredKernels(n),this.registry[n].dispose(),delete this.registry[n];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),B=function(){var t=function(){if(null==eE){var e=void 0;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else{if(typeof self>"u")throw new Error("Could not find a global object");e=self}eE=e}return eE}();if(null==t._tfengine){var n=new fF(t);t._tfengine=new LG(n)}return kD=t._tfengine.ENV,Ta=function(){return t._tfengine},t._tfengine}();function MF(){return typeof window<"u"&&null!=window.document||typeof WorkerGlobalScope<"u"}var ys=K();ys.registerFlag("DEBUG",function(){return!1},function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),ys.registerFlag("IS_BROWSER",function(){return MF()}),ys.registerFlag("IS_NODE",function(){return typeof process<"u"&&void 0!==process.versions&&void 0!==process.versions.node}),ys.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),ys.registerFlag("PROD",function(){return!1}),ys.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return ys.getBool("DEBUG")}),ys.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),ys.registerFlag("IS_TEST",function(){return!1});var Mg,Po,Oo,Kc={},tE={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function NF(t,n){Kc[t]=n}function Ra(t){t in Kc||(Kc[t]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(o){if(typeof OffscreenCanvas<"u"&&2===o)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return r.addEventListener("webglcontextlost",function(o){o.preventDefault(),delete Kc[e]},!1),1===e?r.getContext("webgl",tE)||r.getContext("experimental-webgl",tE):r.getContext("webgl2",tE)}(t));var n=Kc[t];return n.isContextLost()?(delete Kc[t],Ra(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Kc[t])}function lw(t,n){return[n,t]}function Ng(t){var n=_e(t);return sw(Math.ceil(n/4))}function Fg(t,n){return[Math.max(1,Math.ceil(n/2)),Math.max(1,Math.ceil(t/2))]}function nE(t,n){var e,r,o,i,a,s,u,c,f,d=t;return 2===K().getNumber("WEBGL_VERSION")?(e=d.R32F,r=d.R16F,o=d.RGBA16F,i=d.RGBA32F,a=d.RED,s=4,u=1,c=d.HALF_FLOAT,f=d.FLOAT):(e=t.RGBA,r=t.RGBA,o=t.RGBA,i=d.RGBA,a=t.RGBA,s=4,u=4,c=null!=n?n.HALF_FLOAT_OES:null,f=t.FLOAT),{internalFormatFloat:e,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:f}}function me(t,n,e){var r=e();return n&&function(o){var i=o.getError();if(i!==o.NO_ERROR)throw new Error("WebGL Error: "+kF(o,i))}(t),r}function FF(t){return!!(K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function kF(t,n){switch(n){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+n}}function kg(t,n,e){return ws(t,n,function(){return t.getExtension(e)},'Extension "'+e+'" not supported on this browser.')}function PF(t,n,e){var r=ws(t,n,function(){return t.createShader(t.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(me(t,n,function(){return t.shaderSource(r,e)}),me(t,n,function(){return t.compileShader(r)}),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function OF(t,n,e){var r=ws(t,n,function(){return t.createShader(t.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(me(t,n,function(){return t.shaderSource(r,e)}),me(t,n,function(){return t.compileShader(r)}),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw function(o,i){var a=UG.exec(i);if(null==a)return console.log("Couldn't parse line number in error: "+i),void console.log(o);for(var s=+a[1],u=o.split("\n"),c=u.length.toString().length+2,f=u.map(function(w,b){return Gc((b+1).toString(),c)+w}),d=0,p=0;p<f.length;p++)d=Math.max(f[p].length,d);var g=f.slice(0,s-1),m=f.slice(s-1,s),y=f.slice(s);console.log(g.join("\n")),console.log(i.split("\n")[0]),console.log("%c "+Gc(m[0],d),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(y.join("\n"))}(e,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Mg||(Mg={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(Po||(Po={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Oo||(Oo={}));var fw,dw,UG=/ERROR: [0-9]+:([0-9]+):/g;function LF(t,n){return ws(t,n,function(){return t.createProgram()},"Unable to create WebGLProgram.")}function BF(t,n,e){if(me(t,n,function(){return t.linkProgram(e)}),!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function hw(t,n,e){if(me(t,n,function(){return t.validateProgram(e)}),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function VF(t,n,e){var r=ws(t,n,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return me(t,n,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),me(t,n,function(){return t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)}),r}function UF(t,n,e){var r=ws(t,n,function(){return t.createBuffer()},"Unable to create WebGLBuffer");return me(t,n,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)}),me(t,n,function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)}),r}function WF(t,n){return ws(t,n,function(){return t.createTexture()},"Unable to create WebGLTexture.")}function HF(t,n){var e=K().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||n<=0){var r="["+t+"x"+n+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>e||n>e)throw r="["+t+"x"+n+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+e+"x"+e+"].")}function jF(t,n){return ws(t,n,function(){return t.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function rE(t,n,e,r,o,i,a,s){var u=t.getAttribLocation(e,r);return-1!==u&&(me(t,n,function(){return t.bindBuffer(t.ARRAY_BUFFER,o)}),me(t,n,function(){return t.vertexAttribPointer(u,i,t.FLOAT,!1,a,s)}),me(t,n,function(){return t.enableVertexAttribArray(u)}),!0)}function zF(t,n,e,r){XF(t,r),me(t,n,function(){return t.activeTexture(t.TEXTURE0+r)}),me(t,n,function(){return t.bindTexture(t.TEXTURE_2D,e)})}function $F(t,n,e,r){return ws(t,n,function(){return t.getUniformLocation(e,r)},'uniform "'+r+'" not present in program.')}function GF(t,n,e){return t.getUniformLocation(n,e)}function qF(t,n,e,r,o,i){me(t,n,function(){return zF(t,n,r,i)}),me(t,n,function(){return t.uniform1i(o,i)})}function pw(t,n,e,r){me(t,n,function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)}),me(t,n,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)})}function oE(t,n,e){me(t,n,function(){return t.bindFramebuffer(t.FRAMEBUFFER,e)}),me(t,n,function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)})}function Pg(t){var n=t.checkFramebufferStatus(t.FRAMEBUFFER);if(n!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+KF(t,n))}function KF(t,n){switch(n){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+n}}function ws(t,n,e,r){var o=me(t,n,function(){return e()});if(null==o)throw new Error(r);return o}function XF(t,n){var e=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=n+t.TEXTURE0;if(r<t.TEXTURE0||r>e)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+e+"].")}function Og(t,n){return void 0===n&&(n=2),_e(t.slice(0,t.length-n))}function Lg(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function gw(t){var n=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(n=[Og(t)].concat(Lg(t))),n}function YF(t,n){var e;void 0===n&&(n=!1);var r=K().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n&&(r*=2,1===(t=t.map(function(c,f){return f>=t.length-2?VD(t[f]):t[f]})).length&&(t=[2,t[0]])),2!==t.length){var o=wu(t);t=o.newShape}var i=_e(t);if(t.length<=1&&i<=r)return[1,i];if(2===t.length&&t[0]<=r&&t[1]<=r)return t;if(3===t.length&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(n){var a=Og(t),s=2,u=2;return t.length&&(s=(e=Lg(t))[0],u=e[1]),sw(i=a*(s/2)*(u/2)).map(function(c){return 2*c})}return sw(i)}function vw(t){return t%2==0}function Bg(t,n){if(Fn(t=t.slice(-2),n=n.slice(-2))||!t.length||!n.length||0===t[0]||0===t[1]||0===n[0]||0===n[1])return!0;if(t.length!==n.length){var e=t.slice(-1)[0],r=n.slice(-1)[0];if(e===r||vw(e)&&vw(r)&&(1===t[0]||1===n[0]))return!0}return t[1]===n[1]&&vw(t[0])&&vw(n[0])}function QF(t){if(null==fw){var n=Ra(t);fw=n.getParameter(n.MAX_TEXTURE_SIZE)}return fw}function ZF(t){if(null==dw){var n=Ra(t);dw=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,dw)}function JF(t){if(0===t)return 0;var n=Ra(t);return Lo(n,"EXT_disjoint_timer_query_webgl2")&&2===t?2:Lo(n,"EXT_disjoint_timer_query")?1:0}function Lo(t,n){return null!=t.getExtension(n)}function iE(t){try{if(null!=Ra(t))return!0}catch{return!1}return!1}function ek(t){if(0===t)return!1;var n=Ra(t);if(1===t){if(!Lo(n,"OES_texture_float"))return!1}else if(!Lo(n,"EXT_color_buffer_float"))return!1;return aE(n)}function tk(t){if(0===t)return!1;var n=Ra(t);if(1!==t){if(Lo(n,"EXT_color_buffer_float"))return aE(n);if(Lo(n,"EXT_color_buffer_half_float")){var e=n.getExtension("EXT_color_buffer_half_float");return function(r,o){var i=nE(r,o),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),u}(n,e)}return!1}return!!Lo(n,"OES_texture_float")&&!!Lo(n,"WEBGL_color_buffer_float")&&aE(n)}function aE(t){var n=nE(t),e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatFloat,1,1,0,n.textureFormatFloat,n.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);var o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(e),t.deleteFramebuffer(r),o}function nk(t){return 2===t&&null!=Ra(t).fenceSync}var WG=Object.freeze({callAndCheck:me,canBeRepresented:FF,getWebGLErrorMessage:kF,getExtensionOrThrow:kg,createVertexShader:PF,createFragmentShader:OF,createProgram:LF,linkProgram:BF,validateProgram:hw,createStaticVertexBuffer:VF,createStaticIndexBuffer:UF,getNumChannels:function(){return 2===K().getNumber("WEBGL_VERSION")?1:4},createTexture:WF,validateTextureSize:HF,createFramebuffer:jF,bindVertexBufferToProgramAttribute:rE,bindTextureUnit:zF,unbindTextureUnit:function(t,n,e){XF(t,e),me(t,n,function(){return t.activeTexture(t.TEXTURE0+e)}),me(t,n,function(){return t.bindTexture(t.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:$F,getProgramUniformLocation:GF,bindTextureToProgramUniformSampler:qF,bindCanvasToFramebuffer:function(t,n){me(t,n,function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)}),me(t,n,function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)}),me(t,n,function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)})},bindColorTextureToFramebuffer:pw,unbindColorTextureFromFramebuffer:oE,validateFramebuffer:Pg,getFramebufferErrorMessage:KF,getBatchDim:Og,getRowsCols:Lg,getShapeAs3D:gw,getTextureShapeFromLogicalShape:YF,isReshapeFree:Bg,getWebGLMaxTextureSize:QF,resetMaxTextureSize:function(){fw=null},resetMaxTexturesInShader:function(){dw=null},getMaxTexturesInShader:ZF,getWebGLDisjointQueryTimerVersion:JF,hasExtension:Lo,isWebGLVersionEnabled:iE,isCapableOfRenderingToFloatTexture:ek,isDownloadFloatTextureEnabled:tk,isWebGLFenceEnabled:nk}),We=K();function HG(){K().set("PROD",!0)}function jG(){K().set("DEBUG",!0)}function zG(){K().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function sE(t){K().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function $G(){B.disposeVariables()}function GG(){return B}function qG(){return B.memory()}function KG(t){return B.profile(t)}function ge(t,n){return B.tidy(t,n)}function to(t){JD(t).forEach(function(n){return n.dispose()})}function rk(t){return B.keep(t)}function XG(t){return B.time(t)}function YG(t){return B.setBackend(t)}function QG(){return B.ready()}function ZG(){return B.backendName}function JG(t){B.removeBackend(t)}function e5(t){return B.findBackend(t)}function t5(t){return B.findBackendFactory(t)}function n5(t,n,e){return void 0===e&&(e=1),B.registerBackend(t,n,e)}function r5(){return B.backend}function o5(t,n){K().setPlatform(t,n)}function mw(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];K().getBool("IS_TEST")||console.warn.apply(console,t)}function Ma(t,n){var e=t;if(Er(t))return"string"===n?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(e)||Er(e)&&"string"!==n;)r.push(e.length),e=e[0];return Array.isArray(t)&&K().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function o(i,a,s){if(s=s||[],Array.isArray(i)||Er(i)){M(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),M(i.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+i.length+" elements"});for(var u=a.slice(1),c=0;c<i.length;++c)o(i[c],u,s.concat(c))}else M(0===a.length,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"})}(t,r,[]),r}function ok(t,n,e,r){if(null!=t&&("numeric"!==t&&t!==n||"numeric"===t&&"string"===n))throw new Error("Argument '"+e+"' passed to '"+r+"' must be "+t+" tensor, but got "+n+" tensor")}function R(t,n,e,r){if(void 0===r&&(r="numeric"),t instanceof Ut)return ok(r,t.dtype,n,e),t;var o=zf(t);if("string"!==o&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),ok(r,o,n,e),null==t||!Er(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("Argument '"+n+"' passed to '"+e+"' must be a Tensor or TensorLike, but got '"+(null==t?"null":t.constructor.name)+"'");var a=Ma(t,o);Er(t)||Array.isArray(t)||(t=[t]);var s="string"!==o?HD(t,o,K().getBool("DEBUG")):ms(t,[],!0);return B.makeTensor(s,a,o)}function Vg(t,n,e,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+n+" passed to "+e+" must be a `Tensor[]` or `TensorLike[]`");return t.map(function(o,i){return R(o,n+"["+i+"]",e)},r)}function uE(t,n){for(var e=0;e<t.length;++e)if(t[t.length-e-1]!==n-1-e)return!1;return!0}function ik(t,n,e){for(var r=t.length+n.length,o=[],i=0,a=0,s=0;s<r;s++)-1===e.indexOf(s)?o.push(t[i++]):o.push(n[a++]);return o}function Ir(t,n){for(var e=[],r=t.length,o=0;o<r;o++)-1===n.indexOf(o)&&e.push(t[o]);return[e,n.map(function(i){return t[i]})]}function no(t,n){return ik(t,n.map(function(e){return 1}),n)}function _o(t,n,e){M(uE(n,e),function(){return t+" supports only inner-most axes for now. Got axes "+n+" and rank-"+e+" input."})}function Gi(t,n){if(uE(t,n))return null;for(var e=[],r=0;r<n;++r)-1===t.indexOf(r)&&e.push(r);return t.forEach(function(o){return e.push(o)}),e}function yw(t){return t.map(function(n,e){return[e,n]}).sort(function(n,e){return n[1]-e[1]}).map(function(n){return n[0]})}function qi(t,n){for(var e=[],r=n-t;r<n;++r)e.push(r);return e}function ak(t,n){var e=t[0].length;t.forEach(function(o,i){M(o.length===e,function(){return"Error in concat"+e+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+e+")"})}),M(n>=0&&n<e,function(){return"Error in concat"+e+"D: axis must be between 0 and "+(e-1)+"."});var r=t[0];t.forEach(function(o,i){for(var a=0;a<e;a++)M(a===n||o[a]===r[a],function(){return"Error in concat"+e+"D: Shape of tensors["+i+"] ("+o+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function Xc(t,n){for(var e=t[0].slice(),r=1;r<t.length;r++)e[n]+=t[r][n];return e}function V(t){var n=Object.keys(t);if(1!==n.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+n.length+" keys.");var e=n[0],r=t[e];e.endsWith("_")&&(e=e.substring(0,e.length-1));var o=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];B.startScope(e);try{var s=r.apply(void 0,i);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),B.endScope(s),s}catch(u){throw B.endScope(null),u}};return Object.defineProperty(o,"name",{value:e,configurable:!0}),o}We.registerFlag("HAS_WEBGL",function(){return We.getNumber("WEBGL_VERSION")>0}),We.registerFlag("WEBGL_VERSION",function(){return iE(2)?2:iE(1)?1:0}),We.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return 2===We.get("WEBGL_VERSION")}),We.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),We.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),We.registerFlag("WEBGL_PACK",function(){return We.getBool("HAS_WEBGL")}),We.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_PACK_CLIP",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),We.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_PACK_REDUCE",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_LAZILY_UNPACK",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_CONV_IM2COL",function(){return We.getBool("WEBGL_PACK")}),We.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return QF(We.getNumber("WEBGL_VERSION"))}),We.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return ZF(We.getNumber("WEBGL_VERSION"))}),We.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var t=We.getNumber("WEBGL_VERSION");return 0===t?0:JF(t)}),We.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return We.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t}),We.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return ek(We.getNumber("WEBGL_VERSION"))}),We.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!We.getBool("WEBGL_FORCE_F16_TEXTURES")&&We.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),We.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return tk(We.getNumber("WEBGL_VERSION"))}),We.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return nk(We.getNumber("WEBGL_VERSION"))}),We.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return We.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),AF=sE;var ar=V({complex_:function(t,n){var e=R(t,"real","complex"),r=R(n,"imag","complex");return Et(e.shape,r.shape,"real and imag shapes, "+e.shape+" and "+r.shape+", must match in call to tf.complex()."),B.runKernelFunc(function(o){return o.complex(e,r)},{$real:e,$imag:r})}}),Bo=V({real_:function(t){var n=R(t,"input","real");return B.runKernelFunc(function(e){return e.real(n)},{$input:n})}}),Ki=V({imag_:function(t){var n=R(t,"input","imag");return B.runKernelFunc(function(e){return e.imag(n)},{$input:n})}});function sr(t,n,e){return _u(t,n,Ma(t,e),e)}function _u(t,n,e,r){if(null==r&&(r=zf(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Er(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=n){$D(n);var o=_e(n),i=_e(e);M(o===i,function(){return"Based on the provided shape, ["+n+"], the tensor should have "+o+" values but has "+i});for(var a=0;a<e.length;++a){var u=a!==e.length-1||e[a]!==_e(n.slice(a));M(e[a]===n[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+e+") does not match the provided shape ("+n+"). "})}}return Er(t)||Array.isArray(t)||(t=[t]),n=n||e,t="string"!==r?HD(t,r,K().getBool("DEBUG")):ms(t,[],!0),B.makeTensor(t,n,r)}function le(t,n){if((Er(t)&&"string"!==n||Array.isArray(t))&&"complex64"!==n)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===n&&Er(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return _u(t,[],[],n)}function Dn(t,n){$c(t);var e=Ma(t,n);if(1!==e.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return _u(t,null,e,n)}function bs(t,n,e){if($c(t),null!=n&&2!==n.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Ma(t,e);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==n)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return _u(t,n,r,e)}function ww(t,n,e){if($c(t),null!=n&&3!==n.length)throw new Error("tensor3d() requires shape to have three numbers");var r=Ma(t,e);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==n)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return _u(t,n,r,e)}function ro(t,n,e){if($c(t),null!=n&&4!==n.length)throw new Error("tensor4d() requires shape to have four numbers");var r=Ma(t,e);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==n)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return _u(t,n,r,e)}function sk(t,n,e){if($c(t),null!=n&&5!==n.length)throw new Error("tensor5d() requires shape to have five numbers");var r=Ma(t,e);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==n)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return _u(t,n,r,e)}function uk(t,n,e){if($c(t),null!=n&&6!==n.length)throw new Error("tensor6d() requires shape to have six numbers");var r=Ma(t,e);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==n)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return _u(t,n=n||r,r,e)}function ck(t,n,e,r){return void 0===n&&(n=!0),B.makeVariable(t,n,e,r)}function Yc(t,n){if(void 0===n&&(n="float32"),"complex64"===n){var e=Yc(t,"float32"),r=qt(t,"float32");return ar(e,r)}var o=zD(_e(t),n);return B.makeTensor(o,t,n)}function qt(t,n){if(void 0===n&&(n="float32"),"complex64"===n){var e=qt(t,"float32"),r=qt(t,"float32");return ar(e,r)}var o=$f(_e(t),n);return B.makeTensor(o,t,n)}function Xi(t,n,e){return B.runKernelFunc(function(r){return r.fill(t,n,e)},{})}function lk(t,n,e){if(e<=0)throw new Error("The number of values should be positive.");return B.runKernelFunc(function(r){return r.linspace(t,n,e)},{})}function Ug(t,n,e,r){if(void 0===e&&(e=1),void 0===r&&(r="float32"),0===e)throw new Error("Cannot have a step of zero");if(t===n||t<n&&e<0||n<t&&e>1)return qt([0],r);var o=$f(Math.abs(Math.ceil((n-t)/e)),r);n<t&&1===e&&(e=-1),o[0]=t;for(var i=1;i<o.length;i++)o[i]=o[i-1]+e;return Dn(o,r)}var cE=V({onesLike_:function(t){var n=R(t,"x","onesLike");if("complex64"===n.dtype){var e=cE(Bo(n)),r=vt(Ki(n));return ar(e,r)}return B.runKernelFunc(function(o){return o.onesLike(n)},{$x:n},function(o,i){return{$x:function(){return vt(o)}}})}}),vt=V({zerosLike_:function(t){var n=R(t,"x","zerosLike");return B.runKernelFunc(function(e){return e.zerosLike(n)},{$x:n},function(e,r){return{$x:function(){return vt(e)}}})}}),Pn=V({concat_:function(t,n){void 0===n&&(n=0),M(t.length>=1,function(){return"Pass at least one tensor to concat"});var e=Vg(t,"tensors","concat");"complex64"===e[0].dtype&&e.forEach(function(s){if("complex64"!==s.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+s.dtype+". ")}),n=kn(n,e[0].shape)[0];var r=Xc(e.map(function(s){return s.shape}),n);if(0===_e(r))return sr([],r);if(1===(e=e.filter(function(s){return s.size>0})).length)return e[0];var o=e.map(function(s){return s.shape});return ak(o,n),B.runKernelFunc(function(s){return s.concat(e,n)},e,function(s){var u=o.map(function(c){return c[n]});return bw(s,u,n).map(function(c){return function(){return c}})},"Concat",{axis:n})}}),fk=V({concat1d_:function(t){return Pn(t,0)}}),dk=V({concat2d_:function(t,n){return Pn(t,n)}}),hk=V({concat3d_:function(t,n){return Pn(t,n)}}),pk=V({concat4d_:function(t,n){return Pn(t,n)}}),bw=V({split_:function(t,n,e){void 0===e&&(e=0);var r,o=R(t,"x","split");return e=kn(e,o.shape)[0],"number"==typeof n?(M(o.shape[e]%n==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(n).fill(o.shape[e]/n)):(M(o.shape[e]===n.reduce(function(i,a){return i+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=n),B.runKernelFunc(function(i){return i.split(o,r,e)},{$x:o},function(i){return{$x:function(){return Pn(i,e)}}})}});function Qc(t,n){return t(n={exports:{}},n.exports),n.exports}typeof globalThis<"u"||typeof window<"u"||typeof global<"u"&&global;var i5=Qc(function(t){!function(n,e,r){function o(s){var u,c=this,f=(u=4022871197,function(d){d=d.toString();for(var p=0;p<d.length;p++){var g=.02519603282416938*(u+=d.charCodeAt(p));g-=u=g>>>0,u=(g*=u)>>>0,u+=4294967296*(g-=u)}return 2.3283064365386963e-10*(u>>>0)});c.next=function(){var d=2091639*c.s0+2.3283064365386963e-10*c.c;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=0|d)},c.c=1,c.s0=f(" "),c.s1=f(" "),c.s2=f(" "),c.s0-=f(s),c.s0<0&&(c.s0+=1),c.s1-=f(s),c.s1<0&&(c.s1+=1),c.s2-=f(s),c.s2<0&&(c.s2+=1),f=null}function i(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var c=new o(s),f=u&&u.state,d=c.next;return d.int32=function(){return 4294967296*c.next()|0},d.double=function(){return d()+11102230246251565e-32*(2097152*d()|0)},d.quick=d,f&&("object"==typeof f&&i(f,c),d.state=function(){return i(c,{})}),d}e&&e.exports?e.exports=a:this.alea=a}(0,t)}),a5=Qc(function(t){!function(n,e,r){function o(s){var u=this,c="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var d=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^d^d>>>8},s===(0|s)?u.x=s:c+=s;for(var f=0;f<c.length+64;f++)u.x^=0|c.charCodeAt(f),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var c=new o(s),f=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do{var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152}while(0===p);return p},d.int32=c.next,d.quick=d,f&&("object"==typeof f&&i(f,c),d.state=function(){return i(c,{})}),d}e&&e.exports?e.exports=a:this.xor128=a}(0,t)}),s5=Qc(function(t){!function(n,e,r){function o(s){var u=this,c="";u.next=function(){var d=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^d^d<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:c+=s;for(var f=0;f<c.length+64;f++)u.x^=0|c.charCodeAt(f),f==c.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var c=new o(s),f=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do{var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152}while(0===p);return p},d.int32=c.next,d.quick=d,f&&("object"==typeof f&&i(f,c),d.state=function(){return i(c,{})}),d}e&&e.exports?e.exports=a:this.xorwow=a}(0,t)}),u5=Qc(function(t){!function(n,e,r){function o(s){var u=this;u.next=function(){var c,f,d=u.x,p=u.i;return c=d[p],f=(c^=c>>>7)^c<<24,f^=(c=d[p+1&7])^c>>>10,f^=(c=d[p+3&7])^c>>>3,f^=(c=d[p+4&7])^c<<7,c=d[p+7&7],f^=(c^=c<<13)^c<<9,d[p]=f,u.i=p+1&7,f},function(c,f){var d,p=[];if(f===(0|f))p[0]=f;else for(f=""+f,d=0;d<f.length;++d)p[7&d]=p[7&d]<<15^f.charCodeAt(d)+p[d+1&7]<<13;for(;p.length<8;)p.push(0);for(d=0;d<8&&0===p[d];++d);for(8==d&&(p[7]=-1),c.x=p,c.i=0,d=256;d>0;--d)c.next()}(u,s)}function i(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){null==s&&(s=+new Date);var c=new o(s),f=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do{var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152}while(0===p);return p},d.int32=c.next,d.quick=d,f&&(f.x&&i(f,c),d.state=function(){return i(c,{})}),d}e&&e.exports?e.exports=a:this.xorshift7=a}(0,t)}),c5=Qc(function(t){!function(n,e,r){function o(s){var u=this;u.next=function(){var c,f,d=u.w,p=u.X,g=u.i;return u.w=d=d+1640531527|0,f=p[g+34&127],c=p[g=g+1&127],f^=f<<13,c^=c<<17,f=p[g]=(f^=f>>>15)^(c^=c>>>12),u.i=g,f+(d^d>>>16)|0},function(c,f){var d,p,g,m,y,w=[],b=128;for(f===(0|f)?(p=f,f=null):(f+="\0",p=0,b=Math.max(b,f.length)),g=0,m=-32;m<b;++m)f&&(p^=f.charCodeAt((m+32)%f.length)),0===m&&(y=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,m>=0&&(g=0==(d=w[127&m]^=p+(y=y+1640531527|0))?g+1:0);for(g>=128&&(w[127&(f&&f.length||0)]=-1),g=127,m=512;m>0;--m)p=w[g+34&127],d=w[g=g+1&127],p^=p<<13,d^=d<<17,w[g]=(p^=p>>>15)^(d^=d>>>12);c.w=y,c.X=w,c.i=g}(u,s)}function i(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){null==s&&(s=+new Date);var c=new o(s),f=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do{var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152}while(0===p);return p},d.int32=c.next,d.quick=d,f&&(f.X&&i(f,c),d.state=function(){return i(c,{})}),d}e&&e.exports?e.exports=a:this.xor4096=a}(0,t)}),l5=Qc(function(t){!function(n,e,r){function o(s){var u=this,c="";u.next=function(){var d=u.b,p=u.c,g=u.d,m=u.a;return d=d<<25^d>>>7^p,p=p-g|0,g=g<<24^g>>>8^m,m=m-d|0,u.b=d=d<<20^d>>>12^p,u.c=p=p-g|0,u.d=g<<16^p>>>16^m,u.a=m-d|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):c+=s;for(var f=0;f<c.length+20;f++)u.b^=0|c.charCodeAt(f),u.next()}function i(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var c=new o(s),f=u&&u.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do{var p=((c.next()>>>11)+(c.next()>>>0)/4294967296)/2097152}while(0===p);return p},d.int32=c.next,d.quick=d,f&&("object"==typeof f&&i(f,c),d.state=function(){return i(c,{})}),d}e&&e.exports?e.exports=a:this.tychei=a}(0,t)}),Zc=Qc(function(t){!function(n,e){var r,o=this,i=256,s="random",u=e.pow(i,6),c=e.pow(2,52),f=2*c,d=255;function p(b,C,_){var D=[],E=y(function k(N,F){var H,W=[],Z=typeof N;if(F&&"object"==Z)for(H in N)try{W.push(k(N[H],F-1))}catch{}return W.length?W:"string"==Z?N:N+"\0"}((C=1==C?{entropy:!0}:C||{}).entropy?[b,w(n)]:b??function(){try{var k;return r&&(k=r.randomBytes)?k=k(i):(k=new Uint8Array(i),(o.crypto||o.msCrypto).getRandomValues(k)),w(k)}catch{var N=o.navigator,F=N&&N.plugins;return[+new Date,o,F,o.screen,w(n)]}}(),3),D),A=new g(D),P=function(){for(var k=A.g(6),N=u,F=0;k<c;)k=(k+F)*i,N*=i,F=A.g(1);for(;k>=f;)k/=2,N/=2,F>>>=1;return(k+F)/N};return P.int32=function(){return 0|A.g(4)},P.quick=function(){return A.g(4)/4294967296},P.double=P,y(w(A.S),n),(C.pass||_||function(k,N,F,H){return H&&(H.S&&m(H,A),k.state=function(){return m(A,{})}),F?(e[s]=k,N):k})(P,E,"global"in C?C.global:this==e,C.state)}function g(b){var C,_=b.length,D=this,E=0,A=D.i=D.j=0,P=D.S=[];for(_||(b=[_++]);E<i;)P[E]=E++;for(E=0;E<i;E++)P[E]=P[A=d&A+b[E%_]+(C=P[E])],P[A]=C;(D.g=function(k){for(var N,F=0,H=D.i,W=D.j,Z=D.S;k--;)N=Z[H=d&H+1],F=F*i+Z[d&(Z[H]=Z[W=d&W+N])+(Z[W]=N)];return D.i=H,D.j=W,F})(i)}function m(b,C){return C.i=b.i,C.j=b.j,C.S=b.S.slice(),C}function y(b,C){for(var _,D=b+"",E=0;E<D.length;)C[d&E]=d&(_^=19*C[d&E])+D.charCodeAt(E++);return w(C)}function w(b){return String.fromCharCode.apply(0,b)}if(e["seed"+s]=p,y(e.random(),n),t.exports){t.exports=p;try{r=cr(902)}catch{}}}([],Math)});Zc.alea=i5,Zc.xor128=a5,Zc.xorwow=s5,Zc.xorshift7=u5,Zc.xor4096=c5,Zc.tychei=l5;var xw=Zc.alea,lE=function(){function t(n,e,r,o,i){this.mean=n,this.stdDev=e,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=xw(a.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var n=this.nextVal;return this.nextVal=NaN,n}for(var e,r,o=!1;!o;){var i=void 0,a=void 0,s=void 0;do{s=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a}while(s>=1||0===s);var u=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*i*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(e)||(o=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(e)},t.prototype.convertValue=function(n){return null==this.dtype||"float32"===this.dtype?n:Math.round(n)},t.prototype.isValidTruncated=function(n){return n<=this.upper&&n>=this.lower},t}(),f5=function(){function t(n,e,r,o){this.alpha=n,this.beta=1/e,this.dtype=r;var i=o||Math.random();this.randu=xw(i.toString()),this.randn=new lE(0,1,r,!1,this.randu()),this.d=n<1?n+2/3:n-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var n,e,r,o,i,a;;){do{o=this.randn.nextValue(),a=1+this.c*o}while(a<=0);if(e=1-.331*(n=o*o)*n,r=.5*n+this.d*(1-(a*=a*a)+Math.log(a)),(i=this.randu())<e||Math.log(i)<r)break}return a*=1/this.beta*this.d,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},t.prototype.convertValue=function(n){return"float32"===this.dtype?n:Math.round(n)},t}(),d5=function(){function t(n,e,r,o){var i=this;if(void 0===n&&(n=0),void 0===e&&(e=1),this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=n,this.range=e-n,this.dtype=r,null==o&&(o=Math.random()),"number"==typeof o&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+n+" - "+e+" <= 1 and dtype is not float");this.random=xw(o)}return t.prototype.convertValue=function(n){return this.canReturnFloat()?n:Math.round(n)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function Ge(t,n,e){return void 0===n&&(n="float32"),n=n||"float32",$D(t),new Gf(t,n,e)}function gk(t,n){void 0===n&&(n=!1),console.log(t.toString(n))}var fE=V({batchToSpaceND_:function(t,n,e){var r=R(t,"x","batchToSpaceND"),o=n.reduce(function(i,a){return i*a});return M(r.rank>=1+n.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+n.length}),M(e.length===n.length,function(){return"crops.length is "+e.length+" but should be equal to blockShape.length  "+n.length}),M(r.shape[0]%o==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+n.join(" * ")+" === "+o}),B.runKernelFunc(function(i){return i.batchToSpaceND(r,n,e)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(n,e)}}})}}),vk=V({broadcastTo_:function(t,n){var e=R(t,"broadcastTo","x"),r=e.shape;if(n.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+n+"].");if(n.length<e.rank)throw new Error("broadcastTo(): shape.length="+n.length+" < input.rank="+e.rank+".");if(n.length>e.rank){for(var o=e.shape.slice();o.length<n.length;)o.unshift(1);e=e.reshape(o)}for(var i=Array.from(n),a=n.length-1;a>=0;a--)if(e.shape[a]===n[a])i[a]=1;else if(1!==e.shape[a])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+n+"].");var s=i.map(function(u,c){return u>1?c:-1}).filter(function(u){return u>=0});return 0===s.length?e.clone():B.runKernelFunc(function(u){return u.tile(e,i)},{input:e},function(u){return{input:function(){return u.sum(s,!0)}}})}}),mk=V({cast_:function(t,n){var e=R(t,"x","cast");if(!wF(n))throw new Error("Failed to cast to unknown dtype "+n);if("string"===n&&"string"!==e.dtype||"string"!==n&&"string"===e.dtype)throw new Error("Only strings can be casted to strings");return B.runKernelFunc(function(o){return o.cast(e,n)},{x:e},function(o){return{x:function(){return o.clone()}}},"Cast",{dtype:n})}}),yk=V({clone_:function(t){var n=R(t,"x","clone",null);return B.runKernelFunc(function(){return B.makeTensorFromDataId(n.dataId,n.shape,n.dtype)},{$x:n},function(e){return{$x:function(){return e.toFloat()}}})}}),wk=V({cumsum_:function(t,n,e,r){void 0===n&&(n=0),void 0===e&&(e=!1),void 0===r&&(r=!1);var o=R(t,"x","cumsum"),i=Gi([n|=0],o.rank),a=o;null!=i&&(a=o.transpose(i));var s=qi(1,o.rank)[0],u=B.runKernelFunc(function(c){return c.cumsum(a,s,e,r)},{permutedX:a},function(c){return{permutedX:function(){return c.cumsum(n,e,!r)}}});return null!=i&&(u=u.transpose(i)),u}}),bk=V({depthToSpace_:function(t,n,e){void 0===e&&(e="NHWC");var r=R(t,"x","depthToSpace"),o="NHWC"===e?r.shape[1]:r.shape[2],i="NHWC"===e?r.shape[2]:r.shape[3],a="NHWC"===e?r.shape[3]:r.shape[1];return M(o*n>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+n+"  for depthToSpace with input shape\n      "+r.shape}),M(i*n>=0,function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+n+" for depthToSpace with input shape\n          "+r.shape}),M(a%(n*n)==0,function(){return"Dimension size must be evenly divisible by "+n*n+" but is "+a+" for depthToSpace with input shape "+r.shape}),B.runKernelFunc(function(s){return s.depthToSpace(r,n,e)},{$x:r})}}),Vo=V({expandDims_:function(t,n){void 0===n&&(n=0);var e=R(t,"x","expandDims",null);M(n<=e.rank,function(){return"Axis must be <= rank of the tensor"});var r=e.shape.slice();return n<0&&(M(-(e.rank+1)<=n,function(){return"Axis must be in the interval ["+-(e.rank+1)+", "+e.rank+"]"}),n=e.rank+n+1),r.splice(n,0,1),ai(e,r)}}),dE=V({eye_:function(t,n,e,r){void 0===r&&(r="float32"),null==n&&(n=t);for(var o=Ge([t,n],r),i=t<=n?t:n,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(t,n);if(null==e)return s;if(1===e.length)return Jc(Vo(s,0),[e[0],1,1]);if(2===e.length)return Jc(Vo(Vo(s,0),0),[e[0],e[1],1,1]);if(3===e.length)return Jc(Vo(Vo(Vo(s,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+e.length+"D.")}}),xk=V({multinomial_:function(t,n,e,r){void 0===r&&(r=!1);var o=R(t,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);e=e||Math.random();var s=1===a?o.as2D(1,-1):o,u=B.runKernelFunc(function(c){return c.multinomial(s,r,n,e)},{logits2D:s});return 1===a?u.as1D():u}}),_w=V({oneHot_:function(t,n,e,r){if(void 0===e&&(e=1),void 0===r&&(r=0),n<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+n);var o=R(t,"indices","oneHot","int32"),i=o.shape.concat([n]);return o=o.flatten(),B.runKernelFunc(function(a){return a.oneHot(o,n,e,r)},{$indices:o},function(a){return{$indices:function(){return qt(o.shape,"float32")}}}).reshape(i)}}),Cu=V({pad_:function(t,n,e){void 0===e&&(e=0);var r=R(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");return B.runKernelFunc(function(i){return i.pad(r,n,e)},{x:r},function(i){var a=n.map(function(s){return s[0]});return{x:function(){return i.slice(a,r.shape)}}},"PadV2",{paddings:n,constantValue:e})}}),_k=V({pad1d_:function(t,n,e){return void 0===e&&(e=0),M(2===n.length,function(){return"Invalid number of paddings. Must be length of 2."}),Cu(t,[n],e)}}),Ck=V({pad2d_:function(t,n,e){return void 0===e&&(e=0),M(2===n.length&&2===n[0].length&&2===n[1].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Cu(t,n,e)}}),Dk=V({pad3d_:function(t,n,e){return void 0===e&&(e=0),M(3===n.length&&2===n[0].length&&2===n[1].length&&2===n[2].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Cu(t,n,e)}}),Ek=V({pad4d_:function(t,n,e){return void 0===e&&(e=0),M(4===n.length&&2===n[0].length&&2===n[1].length&&2===n[2].length&&2===n[3].length,function(){return"Invalid number of paddings. Must be length of 2 each."}),Cu(t,n,e)}}),Ik=V({rand_:function(t,n,e){var r=_e(t),o=null;if(null==e||"float32"===e)o=new Float32Array(r);else if("int32"===e)o=new Int32Array(r);else{if("bool"!==e)throw new Error("Unknown data type "+e);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=n();return B.makeTensor(o,t,e)}}),Sk=V({randomNormal_:function(t,n,e,r,o){if(void 0===n&&(n=0),void 0===e&&(e=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new lE(n,e,r,!1,o),a=Ge(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),Ak=V({randomGamma_:function(t,n,e,r,o){if(void 0===e&&(e=1),void 0===r&&(r="float32"),null==e&&(e=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var i=new f5(n,e,r,o),a=Ge(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),hE=V({randomUniform_:function(t,n,e,r,o){void 0===n&&(n=0),void 0===e&&(e=1),void 0===r&&(r="float32");for(var i=Ge(t,r),a=new d5(n,e,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),ai=V({reshape_:function(t,n){var e=R(t,"x","reshape",null);return n=mF(n,e.size),M(e.size===_e(n),function(){return"new shape and old shape must have the same number of elements."}),B.runKernelFunc(function(o){return o.reshape(e,n)},{x:e},function(o){return{x:function(){return o.reshape(e.shape)}}},"Reshape",{shape:n})}}),pE=V({spaceToBatchND_:function(t,n,e){var r=R(t,"x","spaceToBatchND");return M(r.rank>=1+n.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+n.length}),M(e.length===n.length,function(){return"paddings.shape[0] "+e.length+" must be equal to [blockShape] "+n.length}),M(r.shape.reduce(function(o,i,a){return a>0&&a<=n.length?o&&(i+e[a-1][0]+e[a-1][1])%n[a-1]==0:o},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+e.toString()+" must be divisible by blockShapes "+n.toString()}),B.runKernelFunc(function(o){return o.spaceToBatchND(r,n,e)},{$x:r},function(o){return{$x:function(){return o.batchToSpaceND(n,e)}}})}}),gE=V({squeeze_:function(t,n){var e=R(t,"x","squeeze");return ai(e,wu(e.shape,n).newShape)}}),Co=V({stack_:function(t,n){void 0===n&&(n=0);var e=Vg(t,"tensors","stack");if(M(e.length>=1,function(){return"Pass at least one tensor to tf.stack"}),1===e.length)return e[0].expandDims(n);var o=e[0].shape,i=e[0].dtype;M(n<=e[0].rank,function(){return"Axis must be <= rank of the tensor"}),e.forEach(function(s){Et(o,s.shape,"All tensors passed to stack must have matching shapes")}),e.forEach(function(s){M(i===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=e.map(function(s){return s.expandDims(n)});return Pn(a,n)}}),Jc=V({tile_:function(t,n){var e=R(t,"x","tile",null);return M(e.rank===n.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of reps "+n+"."}),B.runKernelFunc(function(i,a){var s=i.tile(e,n);return a([e]),s},{x:e},function(i,a){var s=a[0];return{x:function(){var u=vt(s);if(1===s.rank)for(var c=0;c<n[0];++c)u=u.add(i.slice([c*s.shape[0]],[s.shape[0]]));else if(2===s.rank)for(c=0;c<n[0];++c)for(var f=0;f<n[1];++f)u=u.add(i.slice([c*s.shape[0],f*s.shape[1]],[s.shape[0],s.shape[1]]));else if(3===s.rank)for(c=0;c<n[0];++c)for(f=0;f<n[1];++f)for(var d=0;d<n[2];++d)u=u.add(i.slice([c*s.shape[0],f*s.shape[1],d*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(4!==s.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(c=0;c<n[0];++c)for(f=0;f<n[1];++f)for(d=0;d<n[2];++d)for(var p=0;p<n[3];++p)u=u.add(i.slice([c*s.shape[0],f*s.shape[1],d*s.shape[2],p*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return u}}},"Tile",{reps:n},[e])}}),Tk=V({truncatedNormal_:function(t,n,e,r,o){if(void 0===n&&(n=0),void 0===e&&(e=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new lE(n,e,r,!0,o),a=Ge(t,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),On=V({unstack_:function(t,n){void 0===n&&(n=0),n=n||0;var e=R(t,"x","unstack");return M(n>=-e.shape.length&&n<e.shape.length,function(){return"Axis = "+n+" is not in [-"+e.shape.length+", "+e.shape.length+")"}),n<0&&(n+=e.shape.length),B.runKernelFunc(function(o){return o.unstack(e,n)},{x:e},function(o){return{x:function(){return Co(o,n)}}},"Unpack",{axis:n})}}),Rk=function(t,n){return be(this,void 0,void 0,function(){var e,r,o,i,a,s,u,c,f,d;return xe(this,function(p){switch(p.label){case 0:return e=R(t,"x","setdiff1d"),r=R(n,"y","setdiff1d"),M(e.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+e.dtype+") and y ("+r.dtype+")."}),M(1===e.rank,function(){return"x should be 1D tensor, but got x ("+e.shape+")."}),M(1===r.rank,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,e.data()];case 1:return o=p.sent(),[4,r.data()];case 2:for(i=p.sent(),a=new Set(i),s=0,f=0;f<o.length;f++)a.has(o[f])||s++;for(u=new Gf([s],e.dtype),c=new Gf([s],"int32"),f=0,d=0;f<o.length;f++)a.has(o[f])||(u.values[d]=o[f],c.values[d]=f,d++);return[2,[u.toTensor(),c.toTensor()]]}})})};function Cw(t,n,e,r){void 0===r&&(r=!0);var o=[];if(r)(o=o.concat(n.slice(0))).push(t[0]/e),o=o.concat(t.slice(1));else{o=o.concat(t[0]);for(var i=n.length,a=0;a<i;++a)o=o.concat([t[a+1]/n[a],n[a]]);o=o.concat(t.slice(i+1))}return o}function Dw(t,n,e){void 0===e&&(e=!0);var r=[];if(e){r.push(n);for(var o=n+1;o<t;++o)o<=2*n?(r.push(o),r.push(o-(n+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<t;++o)o>=2*n+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function Ew(t,n,e,r){void 0===r&&(r=!0);var o=[];o.push(r?t[0]/e:t[0]*e);for(var i=1;i<t.length;++i)o.push(i<=n.length?r?n[i-1]*t[i]:t[i]/n[i-1]:t[i]);return o}function Mk(t,n){for(var e=[0],r=0;r<n;++r)e.push(t[r][0]);return e}function Nk(t,n,e){for(var r=t.slice(0,1),o=0;o<e;++o)r.push(t[o+1]-n[o][0]-n[o][1]);return r}function vE(t,n){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(n.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+n.rank+".");if("int32"!==n.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+n.dtype+".");if(n.shape[n.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+n.shape[n.rank-1]+" vs. "+t.rank);if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var e=n.shape,r=e[e.length-1],o=1,i=0;i<e.length-1;++i)o*=e[i];var a=t.shape,s=e.slice();s.pop();var u=1;for(i=r;i<t.rank;++i)u*=a[i],s.push(a[i]);var c=zi(t.shape).map(function(f){return f/u}).concat([1]).slice(0,r);return[s,o,u,c]}var h5=Object.freeze({prepareAndValidate:vE});function Iw(t){return t<=30?t:uw(t,Math.floor(Math.sqrt(t)))}function Fk(t,n,e){var r=n.rank>1?n.shape[n.rank-1]:1,o=n.rank>1?n.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+e.shape+", indices.shape: "+n.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+o+".";if(e.rank<o)throw new Error(i+" update.rank < "+o+". ");if(t.length<r+(e.rank-o))throw new Error(i+" Output shape length < "+(r+(e.rank-o)));if(e.rank!==o+t.length-r)throw new Error(i+" update.rank != "+(o+t.length-r));for(var a=0;a<o;++a)if(e.shape[a]!==n.shape[a])throw new Error(i+" updates.shape["+a+"] ("+e.shape[a]+") != indices.shape["+a+"] ("+n.shape[a]+").");for(a=0;a<e.rank-o;++a)if(e.shape[a+o]!==t[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+e.shape[a+o]+") != shape["+(a+o)+"] ("+t[a+o]+")")}function kk(t,n,e){if(n.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+n.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==n.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+n.dtype);if(e.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+e);if(0===e.length){if(0===n.size)throw new Error("Indices specified for empty output. indices shape: "+n.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}Fk(e,n,t)}function Wg(t,n,e){for(var r=n.shape.length,o=r>1?n.shape[r-1]:1,i=e.length,a=1,s=o;s<i;++s)a*=e[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:_e(n.shape)/u,sliceSize:a,strides:zi(e.slice(0,o)).concat([1]),outputSize:_e(e)}}var p5=Object.freeze({validateUpdateShape:Fk,validateInput:kk,calculateShapes:Wg});function Pk(t,n,e){M(t.rank===n.length,function(){return"Error in slice"+t.rank+"D: Length of begin "+n+" must match the rank of the array ("+t.rank+")."}),M(t.rank===e.length,function(){return"Error in slice"+t.rank+"D: Length of size "+e+" must match the rank of the array ("+t.rank+")."});for(var r=function(i){M(n[i]+e[i]<=t.shape[i],function(){return"Error in slice"+t.rank+"D: begin["+i+"] + size["+i+"] ("+(n[i]+e[i])+") would overflow input.shape["+i+"] ("+t.shape[i]+")"})},o=0;o<t.rank;++o)r(o)}function yE(t){for(var n=[],e=0;t>0;)1&t&&n.push(e),t/=2,e++;return n}function Sw(t,n,e){for(var r=[],o=0;o<t.length;o++)r[o]=Math.ceil((n[o]-t[o])/e[o]);return r}function Ok(t,n,e,r,o){var i=n[o];(t&1<<o||null==i)&&(i=(e[o]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),aw(0,i,s-1)}function Lk(t,n,e,r,o){var i=n[o],a=e[o]||1;(t&1<<o||null==i)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),a>0?aw(0,i,s):aw(-1,i,s-1)}function wE(t,n,e){for(var r=e.length,o=0;o<e.length;o++)if(e[o]>1){r=o;break}for(o=r+1;o<e.length;o++)if(n[o]>0||e[o]!==t[o])return!1;return!0}function bE(t,n){for(var e=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)e+=t[r]*n[r];return e}var g5=Object.freeze({assertParamsValid:Pk,maskToAxes:yE,computeOutShape:Sw,startForAxis:Ok,stopForAxis:Lk,isSliceContinous:wE,computeFlatOffset:bE});function v5(t){return M(xu(t),function(){return"The f passed in grad(f) must be a function"}),function(n,e){var r=R(n,"x","tf.grad",null),o=null!=e?R(e,"dy","tf.grad"):null;return B.tidy(function(){var i=B.gradients(function(){return t(r)},[r],o),s=i.grads;return null!=o&&Et(i.value.shape,o.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Aw(s),s[0]})}}function m5(t){return M(xu(t),function(){return"The f passed in grads(f) must be a function"}),function(n,e){M(Array.isArray(n),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var r=Vg(n,"args","tf.grads",null),o=null!=e?R(e,"dy","tf.grads"):null;return B.tidy(function(){var i=B.gradients(function(){return t.apply(void 0,r)},r,o),s=i.grads;return null!=o&&Et(i.value.shape,o.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Aw(s),s})}}function y5(t){return M(xu(t),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(n,e){M(n instanceof Ut,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),M(null==e||e instanceof Ut,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var r=B.gradients(function(){return t(n)},[n],e),o=r.grads,i=r.value;return Aw(o),{grad:o[0],value:i}}}function w5(t){return M(xu(t),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(n,e){M(Array.isArray(n)&&n.every(function(o){return o instanceof Ut}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),M(null==e||e instanceof Ut,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var r=B.gradients(function(){return t.apply(void 0,n)},n,e);return null!=e&&Et(r.value.shape,e.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Aw(r.grads),r}}function Bk(t,n){M(xu(t),function(){return"The f passed in variableGrads(f) must be a function"}),M(null==n||Array.isArray(n)&&n.every(function(f){return f instanceof qc}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var e=null!=n;if(!e)for(var r in n=[],B.registeredVariables)n.push(B.registeredVariables[r]);var o=e?n.filter(function(f){return!f.trainable}):null,i=n.length;M((n=n.filter(function(f){return f.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var a=B.gradients(t,n,null,!0),s=a.value,u=a.grads;M(u.some(function(f){return null!=f}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),M(0===s.rank,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var c={};return n.forEach(function(f,d){null!=u[d]&&(c[f.name]=u[d])}),o?.forEach(function(f){return c[f.name]=null}),{value:s,grads:c}}function Hg(t){return B.customGrad(t)}function Aw(t){if(t.filter(function(n){return null==n}).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var Na=V({softmax_:function(t,n){void 0===n&&(n=-1);var e=R(t,"logits","softmax","float32");if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and dim was "+n);return B.runKernelFunc(function(r,o){var i=r.softmax(e,n);return o([i]),i},{logits:e},function(r,o){var i=o[0],a=r.mul(i);return{logits:function(){return a.sub(a.sum([n],!0).mul(i))}}},"Softmax",{dim:n},[],[!0])}}),Vk=V({logSoftmax_:function(t,n){void 0===n&&(n=-1);var e=R(t,"logits","logSoftmax");if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+e.rank+" and axis was "+n);return Hg(function(r,o){var i=r.max(n,!0),a=r.sub(i),s=a.toFloat().sub(a.exp().sum(n,!0).log());return o([s]),{value:s,gradFunc:function(u,c){var f=c[0].exp();return u.sub(u.sum(n,!0).mul(f))}}})(e)}}),xE=function(){function t(n,e){this.backend=n,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return t.prototype.get=function(n){return this.data.has(n)||this.dataMover.moveData(this.backend,n),this.data.get(n)},t.prototype.set=function(n,e){this.dataIdsCount++,this.data.set(n,e)},t.prototype.has=function(n){return this.data.has(n)},t.prototype.delete=function(n){return this.dataIdsCount--,this.data.delete(n)},t.prototype.numDataIds=function(){return this.dataIdsCount},t}(),_E=function(){function t(){}return t.prototype.time=function(n){return $("time")},t.prototype.read=function(n){return $("read")},t.prototype.readSync=function(n){return $("readSync")},t.prototype.numDataIds=function(){return $("numDataIds")},t.prototype.disposeData=function(n){return $("disposeData")},t.prototype.write=function(n,e,r){return $("write")},t.prototype.move=function(n,e,r,o){return $("move")},t.prototype.memory=function(){return $("memory")},t.prototype.floatPrecision=function(){return $("floatPrecision")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.batchMatMul=function(n,e,r,o){return $("batchMatMul")},t.prototype.fusedBatchMatMul=function(n){return $("fusedBatchMatMul")},t.prototype.slice=function(n,e,r){return $("slice")},t.prototype.stridedSlice=function(n,e,r,o){return $("stridedSlice")},t.prototype.unstack=function(n,e){return $("unstack")},t.prototype.reverse=function(n,e){return $("reverse")},t.prototype.concat=function(n,e){return $("concat")},t.prototype.neg=function(n){return $("neg")},t.prototype.add=function(n,e){return $("add")},t.prototype.addN=function(n){return $("addN")},t.prototype.subtract=function(n,e){return $("subtract")},t.prototype.multiply=function(n,e){return $("multiply")},t.prototype.realDivide=function(n,e){return $("realDivide")},t.prototype.floorDiv=function(n,e){return $("floorDiv")},t.prototype.sum=function(n,e){return $("sum")},t.prototype.prod=function(n,e){return $("prod")},t.prototype.unsortedSegmentSum=function(n,e,r){return $("unsortedSegmentSum")},t.prototype.argMin=function(n,e){return $("argMin")},t.prototype.argMax=function(n,e){return $("argMax")},t.prototype.equal=function(n,e){return $("equal")},t.prototype.notEqual=function(n,e){return $("notEqual")},t.prototype.less=function(n,e){return $("less")},t.prototype.lessEqual=function(n,e){return $("lessEqual")},t.prototype.greater=function(n,e){return $("greater")},t.prototype.greaterEqual=function(n,e){return $("greaterEqual")},t.prototype.logicalNot=function(n){return $("logicalNot")},t.prototype.logicalAnd=function(n,e){return $("logicalAnd")},t.prototype.logicalOr=function(n,e){return $("logicalOr")},t.prototype.where=function(n){return $("where")},t.prototype.select=function(n,e,r){return $("select")},t.prototype.topk=function(n,e,r){return $("topk")},t.prototype.min=function(n,e){return $("min")},t.prototype.minimum=function(n,e){return $("minimum")},t.prototype.mod=function(n,e){return $("mod")},t.prototype.max=function(n,e){return $("max")},t.prototype.maximum=function(n,e){return $("maximum")},t.prototype.all=function(n,e){return $("all")},t.prototype.any=function(n,e){return $("any")},t.prototype.squaredDifference=function(n,e){return $("squaredDifference")},t.prototype.ceil=function(n){return $("ceil")},t.prototype.floor=function(n){return $("floor")},t.prototype.round=function(n){return $("round")},t.prototype.sign=function(n){return $("sign")},t.prototype.isNaN=function(n){return $("isNaN")},t.prototype.isInf=function(n){return $("isInf")},t.prototype.isFinite=function(n){return $("isFinite")},t.prototype.pow=function(n,e){return $("pow")},t.prototype.exp=function(n){return $("exp")},t.prototype.expm1=function(n){return $("expm1")},t.prototype.softmax=function(n,e){return $("softmax")},t.prototype.log=function(n){return $("log")},t.prototype.log1p=function(n){return $("log1p")},t.prototype.sqrt=function(n){return $("sqrt")},t.prototype.rsqrt=function(n){return $("rsqrt")},t.prototype.square=function(n){return $("square")},t.prototype.reciprocal=function(n){return $("reciprocal")},t.prototype.relu=function(n){return $("relu")},t.prototype.relu6=function(n){return $("relu6")},t.prototype.prelu=function(n,e){return $("prelu")},t.prototype.elu=function(n){return $("elu")},t.prototype.eluDer=function(n,e){return $("eluDer")},t.prototype.selu=function(n){return $("selu")},t.prototype.int=function(n){return $("int")},t.prototype.clip=function(n,e,r){return $("clip")},t.prototype.abs=function(n){return $("abs")},t.prototype.complexAbs=function(n){return $("complexAbs")},t.prototype.sigmoid=function(n){return $("sigmoid")},t.prototype.softplus=function(n){return $("softplus")},t.prototype.sin=function(n){return $("sin")},t.prototype.cos=function(n){return $("cos")},t.prototype.tan=function(n){return $("tan")},t.prototype.asin=function(n){return $("asin")},t.prototype.acos=function(n){return $("acos")},t.prototype.atan=function(n){return $("atan")},t.prototype.atan2=function(n,e){return $("atan2")},t.prototype.sinh=function(n){return $("sinh")},t.prototype.cosh=function(n){return $("cosh")},t.prototype.tanh=function(n){return $("tanh")},t.prototype.asinh=function(n){return $("asinh")},t.prototype.acosh=function(n){return $("acosh")},t.prototype.atanh=function(n){return $("atanh")},t.prototype.erf=function(n){return $("erf")},t.prototype.step=function(n,e){return $("step")},t.prototype.fusedConv2d=function(n){return $("fusedConv2d")},t.prototype.conv2d=function(n,e,r){return $("conv2d")},t.prototype.conv2dDerInput=function(n,e,r){return $("conv2dDerInput")},t.prototype.conv2dDerFilter=function(n,e,r){return $("conv2dDerFilter")},t.prototype.fusedDepthwiseConv2D=function(n){return $("fusedDepthwiseConv2D")},t.prototype.depthwiseConv2D=function(n,e,r){return $("depthwiseConv2D")},t.prototype.depthwiseConv2DDerInput=function(n,e,r){return $("depthwiseConv2DDerInput")},t.prototype.depthwiseConv2DDerFilter=function(n,e,r){return $("depthwiseConv2DDerFilter")},t.prototype.conv3d=function(n,e,r){return $("conv3d")},t.prototype.conv3dDerInput=function(n,e,r){return $("conv3dDerInput")},t.prototype.conv3dDerFilter=function(n,e,r){return $("conv3dDerFilter")},t.prototype.maxPool=function(n,e){return $("maxPool")},t.prototype.maxPoolBackprop=function(n,e,r,o){return $("maxPoolBackprop")},t.prototype.avgPool=function(n,e){return $("avgPool")},t.prototype.avgPoolBackprop=function(n,e,r){return $("avgPoolBackprop")},t.prototype.avgPool3d=function(n,e){return $("avgPool3d")},t.prototype.avgPool3dBackprop=function(n,e,r){return $("avgPool3dBackprop")},t.prototype.maxPool3d=function(n,e){return $("maxPool3d")},t.prototype.maxPool3dBackprop=function(n,e,r,o){return $("maxPool3dBackprop")},t.prototype.reshape=function(n,e){return $("reshape")},t.prototype.cast=function(n,e){return $("cast")},t.prototype.tile=function(n,e){return $("tile")},t.prototype.pad=function(n,e,r){return $("pad")},t.prototype.transpose=function(n,e){return $("transpose")},t.prototype.gather=function(n,e,r){return $("gather")},t.prototype.gatherND=function(n,e){return $("gatherND")},t.prototype.scatterND=function(n,e,r){return $("scatterND")},t.prototype.batchToSpaceND=function(n,e,r){return $("batchToSpaceND")},t.prototype.spaceToBatchND=function(n,e,r){return $("spaceToBatchND")},t.prototype.resizeBilinear=function(n,e,r,o){return $("resizeBilinear")},t.prototype.resizeBilinearBackprop=function(n,e,r){return $("resizeBilinearBackprop")},t.prototype.resizeNearestNeighbor=function(n,e,r,o){return $("resizeNearestNeighbor")},t.prototype.resizeNearestNeighborBackprop=function(n,e,r){return $("resizeNearestNeighborBackprop")},t.prototype.batchNormalization=function(n,e,r,o,i,a){return $("batchNormalization")},t.prototype.localResponseNormalization4D=function(n,e,r,o,i){return $("localResponseNormalization4D")},t.prototype.LRNGrad=function(n,e,r,o,i,a,s){return $("LRNGrad")},t.prototype.multinomial=function(n,e,r,o){return $("multinomial")},t.prototype.oneHot=function(n,e,r,o){return $("oneHot")},t.prototype.cumsum=function(n,e,r,o){return $("cumsum")},t.prototype.nonMaxSuppression=function(n,e,r,o,i){return $("nonMaxSuppression")},t.prototype.fft=function(n){return $("fft")},t.prototype.ifft=function(n){return $("ifft")},t.prototype.complex=function(n,e){return $("complex")},t.prototype.real=function(n){return $("real")},t.prototype.imag=function(n){return $("imag")},t.prototype.cropAndResize=function(n,e,r,o,i,a){return $("cropAndResize")},t.prototype.depthToSpace=function(n,e,r){return $("depthToSpace")},t.prototype.split=function(n,e,r){return $("split")},t.prototype.sparseToDense=function(n,e,r,o){return $("sparseToDense")},t.prototype.diag=function(n){return $("diag")},t.prototype.fill=function(n,e,r){return $("fill")},t.prototype.onesLike=function(n){return $("onesLike")},t.prototype.zerosLike=function(n){return $("zerosLike")},t.prototype.linspace=function(n,e,r){return $("linspace")},t.prototype.dispose=function(){return $("dispose")},t}();function $(t){throw new Error("'"+t+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function xs(t,n){for(var e=t.length,r=[],o=0;o<e;o++){var i=e-1-o;(n[n.length-1-o]||1)>1&&1===(t[i]||1)&&r.unshift(i)}return r}function Ln(t,n){for(var e=[],r=0;r<n.length;r++){var o=t[t.length-r-1],i=n.length-r-1;(null==o||1===o&&n[i]>1)&&e.unshift(i)}return e}function ct(t,n){for(var e=[],r=Math.max(t.length,n.length),o=0;o<r;o++){var i=t[t.length-o-1];null==i&&(i=1);var a=n[n.length-o-1];if(null==a&&(a=1),1===i)e.unshift(a);else if(1===a)e.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+t+" and "+n+".");e.unshift(i)}}return e}function qf(t,n,e,r,o,i,a){void 0===a&&(a="channelsLast");var s,u=Tw(n),c=u[0],f=u[1];if("channelsLast"===a)s=[c,f,t[3],t[3]];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);s=[c,f,t[1],t[1]]}return Du(t,s,e,r,o,i,!1,a)}function jg(t,n,e,r,o,i,a){void 0===a&&(a="NDHWC");var s,u,c=DE(n),f=c[0],d=c[1],p=c[2];if("NDHWC"===a)u="channelsLast",s=[f,d,p,t[4],t[4]];else{if("NCDHW"!==a)throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[f,d,p,t[1],t[1]]}return zg(t,s,e,r,o,!1,u,i)}function Du(t,n,e,r,o,i,a,s){void 0===a&&(a=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],f=u[1],d=u[2],p=u[3];if("channelsLast"===s)c=t[0],f=t[1],d=t[2],p=t[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=t[0],p=t[1],f=t[2],d=t[3]}var g,m=n[0],y=n[1],w=n[3],b=Tw(e),C=b[0],_=b[1],D=Tw(r),E=D[0],A=D[1],P=Kf(m,E),k=Kf(y,A),N=function(Y,Q,re,ne,J,se,ue,ve){var Ee,ke,ot;if("number"==typeof Y){Ee={top:Y,bottom:Y,left:Y,right:Y,type:0===Y?"VALID":"NUMBER"};var it=function(wt,Wt,Lt,mn,ln){null==mn&&(mn=CE(wt,Wt,Lt));var Ba=wt[1],Va=$g((wt[0]-Wt+2*mn)/Lt+1,ln);M(cn(Va),function(){return"The output # of rows ("+Va+") must be an integer. Change the stride and/or zero pad parameters"});var jo=$g((Ba-Wt+2*mn)/Lt+1,ln);return M(cn(jo),function(){return"The output # of columns ("+jo+") must be an integer. Change the stride and/or zero pad parameters"}),[Va,jo]}([Q,re],se,ne,Y,ve);ke=it[0],ot=it[1]}else if("same"===Y){ke=Math.ceil(Q/ne),ot=Math.ceil(re/J);var dt=Math.max(0,(ke-1)*ne+se-Q),It=Math.max(0,(ot-1)*J+ue-re),yt=Math.floor(dt/2),St=dt-yt,En=Math.floor(It/2);Ee={top:yt,bottom:St,left:En,right:It-En,type:"SAME"}}else{if("valid"!==Y)throw Error("Unknown padding parameter: "+Y);Ee={top:0,bottom:0,left:0,right:0,type:"VALID"},ke=Math.ceil((Q-se+1)/ne),ot=Math.ceil((re-ue+1)/J)}return{padInfo:Ee,outHeight:ke,outWidth:ot}}(o,f,d,C,_,P,k,i),H=N.outHeight,W=N.outWidth,Z=a?w*p:w;return"channelsFirst"===s?g=[c,Z,H,W]:"channelsLast"===s&&(g=[c,H,W,Z]),{batchSize:c,dataFormat:s,inHeight:f,inWidth:d,inChannels:p,outHeight:H,outWidth:W,outChannels:Z,padInfo:N.padInfo,strideHeight:C,strideWidth:_,filterHeight:m,filterWidth:y,effectiveFilterHeight:P,effectiveFilterWidth:k,dilationHeight:E,dilationWidth:A,inShape:t,outShape:g,filterShape:n}}function zg(t,n,e,r,o,i,a,s){void 0===i&&(i=!1),void 0===a&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],f=u[1],d=u[2],p=u[3],g=u[4];if("channelsLast"===a)c=t[0],f=t[1],d=t[2],p=t[3],g=t[4];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);c=t[0],g=t[1],f=t[2],d=t[3],p=t[4]}var m,y=n[0],w=n[1],b=n[2],C=n[4],_=DE(e),D=_[0],E=_[1],A=_[2],P=DE(r),k=P[0],N=P[1],F=P[2],H=Kf(y,k),W=Kf(w,N),Z=Kf(b,F),Y=function(ue,ve,Ee,ke,ot,it,dt,It,yt,St,En){var wt,Wt,Lt,mn;if("number"==typeof ue){wt={top:ue,bottom:ue,left:ue,right:ue,front:ue,back:ue,type:0===ue?"VALID":"NUMBER"};var ln=function(yd,Ms,AS,wd,Ua,TS){null==Ua&&(Ua=CE(yd,Ms,wd));var FK=yd[1],kK=yd[2],RS=$g((yd[0]-Ms+2*Ua)/wd+1,TS);M(cn(RS),function(){return"The output # of depths ("+RS+") must be an integer. Change the stride and/or zero pad parameters"});var MS=$g((FK-Ms+2*Ua)/wd+1,TS);M(cn(MS),function(){return"The output # of rows ("+MS+") must be an integer. Change the stride and/or zero pad parameters"});var NS=$g((kK-Ms+2*Ua)/wd+1,TS);return M(cn(NS),function(){return"The output # of columns ("+NS+") must be an integer. Change the stride and/or zero pad parameters"}),[RS,MS,NS,1]}([ve,Ee,ke,1],It,0,ot,ue,En);Wt=ln[0],Lt=ln[1],mn=ln[2]}else if("same"===ue){var fn=((Wt=Math.ceil(ve/ot))-1)*ot+It-ve,Ba=((Lt=Math.ceil(Ee/it))-1)*it+yt-Ee,Va=((mn=Math.ceil(ke/dt))-1)*dt+St-ke,jo=Math.floor(fn/2),md=fn-jo,Ts=Math.floor(Ba/2),Bu=Ba-Ts,Rs=Math.floor(Va/2);wt={top:Ts,bottom:Bu,left:Rs,right:Va-Rs,front:jo,back:md,type:"SAME"}}else{if("valid"!==ue)throw Error("Unknown padding parameter: "+ue);wt={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Wt=Math.ceil((ve-It+1)/ot),Lt=Math.ceil((Ee-yt+1)/it),mn=Math.ceil((ke-St+1)/dt)}return{padInfo:wt,outDepth:Wt,outHeight:Lt,outWidth:mn}}(o,f,d,p,D,E,A,H,W,Z,s),re=Y.outDepth,ne=Y.outHeight,J=Y.outWidth,se=i?C*g:C;return"channelsFirst"===a?m=[c,se,re,ne,J]:"channelsLast"===a&&(m=[c,re,ne,J,se]),{batchSize:c,dataFormat:a,inDepth:f,inHeight:d,inWidth:p,inChannels:g,outDepth:re,outHeight:ne,outWidth:J,outChannels:se,padInfo:Y.padInfo,strideDepth:D,strideHeight:E,strideWidth:A,filterDepth:y,filterHeight:w,filterWidth:b,effectiveFilterDepth:H,effectiveFilterHeight:W,effectiveFilterWidth:Z,dilationDepth:k,dilationHeight:N,dilationWidth:F,inShape:t,outShape:m,filterShape:n}}function CE(t,n,e,r){void 0===r&&(r=1);var o=Kf(n,r);return Math.floor((t[0]*(e-1)-e+o)/2)}function Tw(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function DE(t){return"number"==typeof t?[t,t,t]:t}function Kf(t,n){return n<=1?t:t+(t-1)*(n-1)}function $g(t,n){if(!n)return t;switch(n){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+n)}}function el(t){var n=Tw(t);return 1===n[0]&&1===n[1]&&1===n[2]}function oo(t,n){return el(t)||el(n)}function Rw(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function EE(t,n,e){if("complex64"===n){if("complex64"===t.dtype)return t.clone();var r=qt(t.shape),o=t.toFloat(),i=e.complex(o,r);return r.dispose(),o.dispose(),i}if(!bF(t.dtype,n))return B.makeTensorFromDataId(t.dataId,t.shape,n);if("complex64"===t.dtype){var a=e.real(t);return i=a.cast(n),a.dispose(),i}if("int32"===n)return e.int(t);if("bool"===n){var s=le(0,t.dtype);return i=e.notEqual(t,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+n)}function Mw(t,n){return B.makeTensorFromDataId(t.dataId,n,t.dtype)}function IE(t,n,e){var r=(n-t)/(e-1),o=$f(e,"float32");o[0]=t;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return Dn(o,"float32")}var b5=Object.freeze({castTensor:EE,reshapeTensor:Mw,linspaceImpl:IE,upcastType:ir,axesAreInnerMostDims:uE,combineLocations:ik,computeOutAndReduceShapes:Ir,expandShapeToKeepDim:no,assertAxesAreInnerMostDims:_o,getAxesPermutation:Gi,getUndoAxesPermutation:yw,getInnerMostAxes:qi,getBroadcastDims:xs,getReductionAxes:Ln,assertAndGetBroadcastShape:ct,assertParamsConsistent:ak,computeOutShape:Xc,computePool2DInfo:qf,computePool3DInfo:jg,computeConv2DInfo:Du,computeConv3DInfo:zg,computeDefaultPad:CE,tupleValuesAreOne:el,eitherStridesOrDilationsAreOne:oo,convertConv2DDataFormat:Rw,PARALLELIZE_THRESHOLD:30,computeOptimalWindowSize:Iw});function SE(t,n){if(t.length!==n.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+n.length+".");for(var e=new Float32Array(2*t.length),r=0;r<e.length;r+=2)e[r]=t[r/2],e[r+1]=n[r/2];return e}function Uk(t,n){return{real:t[2*n],imag:t[2*n+1]}}function x5(t,n,e,r){t[2*r]=n,t[2*r+1]=e}function _5(t,n,e){var r=(e?2:-2)*Math.PI*(t/n);return{real:Math.cos(r),imag:Math.sin(r)}}function C5(t,n,e){var r=function(u,c,f){for(var d=0,p=u.length,g=0,m=!1;d<p;){var y=f(c,u[g=d+(p-d>>>1)]);y>0?d=g+1:(p=g,m=!y)}return m?d:-d-1}(t,n,e||D5);t.splice(r<0?-(r+1):r,0,n)}function D5(t,n){return t>n?1:t<n?-1:0}function AE(t,n,e,r,o){return Wk(t,n,e,r,o,0).selectedIndices}function TE(t,n,e,r,o,i){var a=Wk(t,n,e,r,o,i,!0);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function Wk(t,n,e,r,o,i,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);for(var u=Array.from(n).map(function(D,E){return{score:D,boxIndex:E,suppressBeginIndex:0}}).filter(function(D){return D.score>o}).sort(Hk),c=i>0?-.5/i:0,f=[],d=[];f.length<e&&u.length>0;){var p=u.pop(),g=p.score,m=p.boxIndex,y=p.suppressBeginIndex;if(g<o)break;for(var w=!1,b=f.length-1;b>=y;--b){var C=E5(t,m,f[b]);if(C>=r){w=!0;break}if(p.score=p.score*I5(r,c,C),p.score<=o)break}p.suppressBeginIndex=f.length,w||(p.score===g?(f.push(m),d.push(p.score)):p.score>o&&C5(u,p,Hk))}var _=f.length;return s&&(f.fill(0,_),d.fill(0,_)),{selectedIndices:Dn(f,"int32"),selectedScores:Dn(d,"float32"),numValidOutputs:le(_,"int32")}}function E5(t,n,e){var r=t.subarray(4*n,4*n+4),o=t.subarray(4*e,4*e+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(o[0],o[2]),f=Math.min(o[1],o[3]),d=Math.max(o[0],o[2]),p=Math.max(o[1],o[3]),g=(s-i)*(u-a),m=(d-c)*(p-f);if(g<=0||m<=0)return 0;var y=Math.max(i,c),w=Math.max(a,f),b=Math.min(s,d),C=Math.min(u,p),_=Math.max(b-y,0)*Math.max(C-w,0);return _/(g+m-_)}function I5(t,n,e){var r=Math.exp(n*e*e);return e<=t?r:0}function Hk(t,n){return t.score-n.score||t.score===n.score&&n.boxIndex-t.boxIndex}function jk(t,n,e){var r=new Array(t.rank).fill(0),o=t.shape.slice();return n.map(function(i){o[e]=i;var a=t.slice(r,o);return r[e]+=i,a})}function zk(t,n){for(var e=new Array(t.rank),r=0;r<e.length;r++)e[r]=t.shape[r]*n[r];var o=Ge(e,t.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(t.rank),s=0;s<a.length;s++)a[s]=i[s]%t.shape[s];var u=t.locToIndex(a);o.values[r]=t.values[u]}return o.toTensor()}function $k(t,n,e,r,o){for(var i=n[n.length-1],a=[t.length/i,i],s=a[0],u=a[1],c=jf(e,s*r),f=jf("int32",s*r),d=0;d<s;d++){for(var p=d*u,g=t.subarray(p,p+u),m=[],y=0;y<g.length;y++)m.push({value:g[y],index:y});m.sort(function(D,E){return E.value-D.value});var w=d*r,b=c.subarray(w,w+r),C=f.subarray(w,w+r);for(y=0;y<r;y++)b[y]=m[y].value,C[y]=m[y].index}var _=n.slice();return _[_.length-1]=r,[sr(c,_,e),sr(f,_,"int32")]}function RE(t,n){for(var e=[],r=0;r<n.length;r++)n[r]&&e.push(r);var o=Ge(t,"int32"),i=Ge([e.length,t.length],"int32");for(r=0;r<e.length;r++){var a=o.indexToLoc(e[r]);i.values.set(a,r*t.length)}return i.toTensor()}var S5=function(t,n){this.outputShape=[],this.outputShape=t,this.variableNames=n.map(function(o,i){return"T"+i});var e=[];this.variableNames.forEach(function(o){e.push("float v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode="\n      void main() {\n        "+e.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},A5=function(t,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map(function(o,i){return"T"+i});var e=[];this.variableNames.forEach(function(o){e.push("vec4 v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode="\n      void main() {\n        "+e.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},T5=function(t,n,e){this.variableNames=["A"];var r=t.windowSize,o=t.batchSize,a=Math.ceil(t.inSize/r);e||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+(e?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));")+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+("max"===n?">":"<")+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function Gk(t,n){return["x","y","z","w","u","v"].slice(0,n).map(function(e){return t+"."+e})}function Do(t,n){return 1===n?[t]:Gk(t,n)}function Ur(){var t,n,e,r,o,i,a,s,u,c;return 2===K().getNumber("WEBGL_VERSION")?(t="#version 300 es",n="in",e="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",n="attribute",e="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:n,varyingVs:e,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function tl(t,n,e){void 0===e&&(e="index");var r=zi(n);return r.map(function(o,i){return"int "+t[i]+" = "+e+" / "+o+"; "+(i===r.length-1?"int "+t[i+1]+" = "+e+" - "+t[i]+" * "+o:"index -= "+t[i]+" * "+o)+";"}).join("")}function ME(t){var n=zi(t).map(function(e){return e.toString()});return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+n[0]+" + coords.y * "+n[1]+" + coords.z;\n  }\n"}var qk="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function R5(t,n,e,r){var o=[];t.forEach(function(g){var m=_e(g.shapeInfo.logicalShape);g.shapeInfo.isUniform?o.push("uniform float "+g.name+(m>1?"["+m+"]":"")+";"):(o.push("uniform sampler2D "+g.name+";"),o.push("uniform int offset"+g.name+";"))});var i,a,g,s=o.join("\n"),u=t.map(function(g){return function(m,y,w){void 0===w&&(w=!1);var b="";return b+=w?Kk(m):Xf(m),m.shapeInfo.logicalShape.length<=y.logicalShape.length&&(b+=w?function(D,E){var A,re,P=D.name,k=P.charAt(0).toUpperCase()+P.slice(1),N="get"+k+"AtOutCoords",F=D.shapeInfo.logicalShape.length,H=E.logicalShape.length,W=xs(D.shapeInfo.logicalShape,E.logicalShape),Z=Kt(H),Y=H-F,Q=["x","y","z","w","u","v"];A=0===F?"":H<2&&W.length>=1?"coords = 0;":W.map(function(Ee){return"coords."+Q[Ee+Y]+" = 0;"}).join("\n"),re=H<2&&F>0?"coords":D.shapeInfo.logicalShape.map(function(Ee,ke){return"coords."+Q[ke+Y]}).join(", ");var ne="return outputValue;",J=1===_e(D.shapeInfo.logicalShape),se=1===_e(E.logicalShape);if(1!==F||J||se){if(J&&!se)ne=1===H?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(W.length){var ue=F-2,ve=F-1;W.indexOf(ue)>-1&&W.indexOf(ve)>-1?ne="return vec4(outputValue.x);":W.indexOf(ue)>-1?ne="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":W.indexOf(ve)>-1&&(ne="return vec4(outputValue.xx, outputValue.zz);")}}else ne="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+N+"() {\n      "+Z+" coords = getOutputCoords();\n      "+A+"\n      vec4 outputValue = get"+k+"("+re+");\n      "+ne+"\n    }\n  "}(m,y):function(D,E){var A=D.name,P=A.charAt(0).toUpperCase()+A.slice(1),k="get"+P+"AtOutCoords",H=D.shapeInfo.logicalShape.length,W=E.logicalShape.length;if(!D.shapeInfo.isUniform&&H===W&&null==D.shapeInfo.flatOffset&&Fn(D.shapeInfo.texShape,E.texShape))return"\n      float "+k+"() {\n        return sampleTexture("+A+", resultUV);\n      }\n    ";var Y=Kt(W),Q=xs(D.shapeInfo.logicalShape,E.logicalShape),re=W-H,ne=["x","y","z","w","u","v"];return"\n    float "+k+"() {\n      "+Y+" coords = getOutputCoords();\n      "+(0===H?"":W<2&&Q.length>=1?"coords = 0;":Q.map(function(se){return"coords."+ne[se+re]+" = 0;"}).join("\n"))+"\n      return get"+P+"("+(W<2&&H>0?"coords":D.shapeInfo.logicalShape.map(function(se,ue){return"coords."+ne[ue+re]}).join(", "))+");\n    }\n  "}(m,y)),b}(g,n,r)}).join("\n"),c=n.texShape,f=Ur(),d="\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+f.texture2D+"(textureSampler, uv).r;\n    }\n  ",p=(g=f).version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+g.varyingFs+" vec2 resultUV;\n    "+g.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+g.defineSpecialNaN+"\n    "+g.defineSpecialInf+"\n    "+g.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+M5+"\n    "+N5+"\n    "+F5+"\n  ";return n.isPacked?(i=function(g,m){switch(g.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return E=m,1===(A=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)])[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+A[1]+".0);\n      }\n    ":1===A[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+A[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+A[0]+", "+A[1]+"));\n      return 2 * (resTexRC.x * "+A[1]+" + resTexRC.y);\n    }\n  ";case 2:return function(D,E){var A=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)];if(Fn(D,E))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+A[0]+", "+A[1]+"));\n      }\n    ";var P=Math.ceil(D[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+A[0]+", "+A[1]+"));\n\n      int index = resTexRC.x * "+A[1]+" + resTexRC.y;\n      int r = 2 * (index / "+P+");\n      int c = imod(index, "+P+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(g,m);case 3:return y=g,w=m,b=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)],_=(C=Math.ceil(y[2]/2))*Math.ceil(y[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+b[0]+", "+b[1]+"));\n      int index = resTexRC.x * "+b[1]+" + resTexRC.y;\n\n      int b = index / "+_+";\n      index -= b * "+_+";\n\n      int r = 2 * (index / "+C+");\n      int c = imod(index, "+C+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(D,E){for(var A=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)],P=Math.ceil(D[D.length-1]/2),k=P*Math.ceil(D[D.length-2]/2),N=k,F="",H="b, r, c",W=2;W<D.length-1;W++)F="\n      int b"+W+" = index / "+(N*=D[D.length-W-1])+";\n      index -= b"+W+" * "+N+";\n    "+F,H="b"+W+", "+H;return"\n    ivec"+D.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+A[0]+", "+A[1]+"));\n      int index = resTexRC.x * "+A[1]+" + resTexRC.y;\n\n      "+F+"\n\n      int b = index / "+k+";\n      index -= b * "+k+";\n\n      int r = 2 * (index / "+P+");\n      int c = imod(index, "+P+") * 2;\n\n      return ivec"+D.length+"("+H+");\n    }\n  "}(g,m)}var E,A,y,w,b,C,_}(n.logicalShape,c),a=function(g){return"\n    void setOutput(vec4 val) {\n      "+g.output+" = val;\n    }\n  "}(f)):(i=function(g,m){switch(g.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return 1===(C=m)[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+C[1]+".0);\n      }\n    ":1===C[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+C[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+C[0]+", "+C[1]+"));\n      return resTexRC.x * "+C[1]+" + resTexRC.y;\n    }\n  ";case 2:return function(b,C){return Fn(b,C)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+C[0]+", "+C[1]+"));\n      }\n    ":1===b[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+C[0]+", "+C[1]+"));\n        int index = resTexRC.x * "+C[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===b[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+C[0]+", "+C[1]+"));\n        int index = resTexRC.x * "+C[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+C[0]+", "+C[1]+"));\n      int index = resTexRC.x * "+C[1]+" + resTexRC.y;\n      int r = index / "+b[1]+";\n      int c = index - r * "+b[1]+";\n      return ivec2(r, c);\n    }\n  "}(g,m);case 3:return y=m,w=tl(["r","c","d"],g),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+y[0]+", "+y[1]+"));\n      int index = resTexRC.x * "+y[1]+" + resTexRC.y;\n      "+w+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(b,C){var _=tl(["r","c","d","d2"],b);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+C[0]+", "+C[1]+"));\n      int index = resTexRC.x * "+C[1]+" + resTexRC.y;\n      "+_+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(g,m);case 5:return function(b,C){var _=tl(["r","c","d","d2","d3"],b);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+C[0]+",\n                             "+C[1]+"));\n\n      int index = resTexRC.x * "+C[1]+" + resTexRC.y;\n\n      "+_+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(g,m);case 6:return function(b,C){var _=tl(["r","c","d","d2","d3","d4"],b);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+C[0]+", "+C[1]+"));\n      int index = resTexRC.x * "+C[1]+" + resTexRC.y;\n\n      "+_+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(g,m);default:throw new Error(g.length+"-D output sampling is not yet supported")}var C,y,w}(n.logicalShape,c),a=function(g){return"\n    void setOutput(float val) {\n      "+g.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(f)),r&&(p+=k5),[p,d,a,s,i,u,e].join("\n")}function Xf(t){var n=t.shapeInfo.logicalShape;switch(n.length){case 0:return function(e){var r=e.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return"float "+o+"() {return "+r+";}";var i=e.shapeInfo.texShape;if(1===i[0]&&1===i[1])return"\n      float "+o+"() {\n        return sampleTexture("+r+", halfCR);\n      }\n    ";var u=e.shapeInfo.texShape;return"\n    float "+o+"() {\n      vec2 uv = uvFromFlat("+u[0]+", "+u[1]+", "+nl(r)+");\n      return sampleTexture("+r+", uv);\n    }\n  "}(t);case 1:return function(e){var r=e.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return"\n      float "+o+"(int index) {\n        "+Yf(e)+"\n      }\n    ";var i=e.shapeInfo.texShape,a=i[0],s=i[1];if(1===s&&1===a)return"\n      float "+o+"(int index) {\n        return sampleTexture("+r+", halfCR);\n      }\n    ";var u=nl(r);return 1===s?"\n      float "+o+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+u+") + 0.5) / "+a+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":1===a?"\n      float "+o+"(int index) {\n        vec2 uv = vec2((float(index + "+u+") + 0.5) / "+s+".0, 0.5);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+o+"(int index) {\n      vec2 uv = uvFromFlat("+a+", "+s+", index + "+u+");\n      return sampleTexture("+r+", uv);\n    }\n  "}(t);case 2:return function(e){var r=e.shapeInfo.logicalShape,o=e.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=e.shapeInfo.texShape;if(null!=a&&Fn(r,a))return"\n    float "+i+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+a[1]+".0, "+a[0]+".0);\n      return sampleTexture("+o+", uv);\n    }\n  ";var c=wu(r),f=c.newShape,d=c.keptDims;if(f.length<r.length)return"\n      "+Xf(Qf(e,f))+"\n      float "+i+"(int row, int col) {\n        return "+i+"("+Zf(["row","col"],d)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+r[1]+", 1)));\n        "+Yf(e)+"\n      }\n    ";var m=a[0],y=a[1],w=nl(o);return 1===y?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+w+"), vec3("+r[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+m+".0);\n      return sampleTexture("+o+", uv);\n    }\n  ":1===m?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+w+"), vec3("+r[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+y+".0, 0.5);\n      return sampleTexture("+o+", uv);\n    }\n  ":"\n  float "+i+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+r[1]+" + col + "+w+";\n    vec2 uv = uvFromFlat("+m+", "+y+", index);\n    return sampleTexture("+o+", uv);\n  }\n"}(t);case 3:return function(e){var r=e.shapeInfo.logicalShape,o=e.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[1]*r[2],s=r[2],u=wu(r),c=u.newShape,f=u.keptDims;if(c.length<r.length)return"\n        "+Xf(Qf(e,c))+"\n        float "+i+"(int row, int col, int depth) {\n          return "+i+"("+Zf(["row","col","depth"],f)+");\n        }\n      ";if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+a+", "+s+", 1)));\n        "+Yf(e)+"\n      }\n    ";var g=e.shapeInfo.texShape,m=g[0],y=g[1],w=e.shapeInfo.flatOffset;return y===a&&null==w?"\n        float "+i+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+s+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+y+".0, "+m+".0);\n          return sampleTexture("+o+", uv);\n        }\n      ":y===s&&null==w?"\n    float "+i+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+r[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+y+".0, "+m+".0);\n      return sampleTexture("+o+", uv);\n    }\n  ":"\n      float "+i+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+a+" + col * "+s+" + depth + "+nl(o)+";\n        vec2 uv = uvFromFlat("+m+", "+y+", index);\n        return sampleTexture("+o+", uv);\n      }\n  "}(t);case 4:return function(e){var r=e.shapeInfo.logicalShape,o=e.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[3],s=r[2]*a,u=r[1]*s,c=wu(r),f=c.newShape,d=c.keptDims;if(f.length<r.length)return"\n      "+Xf(Qf(e,f))+"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        return "+i+"("+Zf(["row","col","depth","depth2"],d)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+u+", "+s+", "+a+", 1)));\n        "+Yf(e)+"\n      }\n    ";var g=e.shapeInfo.flatOffset,m=e.shapeInfo.texShape,y=m[0],w=m[1];return w===u&&null==g?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+s+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+w+".0, "+y+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":w===a&&null==g?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+r[1]*r[2]+", "+r[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+w+".0, "+y+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+u+" + col * "+s+" +\n          depth * "+a+" + depth2;\n      vec2 uv = uvFromFlat("+y+", "+w+", index + "+nl(o)+");\n      return sampleTexture("+o+", uv);\n    }\n  "}(t);case 5:return function(e){var r=e.shapeInfo.logicalShape,o=e.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[4],s=r[3]*a,u=r[2]*s,c=r[1]*u,f=wu(r),d=f.newShape,p=f.keptDims;if(d.length<r.length)return"\n      "+Xf(Qf(e,d))+"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+i+"("+Zf(["row","col","depth","depth2","depth3"],p)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+c+", "+u+", "+s+", "+a+")) +\n          depth3;\n        "+Yf(e)+"\n      }\n    ";var m=e.shapeInfo.flatOffset,y=e.shapeInfo.texShape,w=y[0],b=y[1];return b===c&&null==m?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+u+", "+s+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+b+".0, "+w+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":b===a&&null==m?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+r[1]*r[2]*r[3]+",\n               "+r[2]*r[3]+", "+r[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+b+".0, "+w+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+c+" + col * "+u+" + depth * "+s+" +\n          depth2 * "+a+" + depth3 + "+nl(o)+";\n      vec2 uv = uvFromFlat("+w+", "+b+", index);\n      return sampleTexture("+o+", uv);\n    }\n  "}(t);case 6:return function(e){var r=e.shapeInfo.logicalShape,o=e.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=wu(r),s=a.newShape,u=a.keptDims;if(s.length<r.length)return"\n      "+Xf(Qf(e,s))+"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+i+"("+Zf(["row","col","depth","depth2","depth3","depth4"],u)+");\n      }\n    ";var f=r[5],d=r[4]*f,p=r[3]*d,g=r[2]*p,m=r[1]*g;if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+m+", "+g+", "+p+", "+d+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+f+", 1)));\n        "+Yf(e)+"\n      }\n    ";var y=e.shapeInfo.flatOffset,w=e.shapeInfo.texShape,b=w[0],C=w[1];return C===m&&null==y?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+g+", "+p+", "+d+", "+f+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+C+".0, "+b+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":C===f&&null==y?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+r[1]*r[2]*r[3]*r[4]+",\n               "+r[2]*r[3]*r[4]+",\n               "+r[3]*r[4]+",\n               "+r[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+C+".0, "+b+".0);\n        return sampleTexture("+o+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+m+" + col * "+g+" + depth * "+p+" +\n          depth2 * "+d+" + depth3 * "+f+" + depth4 + "+nl(o)+";\n      vec2 uv = uvFromFlat("+b+", "+C+", index);\n      return sampleTexture("+o+", uv);\n    }\n  "}(t);default:throw new Error(n.length+"-D input sampling is not yet supported")}}function Kk(t){var n,o,i,a,s,u,c;switch(t.shapeInfo.logicalShape.length){case 0:return"\n    vec4 get"+(n=t.name).charAt(0).toUpperCase()+n.slice(1)+"() {\n      return "+Ur().texture2D+"("+n+", halfCR);\n    }\n  ";case 1:return a="get"+(i=(o=t).name).charAt(0).toUpperCase()+i.slice(1),s=o.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=Ur(),"\n    vec4 "+a+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+u[0]+", "+u[1]+", index);\n      return "+c.texture2D+"("+i+", uv);\n    }\n  ";case 2:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,c=u[0],f=u[1],d=Ur();if(null!=u&&Fn(i,u))return"\n      vec4 "+s+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+f+".0, "+c+".0);\n\n        return "+d.texture2D+"("+a+", uv);\n      }\n    ";var p=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];return"\n    vec4 "+s+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(i[1]/2)+", "+p[0]+", "+p[1]+", row, col);\n      return "+d.texture2D+"("+a+", uv);\n    }\n  "}(t);case 3:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,c=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(1===i[0])return"\n        "+Kk(Qf(o,i.slice(1)))+"\n        vec4 "+s+"(int b, int row, int col) {\n          return "+s+"("+Zf(["b","row","col"],[1,2])+");\n        }\n      ";var p=c[0],g=c[1],m=Math.ceil(i[2]/2);return"\n    vec4 "+s+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+p+", "+g+", "+m*Math.ceil(i[1]/2)+", "+m+", b, row, col);\n      return "+Ur().texture2D+"("+a+", uv);\n    }\n  "}(t);default:return function(o){for(var i=o.shapeInfo.logicalShape,a=i.length,s=o.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),c=o.shapeInfo.texShape,f=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)],d=f[0],p=f[1],g=Math.ceil(i[a-1]/2),m=g*Math.ceil(i[a-2]/2),y="int b, int row, int col",w="b * "+m+" + (row / 2) * "+g+" + (col / 2)",b=2;b<a-1;b++)y="int b"+b+", "+y,w="b"+b+" * "+(m*=i[a-b-1])+" + "+w;return"\n    vec4 "+u+"("+y+") {\n      int index = "+w+";\n      int texR = index / "+p+";\n      int texC = index - texR * "+p+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+p+", "+d+");\n      return "+Ur().texture2D+"("+s+", uv);\n    }\n  "}(t)}}var M5="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",N5="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",F5="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",k5="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function nl(t){return"offset"+t}function Yf(t){var n=t.name,e=_e(t.shapeInfo.logicalShape);return e<2?"return "+n+";":"\n    for (int i = 0; i < "+e+"; i++) {\n      if (i == index) {\n        return "+n+"[i];\n      }\n    }\n  "}function Kt(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function Qf(t,n){var e=JSON.parse(JSON.stringify(t));return e.shapeInfo.logicalShape=n,e}function Zf(t,n){return n.map(function(e){return t[e]}).join(", ")}var P5=function(t,n,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,M(t.length>2,function(){return"Packed arg"+(e.charAt(0).toUpperCase()+e.slice(1))+" supports only inputs with rank above 2."});var i=Math.ceil(t[t.length-1]/n);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,c=u.length,f=Kt(c),d=Do("coords",c);if(1===i){var p=Kt(s=c+1);a="\n        "+p+" sourceLocR = "+p+"("+d.join()+", 0);\n        ++"+d[c-1]+";\n        "+p+" sourceLocG = "+p+"("+d.join()+", 0);\n        ++"+d[c-2]+";\n        "+p+" sourceLocA = "+p+"("+d.join()+", 0);\n        --"+d[c-1]+";\n        "+p+" sourceLocB = "+p+"("+d.join()+", 0);\n        --"+d[c-2]+";"}else s=c,a="\n        "+f+" sourceLocR = coords;\n        ++"+d[c-1]+";\n        "+f+" sourceLocG = coords;\n        ++"+d[c-2]+";\n        "+f+" sourceLocA = coords;\n        --"+d[c-1]+";\n        "+f+" sourceLocB = coords;\n        --"+d[c-2]+";";var g=["x","y","z","w","u","v"].slice(0,s),m="."+g[s-1],y=g.map(function(k){return"int "+k}),w=Do("sourceLocR",s-1).concat("inIdx.r"),b=Do("sourceLocG",s-1).concat("inIdx.g"),C=Do("sourceLocB",s-1).concat("inIdx.b"),_=Do("sourceLocA",s-1).concat("inIdx.a"),D="max"===e?"greaterThan":"lessThan",E=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+w.join()+"),\n                             getBestIndicesAChannel("+b.join()+"),\n                             getBestIndicesAChannel("+C.join()+"),\n                             getBestIndicesAChannel("+_.join()+")));",A="vec4(\n            getAChannel("+w.join()+"),\n            hasNextCol ? getAChannel("+b.join()+") : 0.,\n            hasNextRow ? getAChannel("+C.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+_.join()+") : 0.)",P=r?"":"\n      float getBestIndicesAChannel("+y.join()+") {\n        return getChannel(getBestIndicesA("+g.join()+"),\n                                          vec2("+g.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+y.join()+") {\n        return getChannel(getA("+g.join()+"),\n                               vec2("+g.slice(-2).join()+"));\n      }\n      "+P+"\n      void main() {\n        "+f+" coords = getOutputCoords();\n        bool hasNextCol = "+d[c-1]+" < "+(u[c-1]-1)+";\n        bool hasNextRow = "+d[c-2]+" < "+(u[c-2]-1)+";\n        "+a+"\n        ivec4 srcIdx = ivec4(sourceLocR"+m+", sourceLocG"+m+",\n          sourceLocB"+m+", sourceLocA"+m+") * "+n+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+A+";\n\n        for (int i = 0; i < "+n+"; i++) {\n          inIdx = srcIdx;\n          "+E+"\n          vec4 candidate = "+A+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+D+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},O5=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var s=t.effectiveFilterHeight,u=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(s-1-t.padInfo.top)+", "+(u-1-t.padInfo.left)+");\n      const float avgMultiplier = float("+1/(t.filterHeight*t.filterWidth)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+";\n            wC+= "+t.dilationWidth+") {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},L5=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var f=t.effectiveFilterDepth,d=t.effectiveFilterHeight,p=t.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(f-1-t.padInfo.front)+", "+(d-1-t.padInfo.top)+", "+(p-1-t.padInfo.left)+");\n      const float avgMultiplier = float("+1/(t.filterDepth*t.filterHeight*t.filterWidth)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+f+";\n            wD += "+t.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+t.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+d+";\n              wR += "+t.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+p+";\n                wC += "+t.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},B5=function(t,n,e,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],ct(t,n),ct(t,e);var a="0.0";null!=r&&(ct(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";null!=o&&(ct(t,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+a+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+i+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},V5=function(t,n,e,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ct(t,n),ct(t,e);var a="vec4(0.0)";null!=r&&(ct(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=o&&(ct(t,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = "+a+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+i+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},Xk=function(t,n,e){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ct(n,e),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+t+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},NE="return a + b;",FE="return a - b;",Yk="return a * b;",Qk="return (a < 0.) ? b * a : a;",vn=function(t,n,e){this.variableNames=["A","B"],this.outputShape=ct(n,e),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+t+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},Zk="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",_s=function(t,n,e,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ct(n,e);var o=this.outputShape.length,i="";if(r)if(0===o||1===_e(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i="\n          "+Kt(o)+" coords = getOutputCoords();\n        ",1===o)i+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var a=Do("coords",o);i+="\n            bool nextRowOutOfBounds =\n              ("+a[o-2]+" + 1) >= "+this.outputShape[o-2]+";\n            bool nextColOutOfBounds =\n              ("+a[o-1]+" + 1) >= "+this.outputShape[o-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+i+"\n\n        setOutput(result);\n      }\n    "},H5=function(){function t(n){this.variableNames=["A"],this.outputShape=n,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(n,e){var r=this;return function(o,i){null==r.minLoc&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,n),o.gl.uniform1f(r.maxLoc,e)}},t}(),j5=function(){function t(n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(n,e){var r=this;return function(o,i){null==r.minLoc&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,n),o.gl.uniform1f(r.maxLoc,e)}},t}(),z5=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},$5=function(t){this.outputShape=[],this.outputShape=Xc(t,1),this.variableNames=t.map(function(s,u){return"T"+u});var n=new Array(t.length-1);n[0]=t[0][1];for(var e=1;e<n.length;e++)n[e]=n[e-1]+t[e][1];var r=["if (yC < "+n[0]+") setOutput(getT0(yR, yC));"];for(e=1;e<n.length;e++)r.push("else if (yC < "+n[e]+") setOutput(getT"+e+"(yR, yC-"+n[e-1]+"));");r.push("else setOutput(getT"+n.length+"(yR, yC-"+n[n.length-1]+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},G5=function(t,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Xc(t,n);var e=this.outputShape,r=e.length,o=Kt(r),i=Do("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map(function(w,b){return"T"+b});var s=new Array(t.length-1);s[0]=t[0][n];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][n];var c=a[n],f=a.slice(-2),d=a.join(),p="if ("+c+" < "+s[0]+") {\n        return getChannel(\n            getT0("+d+"), vec2("+f.join()+"));\n        }";for(u=1;u<s.length;u++){var g=s[u-1];p+="\n        if ("+c+" < "+s[u]+"  && "+c+" >= "+s[u-1]+") {\n          return getChannel(\n            getT"+u+"("+Nw(a,c,g)+"),\n            vec2("+Nw(f,c,g)+"));\n        }"}var y=s[s.length-1];p+="\n        return getChannel(\n          getT"+s.length+"("+Nw(a,c,y)+"),\n          vec2("+Nw(f,c,y)+"));",this.userCode="\n      float getValue("+a.map(function(w){return"int "+w})+") {\n        "+p+"\n      }\n\n      void main() {\n        "+o+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+i+"), 0., 0., 0.);\n\n        "+i[r-1]+" = "+i[r-1]+" + 1;\n        if ("+i[r-1]+" < "+e[r-1]+") {\n          result.g = getValue("+i+");\n        }\n\n        "+i[r-2]+" = "+i[r-2]+" + 1;\n        if ("+i[r-2]+" < "+e[r-2]+") {\n          result.a = getValue("+i+");\n        }\n\n        "+i[r-1]+" = "+i[r-1]+" - 1;\n        if ("+i[r-2]+" < "+e[r-2]+" &&\n            "+i[r-1]+" < "+e[r-1]+") {\n          result.b = getValue("+i+");\n        }\n        setOutput(result);\n      }\n    "};function Nw(t,n,e){var r=t.indexOf(n);return t.map(function(o,i){return i===r?o+" - "+e:o}).join()}var q5=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              if ("+("channelsLast"===t.dataFormat)+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},K5=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,e=t.filterWidth,i="channelsLast"===t.dataFormat;this.userCode="\n      const ivec2 pads = ivec2("+(n-1-t.padInfo.top)+", "+(e-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+(i?3:1)+"];\n\n        ivec2 dyCorner = ivec2(coords["+(i?1:2)+"], coords["+(i?2:3)+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+n+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+n+" - 1 - wR;\n\n          for (int wC = 0; wC < "+e+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+e+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n\n              if ("+i+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},X5=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yF = 0; yF < "+t.outDepth+"; yF++) {\n            int xF = wF + yF * "+t.strideDepth+" - "+t.padInfo.front+";\n\n            if (xF < 0 || xF >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n              int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n                int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Y5=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,e=t.filterHeight,r=t.filterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(n-1-t.padInfo.front)+", "+(e-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+n+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+t.strideDepth+".0;\n\n          if (dyF < 0.0 || dyF >= "+t.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+n+" - 1 - wF;\n\n          for (int wR = 0; wR < "+e+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+e+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Q5=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+t.outChannels/t.inChannels+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Z5=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,e=t.filterWidth,s=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+(n-1-t.padInfo.top)+", "+(e-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+n+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+n+" - 1 - wR;\n\n          for (int wC = 0; wC < "+e+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+e+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Jk=function(t,n,e,r){void 0===n&&(n=!1),void 0===e&&(e=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,i=t.padInfo.left,a=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,f=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),g=t.inChannels%4,m="channelsLast"===t.dataFormat,y=m?1:2,w=m?2:3,b=m?3:1,C="",_="";e&&(C=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+e+"\n        }":"\n          float activation(float x) {\n            "+e+"\n          }\n        ",_="result = activation(result);");var D=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+C+"\n\n      const ivec2 strides = ivec2("+a+", "+s+");\n      const ivec2 pads = ivec2("+o+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+b+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+y+"], coords["+w+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+f+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+d+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+p+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+m+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===g)+") {\n\n              if ("+m+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+p+") *\n                    getW(wR, wC, "+p+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+p+", xR, xC) *\n                    getW(wR, wC, "+p+", d2);\n              }\n\n            } else if ("+(2===g)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+p+", d2),\n                getW(wR, wC, "+p+" + 1, d2)\n              );\n\n              if ("+m+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+p+"),\n                  getX(batch, xR, xC, "+p+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+p+", xR, xC),\n                  getX(batch, "+p+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===g)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+p+", d2),\n                getW(wR, wC, "+p+" + 1, d2),\n                getW(wR, wC, "+p+" + 2, d2)\n              );\n\n              if ("+m+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+p+"),\n                  getX(batch, xR, xC, "+p+" + 1),\n                  getX(batch, xR, xC, "+p+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+p+", xR, xC),\n                  getX(batch, "+p+" + 1, xR, xC),\n                  getX(batch, "+p+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+D+"\n        "+_+"\n        setOutput(result);\n      }\n    "},J5=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,e=t.padInfo.top,r=t.padInfo.left,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,f=t.filterDepth,d=t.filterHeight,p=t.filterWidth,g=4*Math.floor(t.inChannels/4),m=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+o+", "+i+", "+a+");\n      const ivec3 pads = ivec3("+n+", "+e+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+f+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+d+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+p+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+g+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===m)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+g+") *\n                  getW(wF, wR, wC, "+g+", d2);\n              } else if ("+(2===m)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+g+"),\n                  getX(batch, xF, xR, xC, "+g+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+g+", d2),\n                  getW(wF, wR, wC, "+g+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===m)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+g+"),\n                  getX(batch, xF, xR, xC, "+g+" + 1),\n                  getX(batch, xF, xR, xC, "+g+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+g+", d2),\n                  getW(wF, wR, wC, "+g+" + 1, d2),\n                  getW(wF, wR, wC, "+g+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},eP=function(t,n,e,r){void 0===n&&(n=!1),void 0===e&&(e=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.inHeight,i=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,f=t.dilationHeight,d=t.dilationWidth,p=t.filterHeight,g=t.filterWidth,m=t.outChannels/t.inChannels,y="",w="";e&&(y=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+e+"\n        }":"\n          float activation(float x) {\n            "+e+"\n          }\n        ",w="result = activation(result);");var b=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+m+";\n        int q = d2 - d1 * "+m+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+p+"; wR++) {\n          int xR = xRCorner + wR * "+f+";\n\n          if (xR < 0 || xR >= "+o+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+g+"; wC++) {\n            int xC = xCCorner + wC * "+d+";\n\n            if (xC < 0 || xC >= "+i+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+b+"\n        "+w+"\n        setOutput(result);\n      }\n    "},tP=function(t,n,e,r){void 0===n&&(n=!1),void 0===e&&(e=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var o=t.inHeight,i=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,f=t.dilationHeight,d=t.dilationWidth,p=t.filterHeight,g=t.filterWidth,m=g,y="int xR; int xC; int xCOffset;",w=0;w<p;w++)for(var b=0;b<g;b++)y+="\n          vec4 xTexelR"+w+"C"+2*b+" = vec4(0.);\n          vec4 wR"+w+"C"+b+" = vec4(0.);\n          vec4 xR"+w+"C"+b+" = vec4(0.);";for(w=0;w<p;w++)for(var C=0;C<m;C++){if(y+="\n          xR = xRCorner + "+w*f+";\n          xC = xCCorner + "+(b=2*C)*d+";\n        ",1===c){if(b<g&&(y+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+o+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+w+"C"+b+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    xTexelR"+w+"C"+b+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+w+"C"+b+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+o+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+w+"C"+b+" = vec4(previous.zw, xTexelR"+w+"C"+b+".xy);\n                } else {\n                  xR"+w+"C"+b+" = vec4(0, 0, xTexelR"+w+"C"+b+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+o+" && xC >= 0 && xC < "+i+") {\n                  xTexelR"+w+"C"+b+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+w+"C"+b+" = vec4(0.);\n                }\n\n                xR"+w+"C"+b+" = xTexelR"+w+"C"+b+";\n              ",b+1<g)){var _=s%2==0?VD(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(y+="\n                  xCOffset = xC + "+s%2+" + "+_+";\n\n                  if(xR >= 0 && xR < "+o+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+w+"C"+(b+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",d>1&&(y+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+o+" &&\n                      xCOffset >= 0 && xCOffset < "+i+") {\n                      xTexelR"+w+"C"+b+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+w+"C"+b+" = vec4(0.);\n                    }\n                  "),y+="\n                  xR"+w+"C"+(b+1)+" = vec4(\n                    xTexelR"+w+"C"+b+".zw, xTexelR"+w+"C"+(b+2)+".xy);\n                "):y+="\n                  xCOffset = xC + "+_+";\n\n                  if(xR >= 0 && xR < "+o+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+w+"C"+(b+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+w+"C"+(b+1)+" = xTexelR"+w+"C"+(b+2)+";\n                "}}else b<g&&(y+="\n              if(xR >= 0 && xR < "+o+") {\n            ",s%2==1?(y+="\n                xCOffset = xC + 1 - "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+w+"C"+b+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+w+"C"+b+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+i+") {\n                  xTexelR"+w+"C"+(b+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+w+"C"+(b+2)+" = vec4(0.);\n                }\n\n                xR"+w+"C"+b+" = vec4(\n                  xTexelR"+w+"C"+b+".zw, xTexelR"+w+"C"+(b+2)+".zw);\n              ",b+1<g&&(y+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+c+";\n                  if(xCOffset >= 0 && xCOffset < "+i+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+w+"C"+(b+1)+" = vec4(xTexelR"+w+"C"+(b+2)+".xy, final.xy);\n                ")):(y+="\n                if(xC >= 0 && xC < "+i+") {\n                  xTexelR"+w+"C"+b+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+w+"C"+b+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+w+"C"+(b+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+w+"C"+(b+2)+" = vec4(0.);\n                }\n\n                xR"+w+"C"+b+" = vec4(\n                  xTexelR"+w+"C"+b+".xy, xTexelR"+w+"C"+(b+2)+".xy);\n              ",b+1<g&&(y+="\n                  xR"+w+"C"+(b+1)+" = vec4(\n                    xTexelR"+w+"C"+b+".zw, xTexelR"+w+"C"+(b+2)+".zw);\n                ")),y+="}");b<g&&(y+="\n            vec4 wTexelR"+w+"C"+b+" = getW("+w+", "+b+", d1, q);\n            wR"+w+"C"+b+" = vec4(wTexelR"+w+"C"+b+".xz, wTexelR"+w+"C"+b+".xz);\n          ",b+1<g&&(y+="\n              vec4 wTexelR"+w+"C"+(b+1)+" = getW("+w+", "+(b+1)+", d1, q);\n              wR"+w+"C"+(b+1)+" =\n                vec4(wTexelR"+w+"C"+(b+1)+".xz, wTexelR"+w+"C"+(b+1)+".xz);"))}for(w=0;w<p;w++)for(b=0;b<g;b++)y+="dotProd += xR"+w+"C"+b+" * wR"+w+"C"+b+";";var D="",E="";e&&(D=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+e+"\n        }":"vec4 activation(vec4 x) {\n          "+e+"\n        }",E="result = activation(result);");var A=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+D+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+y+"\n\n        vec4 result = dotProd;\n        "+A+"\n        "+E+"\n        setOutput(result);\n      }\n    "},e8=function(t,n,e,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=t[0],a=t[1],s=t[2],f=e[0],d=e[1];this.outputShape=[n[0],f,d,t[3]];var g=[a-1+".0",s-1+".0"],m=g[0],y=g[1],w=f>1?[""+(a-1)/(f-1),"(y2-y1) * height_ratio","y1*"+m+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+m],D=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+y+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+y];this.userCode="\n      const float height_ratio = float("+w[0]+");\n      const float width_ratio = float("+D[0]+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+i+") {\n          return;\n        }\n\n        float height_scale = "+w[1]+";\n        float width_scale = "+D[1]+";\n\n        float in_y = "+w[2]+";\n        if( in_y < 0.0 || in_y > "+m+" ) {\n          setOutput(float("+o+"));\n          return;\n        }\n        float in_x = "+D[2]+";\n        if( in_x < 0.0 || in_x > "+y+" ) {\n          setOutput(float("+o+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+("bilinear"===r?1:0)+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},t8=function(t,n,e){this.variableNames=["x"],this.outputShape=t;var r=t.length,o=t[t.length-1],i=e?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(e?"return "+o+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+Kt(r)+" coords = getOutputCoords();\n        int end = "+nP(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+o+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+i+" end) {\n            continue;\n          }\n          if (idx == end && "+n+") {\n            continue;\n          }\n          "+nP(r,"coords")+" = idx;\n          val += getX("+function(a,s){if(1===a)return""+s;if(2===a)return s+".x, "+s+".y";if(3===a)return s+".x, "+s+".y, "+s+".z";if(4===a)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function nP(t,n){if(1===t)return""+n;if(2===t)return n+".y";if(3===t)return n+".z";if(4===t)return n+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var n8=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Mg.DENSE;var n=Ng(t),e=Ur();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+tl(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+n[0]+", "+n[1]+"));\n        int index = 4 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+e.output+" = result;\n      }\n    "},r8=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Mg.DENSE;var n=Ng(t),e=Ur();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+tl(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+n[0]+", "+n[1]+"));\n        int index = 4 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+e.output+" = result;\n      }\n    "},o8=function(){function t(n,e,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=n,this.blockSize=e,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+e+";\n      int offset_h = imod(h, "+e+");\n      int in_w = w / "+e+";\n      int offset_w = imod(w, "+e+");\n      int offset_d = (offset_h * "+e+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return t.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),i8=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},a8=function(t){this.variableNames=["A"],this.outTexUsage=Po.DOWNLOAD;var n=Ur();this.outputShape=t,this.userCode="\n      "+qk+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+n.output+" = encode_float(x);\n      }\n    "},s8=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Po.DOWNLOAD;var n=Ur();this.outputShape=t,this.userCode="\n      "+qk+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+n.output+" = encode_float(x);\n      }\n    "},u8=function(t,n,e){void 0===e&&(e=!1),this.variableNames=["A"];var r=Ur(),o=n[0],i=n[1];this.outputShape=t;var a="result";e&&(a="floor(result * 255. + 0.5)"),this.userCode="\n      "+ME(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+i+";\n        int c = imod(flatIndex, "+i+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+o+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+a+", 0., 0., 0.);\n      }\n    "},c8=function(t,n,e){void 0===e&&(e=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Ur(),o=n[0],i=n[1];this.outputShape=t;var a="",s="result";e&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var f=2*u+c;a+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+t[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+t[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+i+";\n              c = imod(flatIndex, "+i+");\n              uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+o+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+f+"] = values[0];\n              } else if(offset == 1) {\n                result["+f+"] = values[1];\n              } else if(offset == 2) {\n                result["+f+"] = values[2];\n              } else {\n                result["+f+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+ME(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+a+"\n\n        "+r.output+" = "+s+";\n      }\n    "},rP=function(t,n,e){this.variableNames=["real","imag"];var r=n[1];this.outputShape=n;var o=e?"2.0 * "+Math.PI:"-2.0 * "+Math.PI;this.userCode="\n      const float exponentMultiplier = "+o+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+t+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+(e?r+".0":"1.0")+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},d8=function(){function t(n,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=n,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(n){var e=this;return function(r,o){null==e.valueLoc&&(e.valueLoc=r.getUniformLocationNoThrow(o,"value")),r.gl.uniform1f(e.valueLoc,n)}},t}(),h8=function(t,n,e){this.variableNames=["A","indices"];var r=t.slice();r[e]=n,this.outputShape=r,this.rank=r.length;var o=Kt(this.rank),i=function(a,s){var u=a.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(1===u)return"int(getIndices(resRC))";for(var c=["resRC.x","resRC.y","resRC.z","resRC.w"],f=[],d=0;d<a.length;d++)f.push(d===s?"int(getIndices("+c[d]+"))":""+c[d]);return f.join()}(t,e);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},p8=function(t,n,e){this.sliceDim=t,this.strides=n,this.variableNames=["x","indices"],this.outputShape=e;var r=Kt(n.length),o=Kt(e.length);this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+o+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+(this.sliceDim>1?"strides[j]":"strides")+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function oP(t,n){var e=Ur();return PF(t,n,e.version+"\n    precision highp float;\n    "+e.attribute+" vec3 clipSpacePos;\n    "+e.attribute+" vec2 uv;\n    "+e.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function iP(t,n){return VF(t,n,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function aP(t,n){return UF(t,n,new Uint16Array([0,1,2,2,1,3]))}function Gg(t,n,e,r,o,i,a){HF(e,r);var s=WF(t,n),u=t.TEXTURE_2D;return me(t,n,function(){return t.bindTexture(u,s)}),me(t,n,function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)}),me(t,n,function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}),me(t,n,function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)}),me(t,n,function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)}),me(t,n,function(){return t.texImage2D(u,0,o,e,r,0,i,a,null)}),me(t,n,function(){return t.bindTexture(t.TEXTURE_2D,null)}),s}function sP(t,n,e,r,o){var i=lw(e,r);return Gg(t,n,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,t.FLOAT)}function uP(t,n,e,r,o){var i=lw(e,r);return Gg(t,n,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function cP(t,n,e,r,o){var i=lw(e,r);return Gg(t,n,i[0],i[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function lP(t,n,e,r,o){var i=Fg(e,r);return Gg(t,n,i[0],i[1],o.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function fP(t,n,e,r,o){var i=Fg(e,r);return Gg(t,n,i[0],i[1],o.internalFormatPackedHalfFloat,t.RGBA,o.textureTypeHalfFloat)}function dP(t,n,e,r){return me(t,n,function(){return t.bindBuffer(t.ARRAY_BUFFER,r)}),rE(t,n,e,"clipSpacePos",r,3,20,0)&&rE(t,n,e,"uv",r,2,20,12)}function hP(t,n,e,r,o,i,a){var s,u,c;me(t,n,function(){return t.bindTexture(t.TEXTURE_2D,e)}),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=t.UNSIGNED_BYTE,c=t.RGBA):(s=new Float32Array(r*o*4),u=t.FLOAT,c=a.internalFormatPackedFloat),s.set(i),me(t,n,function(){return t.texImage2D(t.TEXTURE_2D,0,c,r,o,0,t.RGBA,u,s)}),me(t,n,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function pP(t,n,e,r){me(t,n,function(){return t.bindTexture(t.TEXTURE_2D,e)}),r.data instanceof Uint8Array?me(t,n,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)}):me(t,n,function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)}),me(t,n,function(){return t.bindTexture(t.TEXTURE_2D,null)})}function gP(t,n,e,r,o){var i=t.createBuffer();me(t,n,function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,i)});var a=16*e*r;return me(t,n,function(){return t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)}),me(t,n,function(){return t.readPixels(0,0,r,e,t.RGBA,t.FLOAT,0)}),me(t,n,function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}),i}function vP(t,n,e){var r=t,o=new Float32Array(e);return r.bindBuffer(r.PIXEL_PACK_BUFFER,n),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function mP(t,n,e,r,o){var i=lw(e,r),a=i[0],s=i[1],u=new Uint8Array(e*r*4);return me(t,n,function(){return t.readPixels(0,0,a,s,o.downloadTextureFormat,t.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function yP(t,n,e,r,o,i,a,s){var p,u=t,c=new Float32Array((p=Fg(i,a))[0]*p[1]*4);return u.bindBuffer(u.PIXEL_PACK_BUFFER,n),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function wP(t,n,e,r){var o=new Float32Array(e*r*4);return me(t,n,function(){return t.readPixels(0,0,r,e,t.RGBA,t.FLOAT,o)}),o}var g8=Object.freeze({createVertexShader:oP,createVertexBuffer:iP,createIndexBuffer:aP,createFloat32MatrixTexture:sP,createFloat16MatrixTexture:uP,createUnsignedBytesMatrixTexture:cP,createPackedMatrixTexture:lP,createFloat16PackedMatrixTexture:fP,bindVertexProgramAttributeStreams:dP,uploadDenseMatrixToTexture:hP,uploadPixelDataToTexture:pP,createBufferFromOutputTexture:gP,downloadFloat32MatrixFromBuffer:vP,downloadByteEncodedFloatMatrixFromOutputTexture:mP,downloadPackedMatrixFromBuffer:yP,downloadMatrixFromPackedOutputTexture:wP}),bP=function(){function t(n){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=K().getNumber("WEBGL_VERSION");null!=n?(this.gl=n,NF(e,n)):this.gl=Ra(e);var r="WEBGL_color_buffer_float";if(1===K().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=kg(this.gl,this.debug,"OES_texture_float"),Lo(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=kg(this.gl,this.debug,"OES_texture_half_float");else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Lo(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=kg(this.gl,this.debug,"EXT_color_buffer_half_float");else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(Lo(this.gl,r="EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Lo(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=iP(this.gl,this.debug),this.indexBuffer=aP(this.gl,this.debug),this.framebuffer=jF(this.gl,this.debug),this.textureConfig=nE(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return K().getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var n=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;me(e,this.debug,function(){return e.finish()}),me(e,this.debug,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),me(e,this.debug,function(){return e.deleteFramebuffer(n.framebuffer)}),me(e,this.debug,function(){return e.bindBuffer(e.ARRAY_BUFFER,null)}),me(e,this.debug,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}),me(e,this.debug,function(){return e.deleteBuffer(n.indexBuffer)}),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(n,e){return this.throwIfDisposed(),sP(this.gl,this.debug,n,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(n,e){return this.throwIfDisposed(),uP(this.gl,this.debug,n,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(n,e){return this.throwIfDisposed(),cP(this.gl,this.debug,n,e)},t.prototype.uploadPixelDataToTexture=function(n,e){this.throwIfDisposed(),pP(this.gl,this.debug,n,e)},t.prototype.uploadDenseMatrixToTexture=function(n,e,r,o){this.throwIfDisposed(),hP(this.gl,this.debug,n,e,r,o,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(n,e){return this.throwIfDisposed(),fP(this.gl,this.debug,n,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(n,e){return this.throwIfDisposed(),lP(this.gl,this.debug,n,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(n){var e=this;this.throwIfDisposed(),this.outputTexture===n&&(oE(this.gl,this.debug,this.framebuffer),this.outputTexture=null),me(this.gl,this.debug,function(){return e.gl.deleteTexture(n)})},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(n,e,r){var o=this;return this.downloadMatrixDriver(n,function(){return mP(o.gl,o.debug,e,r,o.textureConfig)})},t.prototype.downloadPackedMatrixFromBuffer=function(n,e,r,o,i,a){return yP(this.gl,n,0,0,0,i,a)},t.prototype.downloadFloat32MatrixFromBuffer=function(n,e){return vP(this.gl,n,e)},t.prototype.createBufferFromTexture=function(n,e,r){this.bindTextureToFrameBuffer(n);var o=gP(this.gl,this.debug,e,r);return this.unbindTextureToFrameBuffer(),o},t.prototype.createAndWaitForFence=function(){var n=this.createFence(this.gl);return this.pollFence(n)},t.prototype.createFence=function(n){var e,r,o=this;if(K().getBool("WEBGL_FENCE_API_ENABLED")){var i=n,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);n.flush(),r=function(){var s=i.clientWaitSync(a,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},e=a}else K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),r=function(){return o.isQueryAvailable(e,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:e,isFencePassed:r}},t.prototype.downloadMatrixFromPackedTexture=function(n,e,r){var o=this;return this.downloadMatrixDriver(n,function(){return wP(o.gl,o.debug,e,r)})},t.prototype.createProgram=function(n){this.throwIfDisposed();var e=this.gl,r=OF(e,this.debug,n),o=oP(e,this.debug),i=LF(e,this.debug);return me(e,this.debug,function(){return e.attachShader(i,o)}),me(e,this.debug,function(){return e.attachShader(i,r)}),BF(e,this.debug,i),this.debug&&hw(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=dP(e,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(n){var e=this;this.throwIfDisposed(),n===this.program&&(this.program=null),null!=n&&me(this.gl,this.debug,function(){return e.gl.deleteProgram(n)})},t.prototype.setProgram=function(n){var e=this;this.throwIfDisposed(),this.program=n,null!=this.program&&this.debug&&hw(this.gl,this.debug,this.program),me(this.gl,this.debug,function(){return e.gl.useProgram(n)})},t.prototype.getUniformLocation=function(n,e,r){return void 0===r&&(r=!0),this.throwIfDisposed(),r?$F(this.gl,this.debug,n,e):GF(this.gl,n,e)},t.prototype.getAttributeLocation=function(n,e){var r=this;return this.throwIfDisposed(),me(this.gl,this.debug,function(){return r.gl.getAttribLocation(n,e)})},t.prototype.getUniformLocationNoThrow=function(n,e){return this.throwIfDisposed(),this.gl.getUniformLocation(n,e)},t.prototype.setInputMatrixTexture=function(n,e,r){this.throwIfDisposed(),this.throwIfNoProgram(),qF(this.gl,this.debug,0,n,e,r)},t.prototype.setOutputMatrixTexture=function(n,e,r){this.setOutputMatrixTextureDriver(n,r,e)},t.prototype.setOutputPackedMatrixTexture=function(n,e,r){this.throwIfDisposed();var o=Fg(e,r);this.setOutputMatrixTextureDriver(n,o[0],o[1])},t.prototype.setOutputMatrixWriteRegion=function(n,e,r,o){this.setOutputMatrixWriteRegionDriver(r,n,o,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(n,e,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&hw(this.gl,this.debug,this.program),Pg(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var n=this.gl;this.debug&&this.debugValidate(),me(n,this.debug,function(){return n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0)})},t.prototype.blockUntilAllProgramsCompleted=function(){var n=this;this.throwIfDisposed(),me(this.gl,this.debug,function(){return n.gl.finish()})},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=kg(this.gl,this.debug,2===K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(2===K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var n=this.gl,e=this.getQueryTimerExtensionWebGL2(),r=n.createQuery();return n.beginQuery(e.TIME_ELAPSED_EXT,r),r}var o=this.getQueryTimerExtensionWebGL1(),i=o.createQueryEXT();return o.beginQueryEXT(o.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(2!==K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var n=this.getQueryTimerExtensionWebGL1();n.endQueryEXT(n.TIME_ELAPSED_EXT)}else{var e=this.gl,r=this.getQueryTimerExtensionWebGL2();e.endQuery(r.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(n){return be(this,void 0,void 0,function(){var e=this;return xe(this,function(r){switch(r.label){case 0:return[4,UD(function(){return e.disposed||e.isQueryAvailable(n,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(n,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},t.prototype.getQueryTime=function(n,e){if(0===e)return null;if(2===e){var r=this.gl;return r.getQueryParameter(n,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(n,o.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(n,e){if(0===e)return!0;if(2===e){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(n,r.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(n,o.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(n){var e=this;return new Promise(function(r){e.addItemToPoll(function(){return n.isFencePassed()},function(){return r()})})},t.prototype.pollItems=function(){for(var n=function(r){for(var o=0;o<r.length&&r[o]();++o);return o-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),e=0;e<=n;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(n+1)},t.prototype.addItemToPoll=function(n,e){var r=this;this.itemsToPoll.push({isDoneFn:n,resolveFn:e}),this.itemsToPoll.length>1||UD(function(){return r.pollItems(),0===r.itemsToPoll.length})},t.prototype.bindTextureToFrameBuffer=function(n){this.throwIfDisposed(),pw(this.gl,this.debug,n,this.framebuffer),this.debug&&Pg(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(pw(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Pg(this.gl)):oE(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(n,e){this.bindTextureToFrameBuffer(n);var r=e();return this.unbindTextureToFrameBuffer(),r},t.prototype.setOutputMatrixTextureDriver=function(n,e,r){this.throwIfDisposed();var o=this.gl;pw(o,this.debug,n,this.framebuffer),this.debug&&Pg(o),this.outputTexture=n,me(o,this.debug,function(){return o.viewport(0,0,e,r)}),me(o,this.debug,function(){return o.scissor(0,0,e,r)})},t.prototype.setOutputMatrixWriteRegionDriver=function(n,e,r,o){var i=this;this.throwIfDisposed(),me(this.gl,this.debug,function(){return i.gl.scissor(n,e,r,o)})},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},t}();function xP(t,n){if(t.length!==n.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+n.length+" inputs");t.forEach(function(e,r){var o=e.logicalShape,i=n[r],a=i.shape;if(!Fn(o,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+a+" must match");if(!e.isUniform||!i.isUniform){var s=e.texShape,u=i.isUniform?null:i.texData.texShape;if(!Fn(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var v8=function(t,n,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var o=e.inChannels,i=e.strideWidth,a=e.strideHeight,s=e.padInfo,u=e.outWidth,c=e.dilationWidth,f=e.dilationHeight,d=e.dataFormat,p=s.left,g=s.top,m=o*e.filterWidth,y=Ur(),w="channelsLast"===d,b=w?0:1,C=w?1:2,_="",D=0;D<=1;D++)for(var E=0;E<=1;E++)_+="\n          blockIndex = rc.y + "+E+";\n          pos = rc.x + "+D+";\n\n          if(blockIndex < "+t[1]+" && pos < "+t[0]+") {\n            offsetY = int(blockIndex / ("+u+")) * "+a+" - "+g+";\n            d0 = offsetY + "+f+" * (pos / "+m+");\n\n            if(d0 < "+n[b]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+u+".) * "+i+". - "+p+".);\n              d1 = offsetX + "+c+" * (int(mod(float(pos), "+m+".) / "+o+".));\n\n              if(d1 < "+n[C]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+o+".));\n\n                if ("+w+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*D+E)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*D+E)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+_+"\n\n        "+y.output+" = result;\n      }\n    "},m8=function(t,n,e,r,o){this.variableNames=["x"],this.outputShape=[];var a=n,s=t[3]-1;this.outputShape=t;var u="float("+e+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+a+"; j <= "+a+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+(.5===o?"inversesqrt("+u+")":1===o?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));")+";\n        setOutput(val);\n      }\n    "},y8=function(t,n,e,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=e,this.alpha=r,this.beta=o,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+n+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+n+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+e+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+o+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+o+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},w8=function(t,n,e,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var a=n,s=t[3]-1;this.outputShape=t;var u="float("+e+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+a+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+a+"; j <= "+a+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+(.5===o?"inversesqrt("+u+")":1===o?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));")+";\n        setOutput(result);\n      }\n    "},b8=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var o=t.effectiveFilterHeight,i=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(o-1-t.padInfo.top)+", "+(i-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+o+";\n          wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+i+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+(o*i-1)+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+i+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},x8=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(s-1-t.padInfo.front)+", "+(u-1-t.padInfo.top)+", "+(c-1-t.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+t.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+t.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+t.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+t.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+(s*u*c-1)+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+u+" * "+c+" +\n                  wR * "+c+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},kE=function(t,n,e,r,o,i,a){void 0===e&&(e=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===i&&(i=null),void 0===a&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;var u=Math.ceil((e?t[1]:t[2])/2),c=e?"i * 2, rc.y":"rc.y, i * 2",f=r?"rc.z, i * 2":"i * 2, rc.z",d=e?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",m="";i&&(g=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"vec4 activation(vec4 x) {\n          "+i+"\n        }",m="result = activation(result);");var y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+g+"\n\n      const float sharedDimension = "+u+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+u+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+c+");\n          vec4 b = getMatrixB(rc.x, "+f+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+d[0]+" * "+p[0]+");\n          result += ("+d[1]+" * "+p[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+y+"\n\n        "+m+"\n\n        setOutput(result);\n      }\n    "},_8=function(){function t(n,e,r){this.variableNames=["probs"],this.outputShape=[n,r],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(n){var e=this;return function(r,o){null==e.seedLoc&&(e.seedLoc=r.getUniformLocation(o,"seed")),r.gl.uniform1f(e.seedLoc,n)}},t}(),C8=function(t,n,e,r){this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+e+"),\n                      float(index == coords.y)));\n      }\n    "},D8=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var s,c,f,n=t.length;if(0===n)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var e=Do("rc",n),r=Kt(n),o=function(s,u,c){if(1===s)return"rc > "+u[0];for(var f="",d=s-2;d<s;d++)f+=c[d]+" >= "+u[d],d<s-1&&(f+="||");return f}(n,t,e),i=function(s,u,c,f){if(1===s)return"";var d=f.slice(-2);return"\n    int r = "+d[0]+";\n    int c = "+d[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+u+";\n    bool rEdge = rp1 >= "+c+";\n  "}(n,t[t.length-1],t[t.length-2],e),a=(f=function(d,p){for(var g=[],m=0;m<=1;m++)for(var y=0;y<=1;y++){for(var w=(0===m?"r":"rp1")+", "+(0===y?"c":"cp1"),b=2;b<d;b++)w=p[p.length-1-b]+","+w;g.push(w)}return g}(c=(s=t).length,e),1===c?"getA(rc),\n            rc + 1 >= "+s[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+f[0]+"),\n          cEdge ? 0. : getA("+f[1]+"),\n          rEdge ? 0. : getA("+f[2]+"),\n          rEdge || cEdge ? 0. : getA("+f[3]+")");this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+o+") {\n            setOutput(vec4(0));\n          } else {\n            "+i+"\n\n            setOutput(vec4("+a+"));\n          }\n        }\n      "}},E8=function(t,n,e){this.variableNames=["x"],this.outputShape=n.map(function(u,c){return u[0]+t[c]+u[1]});var r=t.length,o=Kt(r),i=n.map(function(u){return u[0]}).join(","),a=n.map(function(u,c){return u[0]+t[c]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+o+" start = "+o+"("+i+");\n      "+o+" end = "+o+"("+a+");\n\n      void main() {\n        "+o+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+e+"));\n        } else {\n          "+o+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+i+";\n        int end = "+a+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+e+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},I8=function(t,n,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map(function(w,b){return w[0]+t[b]+w[1]});for(var r=t.length,o=Kt(r),i=n.map(function(w){return w[0]}).join(","),a=n.map(function(w,b){return w[0]+t[b]}).join(","),s=Do("rc",r),u=Do("source",r),c=s[r-1]+" < "+this.outputShape[r-1],f=1===r?"source":"vec2("+u.slice(-2).join()+")",d=[o+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],p=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",g="",m=0,y=1===r?2:4;m<y;m++)g+="\n        "+d[m]+"\n        if ("+p+") {\n          result["+m+"] = float("+e+");\n        } else {\n          "+o+" source = rc - start;\n          result["+m+"] = getChannel(getX("+u.join()+"), "+f+");\n        }\n      ";this.userCode="\n      const "+o+" start = "+o+"("+i+");\n      const "+o+" end = "+o+"("+a+");\n\n      void main() {\n        "+o+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+(g+=1===r?"} ":"}}")+"\n        setOutput(result);\n      }\n    "},PE=function(t,n,e){if(this.variableNames=["x"],"avg"===n&&e)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,o=t.strideHeight,i=t.strideWidth,a=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,f=t.padInfo.top,d=t.padInfo.left;this.outputShape=t.outShape;var p="avg"===n,g="0.0";if(p||(g="-1.0 / 1e-20"),e)this.userCode="\n        const ivec2 strides = ivec2("+o+", "+i+");\n        const ivec2 pads = ivec2("+f+", "+d+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+a+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+c+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var m=n+"("+n+"("+n+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(m="avgValue / count");var y=4*Math.floor(r/4),w=r%4,b="\n      if ("+p+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+i+");\n      const ivec2 pads = ivec2("+f+", "+d+");\n      const float initializationValue = "+g+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+g+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+a+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+y+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+b+"\n          }\n\n          int xC = xCCorner + "+y+";\n          if ("+(1===w)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+b+"\n          } else if ("+(2===w)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+b+"\n          } else if ("+(3===w)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+b+"\n          }\n        }\n        setOutput("+m+");\n      }\n    "}},OE=function(t,n,e){if(this.variableNames=["x"],"avg"===n&&e)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,o=t.strideDepth,i=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,f=t.effectiveFilterDepth,d=t.effectiveFilterHeight,p=t.effectiveFilterWidth,g=t.padInfo.front,m=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;var w="avg"===n,b="0.0";if(w||(b="-1.0 / 1e-20"),e)this.userCode="\n        const ivec3 strides =\n            ivec3("+o+", "+i+", "+a+");\n        const ivec3 pads = ivec3("+g+", "+m+", "+y+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+f+";\n              wD += "+s+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+d+";\n                wR += "+u+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+p+";\n                  wC += "+c+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+d+" * "+p+" +\n                      wR * "+p+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var C=n+"("+n+"("+n+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(C="avgValue / count");var _=4*Math.floor(r/4),D=r%4,E="\n      if ("+w+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+o+", "+i+", "+a+");\n      const ivec3 pads = ivec3("+g+", "+m+", "+y+");\n      const float initializationValue = "+b+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+b+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+f+";\n            wD += "+s+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+d+";\n            wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+_+"; wC += 4) {\n              int xC = xCCorner + wC * "+c+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+c+", ch)\n              );\n\n              "+E+"\n            }\n\n            int xC = xCCorner + "+_+";\n            if ("+(1===D)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+E+"\n            } else if ("+(2===D)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+E+"\n            } else if ("+(3===D)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                initializationValue\n              );\n\n              "+E+"\n            }\n          }\n          setOutput("+C+");\n        }\n      }\n    "}},S8=function(t,n){this.variableNames=["x"];var e=t.windowSize,r=t.batchSize,o=t.inSize,i=Math.ceil(o/e);this.outputShape=[r,i];var a="0.0",s="";"prod"===n?a="1.0":"min"===n?(a="1.0 / 1e-20",s="min"):"max"===n&&(a="-1.0 / 1e-20",s="max");var u=n+"("+n+"("+n+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?u="sumValue":"prod"===n?u="prodValue":"all"===n?u="allValue":"any"===n&&(u="anyValue");var c=4*Math.floor(e/4),f=e%4,d="\n      if ("+("sum"===n)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===n)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",p="vec4";"all"===n?(a="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",p="bvec4"):"any"===n&&(a="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",p="bvec4");var g="";o%e>0&&(g="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+a+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+g+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+e+";\n\n        vec4 minMaxValue = vec4("+a+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+d+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===f)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+d+"\n        } else if ("+(2===f)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+d+"\n        } else if ("+(3===f)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+d+"\n        }\n        setOutput("+u+");\n      }\n    "},A8=function(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var e="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),e+="\n        "+o+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+tl(["r","c","d"],n)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+ME(t)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+t[1]+";\n        int cols = "+t[2]+";\n\n        "+e+"\n\n        setOutput(result);\n      }\n    "},T8=function(t,n,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n.shape;var r=n.shape,o=r[1],i=r[2],a=t.shape,s=a[1],u=a[2],c=[e&&s>1?o-1:o,e&&u>1?i-1:i],f=[e&&s>1?s-1:s,e&&u>1?u-1:u],d=c[0]/f[0],p=c[1]/f[1],g=1/d,m=1/p,y=2*Math.ceil(g)+2,w=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+d+");\n        const float widthScale = float("+p+");\n\n        const float invHeightScale = float("+g+");\n        const float invWidthScale = float("+m+");\n\n        const int winHeight = int("+y+");\n        const int winWidth = int("+w+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(o-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(i-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},R8=function(t,n,e,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],a=t[2];this.outputShape=[t[0],n,e,t[3]];var u=[r&&n>1?i-1:i,r&&e>1?a-1:a],c=[r&&n>1?n-1:n,r&&e>1?e-1:e];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},M8=function(t,n,e,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=t[1],a=t[2],s=t[3];this.outputShape=[t[0],n,e,s];var u=[r&&n>1?i-1:i,r&&e>1?a-1:a],c=[r&&n>1?n-1:n,r&&e>1?e-1:e];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+",\n          "+u[1]/c[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+a+".0,\n                                     "+a+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+";\n        bool hasNextRow = coords.z < "+(e-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},N8=function(t,n,e){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n.shape;var r=n.shape,o=r[1],i=r[2],a=t.shape,s=a[1],u=a[2],c=[e&&s>1?o-1:o,e&&u>1?i-1:i],f=[e&&s>1?s-1:s,e&&u>1?u-1:u],d=c[0]/f[0],p=c[1]/f[1],g=1/d,m=1/p,y=2*Math.ceil(g)+2,w=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+d+");\n        const float widthScale = float("+p+");\n\n        const float invHeightScale = float("+g+");\n        const float invWidthScale = float("+m+");\n\n        const int winHeight = int("+y+");\n        const int winWidth = int("+w+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+f[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+f[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+o+") - 1),\n                "+e+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+i+") - 1),\n                "+e+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},F8=function(t,n,e,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],a=t[2];this.outputShape=[t[0],n,e,t[3]];var u=[r&&n>1?i-1:i,r&&e>1?a-1:a],c=[r&&n>1?n-1:n,r&&e>1?e-1:e];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+(r?"0.5":"0.0")+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},k8=function(t,n){this.variableNames=["x"];var e=t.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");if(this.outputShape=t,1!==e){var r=t.map(function(i,a){return-1!==n.indexOf(s=a)&&1!==t[s]?t[s]+" - coords["+s+"] - 1":"coords["+s+"]";var s}).join(","),o=Kt(e);this.userCode="\n      void main() {\n        "+o+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+t[0]+" - coord - 1));\n        }\n      "},P8=function(t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var e=t.length;if(e>4)throw new Error("WebGL backend: Reverse of rank-"+e+" tensor is not yet supported");this.outputShape=t;var u,r=Do("rc",e),o=r[e-1]+" + 1 < "+this.outputShape[e-1],i=r[e-2]+" + 1 < "+this.outputShape[e-2],a=Kt(e);function s(u){var c=t.map(function(f,d){return g=u,-1!==n.indexOf(p=d)&&1!==t[p]?t[p]+" - "+g[p]+" - 1":""+g[p];var p,g});return"getChannel(getX("+c.join(",")+"), vec2("+c.slice(-2).join(",")+"))"}this.userCode=1===e?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+t[0]+" - rc - 1),\n            "+t[0]+" - rc - 1);\n          if("+o+"){\n              result.g = getChannel(getX("+t[0]+" - (rc  + 1) - 1),\n                "+t[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+a+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+s(r.slice())+";\n          if("+o+"){\n            result.g = "+((u=r.slice())[e-1]="("+u[e-1]+" + 1)",s(u)+";\n          }\n          if(")+i+") {\n            result.b = "+function(u){return u[e-2]="("+u[e-2]+" + 1)",s(u)}(r.slice())+";\n            if("+o+") {\n              result.a = "+function(u){return u[e-1]="("+u[e-1]+" + 1)",u[e-2]="("+u[e-2]+" + 1)",s(u)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},_P=function(t,n,e,r,o,i,a){void 0===a&&(a=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=Kt(o.length),u=Kt(i.length),c="";1===e?c="i":2===e&&(c="i, j");var d="";1===r?d="i":2===r&&(d="i, coords[1]"),this.userCode="\n        "+s+" strides = "+s+"("+o+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+t+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+n+"; j++) {\n              int index = round(getIndices("+c+"));\n              flattenedIndex += index * "+(n>1?"strides[j]":"strides")+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates("+d+");\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},O8=function(t,n){this.variableNames=["x","segmentIds"];var e=t.windowSize,r=t.batchSize,o=t.inSize,i=t.numSegments,a=i*Math.ceil(o/e);this.outputShape=[r,a];var s=4*Math.floor(e/4),u=e%4,c="\n        sumValue += dot(values, segFilter);\n    ",f="";o%e>0&&(f="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      ");var d="";o%e>0&&(d="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+f+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+d+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+i+")) * float("+e+"));\n        int currentSeg = int(mod(float(outIdx), float("+i+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},L8=function(t,n,e){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=n,e>4)throw Error("Where for rank "+e+" is not yet supported");if(1===e)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<n.length;u++)s.push(""+i[u]),u<t&&a.push(""+i[u]);r=a.join(),o=s.join()}var c=Kt(e);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+o+"));\n        } else {\n          setOutput(getB("+o+"));\n        }\n      }\n    "},B8=function(){function t(n){this.variableNames=["source"],this.outputShape=n,this.rank=n.length;var e,r=Kt(this.rank),o="uniform int start["+this.rank+"];",i=function(a){if(1===a)return"sourceLoc";if(a<=6)return LE.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);e="\n        "+r+" sourceLoc;\n        "+r+" coords = getOutputCoords();\n        "+n.map(function(a,s){return"sourceLoc."+LE[s]+" = start["+s+"] + coords."+LE[s]+";"}).join("\n")+"\n      ",this.userCode="\n      "+o+"\n      void main() {\n        "+e+"\n        setOutput(getSource("+i+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(n){var e=this;if(n.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+n.length+")");return function(r,o){null==e.startLoc&&(e.startLoc=r.getUniformLocationNoThrow(o,"start"),null==e.startLoc)||r.gl.uniform1iv(e.startLoc,n)}},t}(),LE=["x","y","z","w","u","v"],V8=function(){function t(n){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.rank=n.length;var e=Kt(this.rank),r=Do("coords",this.rank),o=Do("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2("+o.slice(-2).join()+")",a="getChannel(getSource("+o.join()+"), "+i+")",s="\n      result.x = "+a+";\n      if (++"+r[this.rank-1]+" < "+n[this.rank-1]+") {\n        ++"+o[this.rank-1]+";\n        result.y = "+a+";\n        --"+o[this.rank-1]+";\n      }\n    ",u=1===this.rank?"":"\n      --"+r[this.rank-1]+";\n      if (++"+r[this.rank-2]+" < "+n[this.rank-2]+") {\n        ++"+o[this.rank-2]+";\n        result.z = "+a+";\n        if (++"+r[this.rank-1]+" < "+n[this.rank-1]+") {\n          ++"+o[this.rank-1]+";\n          result.w = "+a+";\n        }\n      }\n    ",c=this.rank<=4?"sourceLoc = coords +\n            "+e+"("+n.map(function(f,d){return"start["+d+"]"}).join()+");":n.map(function(f,d){return o[d]+" = "+r[d]+" + start["+d+"];"}).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+e+" coords = getOutputCoords();\n        "+e+" sourceLoc;\n        "+c+"\n        vec4 result = vec4(0.);\n        "+s+"\n        "+u+"\n        setOutput(result);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(n){var e=this;if(n.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+n.length+")");return function(r,o){null==e.startLoc&&(e.startLoc=r.getUniformLocationNoThrow(o,"start"),null==e.startLoc)||r.gl.uniform1iv(e.startLoc,n)}},t}(),U8=function(t,n,e){this.variableNames=["x"],this.outputShape=e;var r=e.length,o=Kt(e.length),i=Kt(e.length),a="";if(1===r)a="coords * strides + begin";else{var s=0;a=e.map(function(u,c){return s++,1===e.length?"coords * strides["+c+"] + begin["+c+"]":"coords["+(s-1)+"] * strides["+c+"] + begin["+c+"]"}).join(",")}this.userCode="\n      "+o+" begin = "+o+"("+t+");\n      "+o+" strides = "+o+"("+n+");\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+a+"));\n      }\n    "},W8=function(){function t(n){this.gpgpu=n,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(n,e,r){var o,i=CP(e,r),a=DP(n,i,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),i===Oo.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(n[0],n[1]):i===Oo.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(n[0],n[1]):i===Oo.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(n[0],n[1]):i===Oo.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(n[0],n[1]):i===Oo.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(n[0],n[1])),this.usedTextures[a].push(o),o},t.prototype.releaseTexture=function(n,e,r,o){if(null!=this.freeTextures){var i=DP(e,CP(r,o),o);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(n),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],s=a.indexOf(n);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},t.prototype.log=function(){this.logEnabled&&console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+(this.numFreeTextures+this.numUsedTextures)+")")},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var n=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach(function(r){n.gpgpu.deleteMatrixTexture(r)});for(var e in this.usedTextures)this.usedTextures[e].forEach(function(o){n.gpgpu.deleteMatrixTexture(o)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function CP(t,n){if(t===Po.UPLOAD)return Oo.PACKED_2X2_FLOAT32;if(t===Po.RENDER||null==t)return e=n,K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Oo.PACKED_2X2_FLOAT32:Oo.UNPACKED_FLOAT32:e?Oo.PACKED_2X2_FLOAT16:Oo.UNPACKED_FLOAT16;var e;if(t===Po.DOWNLOAD||t===Po.PIXELS)return Oo.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function DP(t,n,e){return t[0]+"_"+t[1]+"_"+n+"_"+e}var H8=function(t,n){this.variableNames=["A"];for(var e=new Array(t.length),r=0;r<e.length;r++)e[r]=t[r]*n[r];this.outputShape=e,this.rank=e.length;var o=Kt(this.rank),i=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(1===s)return"imod(resRC, "+a[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],c=[],f=0;f<a.length;f++)c.push("imod("+u[f]+", "+a[f]+")");return c.join()}(t);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},j8=function(t,n){this.variableNames=["A"];for(var e=new Array(t.length),r=0;r<e.length;r++)e[r]=t[n[r]];this.outputShape=e,this.rank=e.length;var o=Kt(this.rank),i=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],c=new Array(s),f=0;f<a.length;f++)c[a[f]]=u[f];return c.join()}(n);this.userCode="\n    void main() {\n      "+o+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "},z8=function(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var e=new Array(t.length),r=0;r<e.length;r++)e[r]=t[n[r]];if(this.outputShape=e,this.rank=e.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=Kt(this.rank),i=Gk("rc",this.rank),a=new Array(this.rank);for(r=0;r<n.length;r++)a[n[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+e[this.rank-1],c="getChannel(getA("+a.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+o+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+i[this.rank-1]+";\n      if(++"+i[this.rank-2]+" < "+e[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }\n      setOutput(result);\n    }\n    "},Je=function(t,n){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        "+n+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Yi="if (isnan(x)) return x;",EP="return abs(x);",IP=Yi+"\n  return (x < 0.0) ? 0.0 : x;\n",SP=Yi+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",AP="return (x >= 0.0) ? x : (exp(x) - 1.0);",TP="return -x;",RP="return ceil(x);",MP="return floor(x);",NP="return exp(x);",FP="return exp(x) - 1.0;",Fw="return x;",kP="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",PP="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",OP="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",qg=function(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+n+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},nq=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var n=t.length,e=Do("rc",n),r=Kt(n),o=function(s,u){if(1===s)return"rc";for(var c="",f=0;f<s;f++)c+=u[f],f<s-1&&(c+=",");return c}(n,e),i=e.slice(-2),a=n<=1?"rc":"vec2("+i.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+o+");\n\n        setOutput(getChannel(packedInput, "+a+"));\n      }\n    "},kw={};function Pw(t,n){if(void 0===n&&(n=!1),"linear"===t)return"return x;";if("relu"===t)return n?kP:IP;if("elu"===t)return n?OP:AP;if("relu6"===t)return n?PP:SP;if("prelu"===t)return n?Zk:Qk;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var LP=function(t){function n(e){var r,o=t.call(this)||this;if(o.pendingRead=new WeakMap,o.pendingDisposal=new WeakSet,o.dataRefCount=new WeakMap,o.numBytesInGPU=0,o.uploadWaitMs=0,o.downloadWaitMs=0,o.warnedAboutMemory=!1,o.pendingDeletes=0,o.disposed=!1,!K().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var i=Ra(K().getNumber("WEBGL_VERSION"));o.binaryCache=((r=K().getNumber("WEBGL_VERSION"))in kw||(kw[r]={}),kw[r]),o.gpgpu=new bP(i),o.canvas=i.canvas,o.gpgpuCreatedLocally=!0}else o.gpgpu=e,o.binaryCache={},o.gpgpuCreatedLocally=!1,o.canvas=e.gl.canvas;return o.textureManager=new W8(o.gpgpu),o.numMBBeforeWarning=null==K().global.screen?1024:K().global.screen.height*K().global.screen.width*window.devicePixelRatio*600/1024/1024,o.texData=new xE(o,B),o}return ji(n,t),n.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},n.prototype.write=function(e,r,o){if(K().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===o&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:o,values:e,usage:Po.UPLOAD}),i},n.prototype.move=function(e,r,o,i){if(K().getBool("DEBUG")&&this.checkNumericalProblems(r),"complex64"===i)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:o,dtype:i,values:r,usage:Po.UPLOAD})},n.prototype.readSync=function(e){var r=this.texData.get(e),o=r.values,i=r.dtype,a=r.complexTensors,u=r.shape;if(null!=r.slice){var f;f=r.isPacked?new qg(u,Fw):new Je(u,Fw);var d=this.runWebGLProgram(f,[{dataId:e,shape:u,dtype:i}],i),p=this.readSync(d.dataId);return this.disposeData(d.dataId),p}if(null!=o)return this.convertAndCacheOnCPU(e);if("string"===i)return o;var g,m,y=null!=this.activeTimers;return y&&(g=$i()),m="complex64"===i?SE(a.real.dataSync(),a.imag.dataSync()):this.getValuesFromTexture(e),y&&(this.downloadWaitMs+=$i()-g),this.convertAndCacheOnCPU(e,m)},n.prototype.read=function(e){return be(this,void 0,void 0,function(){var r,o,i,a,u,c,f,d,p,g,m,y,w,b,C,E,A,P,k;return xe(this,function(N){switch(N.label){case 0:if(this.pendingRead.has(e))return r=this.pendingRead.get(e),[2,new Promise(function(F){return r.push(F)})];if(o=this.texData.get(e),i=o.values,a=o.shape,u=o.dtype,c=o.complexTensors,f=o.isPacked,null!=o.slice)return d=f?new qg(a,Fw):new Je(a,Fw),p=this.runWebGLProgram(d,[{dataId:e,shape:a,dtype:u}],u),g=this.read(p.dataId),this.disposeData(p.dataId),[2,g];if(null!=i)return[2,this.convertAndCacheOnCPU(e)];if(!K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===K().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return m=null,"complex64"!==u&&K().get("WEBGL_BUFFER_SUPPORTED")&&(y=this.decode(e),w=this.texData.get(y.dataId),m=(k=this.gpgpu).createBufferFromTexture.apply(k,[w.texture].concat(Ng(a)))),this.pendingRead.set(e,[]),"complex64"===u?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:N.sent(),N.label=2;case 2:return"complex64"!==u?[3,4]:[4,Promise.all([c.real.data(),c.imag.data()])];case 3:return C=N.sent(),b=SE(C[0],C[1]),[3,5];case 4:null==m?b=this.getValuesFromTexture(e):(E=_e(a),b=this.gpgpu.downloadFloat32MatrixFromBuffer(m,E)),N.label=5;case 5:return null!=y&&this.disposeData(y.dataId),A=this.convertAndCacheOnCPU(e,b),P=this.pendingRead.get(e),this.pendingRead.delete(e),P.forEach(function(F){return F(A)}),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,A]}})})},n.prototype.checkNumericalProblems=function(e){if(null!=e)for(var r=0;r<e.length;r++){var o=e[r];if(!FF(o))throw K().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+o+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+o+" cannot be represented on this device.")}},n.prototype.getValuesFromTexture=function(e){var r,o=this.texData.get(e),i=o.shape,a=o.dtype,s=o.isPacked,u=_e(i);if(K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var c=this.decode(e),f=this.texData.get(c.dataId),d=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[f.texture].concat(Ng(i))).subarray(0,u);return this.disposeData(c.dataId),d}var p=K().getBool("WEBGL_PACK")&&!0===s,g=p?gw(i):i,m=p?new s8(g):new a8(g),y=this.runWebGLProgram(m,[{shape:g,dtype:a,dataId:e}],"float32"),w=this.texData.get(y.dataId),b=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(w.texture,w.texShape[0],w.texShape[1]).subarray(0,u);return this.disposeData(y.dataId),b},n.prototype.time=function(e){return be(this,void 0,void 0,function(){var r,o,i,a,s,u,c;return xe(this,function(f){switch(f.label){case 0:return r=this.activeTimers,o=[],i=!1,null==this.programTimersStack?(this.programTimersStack=o,i=!0):this.activeTimers.push(o),this.activeTimers=o,e(),a=ms(this.activeTimers.map(function(d){return d.query})).filter(function(d){return null!=d}),s=ms(this.activeTimers.map(function(d){return d.name})).filter(function(d){return null!=d}),this.activeTimers=r,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return c=f.sent(),u.kernelMs=gF(c),u.getExtraProfileInfo=function(){return c.map(function(d,p){return{name:s[p],ms:d}}).map(function(d){return d.name+": "+d.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},f.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},n.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},n.prototype.startTimer=function(){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:$i(),endMs:null}},n.prototype.endTimer=function(e){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=$i(),e)},n.prototype.getQueryTime=function(e){return be(this,void 0,void 0,function(){var r;return xe(this,function(o){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(r=e).endMs-r.startMs]})})},n.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var r=this.texData.get(e).complexTensors;null!=r&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(e)}}},n.prototype.releaseGPUData=function(e){var r=this.texData.get(e),o=r.texture,i=r.dtype,a=r.texShape,s=r.usage,u=r.isPacked,c=r.slice,f=c&&c.origDataId||e,d=this.dataRefCount.get(f);d>1?this.dataRefCount.set(f,d-1):(this.dataRefCount.delete(f),null!=o&&(this.numBytesInGPU-=this.computeBytes(a,i),this.textureManager.releaseTexture(o,a,s,u)));var p=this.texData.get(e);p.texture=null,p.texShape=null,p.isPacked=!1,p.slice=null},n.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},n.prototype.getDataInfo=function(e){return this.texData.get(e)},n.prototype.getCPUBackend=function(){return K().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=B.findBackend("cpu")),this.cpuBackend):null},n.prototype.shouldExecuteOnCPU=function(e,r){var o=this;return void 0===r&&(r=128),null!=this.getCPUBackend()&&e.every(function(i){return null==o.texData.get(i.dataId).texture&&i.size<r})},n.prototype.getGPGPUContext=function(){return this.gpgpu},n.prototype.complex=function(e,r){var o=this.makeOutput(e.shape,"complex64");return this.texData.get(o.dataId).complexTensors={real:B.keep(e.clone()),imag:B.keep(r.clone())},o},n.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},n.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},n.prototype.slice=function(e,r,o){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,r,o);if(0===_e(o))return sr([],o,e.dtype);var i=this.texData.get(e.dataId).isPacked,a=wE(e.shape,r,o);if(i||!a){var s=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new V8(o):new B8(o),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[e],null,u)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,r,o)},n.prototype.shallowSlice=function(e,r,o){var i=this.texData.get(e.dataId),a=this.makeOutput(o,e.dtype),s=this.texData.get(a.dataId);Object.assign(s,i),s.shape=o,s.dtype=e.dtype;var u=bE(r,e.strides);i.slice&&(u+=i.slice.flatOffset),s.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||e.dataId};var c=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,c+1),a},n.prototype.stridedSlice=function(e,r,o,i){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,r,o,i);var a=Sw(r,o,i);if(a.some(function(u){return 0===u}))return sr([],a);var s=new U8(r,i,a);return this.compileAndRun(s,[e])},n.prototype.reverse=function(e,r){var o=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new P8(e.shape,r):new k8(e.shape,r);return this.compileAndRun(o,[e])},n.prototype.concat=function(e,r){if("complex64"===e[0].dtype){var o=e.map(function(g){return Bo(g)}),i=e.map(function(g){return Ki(g)});return ar(this.concat(o,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,r);if(1===e.length)return e[0];if(e.length>K().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(e.length/2),s=this.concat(e.slice(0,a),r),u=this.concat(e.slice(a),r);return this.concat([s,u],r)}if(K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var c=new G5(e.map(function(g){return g.shape}),r);return this.compileAndRun(c,e)}var f=Xc(e.map(function(g){return g.shape}),r),d=e.map(function(g){return g.as2D(-1,_e(g.shape.slice(r)))}),p=new $5(d.map(function(g){return g.shape}));return this.compileAndRun(p,d).reshape(f)},n.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,TP,e.dtype);var r=new Je(e.shape,TP);return this.compileAndRun(r,[e])},n.prototype.batchMatMul=function(e,r,o,i){var a=o?e.shape[2]:e.shape[1],s=i?r.shape[1]:r.shape[2],u=o?e.shape[1]:e.shape[2],c=e.shape[0];if((1===a||1===s)&&u>1e3){o&&(e=e.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var f=1===s?e:e.as3D(c,u,1),d=1===s?2:1,p=1===s?r.as3D(c,1,u):r;return this.multiply(f,p).sum(d,!0)}var g=ir(e.dtype,r.dtype),m=new kE(e.shape,[c,a,s],o,i);return this.compileAndRun(m,[e,r],g)},n.prototype.fusedBatchMatMul=function(e){var r=e.a,o=e.b,i=e.transposeA,a=e.transposeB,s=e.bias,u=e.activation,c=e.preluActivationWeights,f=i?r.shape[2]:r.shape[1],d=a?o.shape[1]:o.shape[2],p=r.shape[0],g=ir(r.dtype,o.dtype),m=null!=s,y=null!=c,w=u?Pw(u,!0):null,b=new kE(r.shape,[p,f,d],i,a,m,w,y),C=[r,o];return s&&C.push(s),c&&C.push(c),this.compileAndRun(b,C,g)},n.prototype.multiply=function(e,r){if("complex64"===e.dtype){var o=this.texData.get(e.dataId),i=this.texData.get(r.dataId),a=new Xk("return areal * breal - aimag * bimag;",e.shape,r.shape),s=new Xk("return areal * bimag + aimag * breal;",e.shape,r.shape),u=[this.makeComplexComponentTensorInfo(e,o.complexTensors.real),this.makeComplexComponentTensorInfo(e,o.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],c=this.compileAndRun(a,u),f=this.compileAndRun(s,u),d=this.complex(c,f);return c.dispose(),f.dispose(),d}if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.multiply(e,r);if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,Yk,e.dtype);var p=new vn(Yk,e.shape,r.shape);return this.compileAndRun(p,[e,r],e.dtype)},n.prototype.batchNormalization=function(e,r,o,i,a,s){var u=[e,r,o],c=null;null!=s&&(c=s.shape,u.push(s));var f=null;if(null!=a&&(f=a.shape,u.push(a)),K().getBool("WEBGL_PACK_NORMALIZATION")){var d=new V5(e.shape,r.shape,o.shape,c,f,i);return this.compileAndRun(d,u)}var p=new B5(e.shape,r.shape,o.shape,c,f,i);return this.compileAndRun(p,u)},n.prototype.localResponseNormalization4D=function(e,r,o,i,a){var s=K().getBool("WEBGL_PACK_NORMALIZATION")?new w8(e.shape,r,o,i,a):new m8(e.shape,r,o,i,a);return this.compileAndRun(s,[e])},n.prototype.LRNGrad=function(e,r,o,i,a,s,u){var c=new y8(r.shape,i,a,s,u);return this.compileAndRun(c,[r,o,e])},n.prototype.tile=function(e,r){if("string"===e.dtype){var o=this.readSync(e.dataId).map(function(a){return Sg(a)});return zk(Ge(e.shape,e.dtype,o),r)}var i=new H8(e.shape,r);return this.compileAndRun(i,[e])},n.prototype.pad=function(e,r,o){var i=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new I8(e.shape,r,o):new E8(e.shape,r,o);return this.compileAndRun(i,[e])},n.prototype.transpose=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,r);var o=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new z8(e.shape,r):new j8(e.shape,r);return this.compileAndRun(o,[e])},n.prototype.gather=function(e,r,o){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.gather(e,r,o);var i=new h8(e.shape,r.size,o);return this.compileAndRun(i,[e,r])},n.prototype.batchToSpaceND=function(e,r,o){M(e.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(d,p){return d*p}),a=Cw(e.shape,r,i),s=Dw(a.length,r.length),u=Ew(e.shape,r,i),c=Mk(o,r.length),f=Nk(u,o,r.length);return e.reshape(a).transpose(s).reshape(u).slice(c,f)},n.prototype.spaceToBatchND=function(e,r,o){M(e.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(p,g){return p*g}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<e.shape.length;++s)a.push([0,0]);var u=e.pad(a),c=Cw(u.shape,r,i,!1),f=Dw(c.length,r.length,!1),d=Ew(u.shape,r,i,!1);return u.reshape(c).transpose(f).reshape(d)},n.prototype.reduce=function(e,r,o){var i=e.shape[0],a=e.shape[1],s=Iw(a),u=new S8({windowSize:s,inSize:a,batchSize:i},r),c=this.compileAndRun(u,[e],o);return 1===c.shape[1]?c:this.reduce(c,r,o)},n.prototype.argReduce=function(e,r,o){void 0===o&&(o=null);var i=e.shape[0],a=e.shape[1];null!=o&&(i=o.shape[0],a=o.shape[1]);var s=Iw(a),u=new T5({windowSize:s,inSize:a,batchSize:i},r,null==o),c=[e];null!=o&&c.push(o);var f=this.compileAndRun(u,c,"int32");return 1===f.shape[1]?f:this.argReduce(e,r,f)},n.prototype.argReducePacked=function(e,r,o){void 0===o&&(o=null);var i=null!=o?o.shape:e.shape,a=Iw(i[i.length-1]),s=new P5(i,a,r,null==o),c=this.compileAndRun(s,null==o?[e]:[e,o],"int32");return c.rank===e.rank?this.argReducePacked(e,r,c):c},n.prototype.sum=function(e,r){_o("sum",r,e.rank);var o=Ir(e.shape,r),i=o[0],a=_e(o[1]),s=e.as2D(-1,a),u=cw(e.dtype);return this.reduce(s,"sum",u).reshape(i)},n.prototype.prod=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,r);var o=Ir(e.shape,r),i=o[0],a=_e(o[1]),s=e.as2D(-1,a),u=cw(e.dtype);return this.reduce(s,"prod",u).reshape(i)},n.prototype.unsortedSegmentSum=function(e,r,o){var i=0,a=Gi([i],e.rank),s=e;null!=a&&(s=e.transpose(a),i=qi(1,e.rank)[0]);var u=function(g,m,y){for(var w=[],b=g.length,C=0;C<b;C++)w.push(C!==m?g[C]:y);return w}(s.shape,i,o),c=_e([s.shape[i]]),f=s.as2D(-1,c),d=cw(e.dtype),p=this.segOpCompute(f,"unsortedSegmentSum",r,d,o).reshape(u);return null!=a&&(p=p.transpose(yw(a))),p},n.prototype.segOpCompute=function(e,r,o,i,a){var s=e.shape[0],u=e.shape[1],c=function(p,g){var m,y=!1;for(p<=30?(m=p,y=!0):m=uw(p,Math.floor(Math.sqrt(p)));!y;)m>g||m===p?y=!0:m=uw(p,m+1);return m}(u,a),f=new O8({windowSize:c,inSize:u,batchSize:s,numSegments:a},r),d=this.compileAndRun(f,[e,o],i);return d.shape[1]===a?d:(o=Ug(0,a).tile([u/c]),this.segOpCompute(d,r,o,i,a))},n.prototype.argMinMaxReduce=function(e,r,o){var i=[r];if(_o("arg"+o.charAt(0).toUpperCase()+o.slice(1),i,e.rank),!K().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var a=Ir(e.shape,i),s=a[0],u=_e(a[1]),c=e.as2D(-1,u);return this.argReduce(c,o).reshape(s)}return this.argReducePacked(e,o)},n.prototype.argMin=function(e,r){return this.argMinMaxReduce(e,r,"min")},n.prototype.argMax=function(e,r){return this.argMinMaxReduce(e,r,"max")},n.prototype.cumsum=function(e,r,o,i){if(r!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+r);var a=new t8(e.shape,o,i);return this.compileAndRun(a,[e])},n.prototype.equal=function(e,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return vec4(equal(a, b));\n","bool");var o=new vn("return float(a == b);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},n.prototype.notEqual=function(e,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return vec4(notEqual(a, b));\n","bool");var o=new vn("return float(a != b);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},n.prototype.less=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.less(e,r);if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return vec4(lessThan(a, b));\n","bool");var o=new vn("return float(a < b);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},n.prototype.lessEqual=function(e,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return vec4(lessThanEqual(a, b));\n","bool");var o=new vn("return float(a <= b);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},n.prototype.greater=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.greater(e,r);if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return vec4(greaterThan(a, b));\n","bool");var o=new vn("return float(a > b);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},n.prototype.greaterEqual=function(e,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var o=new vn("return float(a >= b);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},n.prototype.logicalNot=function(e){var r=new Je(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[e])},n.prototype.logicalAnd=function(e,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var o=new vn("return float(a >= 1.0 && b >= 1.0);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},n.prototype.logicalOr=function(e,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var o=new vn("return float(a >= 1.0 || b >= 1.0);",e.shape,r.shape);return this.compileAndRun(o,[e,r],"bool")},n.prototype.select=function(e,r,o){var i=new L8(e.rank,r.shape,r.rank);return this.compileAndRun(i,[e,r,o],ir(r.dtype,o.dtype))},n.prototype.where=function(e){mw("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=e.dataSync();return RE(e.shape,r)},n.prototype.topk=function(e,r,o){return $k(e.dataSync(),e.shape,e.dtype,r)},n.prototype.min=function(e,r){_o("min",r,e.rank);var o=Ir(e.shape,r),i=o[0],a=_e(o[1]),s=e.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(i)},n.prototype.minimum=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.minimum(e,r);var o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new _s("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,r.shape):new vn("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,r.shape);return this.compileAndRun(o,[e,r])},n.prototype.mod=function(e,r){var o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new _s("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,r.shape):new vn("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,r.shape);return this.compileAndRun(o,[e,r])},n.prototype.max=function(e,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,r);_o("max",r,e.rank);var o=Ir(e.shape,r),i=o[0],a=_e(o[1]),s=e.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(i)},n.prototype.maximum=function(e,r){if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.maximum(e,r);var o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new _s("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,r.shape):new vn("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,r.shape);return this.compileAndRun(o,[e,r])},n.prototype.all=function(e,r){_o("all",r,e.rank);var o=Ir(e.shape,r),i=o[0],a=_e(o[1]),s=e.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(i)},n.prototype.any=function(e,r){_o("any",r,e.rank);var o=Ir(e.shape,r),i=o[0],a=_e(o[1]),s=e.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(i)},n.prototype.realDivide=function(e,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var o=new vn("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,r.shape);return this.compileAndRun(o,[e,r],"float32")},n.prototype.floorDiv=function(e,r){if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var o=new vn("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,r.shape);return this.compileAndRun(o,[e,r],"int32")},n.prototype.add=function(e,r){if("complex64"===e.dtype&&"complex64"===r.dtype)return this.complexSeparableBinaryOp(e,r,NE);if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.add(e,r);var o=ir(e.dtype,r.dtype);if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,NE,o);var i=new vn(NE,e.shape,r.shape);return this.compileAndRun(i,[e,r],o)},n.prototype.packedUnaryOp=function(e,r,o){var i=new qg(e.shape,r);return this.compileAndRun(i,[e],o)},n.prototype.packedBinaryOp=function(e,r,o,i,a){void 0===a&&(a=!1);var s=new _s(o,e.shape,r.shape,a);return this.compileAndRun(s,[e,r],i)},n.prototype.complexSeparableBinaryOp=function(e,r,o){var i=this,a=this.texData.get(e.dataId),s=this.texData.get(r.dataId),u=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(p){var g=p[0],m=p[1],y=i.makeComplexComponentTensorInfo(e,g),w=i.makeComplexComponentTensorInfo(r,m),b=new vn(o,e.shape,r.shape);return i.compileAndRun(b,[y,w],ir(g.dtype,m.dtype))}),c=u[0],f=u[1],d=this.complex(c,f);return c.dispose(),f.dispose(),d},n.prototype.makeComplexComponentTensorInfo=function(e,r){return{dataId:r.dataId,dtype:r.dtype,shape:e.shape}},n.prototype.addN=function(e){if(1===e.length)return e[0];if(e.length>K().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(e.length/2),o=this.addN(e.slice(0,r)),i=this.addN(e.slice(r));return this.addN([o,i])}var a=e.map(function(c){return c.dtype}).reduce(function(c,f){return ir(c,f)}),s=e.map(function(c){return c.shape}),u=K().getBool("WEBGL_PACK")?new A5(e[0].shape,s):new S5(e[0].shape,s);return this.compileAndRun(u,e,a)},n.prototype.subtract=function(e,r){if("complex64"===e.dtype&&"complex64"===r.dtype)return this.complexSeparableBinaryOp(e,r,FE);if(this.shouldExecuteOnCPU([e,r]))return this.cpuBackend.subtract(e,r);var o=ir(e.dtype,r.dtype);if(K().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,r,FE,e.dtype);var i=new vn(FE,e.shape,r.shape);return this.compileAndRun(i,[e,r],o)},n.prototype.pow=function(e,r){var o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new _s("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,r.shape):new vn("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,r.shape),i=ir(e.dtype,r.dtype);return this.compileAndRun(o,[e,r],i)},n.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,RP,e.dtype);var r=new Je(e.shape,RP);return this.compileAndRun(r,[e])},n.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,MP,e.dtype);var r=new Je(e.shape,MP);return this.compileAndRun(r,[e])},n.prototype.sign=function(e){var r=new Je(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(r,[e])},n.prototype.isNaN=function(e){var r=new Je(e.shape,"return float(isnan(x));");return this.compileAndRun(r,[e],"bool")},n.prototype.isInf=function(e){var r=new Je(e.shape,"return float(isinf(x));");return this.compileAndRun(r,[e],"bool")},n.prototype.isFinite=function(e){var r=new Je(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[e],"bool")},n.prototype.round=function(e){var r=new Je(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(r,[e])},n.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,NP,e.dtype);var r=new Je(e.shape,NP);return this.compileAndRun(r,[e])},n.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,FP,e.dtype);var r=new Je(e.shape,FP);return this.compileAndRun(r,[e])},n.prototype.softmax=function(e,r){var o=kn([r],e.shape),i=this.max(e,o),a=no(i.shape,o),s=this.subtract(e,i.reshape(a)),u=this.exp(s),c=this.sum(u,o).reshape(a);return this.realDivide(u,c)},n.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var r=new Je(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(r,[e])},n.prototype.log1p=function(e){var r=new Je(e.shape,"return log(1.0 + x);");return this.compileAndRun(r,[e])},n.prototype.sqrt=function(e){var r=new Je(e.shape,"return sqrt(x);");return this.compileAndRun(r,[e])},n.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var r=new Je(e.shape,"return inversesqrt(x);");return this.compileAndRun(r,[e])},n.prototype.reciprocal=function(e){var r=new Je(e.shape,"return 1.0 / x;");return this.compileAndRun(r,[e])},n.prototype.relu=function(e){var r;return r=K().getBool("WEBGL_PACK")?new qg(e.shape,kP):new Je(e.shape,IP),this.compileAndRun(r,[e])},n.prototype.relu6=function(e){var r;return r=K().getBool("WEBGL_PACK")?new qg(e.shape,PP):new Je(e.shape,SP),this.compileAndRun(r,[e])},n.prototype.prelu=function(e,r){var o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new _s(Zk,e.shape,r.shape):new vn(Qk,e.shape,r.shape);return this.compileAndRun(o,[e,r])},n.prototype.elu=function(e){if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,OP,e.dtype);var r=new Je(e.shape,AP);return this.compileAndRun(r,[e])},n.prototype.eluDer=function(e,r){var o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new _s("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,r.shape):new vn("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,r.shape);return this.compileAndRun(o,[e,r])},n.prototype.selu=function(e){var r=new Je(e.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(r,[e])},n.prototype.int=function(e){var r=new Je(e.shape,"return float(int(x));");return this.compileAndRun(r,[e],"int32")},n.prototype.clip=function(e,r,o){var i,a=(i=K().getBool("WEBGL_PACK_CLIP")?new j5(e.shape):new H5(e.shape)).getCustomSetupFunc(r,o);return this.compileAndRun(i,[e],null,a)},n.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,EP,e.dtype);var r=new Je(e.shape,EP);return this.compileAndRun(r,[e])},n.prototype.complexAbs=function(e){var r=this.texData.get(e.dataId),o=new z5(e.shape),i=[this.makeComplexComponentTensorInfo(e,r.complexTensors.real),this.makeComplexComponentTensorInfo(e,r.complexTensors.imag)];return this.compileAndRun(o,i)},n.prototype.sigmoid=function(e){var r=new Je(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[e])},n.prototype.softplus=function(e){var r=new Je(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(r,[e])},n.prototype.sin=function(e){var r=new Je(e.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(r,[e])},n.prototype.cos=function(e){var r=new Je(e.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(r,[e])},n.prototype.tan=function(e){var r=new Je(e.shape,"return tan(x);");return this.compileAndRun(r,[e])},n.prototype.asin=function(e){var r=new Je(e.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(r,[e])},n.prototype.acos=function(e){var r=new Je(e.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(r,[e])},n.prototype.atan=function(e){var r=new Je(e.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(r,[e])},n.prototype.atan2=function(e,r){var o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new _s("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,r.shape):new vn("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,r.shape);return this.compileAndRun(o,[e,r])},n.prototype.sinh=function(e){var r=new Je(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(r,[e])},n.prototype.cosh=function(e){var r=new Je(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(r,[e])},n.prototype.tanh=function(e){var r=new Je(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(r,[e])},n.prototype.asinh=function(e){var r=new Je(e.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(r,[e])},n.prototype.acosh=function(e){var r=new Je(e.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(r,[e])},n.prototype.atanh=function(e){var r=new Je(e.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(r,[e])},n.prototype.erf=function(e){var r=new Je(e.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(r,[e])},n.prototype.step=function(e,r){var i,o=new Je(e.shape,(void 0===(i=r)&&(i=0),Yi+"\n    return x > 0.0 ? 1.0 : float("+i+");\n  "));return this.compileAndRun(o,[e])},n.prototype.conv2dByMatMul=function(e,r,o,i,a,s){var u=e.shape,c=this.texData.get(e.dataId),g="channelsLast"===o.dataFormat,y=u[2]%2!=0&&!!c.isPacked;if((1==u[0]*u[1]*u[2]||1===o.outChannels)&&o.inChannels>1e3||!K().getBool("WEBGL_LAZILY_UNPACK")||!K().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!y){var b=this.reshape(e,[1,g?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],o.inChannels]),C=this.reshape(r,[1,o.inChannels,o.outChannels]);return this.reshape(this.fusedBatchMatMul({a:b,b:C,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),o.outShape)}var D={dataId:e.dataId,shape:[1,g?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),o.inChannels],dtype:e.dtype},E=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,M(Bg(c.shape,D.shape),function(){return"packed reshape "+c.shape+" to "+D.shape+" isn't free"});var A=this.reshape(r,[1,o.inChannels,o.outChannels]),P=this.fusedBatchMatMul({a:D,b:A,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),k=this.texData.get(P.dataId);return M(k.isPacked,function(){return"batchMatMul result is expected to be packed"}),c.shape=E,k.shape=o.outShape,B.makeTensorFromDataId(P.dataId,o.outShape,P.dtype)},n.prototype.conv2dWithIm2Row=function(e,r,o,i,a,s){var d=o.outWidth,p=o.outHeight,g="channelsLast"===o.dataFormat,m=o.filterWidth*o.filterHeight*o.inChannels,y=p*d,w=[m,y],b=e.squeeze([0]),C=r.reshape([1,m,-1]),_=new v8(w,b.shape,o),D=this.compileAndRun(_,[b]).reshape([1,w[0],w[1]]),E=null!=i,A=null!=s,P=a?Pw(a,!0):null,k=new kE(D.shape,[1,y,o.outChannels],!0,!1,E,P,A),N=[D,C];return i&&N.push(i),A&&N.push(s),this.compileAndRun(k,N).reshape(g?[1,p,d,o.outChannels]:[1,o.outChannels,p,d])},n.prototype.fusedConv2d=function(e){var r=e.input,o=e.filter,i=e.convInfo,a=e.bias,s=e.activation,u=e.preluActivationWeights;if(1===i.filterHeight&&1===i.filterWidth&&1===i.dilationHeight&&1===i.dilationWidth&&1===i.strideHeight&&1===i.strideWidth&&("SAME"===i.padInfo.type||"VALID"===i.padInfo.type))return this.conv2dByMatMul(r,o,i,a,s,u);if(K().getBool("WEBGL_CONV_IM2COL")&&1===r.shape[0])return this.conv2dWithIm2Row(r,o,i,a,s,u);var c=null!=a,f=null!=u,d=s?Pw(s,!1):null,p=new Jk(i,c,d,f),g=[r,o];return a&&g.push(a),u&&g.push(u),this.compileAndRun(p,g)},n.prototype.conv2d=function(e,r,o){if(1===o.filterHeight&&1===o.filterWidth&&1===o.dilationHeight&&1===o.dilationWidth&&1===o.strideHeight&&1===o.strideWidth&&("SAME"===o.padInfo.type||"VALID"===o.padInfo.type))return this.conv2dByMatMul(e,r,o);if(K().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,r,o);var i=new Jk(o);return this.compileAndRun(i,[e,r])},n.prototype.conv2dDerInput=function(e,r,o){var i=new K5(o);return this.compileAndRun(i,[e,r])},n.prototype.conv2dDerFilter=function(e,r,o){var i=new q5(o);return this.compileAndRun(i,[e,r])},n.prototype.fusedDepthwiseConv2D=function(e){var r,o=e.input,i=e.filter,a=e.convInfo,s=e.bias,u=e.activation,c=e.preluActivationWeights,f=K().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,d=u?Pw(u,f):null,p=[o,i],g=null!=s,m=null!=c;return g&&p.push(s),m&&p.push(c),f?(r=new tP(a,g,d,m),this.compileAndRun(r,p)):(r=new eP(a,g,d,m),this.compileAndRun(r,p))},n.prototype.depthwiseConv2D=function(e,r,o){var i;return K().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1?(i=new tP(o),this.compileAndRun(i,[e,r])):(i=new eP(o),this.compileAndRun(i,[e,r]))},n.prototype.depthwiseConv2DDerInput=function(e,r,o){var i=new Z5(o);return this.compileAndRun(i,[e,r])},n.prototype.depthwiseConv2DDerFilter=function(e,r,o){var i=new Q5(o);return this.compileAndRun(i,[e,r])},n.prototype.conv3d=function(e,r,o){var i=new J5(o);return this.compileAndRun(i,[e,r])},n.prototype.conv3dDerInput=function(e,r,o){var i=new Y5(o);return this.compileAndRun(i,[e,r])},n.prototype.conv3dDerFilter=function(e,r,o){var i=new X5(o);return this.compileAndRun(i,[e,r])},n.prototype.maxPool=function(e,r){var o=new PE(r,"max",!1);return this.compileAndRun(o,[e])},n.prototype.avgPool=function(e,r){var o=new PE(r,"avg",!1);return this.compileAndRun(o,[e],"float32")},n.prototype.maxPoolBackprop=function(e,r,o,i){var a=new PE(i,"max",!0),s=this.compileAndRun(a,[r]),u=new b8(i),c=this.compileAndRun(u,[e,s],r.dtype);return s.dispose(),c},n.prototype.avgPoolBackprop=function(e,r,o){var i=new O5(o);return this.compileAndRun(i,[e],r.dtype)},n.prototype.cast=function(e,r){return EE(e,r,this)},n.prototype.unstack=function(e,r){for(var o=e.shape[r],i=new Array(e.rank-1),a=0,s=0;s<e.rank;s++)s!==r&&(i[a++]=e.shape[s]);var u=new Array(e.rank).fill(0),c=e.shape.slice();c[r]=1;var f=new Array(o);for(s=0;s<f.length;s++)u[r]=s,f[s]=this.slice(e,u,c).reshape(i);return f},n.prototype.avgPool3d=function(e,r){var o=new OE(r,"avg",!1);return this.compileAndRun(o,[e],"float32")},n.prototype.avgPool3dBackprop=function(e,r,o){var i=new L5(o);return this.compileAndRun(i,[e],r.dtype)},n.prototype.maxPool3d=function(e,r){var o=new OE(r,"max",!1);return this.compileAndRun(o,[e],"float32")},n.prototype.maxPool3dBackprop=function(e,r,o,i){var a=new OE(i,"max",!0),s=this.compileAndRun(a,[r]),u=new x8(i),c=this.compileAndRun(u,[e,s],r.dtype);return s.dispose(),c},n.prototype.reshape=function(e,r){var o=this.texData.get(e.dataId);if(o.isPacked&&!Bg(e.shape,r)&&(null===o.texture||!Bg(o.shape,r))){var i=this.packedReshape(e,r);return B.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return Mw(e,r)},n.prototype.resizeBilinear=function(e,r,o,i){var a=K().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new M8(e.shape,r,o,i):new R8(e.shape,r,o,i);return this.compileAndRun(a,[e],"float32")},n.prototype.resizeBilinearBackprop=function(e,r,o){var i=new T8(e,r,o);return this.compileAndRun(i,[e])},n.prototype.resizeNearestNeighbor=function(e,r,o,i){var a=new F8(e.shape,r,o,i);return this.compileAndRun(a,[e])},n.prototype.resizeNearestNeighborBackprop=function(e,r,o){var i=new N8(e,r,o);return this.compileAndRun(i,[e])},n.prototype.multinomial=function(e,r,o,i){var a=r?e:Na(e),c=new _8(a.shape[0],a.shape[1],o),f=c.getCustomSetupFunc(i);return this.compileAndRun(c,[a],"int32",f)},n.prototype.oneHot=function(e,r,o,i){var a=new C8(e.size,r,o,i);return this.compileAndRun(a,[e])},n.prototype.diag=function(e){var r=new i8(e.size);return this.compileAndRun(r,[e])},n.prototype.nonMaxSuppression=function(e,r,o,i,a){return mw("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),AE(e.dataSync(),r.dataSync(),o,i,a)},n.prototype.cropAndResize=function(e,r,o,i,a,s){var u=new e8(e.shape,r.shape,i,a,s);return this.compileAndRun(u,[e,r,o],"float32")},n.prototype.depthToSpace=function(e,r,o){M(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=e.shape[0],c=("NHWC"===o?e.shape[1]:e.shape[2])*r,f=("NHWC"===o?e.shape[2]:e.shape[3])*r,d=("NHWC"===o?e.shape[3]:e.shape[1])/(r*r),p=new o8("NHWC"===o?[i,c,f,d]:[i,d,c,f],r,o);return this.compileAndRun(p,[e])},n.prototype.split=function(e,r,o){return jk(e,r,o)},n.prototype.scatterND=function(e,r,o){var i=Wg(0,e,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,c=i.strides,f=i.outputSize,d=[f/u,u],p=e.reshape([s,a]),g=r.reshape([s,u]);if(0===f)return Mw(sr([]),o);var m=le(0),y=new _P(s,a,p.rank,g.rank,c,d);return this.compileAndRun(y,[g,p,m]).reshape(o)},n.prototype.sparseToDense=function(e,r,o,i){var a=Wg(0,e,o),d=new _P(a.numUpdates,a.sliceRank,e.rank,r.rank,a.strides,[a.outputSize,1],!1);return this.compileAndRun(d,[r,e,i]).reshape(o)},n.prototype.fft=function(e){return this.fftImpl(e,!1)},n.prototype.ifft=function(e){return this.fftImpl(e,!0)},n.prototype.fftImpl=function(e,r){var o=this.texData.get(e.dataId),i=new rP("return real * expR - imag * expI;",e.shape,r),a=new rP("return real * expI + imag * expR;",e.shape,r),s=[this.makeComplexComponentTensorInfo(e,o.complexTensors.real),this.makeComplexComponentTensorInfo(e,o.complexTensors.imag)],u=this.compileAndRun(i,s),c=this.compileAndRun(a,s),f=this.complex(u,c).as2D(e.shape[0],e.shape[1]);return u.dispose(),c.dispose(),f},n.prototype.gatherND=function(e,r){var o=r.shape,i=o[o.length-1],a=vE(e,r),s=a[0],u=a[1],c=a[2],f=a[3],d=r.reshape([u,i]),p=e.reshape([e.size/c,c]),g=new p8(i,f,[u,c]);return this.compileAndRun(g,[p,d]).reshape(s)},n.prototype.fill=function(e,r,o){if("string"===(o=o||zf(r))){var i=Ig(o,_e(e));return i.fill(r),B.makeTensor(i,e,o,this)}var a=new d8(e,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],o,s)},n.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},n.prototype.zerosLike=function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)},n.prototype.linspace=function(e,r,o){return IE(e,r,o)},n.prototype.makeTensorInfo=function(e,r){var o=this.write(null,e,r);return this.texData.get(o).usage=null,{dataId:o,shape:e,dtype:r}},n.prototype.makeOutput=function(e,r){var o=this.makeTensorInfo(e,r).dataId;return B.makeTensorFromDataId(o,e,r,this)},n.prototype.unpackTensor=function(e){var r=new nq(e.shape);return this.runWebGLProgram(r,[e],e.dtype)},n.prototype.packTensor=function(e){var r=new D8(e.shape);return this.runWebGLProgram(r,[e],e.dtype,null,!0)},n.prototype.packedReshape=function(e,r){var o=[Og(e.shape)].concat(Lg(e.shape)),i={dtype:e.dtype,shape:o,dataId:e.dataId},a=[Og(r)].concat(Lg(r)),s=new A8(a,o),u=this.runWebGLProgram(s,[i],e.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},n.prototype.decode=function(e){var r,o=this.texData.get(e),i=o.isPacked,a=o.shape,s=o.dtype,u=gw(a);return r=i?new r8(u):new n8(u),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:e}],s,null,!0).dataId}},n.prototype.runWebGLProgram=function(e,r,o,i,a){var s=this;void 0===a&&(a=!1);var u=this.makeTensorInfo(e.outputShape,o),c=this.texData.get(u.dataId);if(e.packedOutput&&(c.isPacked=!0),e.outPackingScheme===Mg.DENSE){var f=Ng(e.outputShape);c.texShape=f.map(function(_){return 2*_})}if(null!=e.outTexUsage&&(c.usage=e.outTexUsage),0===_e(u.shape))return c.values=jf(u.dtype,0),u;var d=[],p=r.map(function(_){if("complex64"===_.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var D=s.texData.get(_.dataId);if(null==D.texture){if(!e.packedInputs&&_e(_.shape)<=K().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:_.shape,texData:null,isUniform:!0,uniformValues:D.values};e.packedInputs&&(D.isPacked=!0,D.shape=_.shape)}else if(!!D.isPacked!=!!e.packedInputs)_=D.isPacked?s.unpackTensor(_):s.packTensor(_),d.push(_),D=s.texData.get(_.dataId);else if(D.isPacked&&!Bg(D.shape,_.shape)){var E=_,A=_.shape;_.shape=D.shape,_=s.packedReshape(_,A),d.push(_),D=s.texData.get(_.dataId),E.shape=A}return s.uploadToGPU(_.dataId),{shape:_.shape,texData:D,isUniform:!1}});this.uploadToGPU(u.dataId);var g,_,A,m={shape:u.shape,texData:c,isUniform:!1},y=(_=e,A="",p.concat(m).forEach(function(N){A+=N.shape+"_"+(N.isUniform?"uniform":N.texData.texShape)+"_"+(null!=N.texData&&null!=N.texData.slice&&N.texData.slice.flatOffset>0)}),_.constructor.name+"_"+A+"_"+_.userCode),w=this.getAndSaveBinary(y,function(){return function(_,D,E,A){var P=D.userCode,k=E.map(function(J,se){var ue={logicalShape:J.shape,texShape:J.isUniform?null:J.texData.texShape,isUniform:J.isUniform,isPacked:!J.isUniform&&J.texData.isPacked,flatOffset:null};return null!=J.texData&&null!=J.texData.slice&&J.texData.slice.flatOffset>0&&(ue.flatOffset=J.texData.slice.flatOffset),{name:D.variableNames[se],shapeInfo:ue}}),N=k.map(function(J){return J.shapeInfo}),F={logicalShape:A.shape,texShape:A.texData.texShape,isUniform:!1,isPacked:A.texData.isPacked,flatOffset:null},H=R5(k,F,P,D.packedInputs),W=_.createProgram(H),Z=null,Y=_.getUniformLocation(W,"NAN",!1);1===K().getNumber("WEBGL_VERSION")&&(Z=_.getUniformLocation(W,"INFINITY",!1));for(var Q={},re=0;re<D.variableNames.length;re++){var ne=D.variableNames[re];Q[ne]=_.getUniformLocation(W,ne,!1),Q["offset"+ne]=_.getUniformLocation(W,"offset"+ne,!1)}return{program:D,source:H,webGLProgram:W,uniformLocations:Q,inShapeInfos:N,outShapeInfo:F,infLoc:Z,nanLoc:Y}}(s.gpgpu,e,p,m)}),b=null!=this.activeTimers;if(b&&(g=this.startTimer()),function(_,D,E,A,P){xP(D.inShapeInfos,E),xP([D.outShapeInfo],[A]);var k=A.texData.texture,N=A.texData.texShape;A.texData.isPacked?_.setOutputPackedMatrixTexture(k,N[0],N[1]):_.setOutputMatrixTexture(k,N[0],N[1]),_.setProgram(D.webGLProgram),1===K().getNumber("WEBGL_VERSION")&&null!==D.infLoc&&_.gl.uniform1f(D.infLoc,1/0),null!==D.nanLoc&&_.gl.uniform1f(D.nanLoc,NaN),E.forEach(function(F,H){var W=D.program.variableNames[H],Z=D.uniformLocations[W],Y=D.uniformLocations["offset"+W];if(null!=Z)if(F.isUniform)if(_e(F.shape)<2)_.gl.uniform1f(Z,F.uniformValues[0]);else{var Q=F.uniformValues;Q instanceof Float32Array||(Q=new Float32Array(Q)),_.gl.uniform1fv(Z,Q)}else null!=F.texData.slice&&null!=Y&&_.gl.uniform1i(Y,F.texData.slice.flatOffset),_.setInputMatrixTexture(F.texData.texture,Z,H)}),P?.(_,D.webGLProgram),_.executeProgram()}(this.gpgpu,w,p,m,i),d.forEach(function(_){return s.disposeData(_.dataId)}),b&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)})),!K().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&!1===a){var C=this.unpackTensor(u);return this.disposeData(u.dataId),C}return u},n.prototype.compileAndRun=function(e,r,o,i,a){void 0===a&&(a=!1);var s=this.runWebGLProgram(e,r,o=o||r[0].dtype,i,a);return B.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},n.prototype.getAndSaveBinary=function(e,r){return e in this.binaryCache||(this.binaryCache[e]=r()),this.binaryCache[e]},n.prototype.getTextureManager=function(){return this.textureManager},n.prototype.dispose=function(){var e=this;this.disposed||(K().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){e.gpgpu.deleteProgram(e.binaryCache[r].webGLProgram),delete e.binaryCache[r]}),this.textureManager.dispose(),null!=this.canvas&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},n.prototype.floatPrecision=function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=ge(function(){if(!K().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=K().getBool("DEBUG");K().set("DEBUG",!1);var o=e.abs(le(1e-8)).dataSync()[0];if(K().set("DEBUG",r),o>0)return 32}return 16})),this.floatPrecisionValue},n.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},n.prototype.uploadToGPU=function(e){var r,o=this.texData.get(e),i=o.shape,a=o.dtype,s=o.values,c=o.usage,f=o.isPacked;if(null==o.texture){var d,p=null!=this.activeTimers;p&&(d=$i());var g=o.texShape;if(null==g&&(g=YF(i,f),o.texShape=g),null!=s){var m=gw(i),y=void 0,w=g[1],b=g[0],C=s instanceof Uint8Array;f?(w=(r=Fg(g[0],g[1]))[0],y=new c8(m,[b=r[1],w],C)):y=new u8(m,[b,w],C);var _=this.makeTensorInfo([b,w],a);this.texData.get(_.dataId).usage=C?Po.PIXELS:Po.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(_.dataId),w,b,s);var D=this.runWebGLProgram(y,[_],a,null,!0),E=this.texData.get(D.dataId);o.texture=E.texture,o.texShape=E.texShape,o.isPacked=E.isPacked,o.usage=E.usage,this.disposeData(_.dataId),this.texData.delete(D.dataId),o.values=null,p&&(this.uploadWaitMs+=$i()-d)}else{var A=this.acquireTexture(g,c,a,f);o.texture=A}}},n.prototype.convertAndCacheOnCPU=function(e,r){var o=this.texData.get(e),i=o.dtype;return this.releaseGPUData(e),null!=r&&(o.values=function(a,s){if("float32"===s||"complex64"===s)return a;if("int32"===s||"bool"===s){for(var u="int32"===s?new Int32Array(a.length):new Uint8Array(a.length),c=0;c<u.length;++c)u[c]=Math.round(a[c]);return u}throw new Error("Unknown dtype "+s)}(r,i)),o.values},n.prototype.acquireTexture=function(e,r,o,i){if(this.numBytesInGPU+=this.computeBytes(e,o),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,r,i)},n.prototype.computeBytes=function(e,r){return e[0]*e[1]*WD(r)},n}(_E);MF()&&B.registerBackend("webgl",function(){return new LP},2);var BP=V({square_:function(t){var n=R(t,"x","square");return B.runKernelFunc(function(r,o){return o([n]),r.square(n)},{x:n},null,"Square",{},[n],[])}}),Kg="SquaredDifference",UE=V({squaredDifference_:function(t,n){var e,r=R(t,"a","squaredDifference"),o=R(n,"b","squaredDifference");return e=tn(r,o),ct((r=e[0]).shape,(o=e[1]).shape),B.runKernelFunc(function(s,u){var c=s.squaredDifference(r,o);return u([r,o]),c},{a:r,b:o},function(s,u){var c=u[0],f=u[1],d=le(2);return{a:function(){return s.mul(c.sub(f).mul(d))},b:function(){return s.mul(f.sub(c).mul(d))}}},Kg,{},[r,o],[])}}),VP=V({abs_:function(t){var n=R(t,"x","abs");return"complex64"===n.dtype?B.runKernelFunc(function(e){return e.complexAbs(n)},{$x:n}):B.runKernelFunc(function(e,r){var o=e.abs(n);return r([n]),o},{x:n},function(e,r){var o=r[0];return{x:function(){return e.mul(o.toFloat().step(-1))}}},"Abs")}}),UP=V({acos_:function(t){var n=R(t,"x","acos");return B.runKernelFunc(function(e,r){var o=e.acos(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return e.divStrict(le(1).sub(o.toFloat().square()).sqrt()).neg()}}})}}),WP=V({acosh_:function(t){var n=R(t,"x","acosh");return B.runKernelFunc(function(e,r){var o=e.acosh(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return e.divStrict(o.toFloat().square().sub(1).sqrt())}}})}}),HP=V({asin_:function(t){var n=R(t,"x","asin");return B.runKernelFunc(function(e,r){var o=e.asin(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return e.divStrict(le(1).sub(o.toFloat().square()).sqrt())}}})}}),jP=V({asinh_:function(t){var n=R(t,"x","asinh");return B.runKernelFunc(function(e,r){var o=e.asinh(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return e.divStrict(le(1).add(o.toFloat().square()).sqrt())}}})}}),zP=V({atan_:function(t){var n=R(t,"x","atan");return B.runKernelFunc(function(e,r){var o=e.atan(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return e.div(o.toFloat().square().add(1))}}})}}),$P=V({atanh_:function(t){var n=R(t,"x","atanh");return B.runKernelFunc(function(e,r){var o=e.atanh(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return e.div(le(1).sub(o.toFloat().square()))}}})}}),GP=V({ceil_:function(t){var n=R(t,"x","ceil");return B.runKernelFunc(function(e){return e.ceil(n)},{$x:n},function(e){return{$x:function(){return vt(e)}}})}}),Ow=V({clipByValue_:function(t,n,e){var r=R(t,"x","clipByValue");return M(n<=e,function(){return"Error in clip: min ("+n+") must be less than or equal to max ("+e+")."}),B.runKernelFunc(function(a,s){var u=a.clip(r,n,e);return s([r]),u},{x:r},function(a,s){var u=s[0];return{x:function(){return a.where(u.greaterEqual(n).logicalAnd(u.lessEqual(e)),vt(a))}}},"ClipByValue",{min:n,max:e},[r])}}),qP=V({cos_:function(t){var n=R(t,"x","cos");return B.runKernelFunc(function(r,o){var i=r.cos(n);return o([n]),i},{x:n},function(r,o){var i=o[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},[n])}}),KP=V({cosh_:function(t){var n=R(t,"x","cosh");return B.runKernelFunc(function(e,r){var o=e.cosh(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return o.toFloat().sinh().mulStrict(e)}}})}}),XP=V({erf_:function(t){var n=R(t,"x","erf");return M("int32"===n.dtype||"float32"===n.dtype,function(){return"Input dtype must be `int32` or `float32`."}),"int32"===n.dtype&&(n=n.toFloat()),B.runKernelFunc(function(e,r){var o=e.erf(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return e.mul(o.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),Lw=V({exp_:function(t){var n=R(t,"x","exp");return B.runKernelFunc(function(e,r){var o=e.exp(n);return r([o]),o},{x:n},function(e,r){return{x:function(){return e.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),YP=V({expm1_:function(t){var n=R(t,"x","expm1");return B.runKernelFunc(function(e,r){var o=e.expm1(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return e.mul(o.exp())}}})}}),QP=V({floor_:function(t){var n=R(t,"x","floor");return B.runKernelFunc(function(e){return e.floor(n)},{$x:n},function(e){return{$x:function(){return vt(e)}}})}}),ZP=V({log_:function(t){var n=R(t,"x","log");return B.runKernelFunc(function(r,o){var i=r.log(n);return o([n]),i},{x:n},function(r,o){var i=o[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},[n])}}),JP=V({log1p_:function(t){var n=R(t,"x","log1p");return B.runKernelFunc(function(e,r){var o=e.log1p(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return e.div(o.add(1))}}})}}),eO=V({logSigmoid_:function(t){var n=R(t,"x","logSigmoid");return B.runKernelFunc(function(e,r){var o=e.softplus(n.neg()).neg();return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return e.mul(o.neg().sigmoid())}}})}}),Xg=V({neg_:function(t){var n=R(t,"x","neg");return B.runKernelFunc(function(r){return r.neg(n)},{x:n},function(r){return{x:function(){return r.neg()}}},"Neg",{},[n])}}),tO=V({reciprocal_:function(t){var n=R(t,"x","reciprocal");return B.runKernelFunc(function(e,r){var o=e.reciprocal(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return e.div(o.square().neg())}}})}}),nO=V({round_:function(t){var n=R(t,"x","round");return B.runKernelFunc(function(e){return e.round(n)},{$x:n},function(e){return{$x:function(){return vt(e)}}})}}),WE=V({rsqrt_:function(t){var n=R(t,"x","rsqrt");return B.runKernelFunc(function(r,o){var i=r.rsqrt(n);return o([n]),i},{x:n},function(r,o){var i=o[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},[n])}}),HE=V({sigmoid_:function(t){var n=R(t,"x","sigmoid");return B.runKernelFunc(function(e,r){var o=e.sigmoid(n);return r([o]),o},{x:n},function(e,r){var o=r[0];return{x:function(){return e.mul(o.mul(le(1).sub(o)))}}},"Sigmoid")}}),rO=V({sign_:function(t){var n=R(t,"x","sign");return B.runKernelFunc(function(e){return e.sign(n)},{$x:n},function(e){return{$x:function(){return vt(e)}}})}}),oO=V({isNaN_:function(t){var n=R(t,"x","isNaN");return B.runKernelFunc(function(e){return e.isNaN(n)},{$x:n},function(e){return{$x:function(){return vt(e)}}})}}),iO=V({isInf_:function(t){var n=R(t,"x","isInf");return B.runKernelFunc(function(e){return e.isInf(n)},{$x:n},function(e){return{$x:function(){return vt(e)}}})}}),aO=V({isFinite_:function(t){var n=R(t,"x","isFinite");return B.runKernelFunc(function(e){return e.isFinite(n)},{$x:n},function(e){return{$x:function(){return vt(e)}}})}}),sO=V({sin_:function(t){var n=R(t,"x","sin");return B.runKernelFunc(function(r,o){var i=r.sin(n);return o([n]),i},{x:n},function(r,o){var i=o[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},[n])}}),uO=V({sinh_:function(t){var n=R(t,"x","sinh");return B.runKernelFunc(function(e,r){var o=e.sinh(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return o.toFloat().cosh().mulStrict(e)}}})}}),cO=V({softplus_:function(t){var n=R(t,"x","softplus");return B.runKernelFunc(function(e,r){var o=e.softplus(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return e.mul(o.sigmoid())}}})}}),lO=V({sqrt_:function(t){var n=R(t,"x","sqrt");return B.runKernelFunc(function(e,r){var o=e.sqrt(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return e.div(o.toFloat().sqrt().mul(2))}}})}}),fO=V({step_:function(t,n){void 0===n&&(n=0);var e=R(t,"x","step");return B.runKernelFunc(function(r){return r.step(e,n)},{$x:e},function(r){return{$x:function(){return vt(r)}}})}}),dO=V({tan_:function(t){var n=R(t,"x","tan");return B.runKernelFunc(function(e,r){var o=e.tan(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return e.div(o.cos().square())}}})}}),hO=V({tanh_:function(t){var n=R(t,"x","tanh");return B.runKernelFunc(function(e,r){var o=e.tanh(n);return r([o]),o},{x:n},function(e,r){var o=r[0];return{x:function(){return le(1).sub(o.square()).mulStrict(e)}}},"Tanh",{},null,[!0])}});function pO(t,n,e,r,o,i){var a,s,u=R(t,"x","batchNorm"),c=R(n,"mean","batchNorm"),f=R(e,"variance","batchNorm");return null!=o&&(a=R(o,"scale","batchNorm")),null!=r&&(s=R(r,"offset","batchNorm")),M(2===u.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),M(2===c.rank||1===c.rank,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."}),M(2===f.rank||1===f.rank,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+f.rank+"."}),null!=a&&M(2===a.rank||1===a.rank,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),null!=s&&M(2===s.rank||1===s.rank,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Yg(u,c,f,s,a,i)}function gO(t,n,e,r,o,i){var a,s,u=R(t,"x","batchNorm"),c=R(n,"mean","batchNorm"),f=R(e,"variance","batchNorm");return null!=o&&(a=R(o,"scale","batchNorm")),null!=r&&(s=R(r,"offset","batchNorm")),M(3===u.rank,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),M(3===c.rank||1===c.rank,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."}),M(3===f.rank||1===f.rank,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+f.rank+"."}),null!=a&&M(3===a.rank||1===a.rank,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),null!=s&&M(3===s.rank||1===s.rank,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Yg(u,c,f,s,a,i)}function vO(t,n,e,r,o,i){var a,s,u=R(t,"x","batchNorm"),c=R(n,"mean","batchNorm"),f=R(e,"variance","batchNorm");return null!=o&&(a=R(o,"scale","batchNorm")),null!=r&&(s=R(r,"offset","batchNorm")),M(4===u.rank,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),M(4===c.rank||1===c.rank,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."}),M(4===f.rank||1===f.rank,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+f.rank+"."}),null!=a&&M(4===a.rank||1===a.rank,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),null!=s&&M(4===s.rank||1===s.rank,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Yg(u,c,f,s,a,i)}function Yg(t,n,e,r,o,i){null==i&&(i=.001);var a,s,u,c=R(t,"x","batchNorm"),f=R(n,"mean","batchNorm"),d=R(e,"variance","batchNorm");return null!=o&&(a=R(o,"scale","batchNorm")),null!=r&&(s=R(r,"offset","batchNorm")),M(f.rank===d.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),M(null==s||f.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),M(null==a||f.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=0===c.rank||1===c.rank?c.as4D(1,1,1,c.size):2===c.rank?c.as4D(1,1,c.shape[0],c.shape[1]):3===c.rank?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c,B.runKernelFunc(function(g,m){var y=g.batchNormalization(u,Bw(f),Bw(d),i,Bw(a),Bw(s));return m([c,f,d,a]),y},{x:c,mean:f,variance:d,scale:a,offset:s},function(g,m){var w=m[0],b=m[1],C=m[2],D=m[3]??le(1),E=Ln(b.shape,u.shape),A=[];if(1===b.rank){for(var P=0;P<u.shape.length-1;++P)A.push(u.shape[P]);A.push(1)}var k=w.sub(b),N=g.mul(D),F=WE(C.add(le(i))),H=F.mul(F).mul(F).mul(le(-.5));return{x:function(){return 1===b.rank?g.mul(Jc(F.as4D(1,1,1,b.shape[0]),A)).mul(D).reshape(w.shape):g.mul(F).mul(D).reshape(w.shape)},mean:function(){var W=F.mul(le(-1)).mul(N);return 1===b.rank&&(W=W.sum(E)),W.reshape(b.shape)},variance:function(){var W=H.mul(k).mul(N);return 1===b.rank&&(W=W.sum(E)),W.reshape(b.shape)},scale:function(){var W=k.mul(F),Z=g.mul(W);return 1===b.rank&&(Z=Z.sum(E)),Z.reshape(b.shape)},offset:function(){var W=g;return 1===b.rank&&(W=W.sum(E)),W.reshape(b.shape)}}},"BatchNormalization",{varianceEpsilon:i},[c,f,d,a]).reshape(c.shape)}function Bw(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function Vw(){sE("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var mO=V({batchNormalization2d_:function(t,n,e,r,o,i){return void 0===r&&(r=.001),Vw(),pO(t,n,e,i,o,r)}}),yO=V({batchNormalization3d_:function(t,n,e,r,o,i){return void 0===r&&(r=.001),Vw(),gO(t,n,e,i,o,r)}}),wO=V({batchNormalization4d_:function(t,n,e,r,o,i){return void 0===r&&(r=.001),Vw(),vO(t,n,e,i,o,r)}}),bO=V({batchNormalization_:function(t,n,e,r,o,i){return void 0===r&&(r=.001),Vw(),Yg(t,n,e,i,o,r)}}),jE=V({batchNorm_:Yg}),xO=V({batchNorm2d_:pO}),_O=V({batchNorm3d_:gO}),CO=V({batchNorm4d_:vO}),Qg=V({logicalAnd_:function(t,n){var e=R(t,"a","logicalAnd","bool"),r=R(n,"b","logicalAnd","bool");return ct(e.shape,r.shape),B.runKernelFunc(function(o){return o.logicalAnd(e,r)},{a:e,b:r},null,"LogicalAnd")}}),DO=V({logicalNot_:function(t){var n=R(t,"x","logicalNot","bool");return B.runKernelFunc(function(e){return e.logicalNot(n)},{$x:n})}}),zE=V({logicalOr_:function(t,n){var e=R(t,"a","logicalOr","bool"),r=R(n,"b","logicalOr","bool");return ct(e.shape,r.shape),B.runKernelFunc(function(o){return o.logicalOr(e,r)},{$a:e,$b:r})}}),EO=V({logicalXor_:function(t,n){var e=R(t,"a","logicalXor","bool"),r=R(n,"b","logicalXor","bool");return ct(e.shape,r.shape),zE(t,n).logicalAnd(Qg(t,n).logicalNot())}}),Eu=V({where_:function(t,n,e){var r=R(n,"a","where"),o=R(e,"b","where"),i=R(t,"condition","where","bool");return Et(r.shape,o.shape,"Error in where: "),1===i.rank?M(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):Et(i.shape,o.shape,"Error in where: "),B.runKernelFunc(function(a,s){var u=a.select(i,r,o);return s([i]),u},{$condition:i,$a:r,$b:o},function(a,s){var u=s[0];return{$condition:function(){return vt(u).toFloat()},$a:function(){return a.mul(u.cast(a.dtype))},$b:function(){return a.mul(u.logicalNot().cast(a.dtype))}}})}}),$E=function(t){return be(this,void 0,void 0,function(){var n,e,r;return xe(this,function(o){switch(o.label){case 0:return[4,(n=R(t,"condition","whereAsync","bool")).data()];case 1:return e=o.sent(),r=RE(n.shape,e),t!==n&&n.dispose(),[2,r]}})})},rt=V({add_:function(t,n){var e,r=R(t,"a","add"),o=R(n,"b","add");e=tn(r,o);var i=ct((r=e[0]).shape,(o=e[1]).shape);return B.runKernelFunc(function(a){return a.add(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=Ln(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=Ln(o.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(o.shape)}}},"Add")}}),IO=V({addN_:function(t){M(Array.isArray(t),function(){return"The argument passed to tf.addN() must be a list of tensors"}),M(t.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length});var n=t.map(function(o,i){return R(o,"tensors"+i,"addN")}),e=n[0];return n.forEach(function(o){if(o.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),n.forEach(function(o){if(!Fn(o.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}),B.runKernelFunc(function(o){return o.addN(n)},n,function(o){var i={};return n.forEach(function(a,s){i[s]=function(){return o.clone()}}),i},"AddN")}}),SO=V({addStrict_:function(t,n){var e=R(t,"a","addStrict"),r=R(n,"b","addStrict");return Et(e.shape,r.shape,"Error in addStrict: "),e.add(r)}}),AO=V({atan2_:function(t,n){var e,r=R(t,"a","atan2"),o=R(n,"b","atan2");e=tn(r,o);var i=ct((r=e[0]).shape,(o=e[1]).shape);return B.runKernelFunc(function(a,s){var u=a.atan2(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],c=s[1];return{$a:function(){var f=rt(u.square(),c.square()),d=a.mul(c.div(f)),p=Ln(u.shape,i);return p.length>0&&(d=d.sum(p)),d.reshape(u.shape)},$b:function(){var f=rt(u.square(),c.square()),d=Xg(a.mul(u.div(f))),p=Ln(c.shape,i);return p.length>0&&(d=d.sum(p)),d.reshape(c.shape)}}})}}),si=V({div_:function(t,n){var e,r=R(t,"a","div"),o=R(n,"b","div");if(e=tn(r,o),o=e[1],"int32"===(r=e[0]).dtype&&"int32"===o.dtype)return GE(r,o);var i=ct(r.shape,o.shape);return B.runKernelFunc(function(a,s){var u=a.realDivide(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],c=s[1];return{a:function(){var f=a.div(c.toFloat()),d=Ln(u.shape,i);return d.length>0?f.sum(d).reshape(u.shape):f},b:function(){var f=a.mul(u.toFloat()),d=Ln(c.shape,i);d.length>0&&(f=f.sum(d).reshape(c.shape));var p=c.square();return f.div(p.toFloat()).neg()}}},"Div")}}),TO=V({divNoNan_:function(t,n){var e,r=R(t,"a","div"),o=R(n,"b","div");r=(e=tn(r,o))[0];var i=si(r,o=e[1]),a=vt(i),s=o.equal(a);return Eu(s,a,i)}}),RO=V({divStrict_:function(t,n){var e=R(t,"a","div"),r=R(n,"b","div");return Et(e.shape,r.shape,"Error in divideStrict: "),e.div(r)}}),GE=V({floorDiv_:function(t,n){var e,r=R(t,"a","floorDiv"),o=R(n,"b","floorDiv");e=tn(r,o);var i=ct((r=e[0]).shape,(o=e[1]).shape);return B.runKernelFunc(function(a,s){var u=a.floorDiv(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],c=s[1];return{a:function(){var f=a.div(c.toFloat()),d=Ln(u.shape,i);return d.length>0?f.sum(d).reshape(u.shape):f},b:function(){var f=a.mul(u.toFloat()),d=Ln(c.shape,i);d.length>0&&(f=f.sum(d).reshape(c.shape));var p=c.square();return f.div(p.toFloat()).neg()}}},"FloorDiv")}}),Uw=V({maximum_:function(t,n){var e,r=R(t,"a","maximum"),o=R(n,"b","maximum");return e=tn(r,o),o=e[1],"bool"===(r=e[0]).dtype&&(r=r.toInt(),o=o.toInt()),ct(r.shape,o.shape),B.runKernelFunc(function(i,a){var s=i.maximum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.greaterEqual(u).toFloat())},b:function(){return i.mul(s.less(u).toFloat())}}},"Maximum")}}),MO=V({maximumStrict_:function(t,n){var e=R(t,"a","maximumStrict"),r=R(n,"b","maximumStrict");return Et(e.shape,r.shape,"Error in maximumStrict: "),e.maximum(r)}}),qE=V({minimum_:function(t,n){var e,r=R(t,"a","minimum"),o=R(n,"b","minimum");return e=tn(r,o),o=e[1],"bool"===(r=e[0]).dtype&&(r=r.toInt(),o=o.toInt()),ct(r.shape,o.shape),B.runKernelFunc(function(i,a){var s=i.minimum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.lessEqual(u).toFloat())},b:function(){return i.mul(s.greater(u).toFloat())}}},"Minimum")}}),NO=V({minimumStrict_:function(t,n){var e=R(t,"a","minimumStrict"),r=R(n,"b","minimumStrict");return Et(e.shape,r.shape,"Error in minimumStrict: "),e.minimum(r)}}),FO=V({mod_:function(t,n){var e,r=R(t,"a","mod"),o=R(n,"b","mod");e=tn(r,o);var i=ct((r=e[0]).shape,(o=e[1]).shape);return B.runKernelFunc(function(a,s){var u=a.mod(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],c=s[1];return{$a:function(){var f=Ln(u.shape,i);return f.length>0?a.sum(f).reshape(u.shape):a},$b:function(){var f=a.mul(u.div(c).floor().neg()),d=Ln(c.shape,i);return d.length>0?f.sum(d).reshape(c.shape):f}}})}}),kO=V({modStrict_:function(t,n){var e=R(t,"a","modStrict"),r=R(n,"b","modStrict");return Et(e.shape,r.shape,"Error in modStrict: "),e.mod(r)}}),Sr=V({mul_:function(t,n){var e,r=R(t,"a","mul"),o=R(n,"b","mul");e=tn(r,o);var i=ct((r=e[0]).shape,(o=e[1]).shape);return B.runKernelFunc(function(a,s){var u=a.multiply(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],c=s[1];return{a:function(){var f=a.mul(c.toFloat()),d=Ln(u.shape,i);return d.length>0?f.sum(d).reshape(u.shape):f},b:function(){var f=a.mul(u.toFloat()),d=Ln(c.shape,i);return d.length>0?f.sum(d).reshape(c.shape):f}}},"Mul")}}),PO=V({mulStrict_:function(t,n){var e=R(t,"a","mul"),r=R(n,"b","mul");return Et(e.shape,r.shape,"Error in multiplyStrict: "),e.mul(r)}}),Zg=V({pow_:function(t,n){var e,r=R(t,"base","pow"),o=R(n,"exp","pow");e=tn(r,o);var i=ct((r=e[0]).shape,(o=e[1]).shape);return B.runKernelFunc(function(s,u){var c=s.pow(r,o);return u([r,o,c]),c},{a:r,b:o},function(s,u){var c=u[0],f=u[1],d=u[2];return{a:function(){var p=f.toFloat(),g=s.mul(p.mul(c.pow(p.sub(le(1))))),m=Ln(c.shape,i);return m.length>0&&(g=g.sum(m)),g.reshape(c.shape)},b:function(){var p=c.greater(0),g=c.log().where(p,vt(c)),m=s.mul(d.mul(g)),y=Ln(f.shape,i);return y.length>0&&(m=m.sum(y)),m.reshape(f.shape)}}},"Pow",{},[r,o],[!0])}}),OO=V({powStrict_:function(t,n){return Et(t.shape,n.shape,"Error in powStrict: "),t.pow(n)}}),LO=V({squaredDifferenceStrict_:function(t,n){var e=R(t,"a","squaredDifferenceStrict"),r=R(n,"b","squaredDifferenceStrict");return Et(e.shape,r.shape,"Error in squaredDifferenceStrict: "),e.squaredDifference(r)}}),Bn=V({sub_:function(t,n){var e,r=R(t,"a","sub"),o=R(n,"b","sub");e=tn(r,o);var i=ct((r=e[0]).shape,(o=e[1]).shape);return B.runKernelFunc(function(a){return a.subtract(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=Ln(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=Ln(o.shape,i);return u.length>0&&(s=s.sum(u)),s.neg().reshape(o.shape)}}},"Sub")}}),BO=V({subStrict_:function(t,n){var e=R(t,"a","subStrict"),r=R(n,"b","subStrict");return Et(e.shape,r.shape,"Error in subStrict: "),e.sub(r)}}),KE=V({equal_:function(t,n){var e,r=R(t,"a","equal"),o=R(n,"b","equal");return e=tn(r,o),ct((r=e[0]).shape,(o=e[1]).shape),B.runKernelFunc(function(i){return i.equal(r,o)},{$a:r,$b:o})}}),VO=V({equalStrict_:function(t,n){var e=R(t,"a","equalStrict"),r=R(n,"b","equalStrict");return Et(e.shape,r.shape,"Error in equalStrict: "),e.equal(r)}}),UO=V({greater_:function(t,n){var e,r=R(t,"a","greater"),o=R(n,"b","greater");return e=tn(r,o),ct((r=e[0]).shape,(o=e[1]).shape),B.runKernelFunc(function(i){return i.greater(r,o)},{a:r,b:o},null,"Greater")}}),XE=V({greaterEqual_:function(t,n){var e,r=R(t,"a","greaterEqual"),o=R(n,"b","greaterEqual");return e=tn(r,o),ct((r=e[0]).shape,(o=e[1]).shape),B.runKernelFunc(function(i,a){var s=i.greaterEqual(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return vt(s)},b:function(){return vt(u)}}},"GreaterEqual")}}),WO=V({greaterEqualStrict_:function(t,n){var e=R(t,"a","greaterEqualStrict"),r=R(n,"b","greaterEqualStrict");return Et(e.shape,r.shape,"Error in greaterEqualStrict: "),e.greaterEqual(r)}}),HO=V({greaterStrict_:function(t,n){var e=R(t,"a","greaterStrict"),r=R(n,"b","greaterStrict");return Et(e.shape,r.shape,"Error in greaterStrict: "),e.greater(r)}}),jO=V({less_:function(t,n){var e,r=R(t,"a","less"),o=R(n,"b","less");return e=tn(r,o),ct((r=e[0]).shape,(o=e[1]).shape),B.runKernelFunc(function(i){return i.less(r,o)},{a:r,b:o},null,"Less")}}),zO=V({lessEqual_:function(t,n){var e,r=R(t,"a","lessEqual"),o=R(n,"b","lessEqual");return e=tn(r,o),ct((r=e[0]).shape,(o=e[1]).shape),B.runKernelFunc(function(i,a){var s=i.lessEqual(r,o);return a([r,o]),s},{a:r,b:o},null,"LessEqual")}}),$O=V({lessEqualStrict_:function(t,n){var e=R(t,"a","lessEqualStrict"),r=R(n,"b","lessEqualStrict");return Et(e.shape,r.shape,"Error in lessEqualStrict: "),e.lessEqual(r)}}),GO=V({lessStrict_:function(t,n){var e=R(t,"a","lessStrict"),r=R(n,"b","lessStrict");return Et(e.shape,r.shape,"Error in lessStrict: "),e.less(r)}}),qO=V({notEqual_:function(t,n){var e,r=R(t,"a","notEqual"),o=R(n,"b","notEqual");return e=tn(r,o),ct((r=e[0]).shape,(o=e[1]).shape),B.runKernelFunc(function(i){return i.notEqual(r,o)},{a:r,b:o},null,"NotEqual")}}),KO=V({notEqualStrict_:function(t,n){var e=R(t,"a","notEqualStrict"),r=R(n,"b","notEqualStrict");return Et(e.shape,r.shape,"Error in notEqualStrict: "),e.notEqual(r)}});function XO(t,n){for(var e=[],r=t;r<n;++r)e.push(r);return e}function YO(t){for(var n=[],e=0;e<t.length;++e)for(var r=0;r<t[e].length;++r)n.push(t[e][r]);return n}var Ww=V({gather_:function(t,n,e){void 0===e&&(e=0);var r=R(t,"x","gather"),o=R(n,"indices","gather","int32");e=kn(e,r.shape)[0];var i=function(a,s,u){for(var c=a.shape[u],f=[],d=1,p=1,g=0;g<u;g++)f.push(a.shape[g]),d*=a.shape[g];for(g=0;g<s.rank;g++)f.push(s.shape[g]);for(g=u+1;g<a.rank;g++)f.push(a.shape[g]),p*=a.shape[g];return{batchSize:d,sliceSize:p,dimSize:c,outputShape:f}}(r,o,e);return B.runKernelFunc(function(a,s){var u=a.gather(r,o.flatten(),e);return s([o]),u},{x:r,indices:o},function(a,s){var u=s[0];return{x:function(){var c=r.shape,f=u.size,d=c.slice(0,e),p=d.length,g=c.slice(e,c.length).slice(1),m=g.length,y=XO(0,p),w=XO(p+1,p+1+m),b=YO([d,[f],g]),C=a.reshape(b),_=u.reshape([f]),D=YO([[p],y,w]),E=C.transpose(D),A=YE(E,_,r.shape[e]),P=yw(D);return A.transpose(P)},indices:function(){return u}}},"Gather",{axis:e}).reshape(i.outputShape)}}),YE=V({unsortedSegmentSum_:function(t,n,e){var r=R(t,"x","unsortedSegmentSum"),o=R(n,"segmentIds","unsortedSegmentSum","int32");return M(cn(e),function(){return"numSegments must be of dtype int"}),B.runKernelFunc(function(i,a){var s=i.unsortedSegmentSum(r,o,e);return a([o]),s},{$x:r},function(i,a){var s=a[0];return{$x:function(){return function(u,c){for(var f=Uw(c,vt(c)),d=Ww(u,f),p=XE(c,le(0,"int32")),g=d.rank-p.rank,m=0;m<g;++m)p=Vo(p,m+1);p=Qg(p,Yc(d.shape,"bool"));var y=vt(d);return Eu(p,d,y)}(i,s)}}})}}),QO=function(t,n,e){return be(this,void 0,void 0,function(){var r,o,i,a,s,u,c,f,d,p,g,m,y;return xe(this,function(w){switch(w.label){case 0:for(r=R(t,"tensor","boolMask"),o=R(n,"mask","boolMask","bool"),i=e??0,s=r.shape,M((a=o.rank)>0,function(){return"mask cannot be scalar"}),Et(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,c=i;c<i+a;c++)u*=s[c];return f=s.slice(0,i).concat([u],s.slice(i+a)),d=r.reshape(f),p=o.reshape([-1]),[4,$E(p)];case 1:return g=w.sent(),m=g.squeeze([1]),y=Ww(d,m,i),t!==r&&r.dispose(),n!==o&&o.dispose(),m.dispose(),d.dispose(),p.dispose(),g.dispose(),[2,y]}})})};function ZO(t,n,e,r,o,i,a){void 0===i&&(i="NHWC"),M(t.length===n.rank,function(){return"Length of inShape ("+t.length+") and rank of dy ("+n.rank+") must match"});var s=t,u=n,c=!1;3===n.rank&&(c=!0,u=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]),s=[1,t[0],t[1],t[2]]),M(4===s.length,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),M(4===u.rank,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),M(4===e.rank,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+e.rank});var f="NHWC"===i?s[3]:s[1],d="NHWC"===i?u.shape[3]:u.shape[1];M(f===e.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+f+") must match input depth for filter "+e.shape[2]+"."}),M(d===e.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+e.shape[3]+"."}),null!=a&&M(cn(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var p=Rw(i),g=Du(s,e.shape,r,1,o,a,!1,p),m=B.runKernelFunc(function(y,w){var b=y.conv2dDerInput(u,e,g);return w([e,u]),b},{dy4D:u,filter:e},function(y,w){var b=w[0],C=w[1];return{dy4D:function(){return Uo(y,b,r,o,i,1,a)},filter:function(){return ZE(y,C,b.shape,r,o,i,a)}}});return c?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}function QE(t){var i,n="number"==typeof(i=t)?[i,i,i]:2===i.length?[i[0],i[1],1]:i;return 1===n[0]&&1===n[1]&&1===n[2]}function JO(t,n,e,r,o){M(t.length===n.rank,function(){return"Length of inShape ("+t.length+") and rank of dy ("+n.rank+") must match"});var i=t,a=n,s=!1;4===n.rank&&(s=!0,a=n.as5D(1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]),i=[1,t[0],t[1],t[2],t[3]]);var u=i[4],c=a.shape[4];M(5===i.length,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),M(5===a.rank,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),M(5===e.rank,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+e.rank}),M(u===e.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+e.shape[3]+"."}),M(c===e.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+e.shape[4]+"."});var f=zg(i,e.shape,r,1,o),d=B.runKernelFunc(function(p){return p.conv3dDerInput(a,e,f)},{dy5D:a});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var eL=V({conv1d_:function(t,n,e,r,o,i,a){void 0===o&&(o="NWC"),void 0===i&&(i=1);var s=R(t,"x","conv1d"),u=R(n,"filter","conv1d"),c=s,f=!1;2===s.rank&&(f=!0,c=s.as3D(1,s.shape[0],s.shape[1])),M(3===c.rank,function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."}),M(3===u.rank,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),null!=a&&M(cn(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),M(c.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),M(oo(e,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+e+" and dilation '"+i+"'"}),M("NWC"===o,function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),p=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),g=Uo(p,d,[1,e],r,"NHWC",[1,i],a);return f?g.as2D(g.shape[2],g.shape[3]):g.as3D(g.shape[0],g.shape[2],g.shape[3])}}),Uo=V({conv2d_:function(t,n,e,r,o,i,a){void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]);var s=R(t,"x","conv2d"),u=R(n,"filter","conv2d"),c=s,f=!1;3===s.rank&&(f=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),M(4===c.rank,function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."}),M(4===u.rank,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),null!=a&&M(cn(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d="NHWC"===o?c.shape[3]:c.shape[1];M(d===u.shape[2],function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."}),M(oo(e,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"});var p=Rw(o),g=Du(c.shape,u.shape,e,i,r,a,!1,p),y=B.runKernelFunc(function(w,b){var C=w.conv2d(c,u,g);return b([u,c]),C},{x:c,filter:u},function(w,b){var _=b[0],D=b[1];return M(el(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return nL(D.shape,w,_,e,r,o)},filter:function(){return ZE(D,w,_.shape,e,r,o)}}},"Conv2D",g,[u,c]);return f?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}}),tL=V({conv3d_:function(t,n,e,r,o,i){void 0===o&&(o="NDHWC"),void 0===i&&(i=[1,1,1]);var g,a=R(t,"x","conv3d"),s=R(n,"filter","conv3d"),u=a,c=!1;4===a.rank&&(c=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),M(5===u.rank,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),M(5===s.rank,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),M(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),M((g=i,QE(e)||QE(g)),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}),M("NDHWC"===o,function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var f=zg(u.shape,s.shape,e,i,r),d=B.runKernelFunc(function(p,g){var m=p.conv3d(u,s,f);return g([u,s]),m},{x:u,$filter:s},function(p,g){M(QE(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var m=g[0],y=g[1];return{x:function(){return JO(m.shape,p,y,e,r)},$filter:function(){return function(w,b,C,_,D){var E=w;4===w.rank&&(E=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]));var A=b;4===A.rank&&(A=b.as5D(1,b.shape[0],b.shape[1],b.shape[2],b.shape[3])),M(5===E.rank,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+E.shape+"."}),M(5===A.rank,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+A.shape+"."}),M(5===C.length,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+C+"."}),M(E.shape[4]===C[3],function(){return"Error in conv3dDerFilter: depth of input "+E.shape[4]+") must match input depth in filter ("+C[3]+"."}),M(A.shape[4]===C[4],function(){return"Error in conv3dDerFilter: depth of dy ("+A.shape[4]+") must match output depth for filter ("+C[4]+")."});var P=zg(E.shape,C,_,1,D);return B.runKernelFunc(function(k){return k.conv3dDerFilter(E,A,P)},{x5D:E,dy5D:A})}(m,p,y.shape,e,r)}}});return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),ZE=V({conv2dDerFilter_:function(t,n,e,r,o,i,a){void 0===i&&(i="NHWC");var s=t;3===t.rank&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=n;3===u.rank&&(u=n.as4D(1,n.shape[0],n.shape[1],n.shape[2])),M(4===s.rank,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),M(4===u.rank,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),M(4===e.length,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+e+"."});var c="NHWC"===i?s.shape[3]:s.shape[1],f="NHWC"===i?u.shape[3]:u.shape[1];M(c===e[2],function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+e[2]+"."}),M(f===e[3],function(){return"Error in conv2dDerFilter: depth of dy ("+f+") must match output depth for filter ("+e[3]+")."}),null!=a&&M(cn(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var d=Rw(i),p=Du(s.shape,e,r,1,o,a,!1,d);return B.runKernelFunc(function(g){return g.conv2dDerFilter(s,u,p)},{x4D:s,dy4D:u})}}),nL=V({conv2dDerInput_:ZO}),Jg=V({depthwiseConv2d_:function(t,n,e,r,o,i,a){void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]);var s=R(t,"x","depthwiseConv2d"),u=R(n,"filter","depthwiseConv2d"),c=s,f=!1;3===s.rank&&(f=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),M(4===c.rank,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."}),M(4===u.rank,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),M(c.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),null==i&&(i=[1,1]),M(oo(e,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+i+"'"}),null!=a&&M(cn(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var d=Du(c.shape,u.shape,e,i,r,a,!0),g=B.runKernelFunc(function(m,y){var w=m.depthwiseConv2D(c,u,d);return y([c,u]),w},{x:c,filter:u},function(m,y){M(el(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var w=y[0],b=y[1];return{x:function(){return rL(w.shape,m,b,d)},filter:function(){return oL(w,m,b.shape,d)}}},"DepthwiseConv2dNative",d,[c,u]);return f?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),rL=V({depthwiseConv2dDerInput_:function(t,n,e,r){var o=n,i=!1;3===n.rank&&(i=!0,o=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]));var a=B.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(o,e,r)},{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),oL=V({depthwiseConv2dDerFilter_:function(t,n,e,r){var o=t;3===t.rank&&(o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var i=n;return 3===i.rank&&(i=n.as4D(1,n.shape[0],n.shape[1],n.shape[2])),B.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(o,i,r)},{x4D:o,dy4D:i})}}),Hw=V({separableConv2d_:function(t,n,e,r,o,i,a){void 0===i&&(i=[1,1]),void 0===a&&(a="NHWC");var s=R(t,"x","separableConv2d"),u=R(n,"depthwiseFilter","separableConv2d"),c=R(e,"pointwiseFilter","separableConv2d"),f=s,d=!1;if(3===s.rank&&(d=!0,f=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===a)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");M(4===f.rank,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+f.rank+"."}),M(4===u.rank,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),M(4===c.rank,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),M(1===c.shape[0],function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."}),M(1===c.shape[1],function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."});var p=u.shape[2],g=u.shape[3];M(c.shape[2]===p*g,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+p*g+", but got "+c.shape[2]+"."});var m=Jg(f,u,r,o,a,i),y=Uo(m,c,1,"valid",a);return d?y.as3D(y.shape[1],y.shape[2],y.shape[3]):y}}),iL=V({conv2dTranspose_:function(t,n,e,r,o,i){return ZO(e,R(t,"x","conv2dTranspose"),R(n,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),aL=V({conv3dTranspose_:function(t,n,e,r,o){return JO(e,R(t,"x","conv3dTranspose"),R(n,"filter","conv3dTranspose"),r,o)}}),ev=V({matMul_:function(t,n,e,r){var o;void 0===e&&(e=!1),void 0===r&&(r=!1);var i=R(t,"a","matMul"),a=R(n,"b","matMul");o=tn(i,a),i=o[0],a=o[1];var s=e?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],c=e?i.shape[i.rank-1]:i.shape[i.rank-2],f=r?a.shape[a.rank-2]:a.shape[a.rank-1],d=i.shape.slice(0,-2),p=a.shape.slice(0,-2),g=_e(d),m=_e(p);M(i.rank>=2&&a.rank>=2&&i.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."}),M(Fn(d,p),function(){return"Error in matMul: outer dimensions ("+d+") and ("+p+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."}),M(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+e+" and transposeB="+r+" must match."});var y=i.shape.slice(0,-2).concat([c,f]),w=e?i.as3D(g,s,c):i.as3D(g,c,s),b=r?a.as3D(m,f,u):a.as3D(m,u,f);return B.runKernelFunc(function(_,D){var E=_.batchMatMul(w,b,e,r);return D([w,b]),E},{a:w,b},function(_,D){var A=D[0],P=D[1];return e||r?!e&&r?{a:function(){return _.matMul(P,!1,!1)},b:function(){return _.matMul(A,!0,!1)}}:e&&!r?{a:function(){return P.matMul(_,!1,!0)},b:function(){return A.matMul(_,!1,!1)}}:{a:function(){return P.matMul(_,!0,!0)},b:function(){return _.matMul(A,!0,!0)}}:{a:function(){return _.matMul(P,!1,!0)},b:function(){return A.matMul(_,!0,!1)}}},"BatchMatMul",{transposeA:e,transposeB:r}).reshape(y)}}),sL=V({dot_:function(t,n){var e=R(t,"t1","dot"),r=R(n,"t2","dot");M(!(1!==e.rank&&2!==e.rank||1!==r.rank&&2!==r.rank),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+e.rank+" and "+r.rank+"."});var o=1===e.rank?e.size:e.shape[1],i=1===r.rank?r.size:r.shape[0];return M(o===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."}),1===e.rank&&1===r.rank?e.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===e.rank&&2===r.rank?e.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===e.rank&&1===r.rank?e.matMul(r.as2D(-1,1)).as1D():e.matMul(r.as2D(r.shape[0],r.shape[1]))}}),uL=V({outerProduct_:function(t,n){var e=R(t,"v1","outerProduct"),r=R(n,"v2","outerProduct");return M(1===e.rank&&1===r.rank,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+e.rank+" and "+r.rank+"."}),e.as2D(-1,1).matMul(r.as2D(1,-1))}}),Jf=V({reverse_:function(t,n){var e=R(t,"x","reverse");if(0===e.rank)return e.clone();var r=kn(n,e.shape);return B.runKernelFunc(function(o){return o.reverse(e,r)},{$x:e},function(o){return{$x:function(){return o.reverse(r)}}}).reshapeAs(e)}}),cL=V({reverse1d_:function(t){var n=R(t,"x","reverse");return M(1===n.rank,function(){return"Error in reverse1D: x must be rank 1 but got rank "+n.rank+"."}),Jf(n,0)}}),lL=V({reverse2d_:function(t,n){var e=R(t,"x","reverse");return M(2===e.rank,function(){return"Error in reverse2D: x must be rank 2 but got rank "+e.rank+"."}),Jf(e,n)}}),fL=V({reverse3d_:function(t,n){var e=R(t,"x","reverse");return M(3===e.rank,function(){return"Error in reverse3D: x must be rank 3 but got rank "+e.rank+"."}),Jf(e,n)}}),dL=V({reverse4d_:function(t,n){var e=R(t,"x","reverse");return M(4===e.rank,function(){return"Error in reverse4D: x must be rank 4 but got rank "+e.rank+"."}),Jf(e,n)}});function hL(t,n,e,r,o,i){var a=R(t,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),null==r&&(r=[1,1]),M(4===s.rank,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),M(oo(e,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+r+"'"}),null!=i&&M(cn(o),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var c=qf(s.shape,n,e,r,o,i);if(1===c.filterWidth&&1===c.filterHeight&&Fn(c.inShape,c.outShape))return a.clone();var d=B.runKernelFunc(function(p,g){var m=p.maxPool(s,c);return g([s,m]),m},{x:s},function(p,g){var m=g[0],y=g[1];return{x:function(){return function(w,b,C,_,D,E,A,P){var k=R(w,"dy","maxPoolBackprop"),N=R(b,"input","maxPoolBackprop"),F=R(C,"output","maxPoolBackprop");M(N.rank===k.rank,function(){return"Rank of input ("+N.rank+") does not match rank of dy ("+k.rank+")"}),null==E&&(E=[1,1]),M(oo(D,E),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+D+" and dilations '"+E+"'"}),M(4===k.rank,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+k.rank+"."}),M(4===N.rank,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+N.rank+"."});var H=qf(N.shape,_,D,E,A,void 0);return B.runKernelFunc(function(W){return W.maxPoolBackprop(k,N,F,H)},{$dy:k,$input:N})}(p,m,y,n,e,r,o)}}},"MaxPool",c,[s]);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function pL(t,n,e,r,o,i){var a=R(t,"x","avgPool","float32");null==r&&(r=[1,1]),M(oo(e,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+r+"'"});var s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),M(4===s.rank,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),null!=i&&M(cn(o),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var c=qf(s.shape,n,e,r,o,i);if(1===c.filterWidth&&1===c.filterHeight&&Fn(c.inShape,c.outShape))return a.clone();var f=B.runKernelFunc(function(d){return d.avgPool(s,c)},{x:s},function(d){return{x:function(){return function(p,g,m,y,w,b){var C=R(p,"dy","avgPoolBackprop"),_=R(g,"input","avgPoolBackprop");M(_.rank===C.rank,function(){return"Rank of input ("+_.rank+") does not match rank of dy ("+C.rank+")"}),null==w&&(w=[1,1]),M(oo(y,w),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+y+" and dilations '"+w+"'"});var D=_,E=C,A=!1;3===_.rank&&(A=!0,D=_.as4D(1,_.shape[0],_.shape[1],_.shape[2]),E=C.as4D(1,C.shape[0],C.shape[1],C.shape[2])),M(4===E.rank,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+E.rank+"."}),M(4===D.rank,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+D.rank+"."});var P=qf(D.shape,m,y,w,b),k=B.runKernelFunc(function(N){return N.avgPoolBackprop(E,D,P)},{dy4D:E,input4D:D});return A?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}(d,s,n,e,r,o)}}},"AvgPool",c);return f=f.cast(a.dtype),u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}var Kn=V({maxPool_:function(t,n,e,r,o){return hL(t,n,e,1,r,o)}}),ed=V({avgPool_:function(t,n,e,r,o){return pL(t,n,e,1,r,o)}}),gL=V({pool_:function(t,n,e,r,o,i){null==o&&(o=[1,1]),null==i&&(i=1),0===r&&(r="valid");var a=R(t,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),M(oo(i,o),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"});var c,E,A,P,k,f=qf(s.shape,n,i,o,r),d=[f.dilationHeight,f.dilationWidth];c="same"===r?(E=d,A=[f.filterHeight,f.filterWidth].map(function(N,F){return N+(N-1)*(E[F]-1)}).map(function(N){return N-1}),P=A.map(function(N){return Math.floor(N/2)}),k=A.map(function(N,F){return N-P[F]}),A.map(function(N,F){return[P[F],k[F]]})):[[0,0],[0,0]];var p=1===d[0]&&1===d[1],g=function(D,E,A){var P=A.map(function(Y){return Y[0]}),k=A.map(function(Y){return Y[1]}),N=D.concat(P,k),F=E.map(function(Y,Q){return(Y-N[Q]%Y)%Y}),H=k.map(function(Y,Q){return Y+F[Q]});return[E.map(function(Y,Q){return[P[Q],H[Q]]}),E.map(function(Y,Q){return[0,F[Q]]})]}([f.inHeight,f.inWidth],d,c),y=g[1],w=p?r:"valid",b=p?s:pE(s,d,g[0]),C=("avg"===e?function(){return pL(b,n,i,1,w)}:function(){return hL(b,n,i,1,w)})(),_=p?C:fE(C,d,y);return u?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),vL=V({maxPool3d_:function(t,n,e,r,o,i,a){void 0===i&&(i="NDHWC");var s=R(t,"x","maxPool3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),M(5===u.rank,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),M("NDHWC"===i,function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),M(oo(e,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+a+"'"}),null!=o&&M(cn(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var f=jg(u.shape,n,e,a,r,o,i),d=B.runKernelFunc(function(p,g){var m=p.maxPool3d(u,f);return g([u,m]),m},{x:u},function(p,g){var m=g[0],y=g[1];return{x:function(){return function(w,b,C,_,D,E,A,P){var k=R(w,"dy","maxPool3dBackprop"),N=R(b,"input","maxPool3dBackprop"),F=R(C,"output","maxPool3dBackprop"),H=k,W=N,Z=F,Y=!1;4===N.rank&&(Y=!0,H=k.as5D(1,k.shape[0],k.shape[1],k.shape[2],k.shape[3]),W=N.as5D(1,N.shape[0],N.shape[1],N.shape[2],N.shape[3]),Z=F.as5D(1,F.shape[0],F.shape[1],F.shape[2],F.shape[3])),M(5===H.rank,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+H.rank+"."}),M(5===W.rank,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+W.rank+"."}),M(5===Z.rank,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+Z.rank+"."}),null==E&&(E=[1,1,1]),M(oo(D,E),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+D+" and dilations '"+E+"'"}),null!=P&&M(cn(A),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+P+" but got pad "+A+"."});var Q=jg(W.shape,_,D,E,A,P),re=B.runKernelFunc(function(ne){return ne.maxPool3dBackprop(H,W,Z,Q)},{dy5D:H,input5D:W});return Y?re.as4D(re.shape[1],re.shape[2],re.shape[3],re.shape[4]):re}(p,m,y,n,e,a,r,o)}}});return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),mL=V({avgPool3d_:function(t,n,e,r,o,i,a){void 0===i&&(i="NDHWC");var s=R(t,"x","avgPool3d","float32"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),M(5===u.rank,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),M("NDHWC"===i,function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),M(oo(e,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+e+" and dilations '"+a+"'"}),null!=o&&M(cn(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var f=jg(u.shape,n,e,a,r,o,i),d=B.runKernelFunc(function(p){return p.avgPool3d(u,f)},{x:u},function(p){return{x:function(){return function(g,m,y,w,b,C,_){var D=R(g,"dy","avgPool3dBackprop"),E=R(m,"input","avgPool3dBackprop"),A=D,P=E,k=!1;4===E.rank&&(k=!0,A=D.as5D(1,D.shape[0],D.shape[1],D.shape[2],D.shape[3]),P=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3])),M(5===A.rank,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+A.rank+"."}),M(5===P.rank,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+P.rank+"."}),null==b&&(b=[1,1,1]),M(oo(w,b),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+b+"'"}),null!=_&&M(cn(C),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+_+" but got pad "+C+"."});var N=jg(P.shape,y,w,b,C,_),F=B.runKernelFunc(function(H){return H.avgPool3dBackprop(A,P,N)},{dy5D:A,input5D:P});return k?F.as4D(F.shape[1],F.shape[2],F.shape[3],F.shape[4]):F}(p,u,n,e,a,r,o)}}});return d=d.cast(u.dtype),c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Qi=V({slice_:function(t,n,e){var r,o,i=R(t,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof n?[n].concat(new Array(i.rank-1).fill(0)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(0)):n.slice()).forEach(function(u){M(-1!==u,function(){return"slice() does not support negative begin indexing."})}),o=(o=null==e?new Array(i.rank).fill(-1):"number"==typeof e?[e].concat(new Array(i.rank-1).fill(-1)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(-1)):e).map(function(u,c){return u>=0?u:(M(-1===u,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+c+"."}),i.shape[c]-r[c])}),Pk(i,r,o);var a=i.shape;return B.runKernelFunc(function(u){return u.slice(i,r,o)},{x:i},function(u){for(var c=[],f=0;f<u.rank;f++)c.push([r[f],a[f]-r[f]-o[f]]);return{x:function(){return u.pad(c)}}},"Slice",{begin:r,size:o})}}),yL=V({slice1d_:function(t,n,e){var r=R(t,"x","slice1d");return M(1===r.rank,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Qi(r,[n],[e])}}),wL=V({slice2d_:function(t,n,e){var r=R(t,"x","slice2d");return M(2===r.rank,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Qi(r,n,e)}}),JE=V({slice3d_:function(t,n,e){var r=R(t,"x","slice3d");return M(3===r.rank,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Qi(r,n,e)}}),bL=V({slice4d_:function(t,n,e){var r=R(t,"x","slice4d");return M(4===r.rank,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Qi(r,n,e)}});function xL(t,n,e,r,o){return n.rank<e.rank&&(n=n.reshape(no(n.shape,r))),t.rank<e.rank&&(t=t.reshape(no(t.shape,r))),{x:function(){var i=t.mul(e.equal(n).cast(t.dtype));return null==o?i:i.transpose(o)}}}var _L=V({all_:function(t,n,e){void 0===n&&(n=null),void 0===e&&(e=!1);var r=R(t,"x","all","bool"),o=kn(n,r.shape),i=o,a=Gi(i,r.rank);null!=a&&(r=r.transpose(a),i=qi(i.length,r.rank));var s=B.runKernelFunc(function(c){return c.all(r,i)},{$x:r});if(e){var u=no(s.shape,o);return s.reshape(u)}return s}}),CL=V({any_:function(t,n,e){void 0===n&&(n=null),void 0===e&&(e=!1);var r=R(t,"x","any","bool"),o=kn(n,r.shape),i=o,a=Gi(i,r.rank);null!=a&&(r=r.transpose(a),i=qi(i.length,r.rank));var s=B.runKernelFunc(function(c){return c.any(r,i)},{$x:r});if(e){var u=no(s.shape,o);return s.reshape(u)}return s}}),DL=V({argMax_:function(t,n){void 0===n&&(n=0);var e=R(t,"x","argMax");null==n&&(n=0);var r=kn(n,e.shape),o=Gi(r,e.rank);return null!=o&&(e=e.transpose(o),r=qi(r.length,e.rank)),B.runKernelFunc(function(s,u){var c=s.argMax(e,r[0]);return u([e]),c},{x:e},function(s,u){var c=u[0];return{x:function(){return vt(c)}}},"ArgMax",{axis:r[0]},[e])}}),EL=V({argMin_:function(t,n){void 0===n&&(n=0);var e=R(t,"x","argMin");null==n&&(n=0);var r=kn(n,e.shape),o=Gi(r,e.rank);return null!=o&&(e=e.transpose(o),r=qi(r.length,e.rank)),B.runKernelFunc(function(i,a){var s=i.argMin(e,r[0]);return a([e]),s},{$x:e},function(i,a){var s=a[0];return{$x:function(){return vt(s)}}})}}),IL=V({logSumExp_:function(t,n,e){void 0===n&&(n=null),void 0===e&&(e=!1);var r=R(t,"x","logSumExp"),o=kn(n,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(e){var u=no(s.shape,o);return s.reshape(u)}return s}}),tv=V({max_:function(t,n,e){void 0===n&&(n=null),void 0===e&&(e=!1);var r=R(t,"x","max"),o=r,i=kn(n,r.shape),a=i,s=Gi(a,r.rank);null!=s&&(r=r.transpose(s),a=qi(a.length,r.rank));var c=B.runKernelFunc(function(d,p){var g=d.max(r,a);return p([o,g]),g},{x:r},function(d,p){return xL(d,p[1],p[0],i,s)},"Max",{axes:a},[r],[!0]);if(e){var f=no(c.shape,i);c=c.reshape(f)}return c}}),SL=V({mean_:function(t,n,e){void 0===n&&(n=null),void 0===e&&(e=!1);var r=R(t,"x","mean"),o=kn(n,r.shape),i=_e(Ir(r.shape,o)[1]);return Hg(function(a){var s=le(i);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(n,e),gradFunc:function(u){var c=a.shape.slice();return o.forEach(function(f){c[f]=1}),u.reshape(c).mul(Yc(a.shape,"float32")).div(i)}}})(r)}}),AL=V({min_:function(t,n,e){void 0===n&&(n=null),void 0===e&&(e=!1);var r=R(t,"x","min"),o=r,i=kn(n,r.shape),a=i,s=Gi(a,r.rank);null!=s&&(r=r.transpose(s),a=qi(a.length,r.rank));var c=B.runKernelFunc(function(d,p){var g=d.min(r,a);return p([o,g]),g},{x:r},function(d,p){return xL(d,p[1],p[0],i,s)},"Min",{axes:a},[r],[!0]);if(e){var f=no(c.shape,i);c=c.reshape(f)}return c}}),TL=V({moments_:function(t,n,e){void 0===n&&(n=null),void 0===e&&(e=!1);var r=kn(n,(t=R(t,"x","moments")).shape),o=t.mean(r,e),i=o.shape;e||(i=no(o.shape,r));var a=t.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,e)}}}),eI=V({sum_:function(t,n,e){void 0===n&&(n=null),void 0===e&&(e=!1);var r=R(t,"x","sum");"bool"===r.dtype&&(r=r.toInt());var o=kn(n,r.shape);return Hg(function(i){var a=Gi(o,i.rank),s=o,u=i;null!=a&&(u=i.transpose(a),s=qi(s.length,i.rank));var c=function(g){var m=i.shape.slice();return o.forEach(function(y){m[y]=1}),g.reshape(m).mul(Yc(i.shape,"float32"))},d=B.runKernelFunc(function(g){return g.sum(u,s)},{x:u},function(g){return{x:function(){return c(g)}}},"Sum",{axes:s});if(e){var p=no(d.shape,o);d=d.reshape(p)}return{value:d,gradFunc:c}})(r)}}),RL=V({prod_:function(t,n,e){void 0===n&&(n=null),void 0===e&&(e=!1);var r=R(t,"x","prod");"bool"===r.dtype&&(r=r.toInt());var o=kn(n,r.shape),i=Gi(o,r.rank),a=o,s=r;null!=i&&(s=r.transpose(i),a=qi(a.length,r.rank));var u=B.runKernelFunc(function(f){return f.prod(s,a)},{permutedX:s});if(e){var c=no(u.shape,o);u=u.reshape(c)}return u}}),tI=V({elu_:function(t){var n=R(t,"x","elu");return B.runKernelFunc(function(e,r){var o=e.elu(n);return r([o]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){return B.runKernelFunc(function(i){return i.eluDer(e,o)},{dy:e,y:o})}}})}}),ML=V({leakyRelu_:function(t,n){void 0===n&&(n=.2);var e=R(t,"x","leakyRelu");return Uw(le(n).mul(e),e)}}),nI=V({prelu_:function(t,n){var e=R(t,"x","prelu"),r=R(n,"alpha","prelu");return B.runKernelFunc(function(o,i){var a=o.prelu(e,r);return i([e,r]),a},{x:e,alpha:r},function(o,i){var a=i[0],s=i[1],u=a.greater(0);return{x:function(){return Eu(u,o,o.mul(s))},alpha:function(){var c=Eu(u,vt(o),o.mul(a)),f=Ln(s.shape,o.shape);return f.length>0&&(c=c.sum(f)),c.reshape(s.shape)}}},"Prelu")}}),nn=V({relu_:function(t){var n=R(t,"x","relu");return"bool"===n.dtype?n.toInt():B.runKernelFunc(function(e,r){var o=e.relu(n);return r([n]),o},{x:n},function(e,r){var o=r[0];return{x:function(){return e.mulStrict(o.step().toFloat())}}},"Relu")}}),rI=V({relu6_:function(t){var n=R(t,"x","relu6");return"bool"===n.dtype?n.toInt():B.runKernelFunc(function(e,r){var o=e.relu6(n);return r([n]),o},{x:n},function(e,r){var o=r[0],i=o.lessEqual(6).mul(o.step());return{x:function(){return e.mulStrict(i.toFloat())}}},"Relu6")}}),NL=V({selu_:function(t){var n=R(t,"x","selu");return B.runKernelFunc(function(e,r){var o=e.selu(n);return r([n]),o},{$x:n},function(e,r){var o=r[0];return{$x:function(){var i=o.greater(le(0)),a=le(1.7580993408473768),s=le(1.0507009873554805),u=e.mul(s),c=e.mul(a).mul(o.toFloat().exp());return Eu(i,u,c)}}})}}),Cs=V({transpose_:function(t,n){var e=R(t,"x","transpose");return null==n&&(n=e.shape.map(function(o,i){return i}).reverse()),M(e.rank===n.length,function(){return"Error in transpose: rank of input "+e.rank+" must match length of perm "+n+"."}),n.forEach(function(o){M(o>=0&&o<e.rank,function(){return"All entries in 'perm' must be between 0 and "+(e.rank-1)+" but got "+n})}),e.rank<=1?e.clone():B.runKernelFunc(function(o){return o.transpose(e,n)},{x:e},function(o){var i=yw(n);return{x:function(){return o.transpose(i)}}},"Transpose",{perm:n})}}),FL=V({localResponseNormalization_:function(t,n,e,r,o){void 0===n&&(n=5),void 0===e&&(e=1),void 0===r&&(r=1),void 0===o&&(o=.5);var i=R(t,"x","localResponseNormalization");M(4===i.rank||3===i.rank,function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+i.rank+"."}),M(cn(n),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+n+"."});var a=i,s=!1;3===i.rank&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=B.runKernelFunc(function(c,f){var d=c.localResponseNormalization4D(a,n,e,r,o);return f([a,d]),d},{x4D:a},function(c,f){var d=f[0],p=f[1];return{x4D:function(){return B.runKernelFunc(function(g){return g.LRNGrad(c,d,p,n,e,r,o)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),oI=V({norm_:function(t,n,e,r){void 0===n&&(n="euclidean"),void 0===e&&(e=null),void 0===r&&(r=!1);var o=function s(u,c,f){if(void 0===f&&(f=null),0===u.rank)return u.abs();if(1!==u.rank&&null===f)return s(u.reshape([-1]),c,f);if(1===u.rank||"number"==typeof f||Array.isArray(f)&&1===f.length){if(1===c)return u.abs().sum(f);if(c===1/0)return u.abs().max(f);if(c===-1/0)return u.abs().min(f);if("euclidean"===c||2===c)return u.abs().pow(le(2,"int32")).sum(f).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}if(Array.isArray(f)&&2===f.length){if(1===c)return u.abs().sum(f[0]).max(f[1]-1);if(c===1/0)return u.abs().sum(f[1]).max(f[0]);if(c===-1/0)return u.abs().sum(f[1]).min(f[0]);if("fro"===c||"euclidean"===c)return u.square().sum(f).sqrt();throw new Error("Error in norm: invalid ord value: "+c)}throw new Error("Error in norm: invalid axis: "+f)}(t=R(t,"x","norm"),n,e),i=o.shape;if(r){var a=kn(e,t.shape);i=no(o.shape,a)}return o.reshape(i)}}),kL=V({basicLSTMCell_:function(t,n,e,r,o,i){var a=R(t,"forgetBias","basicLSTMCell"),s=R(n,"lstmKernel","basicLSTMCell"),u=R(e,"lstmBias","basicLSTMCell"),c=R(r,"data","basicLSTMCell"),f=R(o,"c","basicLSTMCell"),d=R(i,"h","basicLSTMCell"),p=c.concat(d,1).matMul(s).add(u),m=p.shape[1]/4,y=[p.shape[0],m],w=p.slice([0,0],y),b=p.slice([0,m],y),C=p.slice([0,2*m],y),_=p.slice([0,3*m],y),D=w.sigmoid().mulStrict(b.tanh()).addStrict(f.mulStrict(a.add(C).sigmoid())),E=D.tanh().mulStrict(_.sigmoid());return[D,E]}}),PL=V({multiRNNCell_:function(t,n,e,r){for(var o=R(n,"data","multiRNNCell"),i=Vg(e,"c","multiRNNCell"),a=Vg(r,"h","multiRNNCell"),s=o,u=[],c=0;c<t.length;c++){var f=t[c](s,i[c],a[c]);u.push(f[0]),u.push(f[1]),s=f[1]}var d=[],p=[];for(c=0;c<u.length;c+=2)d.push(u[c]),p.push(u[c+1]);return[d,p]}}),OL=V({movingAverage_:function(t,n,e,r,o){void 0===o&&(o=!0);var i=R(t,"v","movingAverage"),a=R(n,"x","movingAverage"),s=R(e,"decay","movingAverage");TF(i,a),M(Fn(i.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=le(1),c=u.sub(s),f=a.sub(i).mul(c);if(o){M(null!=r,function(){return"When using zeroDebias: true, step is required."});var d=R(r,"step","movingAverage");f=f.div(u.sub(Zg(s,d)))}return i.add(f)}}),LL=V({stridedSlice_:function(t,n,e,r,o,i,a,s,u){if(void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(n.length)),0!==a)throw new Error("ellipsis mask is not yet supported");var c=R(t,"x","stridedSlice"),f=yE(s),d=c.shape.slice();f.forEach(function(w){n[w]=0,e[w]=1,d.splice(w,0,1)}),c=c.reshape(d);for(var p=0;p<c.rank;p++)n[p]=Ok(o,n,r,c.shape,p),e[p]=Lk(i,e,r,c.shape,p),r[p]=r[p]||1;var g=yE(u);g.forEach(function(w){e[w]=n[w]+1,r[w]=1});var m=Sw(n,e,r),y=m.filter(function(w,b){return-1===g.indexOf(b)});return r.every(function(w){return 1===w})?Qi(c,n,m).reshape(y):B.runKernelFunc(function(w){return w.stridedSlice(c,n,e,r)},{$x:c}).reshape(y)}}),BL=V({topk_:function(t,n,e){void 0===n&&(n=1),void 0===e&&(e=!0);var r=R(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(n>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+n);var i=B.runKernelFunc(function(a){return a.topk(r,n,e)},{$x:r});return{values:i[0],indices:i[1]}}}),VL=V({scatterND_:function(t,n,e){var r=R(t,"indices","scatterND","int32"),o=R(n,"updates","scatterND");return kk(o,r,e),B.runKernelFunc(function(i){return i.scatterND(r,o,e)},{indices:r,updates:o},null,"ScatterNd",{shape:e})}}),jw=V({fft_:function(t){M("complex64"===t.dtype,function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."});var n=t.shape[t.shape.length-1],r=t.as2D(t.size/n,n);return B.runKernelFunc(function(o){return o.fft(r)},{input:t}).reshape(t.shape)}}),nv=V({ifft_:function(t){M("complex64"===t.dtype,function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."});var n=t.shape[t.shape.length-1],r=t.as2D(t.size/n,n);return B.runKernelFunc(function(o){return o.ifft(r)},{input:t}).reshape(t.shape)}}),zw=V({rfft_:function(t,n){M("float32"===t.dtype,function(){return"The dtype for rfft() must be real value but got "+t.dtype});var e,r=t.shape[t.shape.length-1],o=t.size/r;if(null!=n&&n<r){var i=t.shape.map(function(b){return 0}),a=t.shape.map(function(b){return b});a[t.shape.length-1]=n,e=t.slice(i,a),r=n}else if(null!=n&&n>r){var s=t.shape.map(function(b){return b});s[t.shape.length-1]=n-r,e=t.concat(qt(s),t.shape.length-1),r=n}else e=t;var u=e.zerosLike(),c=ar(e,u).as2D(o,r),f=jw(c),d=Math.floor(r/2)+1,p=Bo(f),g=Ki(f),m=p.split([d,r-d],p.shape.length-1),y=g.split([d,r-d],g.shape.length-1),w=e.shape.slice();return w[e.shape.length-1]=d,ar(m[0],y[0]).reshape(w)}}),iI=V({irfft_:function(t){var n=t.shape[t.shape.length-1],e=t.size/n;if(n<=2){var r=t.as2D(e,n),o=nv(r);return Bo(o)}var i=[e,2*(n-1)],a=Bo(t).as2D(e,n),s=Ki(t).as2D(e,n),u=a.slice([0,1],[e,n-2]).reverse(1),c=s.slice([0,1],[e,n-2]).reverse(1).mul(le(-1)),f=a.concat(u,1),d=s.concat(c,1);return r=ar(f,d).as2D(i[0],i[1]),o=nv(r),Bo(o)}}),UL=Object.freeze({fft:jw,ifft:nv,rfft:zw,irfft:iI}),WL=V({sparseToDense_:function(t,n,e,r){void 0===r&&(r=0);var o=R(t,"sparseIndices","sparseToDense","int32"),i=R(n,"sparseValues","sparseToDense"),a=R(r,"defaultValue","sparseToDense",i.dtype);return function(s,u,c,f){if("int32"!==s.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var d=s.rank>0?s.shape[0]:1,p=s.rank>1?s.shape[1]:1;if(c.length!==p)throw new Error("outputShape has incorrect number of elements:, "+c.length+", should be: "+p+".");if(0!==u.rank&&(1!==u.rank||u.size!==d))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+d+"]");if(u.dtype!==f.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,e,a),B.runKernelFunc(function(s){return s.sparseToDense(o,i,e,a)},{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),HL=V({gatherND_:function(t,n){var e=R(n,"indices","gatherND","int32"),r=R(t,"x","gatherND");return B.runKernelFunc(function(o){return o.gatherND(r,e)},{x:r,indices:e},null,"GatherNd")}}),jL=V({diag_:function(t){var n=R(t,"x","diag").flatten(),e=t.shape.concat(t.shape);return B.runKernelFunc(function(r){return r.diag(n)},{$x:n}).reshape(e)}}),zL=V({dropout_:function(t,n,e,r){var o=R(t,"x","dropout");if(M("float32"===o.dtype,function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."}),M(n>=0&&n<1,function(){return"rate must be a float in the range [0, 1), but got "+n+"."}),0===n)return t instanceof Ut?o.clone():o;var i=function(u,c){if(null==c)return u.shape.slice();if(Fn(u.shape,c))return c;if(u.shape.length===c.length){for(var f=[],d=0;d<u.shape.length;d++)f.push(null==c[d]&&null!=u.shape[d]?u.shape[d]:c[d]);return f}return c}(o,e),a=1-n,s=hE(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function $L(t,n,e){for(var r=1-t%2,o=new Float32Array(t),i=0;i<t;++i){var a=2*Math.PI*i/(t+r-1);o[i]=n-e*Math.cos(a)}return Dn(o,"float32")}var Ar,$w=V({hannWindow_:function(t){return $L(t,.5,.5)}}),aI=V({hammingWindow_:function(t){return $L(t,.54,.46)}}),Gw=V({frame_:function(t,n,e,r,o){void 0===r&&(r=!1),void 0===o&&(o=0);for(var i=0,a=[];i+n<=t.size;)a.push(Qi(t,i,n)),i+=e;if(r)for(;i<t.size;){var s=i+n-t.size,u=Pn([Qi(t,i,n-s),Xi([s],o)]);a.push(u),i+=e}return 0===a.length?bs([],[0,n]):Pn(a).as2D(a.length,n)}}),sI=V({stft_:function(t,n,e,r,o){void 0===o&&(o=$w),null==r&&(r=Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2)))));for(var a=Gw(t,n,e),s=Sr(a,o(n)),u=[],c=0;c<a.shape[0];c++)u.push(zw(s.slice([c,0],[1,n]),r));return Pn(u)}}),GL=Object.freeze({hannWindow:$w,hammingWindow:aI,frame:Gw,stft:sI}),qL=function(t,n,e){return void 0===e&&(e=1),be(this,void 0,void 0,function(){var r,o,i,a,s,u,c,f,d,p,g,m,y,w;return xe(this,function(b){switch(b.label){case 0:return r=R(t,"predictions","inTopK"),o=R(n,"targets","inTopK"),M(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),M(r.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank}),Et(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],M(e>0&&e<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+e}),[4,r.data()];case 1:return a=b.sent(),[4,o.data()];case 2:for(s=b.sent(),f=(u=[a.length/i,i])[1],d=jf("bool",c=u[0]),p=0;p<c;p++){for(m=a.subarray(g=p*f,g+f),y=[],w=0;w<m.length;w++)y.push({value:m[w],index:w});for(y.sort(function(C,_){return _.value-C.value}),d[p]=0,w=0;w<e;w++)if(y[w].index===s[p]){d[p]=1;break}}return t!==r&&r.dispose(),n!==o&&o.dispose(),[2,sr(d,o.shape,"bool")]}})})};!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Ar||(Ar={}));var oq=V({absoluteDifference_:function(t,n,e,r){void 0===r&&(r=Ar.SUM_BY_NONZERO_WEIGHTS);var o=R(t,"labels","absoluteDifference"),i=R(n,"predictions","absoluteDifference"),a=null;null!=e&&(a=R(e,"weights","absoluteDifference")),Et(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return Ds(s,a,r)}}),Ds=V({computeWeightedLoss_:function(t,n,e){void 0===e&&(e=Ar.SUM_BY_NONZERO_WEIGHTS);var r=R(t,"losses","computeWeightedLoss"),o=null;null!=n&&(o=R(n,"weights","computeWeightedLoss"));var i=null==o?r:r.mul(o);if(e===Ar.NONE)return i;if(e===Ar.SUM)return i.sum();if(e===Ar.MEAN){if(null==o)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(le(a)):s}if(e===Ar.SUM_BY_NONZERO_WEIGHTS){if(null==o)return i.sum().div(le(r.size));var u=o.mul(Yc(r.shape)).notEqual(le(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+e)}}),iq=V({cosineDistance_:function(t,n,e,r,o){void 0===o&&(o=Ar.SUM_BY_NONZERO_WEIGHTS);var i=R(t,"labels","cosineDistance"),a=R(n,"predictions","cosineDistance"),s=null;null!=r&&(s=R(r,"weights","cosineDistance")),Et(i.shape,a.shape,"Error in cosineDistance: ");var u=le(1).sub(i.mul(a).sum(e,!0));return Ds(u,s,o)}}),aq=V({hingeLoss_:function(t,n,e,r){void 0===r&&(r=Ar.SUM_BY_NONZERO_WEIGHTS);var o=R(t,"labels","hingeLoss"),i=R(n,"predictions","hingeLoss"),a=null;null!=e&&(a=R(e,"weights","hingeLoss")),Et(o.shape,i.shape,"Error in hingeLoss: ");var s=le(1);o=le(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return Ds(u,a,r)}}),sq=V({huberLoss_:function(t,n,e,r,o){void 0===r&&(r=1),void 0===o&&(o=Ar.SUM_BY_NONZERO_WEIGHTS);var i=R(t,"labels","huberLoss"),a=R(n,"predictions","huberLoss"),s=null;null!=e&&(s=R(e,"weights","huberLoss")),Et(i.shape,a.shape,"Error in huberLoss: ");var u=le(r),c=a.sub(i).abs(),f=qE(c,u),d=c.sub(f),p=le(.5).mul(f.square()).add(u.mul(d));return Ds(p,s,o)}}),uq=V({logLoss_:function(t,n,e,r,o){void 0===r&&(r=1e-7),void 0===o&&(o=Ar.SUM_BY_NONZERO_WEIGHTS);var i=R(t,"labels","logLoss"),a=R(n,"predictions","logLoss"),s=null;null!=e&&(s=R(e,"weights","logLoss")),Et(i.shape,a.shape,"Error in logLoss: ");var u=le(1),c=le(r),f=i.mul(a.add(c).log()).neg().sub(u.sub(i).mul(u.sub(a).add(c).log()));return Ds(f,s,o)}}),cq=V({meanSquaredError_:function(t,n,e,r){void 0===r&&(r=Ar.SUM_BY_NONZERO_WEIGHTS);var o=R(t,"labels","meanSquaredError"),i=R(n,"predictions","meanSquaredError"),a=null;null!=e&&(a=R(e,"weights","meanSquaredError")),Et(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return Ds(s,a,r)}}),lq=V({sigmoidCrossEntropy_:function(t,n,e,r,o){void 0===r&&(r=0),void 0===o&&(o=Ar.SUM_BY_NONZERO_WEIGHTS);var i=R(t,"multiClassLabels","sigmoidCrossEntropy"),a=R(n,"logits","sigmoidCrossEntropy"),s=null;if(null!=e&&(s=R(e,"weights","sigmoidCrossEntropy")),Et(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=le(r),c=le(1),f=le(.5);i=i.mul(c.sub(u)).add(f.mul(u))}var d=function(p,g){var m=R(p,"labels","sigmoidCrossEntropyWithLogits"),y=R(g,"logits","sigmoidCrossEntropyWithLogits");Et(m.shape,y.shape,"Error in sigmoidCrossEntropyWithLogits: ");var w=y.relu(),b=y.mul(m),C=y.abs().neg().exp().log1p();return w.sub(b).add(C)}(i,a);return Ds(d,s,o)}}),fq=V({softmaxCrossEntropy_:function(t,n,e,r,o){void 0===r&&(r=0),void 0===o&&(o=Ar.SUM_BY_NONZERO_WEIGHTS);var i=R(t,"onehotLabels","softmaxCrossEntropy"),a=R(n,"logits","softmaxCrossEntropy"),s=null;if(null!=e&&(s=R(e,"weights","softmaxCrossEntropy")),Et(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=le(r),c=le(1),f=le(i.shape[1]);i=i.mul(c.sub(u)).add(u.div(f))}var d=function(p,g,m){if(void 0===m&&(m=-1),-1===m&&(m=g.rank-1),m!==g.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+g.rank+" and dim was "+m);return Hg(function(y,w,b){var C=w.logSumExp([m],!0),_=w.toFloat().sub(C);return b([y,_]),{value:_.mul(y).neg().sum([m]),gradFunc:function(D,E){var A=E[0],P=E[1],k=no(D.shape,[m]);return[D.reshape(k).mul(A.toFloat().sub(P.exp())),D.reshape(k).mul(P.exp().sub(A.toFloat()))]}}})(p,g)}(i,a);return Ds(d,s,o)}}),KL=Object.freeze({get Reduction(){return Ar},absoluteDifference:oq,computeWeightedLoss:Ds,cosineDistance:iq,hingeLoss:aq,huberLoss:sq,logLoss:uq,meanSquaredError:cq,sigmoidCrossEntropy:lq,softmaxCrossEntropy:fq});function XL(t,n){return void 0===n&&(n=!1),B.tidy(function(){if(2!==t.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var e=t.shape[0],r=t.shape[1],o=dE(e),i=t.clone(),a=bs([[1]],[1,1]),s=a.clone(),u=e>=r?r:e,c=function(d){var p,g=i,m=s,y=o;p=B.tidy(function(){var w=i.slice([d,d],[e-d,1]),b=w.norm(),C=i.slice([d,d],[1,1]),_=bs([[-1]]).where(C.greater(0),bs([[1]])),D=C.sub(_.mul(b)),E=w.div(D);s=1===E.shape[0]?a.clone():a.concat(E.slice([1,0],[E.shape[0]-1,E.shape[1]]),0);var A=_.matMul(D).div(b).neg(),P=i.slice([d,0],[e-d,r]),k=A.mul(s);if(0===d)i=P.sub(k.matMul(s.transpose().matMul(P)));else{var N=P.sub(k.matMul(s.transpose().matMul(P)));i=i.slice([0,0],[d,r]).concat(N,0)}var F=o.slice([0,d],[e,o.shape[1]-d]);if(0===d)o=F.sub(F.matMul(s).matMul(k.transpose()));else{var H=F.sub(F.matMul(s).matMul(k.transpose()));o=o.slice([0,0],[e,d]).concat(H,1)}return[s,i,o]}),s=p[0],i=p[1],o=p[2],to([g,m,y])},f=0;f<u;++f)c(f);return!n&&e>r&&(o=o.slice([0,0],[e,r]),i=i.slice([0,0],[r,r])),[o,i]})}var dq=V({bandPart_:function(t,n,e){if(n%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+n+".");if(e%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+e+".");var r=R(t,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(n<=a))throw new Error("bandPart(): numLower ("+n+") must not be greater than the number of rows ("+a+").");if(!(e<=s))throw new Error("bandPart(): numUpper ("+e+") must not be greater than the number of columns ("+s+").");n<0&&(n=a),e<0&&(e=s);var u=Ug(0,a,1,"int32").reshape([-1,1]),c=Ug(0,s,1,"int32"),f=Bn(u,c),d=Qg(f.lessEqual(le(+n,"int32")),f.greaterEqual(le(-e,"int32"))),p=qt([a,s],r.dtype);return Co(On(r.reshape([-1,a,s])).map(function(g){return Eu(d,g,p)})).reshape(o)}}),hq=V({gramSchmidt_:function(t){var n;if(Array.isArray(t)){n=!1,M(null!=t&&t.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var e=t[0].shape[0],r=function(u){M(t[u].shape[0]===e,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[u].shape[0]+" vs. "+e+")"})},o=1;o<t.length;++o)r(o)}else n=!0,t=bw(t,t.shape[0],0).map(function(u){return gE(u,[0])});M(t.length<=t[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."});var i=[],a=t,s=function(u){i.push(B.tidy(function(){var c=a[u];if(u>0)for(var f=0;f<u;++f){var d=eI(i[f].mulStrict(c)).mul(i[f]);c=c.sub(d)}return c.div(oI(c,"euclidean"))}))};for(o=0;o<t.length;++o)s(o);return n?Co(i,0):i}}),pq=V({qr_:function(t,n){if(void 0===n&&(n=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(2===t.rank)return XL(t,n);var e=t.shape.slice(0,t.shape.length-2).reduce(function(a,s){return a*s}),r=On(t.reshape([e,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),o=[],i=[];return r.forEach(function(a){var s=XL(a,n),c=s[1];o.push(s[0]),i.push(c)}),[Co(o,0).reshape(t.shape),Co(i,0).reshape(t.shape)]}}),YL=Object.freeze({bandPart:dq,gramSchmidt:hq,qr:pq});function qw(t,n,e,r,o,i){null==r&&(r=.5),null==o&&(o=Number.NEGATIVE_INFINITY),null==i&&(i=0);var a=t.shape[0];return e=Math.min(e,a),M(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),M(2===t.rank,function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"}),M(4===t.shape[1],function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]}),M(1===n.rank,function(){return"scores must be a 1D tensor"}),M(n.shape[0]===a,function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+n.shape[0]}),M(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:e,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var gq=V({resizeBilinear_:function(t,n,e){void 0===e&&(e=!1);var r=R(t,"images","resizeBilinear");M(3===r.rank||4===r.rank,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),M(2===n.length,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+n+"."});var o=r,i=!1;3===r.rank&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=n[0],s=n[1],u=B.runKernelFunc(function(c,f){return f([o]),c.resizeBilinear(o,a,s,e)},{x:o},function(c,f){return{x:function(){return B.runKernelFunc(function(d){return d.resizeBilinearBackprop(c,f[0],e)},{})}}},"ResizeBilinear",{alignCorners:e,newHeight:a,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),vq=V({resizeNearestNeighbor_:function(t,n,e){void 0===e&&(e=!1);var r=R(t,"images","resizeNearestNeighbor");M(3===r.rank||4===r.rank,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),M(2===n.length,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+n+"."}),M("float32"===r.dtype||"int32"===r.dtype,function(){return"`images` must have `int32` or `float32` as dtype"});var o=r,i=!1;3===r.rank&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=n[0],s=n[1],u=B.runKernelFunc(function(c,f){return f([o]),c.resizeNearestNeighbor(o,a,s,e)},{batchImages:o},function(c,f){return{batchImages:function(){return B.runKernelFunc(function(d){return d.resizeNearestNeighborBackprop(c,f[0],e)},{})}}});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),mq=V({nonMaxSuppression_:function(t,n,e,r,o){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY);var i=R(t,"boxes","nonMaxSuppression"),a=R(n,"scores","nonMaxSuppression"),s=qw(i,a,e,r,o);return B.runKernelFunc(function(c){return c.nonMaxSuppression(i,a,e,r,o)},{boxes:i,scores:a},null,"NonMaxSuppressionV3",{maxOutputSize:e=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:o=s.scoreThreshold})}}),wq=V({nonMaxSuppressionWithScore_:function(t,n,e,r,o,i){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),void 0===i&&(i=0);var a=R(t,"boxes","nonMaxSuppression"),s=R(n,"scores","nonMaxSuppression"),u=qw(a,s,e,r,o,i),c={maxOutputSize:e=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},f=B.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},c);return{selectedIndices:f[0],selectedScores:f[1]}}}),xq=V({cropAndResize_:function(t,n,e,r,o,i){var a=R(t,"image","cropAndResize"),s=R(n,"boxes","cropAndResize","float32"),u=R(e,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var c=s.shape[0];return M(4===a.rank,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),M(2===s.rank&&4===s.shape[1],function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."}),M(1===u.rank&&u.shape[0]===c,function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."}),M(2===r.length,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),M(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),M("bilinear"===o||"nearest"===o,function(){return"method must be bilinear or nearest, but was "+o}),B.runKernelFunc(function(f,d){return f.cropAndResize(a,s,u,r,o,i)},{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),Kw=Object.freeze({resizeBilinear:gq,resizeNearestNeighbor:vq,nonMaxSuppression:mq,nonMaxSuppressionAsync:function(t,n,e,r,o){return void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),be(this,void 0,void 0,function(){var i,a,s,u,d;return xe(this,function(p){switch(p.label){case 0:return i=R(t,"boxes","nonMaxSuppressionAsync"),a=R(n,"scores","nonMaxSuppressionAsync"),s=qw(i,a,e,r,o),e=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return u=p.sent(),d=AE(u[0],u[1],e,r,o),i!==t&&i.dispose(),a!==n&&a.dispose(),[2,d]}})})},nonMaxSuppressionWithScore:wq,nonMaxSuppressionWithScoreAsync:function(t,n,e,r,o,i){return void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),void 0===i&&(i=0),be(this,void 0,void 0,function(){var a,s,u,c,p;return xe(this,function(g){switch(g.label){case 0:return a=R(t,"boxes","nonMaxSuppressionAsync"),s=R(n,"scores","nonMaxSuppressionAsync"),u=qw(a,s,e,r,o,i),e=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return c=g.sent(),p=TE(c[0],c[1],e,r,o,i),a!==t&&a.dispose(),s!==n&&s.dispose(),[2,p]}})})},cropAndResize:xq}),uI=function(t,n){return!(t>0)||"linear"===n},cI=function(t,n,e){if(null==e||"linear"===e)return t;if("relu"===e)return t.mul(n.step());throw new Error("Gradient for activation "+e+" has not been implemented yet.")},lI=function(t,n){var e=n,r=Ln(t.shape,n.shape);return r.length>0&&(e=e.sum(r)),e.reshape(t.shape)},fI=function(t,n,e){if("linear"===n)return t;if("relu"===n)return nn(t);if("elu"===n)return tI(t);if("relu6"===n)return rI(t);if("prelu"===n)return nI(t,e);throw new Error("Unknown fused activation "+n+".")},_q=V({fusedMatMul_:function(t){var n,e=t.a,r=t.b,o=t.transposeA,i=void 0!==o&&o,a=t.transposeB,s=void 0!==a&&a,u=t.bias,c=t.activation,f=void 0===c?"linear":c,d=t.preluActivationWeights;if(!1===uI(B.state.gradientDepth,f)){var p=ev(e,r,i,s);return null!=u&&(p=rt(p,u)),fI(p,f,d)}var g=R(e,"a","fused matMul"),m=R(r,"b","fused matMul");n=tn(g,m),g=n[0],m=n[1];var y=i?g.shape[g.rank-2]:g.shape[g.rank-1],w=s?m.shape[m.rank-1]:m.shape[m.rank-2],b=i?g.shape[g.rank-1]:g.shape[g.rank-2],C=s?m.shape[m.rank-2]:m.shape[m.rank-1],_=g.shape.slice(0,-2),D=m.shape.slice(0,-2),E=_e(_),A=_e(D);M(g.rank>=2&&m.rank>=2&&g.rank===m.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+g.rank+" and "+m.rank+"."}),M(Fn(_,D),function(){return"Error in fused matMul: outer dimensions ("+_+") and ("+D+") of Tensors with shapes "+g.shape+" and "+m.shape+" must match."}),M(y===w,function(){return"Error in fused matMul: inner shapes ("+y+") and ("+w+") of Tensors with shapes "+g.shape+" and "+m.shape+" and transposeA="+i+" and transposeB="+s+" must match."});var P,k,N=g.shape.slice(0,-2).concat([b,C]),F=i?g.as3D(E,y,b):g.as3D(E,b,y),H=s?m.as3D(A,C,w):m.as3D(A,w,C);null!=u&&ct(N,(P=tn(P=R(u,"bias","fused matMul"),g)[0]).shape),null!=d&&(k=R(d,"prelu weights","fused matMul"));var W={a:F,b:H};return null!=u&&(W.bias=P),null!=d&&(W.preluActivationWeights=k),B.runKernelFunc(function(Y,Q){var re=Y.fusedBatchMatMul({a:F,b:H,transposeA:i,transposeB:s,bias:P,activation:f,preluActivationWeights:k});return Q([F,H,re]),re},W,function(Y,Q){var re=Q[0],ne=Q[1],se=cI(Y,Q[2],f),ue={};return null!=u&&(ue={bias:function(){return lI(P,se)}}),Object.assign(i||s?!i&&s?{a:function(){return se.matMul(ne,!1,!1)},b:function(){return se.matMul(re,!0,!1)}}:i&&!s?{a:function(){return ne.matMul(se,!1,!0)},b:function(){return re.matMul(se,!1,!1)}}:{a:function(){return ne.matMul(se,!0,!0)},b:function(){return se.matMul(re,!0,!0)}}:{a:function(){return se.matMul(ne,!1,!0)},b:function(){return re.matMul(se,!0,!1)}},ue)},"_FusedMatMul",{transposeA:i,transposeB:s,activation:f},[F,H],[!0]).reshape(N)}}),Cq=V({fusedConv2d_:function(t){var n=t.x,e=t.filter,r=t.strides,o=t.pad,i=t.dataFormat,a=void 0===i?"NHWC":i,s=t.dilations,u=void 0===s?[1,1]:s,c=t.dimRoundingMode,f=t.bias,d=t.activation,p=void 0===d?"linear":d,g=t.preluActivationWeights;if(!1===uI(B.state.gradientDepth,p=p||"linear")){var m=Uo(n,e,r,o,a,u,c);return null!=f&&(m=rt(m,f)),fI(m,p,g)}var y=R(n,"x","conv2d"),w=R(e,"filter","conv2d"),b=y,C=!1;3===y.rank&&(C=!0,b=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),M(4===b.rank,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+b.rank+"."}),M(4===w.rank,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+w.rank+"."}),null!=c&&M(cn(o),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+o+"."}),M(b.shape[3]===w.shape[2],function(){return"Error in conv2d: depth of input ("+b.shape[3]+") must match input depth for filter "+w.shape[2]+"."}),M(oo(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),M("NHWC"===a,function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var _,D,E=Du(b.shape,w.shape,r,u,o,c);null!=f&&(_=tn(_=R(f,"bias","fused conv2d"),y)[0],ct(E.outShape,_.shape)),null!=g&&(D=R(g,"prelu weights","fused conv2d"));var A={x:b,filter:w};null!=f&&(A.bias=_),null!=g&&(A.preluActivationWeights=D);var k=B.runKernelFunc(function(N,F){var H=N.fusedConv2d({input:b,filter:w,convInfo:E,bias:_,activation:p,preluActivationWeights:D});return F([w,b,H]),H},A,function(N,F){var W=F[0],Z=F[1],Q=cI(N,F[2],p);M(el(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var re={};return null!=f&&(re={bias:function(){return lI(_,Q)}}),Object.assign({x:function(){return nL(Z.shape,Q,W,r,o)},filter:function(){return ZE(Z,Q,W.shape,r,o)}},re)},"FusedConv2D",{convInfo:E,activation:p},[w,b],[!0]);return C?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}}),Dq=V({fusedDepthwiseConv2d_:function(t){var n=t.x,e=t.filter,r=t.strides,o=t.pad,i=t.dataFormat,a=void 0===i?"NHWC":i,s=t.dilations,u=void 0===s?[1,1]:s,c=t.dimRoundingMode,f=t.bias,d=t.activation,p=void 0===d?"linear":d,g=t.preluActivationWeights;if(!1===uI(B.state.gradientDepth,p)){var m=Jg(n,e,r,o,a,u,c);return null!=f&&(m=rt(m,f)),fI(m,p,g)}var y=R(n,"x","depthwiseConv2d"),w=R(e,"filter","depthwiseConv2d"),b=y,C=!1;3===y.rank&&(C=!0,b=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),M(4===b.rank,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+b.rank+"."}),M(4===w.rank,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+w.rank+"."}),M(b.shape[3]===w.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+b.shape[3]+") must match the inChannels dimension in filter "+w.shape[2]+"."}),null==u&&(u=[1,1]),M(oo(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),null!=c&&M(cn(o),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+o+"."});var _,D,E=Du(b.shape,w.shape,r,u,o,c,!0);null!=f&&(_=tn(_=R(f,"bias","fused conv2d"),y)[0],ct(E.outShape,_.shape)),null!=g&&(D=R(g,"prelu weights","fused depthwiseConv2d"));var A={x:b,filter:w};null!=f&&(A.bias=_),null!=g&&(A.preluActivationWeights=D);var k=B.runKernelFunc(function(N,F){var H=N.fusedDepthwiseConv2D({input:b,filter:w,convInfo:E,bias:_,activation:p,preluActivationWeights:D});return F([w,b,H]),H},A,function(N,F){M(el(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var H=F[0],W=F[1],Y=cI(N,F[2],p),Q={};return null!=f&&(Q={bias:function(){return lI(_,Y)}}),Object.assign({x:function(){return rL(W.shape,Y,H,E)},filter:function(){return oL(W,Y,H.shape,E)}},Q)},"FusedDepthwiseConv2D",{convInfo:E,activation:p},[w,b],[!0]);return C?k.as3D(k.shape[1],k.shape[2],k.shape[3]):k}}),QL=Object.freeze({matMul:_q,conv2d:Cq,depthwiseConv2d:Dq}),Eq=Object.freeze({image:Kw,linalg:YL,losses:KL,spectral:UL,fused:QL,signal:GL,square:BP,squaredDifference:UE,conv1d:eL,conv2d:Uo,conv3d:tL,depthwiseConv2d:Jg,separableConv2d:Hw,conv2dTranspose:iL,conv3dTranspose:aL,op:V,batchNormalization2d:mO,batchNormalization3d:yO,batchNormalization4d:wO,batchNormalization:bO,batchNorm:jE,batchNorm2d:xO,batchNorm3d:_O,batchNorm4d:CO,booleanMaskAsync:QO,complex:ar,real:Bo,imag:Ki,concat:Pn,concat1d:fk,concat2d:dk,concat3d:hk,concat4d:pk,split:bw,matMul:ev,dot:sL,outerProduct:uL,reverse:Jf,reverse1d:cL,reverse2d:lL,reverse3d:fL,reverse4d:dL,maxPool:Kn,avgPool:ed,pool:gL,maxPool3d:vL,avgPool3d:mL,slice:Qi,slice1d:yL,slice2d:wL,slice3d:JE,slice4d:bL,abs:VP,acos:UP,acosh:WP,asin:HP,asinh:jP,atan:zP,atanh:$P,ceil:GP,clipByValue:Ow,cos:qP,cosh:KP,erf:XP,exp:Lw,expm1:YP,floor:QP,log:ZP,log1p:JP,logSigmoid:eO,neg:Xg,reciprocal:tO,round:nO,rsqrt:WE,sigmoid:HE,sign:rO,isNaN:oO,isInf:iO,isFinite:aO,sin:sO,sinh:uO,softplus:cO,sqrt:lO,step:fO,tan:dO,tanh:hO,all:_L,any:CL,argMax:DL,argMin:EL,logSumExp:IL,max:tv,mean:SL,min:AL,moments:TL,sum:eI,prod:RL,equal:KE,equalStrict:VO,greater:UO,greaterEqual:XE,greaterEqualStrict:WO,greaterStrict:HO,less:jO,lessEqual:zO,lessEqualStrict:$O,lessStrict:GO,notEqual:qO,notEqualStrict:KO,add:rt,addN:IO,addStrict:SO,atan2:AO,div:si,divNoNan:TO,divStrict:RO,floorDiv:GE,maximum:Uw,maximumStrict:MO,minimum:qE,minimumStrict:NO,mod:FO,modStrict:kO,mul:Sr,mulStrict:PO,pow:Zg,powStrict:OO,squaredDifferenceStrict:LO,sub:Bn,subStrict:BO,elu:tI,leakyRelu:ML,prelu:nI,relu:nn,relu6:rI,selu:NL,logicalAnd:Qg,logicalNot:DO,logicalOr:zE,logicalXor:EO,where:Eu,whereAsync:$E,buffer:Ge,print:gk,batchToSpaceND:fE,broadcastTo:vk,cast:mk,clone:yk,cumsum:wk,depthToSpace:bk,expandDims:Vo,eye:dE,multinomial:xk,oneHot:_w,pad:Cu,pad1d:_k,pad2d:Ck,pad3d:Dk,pad4d:Ek,rand:Ik,randomNormal:Sk,randomGamma:Ak,randomUniform:hE,reshape:ai,spaceToBatchND:pE,squeeze:gE,stack:Co,tile:Jc,truncatedNormal:Tk,unstack:On,setdiff1dAsync:Rk,fill:Xi,linspace:lk,ones:Yc,range:Ug,scalar:le,tensor:sr,tensor1d:Dn,tensor2d:bs,tensor3d:ww,tensor4d:ro,tensor5d:sk,tensor6d:uk,variable:ck,zeros:qt,onesLike:cE,zerosLike:vt,transpose:Cs,softmax:Na,logSoftmax:Vk,localResponseNormalization:FL,norm:oI,gather:Ww,unsortedSegmentSum:YE,basicLSTMCell:kL,multiRNNCell:PL,movingAverage:OL,stridedSlice:LL,topk:BL,scatterND:VL,fft:jw,ifft:nv,rfft:zw,irfft:iI,sparseToDense:WL,gatherND:HL,diag:jL,dropout:zL,hannWindow:$w,hammingWindow:aI,frame:Gw,stft:sI,inTopKAsync:qL});function ie(t,n){Array.isArray(t)||(t=[t]),t.forEach(function(e){null!=e&&M("complex64"!==e.dtype,function(){return n+" does not support complex64 tensors."})})}function dI(t,n,e,r){if("linear"===e)return t.linear(n);if("relu"===e)return t.relu(n);if("elu"===e)return t.elu(n);if("relu6"===e)return t.relu6(n);if("prelu"===e)return t.prelu(n,r);throw new Error("Activation "+e+" has not been implemented for the CPU backend.")}var Iq=function(t){function n(){var e=t.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new xE(e,B),e}return ji(n,t),n.prototype.write=function(e,r,o){this.firstUse&&(this.firstUse=!1,K().get("IS_NODE")&&mw("\n============================\nHi there \u{1f44b}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var i={};return this.data.set(i,{values:e,dtype:o}),i},n.prototype.move=function(e,r,o,i){this.data.set(e,{values:r,dtype:i})},n.prototype.numDataIds=function(){return this.data.numDataIds()},n.prototype.read=function(e){return be(this,void 0,void 0,function(){return xe(this,function(r){return[2,this.readSync(e)]})})},n.prototype.readSync=function(e){var r=this.data.get(e),i=r.complexTensors;return"complex64"===r.dtype?SE(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(e).values},n.prototype.bufferSync=function(e){var r=this.readSync(e.dataId),o=r;if("string"===e.dtype)try{o=r.map(function(i){return Sg(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ge(e.shape,e.dtype,o)},n.prototype.makeOutput=function(e,r,o){var i=this.write(e,r,o);return B.makeTensorFromDataId(i,r,o,this)},n.prototype.disposeData=function(e){if(this.data.has(e)){var r=this.data.get(e).complexTensors;null!=r&&(r.real.dispose(),r.imag.dispose()),this.data.delete(e)}},n.prototype.time=function(e){return be(this,void 0,void 0,function(){var r;return xe(this,function(o){return r=$i(),e(),[2,{kernelMs:$i()-r}]})})},n.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},n.prototype.complex=function(e,r){var o=this.makeOutput(null,e.shape,"complex64");return this.data.get(o.dataId).complexTensors={real:B.keep(e.clone()),imag:B.keep(r.clone())},o},n.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},n.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},n.prototype.slice=function(e,r,o){if(ie(e,"slice"),wE(e.shape,r,o)){var i=bE(r,e.strides),a=_e(o);return sr(this.readSync(e.dataId).subarray(i,i+a),o,e.dtype)}for(var s=Ge(o,e.dtype),u=this.bufferSync(e),c=0;c<s.size;++c){var f=s.indexToLoc(c).map(function(d,p){return d+r[p]});s.values[c]=u.get.apply(u,f)}return s.toTensor()},n.prototype.stridedSlice=function(e,r,o,i){ie(e,"stridedSlice");var a=Sw(r,o,i);if(a.some(function(g){return 0===g}))return sr([],a);for(var s=Ge(a,e.dtype),u=this.bufferSync(e),c=0;c<s.size;c++){for(var f=s.indexToLoc(c),d=new Array(f.length),p=0;p<d.length;p++)d[p]=f[p]*i[p]+r[p];s.set.apply(s,[u.get.apply(u,d)].concat(f))}return s.toTensor()},n.prototype.diag=function(e){for(var r=this.readSync(e.dataId),o=Ge([e.size,e.size],e.dtype),i=o.values,a=0;a<r.length;a++)i[a*e.size+a]=r[a];return o.toTensor()},n.prototype.unstack=function(e,r){for(var o=e.shape[r],i=new Array(e.rank-1),a=0,s=0;s<e.rank;s++)s!==r&&(i[a++]=e.shape[s]);var u=new Array(e.rank).fill(0),c=e.shape.slice();c[r]=1;var f=new Array(o);for(s=0;s<f.length;s++)u[r]=s,f[s]=this.slice(e,u,c).reshape(i);return f},n.prototype.reverse=function(e,r){ie(e,"reverse");for(var o=Ge(e.shape,e.dtype),i=this.bufferSync(e),a=function(u){var c=o.indexToLoc(u),f=c.slice();r.forEach(function(d){return f[d]=e.shape[d]-1-f[d]}),o.set.apply(o,[i.get.apply(i,f)].concat(c))},s=0;s<o.size;s++)a(s);return o.toTensor()},n.prototype.concat=function(e,r){var o=this;if("complex64"===e[0].dtype){var i=e.map(function(g){return Bo(g)}),a=e.map(function(g){return Ki(g)});return ar(this.concat(i,r),this.concat(a,r))}var s=e.map(function(g){var m=_e(g.shape.slice(r));return g.as2D(-1,m)}),u=Xc(s.map(function(g){return g.shape}),1),c=Ge(u,e[0].dtype).values;if(1===s[0].shape[0]){var f=0;s.forEach(function(g){c.set(o.readSync(g.dataId),f),f+=g.size})}else{var d=0;s.forEach(function(g){for(var m=o.readSync(g.dataId),y=0,w=0;w<g.shape[0];++w)for(var b=w*u[1]+d,C=0;C<g.shape[1];++C)c[b+C]=m[y++];d+=g.shape[1]})}var p=Xc(e.map(function(g){return g.shape}),r);return sr(c,p,e[0].dtype)},n.prototype.neg=function(e){return ie(e,"neg"),this.multiply(le(-1),e)},n.prototype.add=function(e,r){return"complex64"===e.dtype||"complex64"===r.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o+a,imag:i+s}}):this.broadcastedBinaryOp(e,r,ir(e.dtype,r.dtype),function(o,i){return o+i})},n.prototype.addN=function(e){var r=this;ie(e,"addN");for(var o=e.map(function(f){return r.readSync(f.dataId)}),i=Ge(e[0].shape,e[0].dtype),a=i.values,s=0;s<e.length;s++)for(var u=o[s],c=0;c<a.length;c++)a[c]+=u[c];return i.toTensor()},n.prototype.softmax=function(e,r){var o=kn([r],e.shape),i=this.max(e,o),a=no(i.shape,o),s=this.subtract(e,i.reshape(a)),u=this.exp(s),c=this.sum(u,o).reshape(a);return this.realDivide(u,c)},n.prototype.subtract=function(e,r){return"complex64"===e.dtype||"complex64"===r.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o-a,imag:i-s}}):this.broadcastedBinaryOp(e,r,ir(e.dtype,r.dtype),function(o,i){return o-i})},n.prototype.pow=function(e,r){return ie([e,r],"pow"),this.broadcastedBinaryOp(e,r,e.dtype,function(o,i){return Math.pow(o,i)})},n.prototype.batchMatMul=function(e,r,o,i){ie([e,r],"matMul");for(var a=o?e.shape[1]:e.shape[2],s=o?e.shape[2]:e.shape[1],u=i?r.shape[1]:r.shape[2],c=e.shape[0],f=this.readSync(e.dataId),d=this.readSync(r.dataId),p=o?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],g=p[0],m=p[1],y=p[2],w=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],b=w[0],C=w[1],_=w[2],D=s*u,E=Ge([c,s,u],e.dtype),A=E.values,P=this.blockSize,k=0;k<c;k++)for(var N=0;N<s;N+=P)for(var F=0;F<u;F+=P)for(var H=0;H<a;H+=P)for(var W=Math.min(N+P,s),Z=Math.min(F+P,u),Y=Math.min(H+P,a),Q=N;Q<W;Q++)for(var re=F;re<Z;re++){for(var ne=0,J=H;J<Y;J++)ne+=f[k*g+Q*m+J*y]*d[J*b+re*C+k*_];A[k*D+(Q*u+re)]+=ne}return E.toTensor()},n.prototype.fusedBatchMatMul=function(e){var s=e.bias,u=e.activation,c=e.preluActivationWeights,f=this.batchMatMul(e.a,e.b,e.transposeA,e.transposeB);return s&&(f=this.add(f,s)),u&&(f=dI(this,f,u,c)),f},n.prototype.multiply=function(e,r){return"complex64"===e.dtype||"complex64"===r.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o*a-i*s,imag:o*s+i*a}}):this.broadcastedBinaryOp(e,r,ir(e.dtype,r.dtype),function(o,i){return o*i})},n.prototype.realDivide=function(e,r){return ie([e,r],"realDivide"),this.broadcastedBinaryOp(e,r,"float32",function(o,i){return o/i})},n.prototype.floorDiv=function(e,r){return ie([e,r],"floorDiv"),this.broadcastedBinaryOp(e,r,"int32",function(o,i){return Math.floor(o/i)})},n.prototype.sum=function(e,r){ie(e,"sum"),_o("sum",r,e.rank);for(var o=Ir(e.shape,r),a=o[1],s=qt(o[0],ir(e.dtype,"int32")),u=_e(a),c=this.readSync(s.dataId),f=this.readSync(e.dataId),d=0;d<c.length;++d){for(var p=d*u,g=0,m=0;m<u;++m)g+=f[p+m];c[d]=g}return s},n.prototype.prod=function(e,r){ie(e,"sum");for(var o=Ir(e.shape,r),a=o[1],s=qt(o[0],ir(e.dtype,"int32")),u=_e(a),c=this.readSync(s.dataId),f=this.readSync(e.dataId),d=0;d<c.length;++d){for(var p=d*u,g=1,m=0;m<u;++m)g*=f[p+m];c[d]=g}return s},n.prototype.unsortedSegmentSum=function(e,r,o){ie(e,"unsortedSegmentSum");for(var i=[],a=e.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<o;++s){var u=le(s,"int32"),c=KE(u,r).asType("float32").mul(e).sum(0);i.push(c)}return Co(i)},n.prototype.argMin=function(e,r){ie(e,"argMin");var o=[r];_o("argMin",o,e.rank);for(var i=Ir(e.shape,o),s=i[1],u=qt(i[0],"int32"),c=_e(s),f=this.readSync(u.dataId),d=this.readSync(e.dataId),p=0;p<f.length;++p){for(var g=p*c,m=d[g],y=0,w=0;w<c;++w){var b=d[g+w];b<m&&(m=b,y=w)}f[p]=y}return u},n.prototype.argMax=function(e,r){ie(e,"argMax");var o=[r];_o("argMax",o,e.rank);for(var i=Ir(e.shape,o),s=i[1],u=qt(i[0],"int32"),c=_e(s),f=this.readSync(u.dataId),d=this.readSync(e.dataId),p=0;p<f.length;++p){for(var g=p*c,m=d[g],y=0,w=0;w<c;++w){var b=d[g+w];b>m&&(m=b,y=w)}f[p]=y}return u},n.prototype.cumsum=function(e,r,o,i){if(ie(e,"cumsum"),r!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+r);for(var a=ir(e.dtype,"int32"),s=qt(e.shape,a),u=this.readSync(s.dataId),c=this.readSync(e.dataId),f=e.shape[e.rank-1],d=i?function(w,b){return w+f-b-1}:function(w,b){return w+b},p=0;p<c.length;p+=f)for(var g=0;g<f;g++){var m=d(p,g);if(0===g)u[m]=o?0:c[m];else{var y=d(p,g-1);u[m]=o?c[y]+u[y]:c[m]+u[y]}}return s},n.prototype.equal=function(e,r){return ie([e,r],"equal"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o===i?1:0})},n.prototype.notEqual=function(e,r){return ie([e,r],"notEqual"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o!==i?1:0})},n.prototype.less=function(e,r){return ie([e,r],"less"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o<i?1:0})},n.prototype.lessEqual=function(e,r){return ie([e,r],"lessEqual"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o<=i?1:0})},n.prototype.greater=function(e,r){return ie([e,r],"greater"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o>i?1:0})},n.prototype.greaterEqual=function(e,r){return ie([e,r],"greaterEqual"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o>=i?1:0})},n.prototype.logicalNot=function(e){ie(e,"logicalNot");for(var r=this.readSync(e.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)o[i]=r[i]?0:1;return this.makeOutput(o,e.shape,"bool")},n.prototype.logicalAnd=function(e,r){return ie([e,r],"logicalAnd"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o&&i})},n.prototype.logicalOr=function(e,r){return ie([e,r],"logicalOr"),this.broadcastedBinaryOp(e,r,"bool",function(o,i){return o||i})},n.prototype.select=function(e,r,o){ie([e,r,o],"select");for(var i=this.readSync(e.dataId),a=this.readSync(r.dataId),s=this.readSync(o.dataId),u=qt(r.shape,ir(r.dtype,o.dtype)),c=this.readSync(u.dataId),f=0,d=0===e.rank||e.rank>1||1===r.rank?1:_e(r.shape.slice(1)),p=0;p<i.length;p++)for(var g=0;g<d;g++)c[f++]=1===i[p]?a[p]:s[p];return u},n.prototype.where=function(e){ie([e],"where");var r=this.readSync(e.dataId);return RE(e.shape,r)},n.prototype.topk=function(e,r,o){return ie(e,"topk"),$k(this.readSync(e.dataId),e.shape,e.dtype,r)},n.prototype.min=function(e,r){ie(e,"min"),_o("min",r,e.rank);for(var o=Ir(e.shape,r),a=o[1],s=qt(o[0],e.dtype),u=_e(a),c=this.readSync(s.dataId),f=this.readSync(e.dataId),d=0;d<c.length;++d){for(var p=d*u,g=f[p],m=0;m<u;++m){var y=f[p+m];y<g&&(g=y)}c[d]=g}return s},n.prototype.minimum=function(e,r){return ie([e,r],"minimum"),this.broadcastedBinaryOp(e,r,e.dtype,function(o,i){return Math.min(o,i)})},n.prototype.mod=function(e,r){return ie([e,r],"mod"),this.broadcastedBinaryOp(e,r,e.dtype,function(o,i){var a=o%i;return o<0&&i<0||o>=0&&i>=0?a:(a+i)%i})},n.prototype.max=function(e,r){ie(e,"max"),_o("max",r,e.rank);for(var o=Ir(e.shape,r),a=o[1],s=qt(o[0],e.dtype),u=_e(a),c=this.readSync(s.dataId),f=this.readSync(e.dataId),d=0;d<c.length;++d){for(var p=d*u,g=f[p],m=0;m<u;++m){var y=f[p+m];y>g&&(g=y)}c[d]=g}return s},n.prototype.maximum=function(e,r){return ie([e,r],"maximum"),this.broadcastedBinaryOp(e,r,e.dtype,function(o,i){return Math.max(o,i)})},n.prototype.all=function(e,r){ie(e,"all"),_o("all",r,e.rank);for(var o=Ir(e.shape,r),a=o[1],s=qt(o[0],e.dtype),u=_e(a),c=this.readSync(s.dataId),f=this.readSync(e.dataId),d=0;d<c.length;++d){for(var p=d*u,g=f[p],m=0;m<u;++m)g=g&&f[p+m];c[d]=g}return s},n.prototype.any=function(e,r){ie(e,"any"),_o("any",r,e.rank);for(var o=Ir(e.shape,r),a=o[1],s=qt(o[0],e.dtype),u=_e(a),c=this.readSync(s.dataId),f=this.readSync(e.dataId),d=0;d<c.length;++d){for(var p=d*u,g=f[p],m=0;m<u;++m)g=g||f[p+m];c[d]=g}return s},n.prototype.squaredDifference=function(e,r){return ie([e,r],"squaredDifference"),this.broadcastedBinaryOp(e,r,e.dtype,function(o,i){var a=o-i;return a*a})},n.prototype.ceil=function(e){ie(e,"ceil");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.ceil(r[i]);return this.makeOutput(o,e.shape,"float32")},n.prototype.floor=function(e){ie(e,"floor");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.floor(r[i]);return this.makeOutput(o,e.shape,"float32")},n.prototype.sign=function(e){ie(e,"x");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=r[i]<0?-1:r[i]>0?1:0;return this.makeOutput(o,e.shape,"float32")},n.prototype.isNaN=function(e){ie(e,"x");for(var r=this.readSync(e.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(o[i]=1);return this.makeOutput(o,e.shape,"bool")},n.prototype.isInf=function(e){ie(e,"x");for(var r=this.readSync(e.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(o[i]=1);return this.makeOutput(o,e.shape,"bool")},n.prototype.isFinite=function(e){ie(e,"x");for(var r=this.readSync(e.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(o[i]=1);return this.makeOutput(o,e.shape,"bool")},n.prototype.round=function(e){ie(e,"round");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=Math.floor(r[i]);o[i]=r[i]-a<.5?Math.floor(r[i]):r[i]-a>.5?Math.ceil(r[i]):a%2==0?a:a+1}return this.makeOutput(o,e.shape,"float32")},n.prototype.exp=function(e){ie(e,"exp");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.exp(r[i]);return this.makeOutput(o,e.shape,"float32")},n.prototype.expm1=function(e){ie(e,"expm1");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.expm1(r[i]);return this.makeOutput(o,e.shape,"float32")},n.prototype.log=function(e){ie(e,"log");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.log(r[i]);return this.makeOutput(o,e.shape,"float32")},n.prototype.log1p=function(e){ie(e,"log1p");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.log1p(r[i]);return this.makeOutput(o,e.shape,"float32")},n.prototype.sqrt=function(e){ie(e,"sqrt");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.sqrt(r[i]);return this.makeOutput(o,e.shape,"float32")},n.prototype.rsqrt=function(e){ie(e,"rsqrt");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/Math.sqrt(r[i]);return this.makeOutput(o,e.shape,"float32")},n.prototype.reciprocal=function(e){ie(e,"reciprocal");for(var r=this.readSync(e.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/r[i];return this.makeOutput(o,e.shape,"float32")},n.prototype.linear=function(e){return e},n.prototype.relu=function(e){ie(e,"relu");for(var r=qt(e.shape,e.dtype),o=this.readSync(r.dataId),i=this.readSync(e.dataId),a=0;a<i.length;++a)o[a]=Math.max(0,i[a]);return r},n.prototype.relu6=function(e){ie(e,"relu");for(var r=qt(e.shape,e.dtype),o=this.readSync(r.dataId),i=this.readSync(e.dataId),a=0;a<i.length;++a)o[a]=Math.min(Math.max(0,i[a]),6);return r},n.prototype.prelu=function(e,r){return ie([e,r],"prelu"),this.broadcastedBinaryOp(e,r,e.dtype,function(o,i){return o<0?i*o:o})},n.prototype.elu=function(e){ie(e,"elu");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,e.shape,"float32")},n.prototype.eluDer=function(e,r){ie([e,r],"eluDer");for(var o=new Float32Array(r.size),i=this.readSync(r.dataId),a=this.readSync(e.dataId),s=0;s<i.length;++s){var u=i[s];o[s]=u>=1?a[s]:a[s]*(u+1)}return this.makeOutput(o,r.shape,"float32")},n.prototype.selu=function(e){ie(e,"selu");for(var i=new Float32Array(e.size),a=this.readSync(e.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=0?1.0507009873554805*u:1.7580993408473768*(Math.exp(u)-1)}return this.makeOutput(i,e.shape,"float32")},n.prototype.clip=function(e,r,o){ie(e,"clip");for(var i=new Float32Array(e.size),a=this.readSync(e.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>o?o:u<r?r:u}return this.makeOutput(i,e.shape,"float32")},n.prototype.abs=function(e){for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.abs(o[i]);return this.makeOutput(r,e.shape,"float32")},n.prototype.complexAbs=function(e){for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<e.size;++i)r[i]=Math.hypot(o[2*i],o[2*i+1]);return this.makeOutput(r,e.shape,"float32")},n.prototype.int=function(e){ie(e,"int");for(var r=new Int32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=o[i];return this.makeOutput(r,e.shape,"int32")},n.prototype.sigmoid=function(e){ie(e,"sigmoid");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=1/(1+Math.exp(-o[i]));return this.makeOutput(r,e.shape,"float32")},n.prototype.softplus=function(e){ie(e,"softplus");for(var r=Math.log(1.1920928955078125e-7)+2,o=new Float32Array(e.size),i=this.readSync(e.dataId),a=0;a<i.length;++a){var f,s=i[a]>-r,u=i[a]<r,c=Math.exp(i[a]);f=u?c:s?i[a]:Math.log(1+c),o[a]=f}return this.makeOutput(o,e.shape,"float32")},n.prototype.sin=function(e){ie(e,"sin");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.sin(o[i]);return this.makeOutput(r,e.shape,"float32")},n.prototype.cos=function(e){ie(e,"cos");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.cos(o[i]);return this.makeOutput(r,e.shape,"float32")},n.prototype.tan=function(e){ie(e,"tan");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.tan(o[i]);return this.makeOutput(r,e.shape,"float32")},n.prototype.asin=function(e){ie(e,"asin");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.asin(o[i]);return this.makeOutput(r,e.shape,"float32")},n.prototype.acos=function(e){ie(e,"acos");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.acos(o[i]);return this.makeOutput(r,e.shape,"float32")},n.prototype.atan=function(e){ie(e,"atan");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.atan(o[i]);return this.makeOutput(r,e.shape,"float32")},n.prototype.atan2=function(e,r){return ie([e,r],"atan2"),this.broadcastedBinaryOp(e,r,e.dtype,function(o,i){return Math.atan2(o,i)})},n.prototype.sinh=function(e){ie(e,"sinh");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.sinh(o[i]);return this.makeOutput(r,e.shape,"float32")},n.prototype.cosh=function(e){ie(e,"cosh");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.cosh(o[i]);return this.makeOutput(r,e.shape,"float32")},n.prototype.tanh=function(e){ie(e,"tanh");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=vF(o[i]);return this.makeOutput(r,e.shape,"float32")},n.prototype.asinh=function(e){ie(e,"asinh");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.asinh(o[i]);return this.makeOutput(r,e.shape,"float32")},n.prototype.acosh=function(e){ie(e,"acosh");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.acosh(o[i]);return this.makeOutput(r,e.shape,"float32")},n.prototype.atanh=function(e){ie(e,"atanh");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i)r[i]=Math.atanh(o[i]);return this.makeOutput(r,e.shape,"float32")},n.prototype.erf=function(e){ie(e,"erf");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i){var a=Math.sign(o[i]),s=Math.abs(o[i]),u=1/(1+.3275911*s);r[i]=a*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,e.shape,"float32")},n.prototype.step=function(e,r){void 0===r&&(r=0),ie(e,"step");for(var o=new Float32Array(e.size),i=this.readSync(e.dataId),a=0;a<i.length;++a){var s=i[a];o[a]=isNaN(s)?NaN:s>0?1:r}return this.makeOutput(o,e.shape,"float32")},n.prototype.fusedConv2d=function(e){var a=e.bias,s=e.activation,u=e.preluActivationWeights,c=this.conv2d(e.input,e.filter,e.convInfo);return a&&(c=this.add(c,a)),s&&(c=dI(this,c,s,u)),c},n.prototype.conv2d=function(e,r,o){ie([e,r],"conv2d");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,c=o.padInfo.left,f=o.padInfo.top,d="channelsLast"===o.dataFormat,p=Ge(o.outShape,e.dtype),g=e.strides[0],m=d?e.strides[1]:e.strides[2],y=d?e.strides[2]:1,w=d?1:e.strides[1],b=p.strides[0],C=d?p.strides[1]:p.strides[2],_=d?p.strides[2]:1,D=d?1:p.strides[1],E=this.readSync(e.dataId),A=this.readSync(r.dataId),P=p.values,k=0;k<o.batchSize;++k)for(var N=k*g,F=k*b,H=0;H<o.outHeight;++H)for(var W=F+H*C,Z=H*o.strideHeight-f,Y=0;Y<i;Y++){var Q=Z+Y*s;if(!(Q<0||Q>=o.inHeight))for(var re=Y*r.strides[0],ne=N+Q*m,J=0;J<o.outWidth;++J)for(var se=W+J*_,ue=J*o.strideWidth-c,ve=0;ve<a;ve++){var Ee=ue+ve*u;if(!(Ee<0||Ee>=o.inWidth))for(var ke=ne+Ee*y,ot=re+ve*r.strides[1],it=0;it<o.inChannels;++it){for(var dt=E[ke+it*w],It=0;It<o.outChannels;++It)P[se+It*D]+=dt*A[ot+It];ot+=o.outChannels}}}return p.toTensor()},n.prototype.conv3d=function(e,r,o){for(var i=o.filterDepth,a=o.filterHeight,s=o.filterWidth,u=o.dilationDepth,c=o.dilationHeight,f=o.dilationWidth,d=o.padInfo.front,p=o.padInfo.left,g=o.padInfo.top,m=Ge(o.outShape,e.dtype),y=this.readSync(e.dataId),w=this.readSync(r.dataId),b=m.values,C=0;C<o.batchSize;++C)for(var _=C*e.strides[0],D=C*m.strides[0],E=0;E<o.outDepth;++E)for(var A=D+E*m.strides[1],P=E*o.strideDepth-d,k=0;k<i;k++){var N=P+k*u;if(!(N<0||N>=o.inDepth))for(var F=k*r.strides[0],H=_+N*e.strides[1],W=0;W<o.outHeight;++W)for(var Z=A+W*m.strides[2],Y=W*o.strideHeight-g,Q=0;Q<a;Q++){var re=Y+Q*c;if(!(re<0||re>=o.inHeight))for(var ne=F+Q*r.strides[1],J=H+re*e.strides[2],se=0;se<o.outWidth;++se)for(var ue=Z+se*o.outChannels,ve=se*o.strideWidth-p,Ee=0;Ee<s;Ee++){var ke=ve+Ee*f;if(!(ke<0||ke>=o.inWidth))for(var it=J+ke*o.inChannels,dt=ne+Ee*r.strides[2],It=0;It<o.inChannels;++It){for(var yt=y[it+It],St=0;St<o.outChannels;++St)b[ue+St]+=yt*w[dt+St];dt+=o.outChannels}}}}return m.toTensor()},n.prototype.conv2dDerInput=function(e,r,o){ie([e,r],"conv2dDerInput");for(var i=Ge(o.inShape,"float32"),a=i.values,s=this.readSync(e.dataId),u=this.readSync(r.dataId),c=r.strides,f=c[0],d=c[1],p=c[2],g=o.batchSize,m=o.filterHeight,y=o.filterWidth,w=o.inChannels,b=o.inHeight,C=o.inWidth,_=o.outChannels,D=o.outHeight,E=o.outWidth,A=o.strideHeight,P=o.strideWidth,N=m-1-o.padInfo.top,F=y-1-o.padInfo.left,H="channelsLast"===o.dataFormat,W=i.strides[0],Z=H?i.strides[1]:i.strides[2],Y=H?i.strides[2]:1,Q=H?1:i.strides[1],re=e.strides[0],ne=H?e.strides[1]:e.strides[2],J=H?e.strides[2]:1,se=H?1:e.strides[1],ue=0;ue<g;++ue)for(var ve=0;ve<w;++ve)for(var Ee=0;Ee<b;++Ee)for(var ke=Ee-N,ot=Math.max(0,Math.ceil(ke/A)),it=Math.min(D,(m+ke)/A),dt=0;dt<C;++dt){for(var It=dt-F,yt=Math.max(0,Math.ceil(It/P)),St=Math.min(E,(y+It)/P),En=0,wt=ot;wt<it;++wt)for(var Wt=wt*A-ke,Lt=yt;Lt<St;++Lt)for(var mn=re*ue+ne*wt+J*Lt,ln=f*(m-1-Wt)+d*(y-1-(Lt*P-It))+p*ve,fn=0;fn<_;++fn)En+=s[mn+se*fn]*u[ln+fn];a[W*ue+Z*Ee+Y*dt+Q*ve]=En}return i.toTensor()},n.prototype.conv3dDerInput=function(e,r,o){for(var i=Ge(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],c=s[1],f=s[2],d=s[3],p=this.readSync(e.dataId),g=e.strides,m=g[0],y=g[1],w=g[2],b=g[3],C=this.readSync(r.dataId),_=r.strides,D=_[0],E=_[1],A=_[2],P=_[3],k=o.batchSize,N=o.filterDepth,F=o.filterHeight,H=o.filterWidth,W=o.inChannels,Z=o.inDepth,Y=o.inHeight,Q=o.inWidth,re=o.outChannels,ne=o.outDepth,J=o.outHeight,se=o.outWidth,ue=o.strideDepth,ve=o.strideHeight,Ee=o.strideWidth,ke=N-1-o.padInfo.front,ot=F-1-o.padInfo.top,it=H-1-o.padInfo.left,dt=0;dt<k;++dt)for(var It=0;It<W;++It)for(var yt=0;yt<Z;++yt)for(var St=yt-ke,En=Math.max(0,Math.ceil(St/ue)),wt=Math.min(ne,(N+St)/ue),Wt=0;Wt<Y;++Wt)for(var Lt=Wt-ot,mn=Math.max(0,Math.ceil(Lt/ve)),ln=Math.min(J,(F+Lt)/ve),fn=0;fn<Q;++fn){for(var Ba=fn-it,Va=Math.max(0,Math.ceil(Ba/Ee)),jo=Math.min(se,(H+Ba)/Ee),md=0,Ts=En;Ts<wt;++Ts)for(var Bu=Ts*ue-St,Rs=mn;Rs<ln;++Rs)for(var yd=Rs*ve-Lt,Ms=Va;Ms<jo;++Ms)for(var AS=m*dt+y*Ts+w*Rs+b*Ms,wd=D*(N-1-Bu)+E*(F-1-yd)+A*(H-1-(Ms*Ee-Ba))+P*It,Ua=0;Ua<re;++Ua)md+=p[AS+Ua]*C[wd+Ua];a[u*dt+c*yt+f*Wt+d*fn+It]=md}return i.toTensor()},n.prototype.conv2dDerFilter=function(e,r,o){ie([e,r],"conv2dDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,c="channelsLast"===o.dataFormat,f=Ge(o.filterShape,"float32"),d=o.padInfo.left,p=o.padInfo.top,g=this.bufferSync(e),m=this.bufferSync(r),y=0;y<s;++y)for(var w=Math.max(0,Math.ceil((p-y)/i)),b=Math.min(o.outHeight,(o.inHeight+p-y)/i),C=0;C<u;++C)for(var _=Math.max(0,Math.ceil((d-C)/a)),D=Math.min(o.outWidth,(o.inWidth+d-C)/a),E=0;E<o.inChannels;++E)for(var A=0;A<o.outChannels;++A){for(var P=0,k=0;k<o.batchSize;++k)for(var N=w;N<b;++N)for(var F=y+N*i-p,H=_;H<D;++H){var W=C+H*a-d;P+=c?g.get(k,F,W,E)*m.get(k,N,H,A):g.get(k,E,F,W)*m.get(k,A,N,H)}f.set(P,y,C,E,A)}return f.toTensor()},n.prototype.conv3dDerFilter=function(e,r,o){for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,c=o.filterHeight,f=o.filterWidth,d=Ge(o.filterShape,"float32"),p=d.values,g=d.strides,m=g[0],y=g[1],w=g[2],b=g[3],C=this.readSync(r.dataId),_=r.strides,D=_[0],E=_[1],A=_[2],P=_[3],k=this.readSync(e.dataId),N=e.strides,F=N[0],H=N[1],W=N[2],Z=N[3],Y=o.padInfo.front,Q=o.padInfo.left,re=o.padInfo.top,ne=0;ne<u;++ne)for(var J=Math.max(0,Math.ceil((Y-ne)/i)),se=Math.min(o.outDepth,(o.inDepth+Y-ne)/i),ue=ne*m,ve=0;ve<c;++ve)for(var Ee=Math.max(0,Math.ceil((re-ve)/a)),ke=Math.min(o.outHeight,(o.inHeight+re-ve)/a),ot=ve*y+ue,it=0;it<f;++it)for(var dt=Math.max(0,Math.ceil((Q-it)/s)),It=Math.min(o.outWidth,(o.inWidth+Q-it)/s),yt=it*w+ot,St=0;St<o.inChannels;++St)for(var En=St*b+yt,wt=0;wt<o.outChannels;++wt){for(var Wt=0,Lt=0;Lt<o.batchSize;++Lt)for(var mn=Lt*F,ln=Lt*D,fn=J;fn<se;++fn)for(var Ba=(ne+fn*i-Y)*H+mn,Va=fn*E+ln,jo=Ee;jo<ke;++jo)for(var md=(ve+jo*a-re)*W+Ba,Ts=jo*A+Va,Bu=dt;Bu<It;++Bu)Wt+=k[(it+Bu*s-Q)*Z+md+St]*C[Bu*P+Ts+wt];p[En+wt]=Wt}return d.toTensor()},n.prototype.fusedDepthwiseConv2D=function(e){var a=e.bias,s=e.activation,u=e.preluActivationWeights,c=this.depthwiseConv2D(e.input,e.filter,e.convInfo);return a&&(c=this.add(c,a)),s&&(c=dI(this,c,s,u)),c},n.prototype.depthwiseConv2D=function(e,r,o){ie([e,r],"depthwiseConv2D");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,c=o.padInfo.left,f=o.padInfo.top,d=o.outChannels/o.inChannels,p=Ge(o.outShape,e.dtype),g=this.readSync(e.dataId),m=this.readSync(r.dataId),y=p.values,w=0;w<o.batchSize;++w)for(var b=w*e.strides[0],C=w*p.strides[0],_=0;_<o.outHeight;++_)for(var D=C+_*p.strides[1],E=_*o.strideHeight-c,A=0;A<i;++A){var P=E+A*s;if(!(P<0||P>=o.inHeight))for(var k=A*r.strides[0],N=b+P*e.strides[1],F=0;F<o.outWidth;++F)for(var H=D+F*p.strides[2],W=F*o.strideWidth-f,Z=0;Z<a;++Z){var Y=W+Z*u;if(!(Y<0||Y>=o.inWidth))for(var re=N+Y*o.inChannels,ne=H,J=k+Z*r.strides[1],se=0;se<o.inChannels;++se){for(var ue=g[re+se],ve=0;ve<d;++ve)y[ne+ve]+=ue*m[J+ve];ne+=d,J+=d}}}return p.toTensor()},n.prototype.depthwiseConv2DDerInput=function(e,r,o){ie([e,r],"depthwiseConv2DDerInput");for(var i=Ge(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],c=s[1],f=s[2],d=this.readSync(e.dataId),p=e.strides,g=p[0],m=p[1],y=p[2],w=this.readSync(r.dataId),b=r.strides,C=b[0],_=b[1],D=b[2],E=o.batchSize,A=o.filterHeight,P=o.filterWidth,k=o.inChannels,N=o.inHeight,F=o.inWidth,W=o.outHeight,Z=o.outWidth,Y=o.strideHeight,Q=o.strideWidth,re=A-1-o.padInfo.top,ne=P-1-o.padInfo.left,J=o.outChannels/k,se=0;se<E;++se)for(var ue=0;ue<k;++ue)for(var ve=0;ve<N;++ve)for(var Ee=ve-re,ke=Math.max(0,Math.ceil(Ee/Y)),ot=Math.min(W,(A+Ee)/Y),it=0;it<F;++it){for(var dt=it-ne,It=Math.max(0,Math.ceil(dt/Q)),yt=Math.min(Z,(P+dt)/Q),St=0,En=ke;En<ot;++En)for(var wt=En*Y-Ee,Wt=It;Wt<yt;++Wt)for(var Lt=g*se+m*En+y*Wt,mn=C*(A-1-wt)+_*(P-1-(Wt*Q-dt))+D*ue,ln=0;ln<J;++ln)St+=d[Lt+(ue*J+ln)]*w[mn+ln];a[u*se+c*ve+f*it+ue]=St}return i.toTensor()},n.prototype.depthwiseConv2DDerFilter=function(e,r,o){ie([e,r],"depthwiseConv2DDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,c=Ge(o.filterShape,"float32"),f=o.padInfo.left,d=o.padInfo.top,p=o.outChannels/o.inChannels,g=this.bufferSync(e),m=this.bufferSync(r),y=0;y<s;++y)for(var w=Math.max(0,Math.ceil((d-y)/i)),b=Math.min(o.outHeight,(o.inHeight+d-y)/i),C=0;C<u;++C)for(var _=Math.max(0,Math.ceil((f-C)/a)),D=Math.min(o.outWidth,(o.inWidth+f-C)/a),E=0;E<o.outChannels;++E){for(var A=Math.trunc(E/p),P=E%p,k=0,N=0;N<o.batchSize;++N)for(var F=w;F<b;++F)for(var H=y+F*i-d,W=_;W<D;++W)k+=g.get(N,H,C+W*a-f,A)*m.get(N,F,W,E);c.set(k,y,C,A,P)}return c.toTensor()},n.prototype.tile=function(e,r){return ie(e,"tile"),zk(this.bufferSync(e),r)},n.prototype.pad=function(e,r,o){ie(e,"pad");var i=r.map(function(p,g){return p[0]+e.shape[g]+p[1]}),a=r.map(function(p){return p[0]}),s=this.bufferSync(e),u=Ge(i,e.dtype);0!==o&&u.values.fill(o);for(var c=0;c<e.size;c++){var f=s.indexToLoc(c),d=f.map(function(p,g){return p+a[g]});u.set.apply(u,[s.get.apply(s,f)].concat(d))}return u.toTensor()},n.prototype.transpose=function(e,r){ie(e,"transpose");for(var o=new Array(e.rank),i=0;i<o.length;i++)o[i]=e.shape[r[i]];var a=this.readSync(e.dataId),s=Ge(o,e.dtype),u=this.bufferSync(e);for(i=0;i<e.size;++i){for(var c=u.indexToLoc(i),f=new Array(c.length),d=0;d<f.length;d++)f[d]=c[r[d]];var p=s.locToIndex(f);s.values[p]=a[i]}return s.toTensor()},n.prototype.gather=function(e,r,o){ie([e,r],"gather");var i=e.shape.slice(),a=this.readSync(r.dataId);i[o]=a.length;for(var s=Ge(i,e.dtype),u=this.bufferSync(e),c=0;c<s.size;++c){var f=s.indexToLoc(c),d=f.slice();d[o]=a[f[o]];var p=u.locToIndex(d);s.values[c]=u.values[p]}return s.toTensor()},n.prototype.batchToSpaceND=function(e,r,o){ie([e],"batchToSpaceND");var i=r.reduce(function(d,p){return d*p}),a=Cw(e.shape,r,i),s=Dw(a.length,r.length),u=Ew(e.shape,r,i),c=Mk(o,r.length),f=Nk(u,o,r.length);return e.reshape(a).transpose(s).reshape(u).slice(c,f)},n.prototype.spaceToBatchND=function(e,r,o){ie([e],"spaceToBatchND");var i=r.reduce(function(p,g){return p*g}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<e.shape.length;++s)a.push([0,0]);var u=e.pad(a),c=Cw(u.shape,r,i,!1),f=Dw(c.length,r.length,!1),d=Ew(u.shape,r,i,!1);return u.reshape(c).transpose(f).reshape(d)},n.prototype.pool=function(e,r,o){ie(e,"pool");for(var i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left,g="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(e.dataId),y=Ge(r.outShape,e.dtype),w=y.values,b=r.outShape[1]*r.outShape[2]*r.outShape[3],C=r.outShape[2]*r.outShape[3],_=r.outShape[3],D=0;D<r.batchSize;++D)for(var E=D*b,A=D*e.strides[0],P=0;P<r.inChannels;++P)for(var k=0;k<r.outHeight;++k)for(var N=k*i-d,F=Math.max(0,N),H=Math.min(r.inHeight,c+N),W=E+k*C,Z=0;Z<r.outWidth;++Z){for(var Y=Z*a-p,Q=Math.max(0,Y),re=Math.min(r.inWidth,f+Y),ne=g,J=0,se=0,ue=F;ue<H;ue+=s){for(var ve=A+ue*e.strides[1],Ee=Q;Ee<re;Ee+=u){var ke=m[ve+Ee*e.strides[2]+P];"max"===o&&ke>ne?ne=ke:"avg"===o&&(J+=ke,se++)}if(isNaN(ne))break}w[W+Z*_+P]="avg"===o?J/se:ne}return y.toTensor()},n.prototype.maxPool=function(e,r){return this.pool(e,r,"max")},n.prototype.maxPoolPositions=function(e,r){for(var o=Ge(r.outShape,"int32"),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left,g=this.bufferSync(e),m=0;m<r.batchSize;++m)for(var y=0;y<r.inChannels;++y)for(var w=0;w<r.outHeight;++w){for(var b=w*i-d,C=b;C<0;)C+=s;for(var _=Math.min(r.inHeight,c+b),D=0;D<r.outWidth;++D){for(var E=D*a-p,A=E;A<0;)A+=u;for(var P=Math.min(r.inWidth,f+E),k=Number.NEGATIVE_INFINITY,N=-1,F=C;F<_;F+=s)for(var H=F-b,W=A;W<P;W+=u){var Z=W-E,Y=g.get(m,F,W,y);Y>k&&(k=Y,N=H*f+Z)}o.set(N,m,w,D,y)}}return o.toTensor()},n.prototype.maxPoolBackprop=function(e,r,o,i){ie([r,o],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,i),s=i.strideHeight,u=i.strideWidth,c=i.dilationHeight,f=i.dilationWidth,d=i.effectiveFilterHeight,p=i.effectiveFilterWidth,g=p-1-i.padInfo.left,m=d-1-i.padInfo.top,y=Ge(r.shape,"float32"),w=this.bufferSync(a),b=this.bufferSync(e),C=0;C<i.batchSize;++C)for(var _=0;_<i.inChannels;++_)for(var D=0;D<i.inHeight;++D)for(var E=0;E<i.inWidth;++E){for(var A=D-m,P=E-g,k=0,N=0;N<d;N+=c){var F=(A+N)/s;if(!(F<0||F>=i.outHeight||Math.floor(F)!==F))for(var H=0;H<p;H+=f){var W=(P+H)/u;if(!(W<0||W>=i.outWidth||Math.floor(W)!==W)){var Z=d*p-1-w.get(C,F,W,_)===N*p+H?1:0;0!==Z&&(k+=b.get(C,F,W,_)*Z)}}}y.set(k,C,D,E,_)}return y.toTensor()},n.prototype.avgPoolBackprop=function(e,r,o){ie([e,r],"avgPoolBackprop");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,c=o.dilationHeight,f=o.dilationWidth,d=o.effectiveFilterHeight,p=o.effectiveFilterWidth,g=p-1-o.padInfo.left,m=d-1-o.padInfo.top,y=Ge(r.shape,"float32"),w=1/(s*u),b=this.bufferSync(e),C=0;C<o.batchSize;++C)for(var _=0;_<o.inChannels;++_)for(var D=0;D<o.inHeight;++D)for(var E=0;E<o.inWidth;++E){for(var A=D-m,P=E-g,k=0,N=0;N<d;N+=c){var F=(A+N)/i;if(!(F<0||F>=o.outHeight||Math.floor(F)!==F))for(var H=0;H<p;H+=f){var W=(P+H)/a;W<0||W>=o.outWidth||Math.floor(W)!==W||(k+=b.get(C,F,W,_))}}y.set(k*w,C,D,E,_)}return y.toTensor()},n.prototype.pool3d=function(e,r,o){ie(e,"pool3d");for(var i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,f=r.dilationWidth,d=r.effectiveFilterDepth,p=r.effectiveFilterHeight,g=r.effectiveFilterWidth,m=r.padInfo.front,y=r.padInfo.top,w=r.padInfo.left,b="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,C=this.readSync(e.dataId),_=Ge(r.outShape,e.dtype),D=_.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],A=r.outShape[2]*r.outShape[3]*r.outShape[4],P=r.outShape[3]*r.outShape[4],k=r.outShape[4],N=0;N<r.batchSize;++N)for(var F=N*E,H=N*e.strides[0],W=0;W<r.inChannels;++W)for(var Z=0;Z<r.outDepth;++Z){for(var Y=Z*i-m,Q=Y;Q<0;)Q+=u;for(var re=Math.min(r.inDepth,d+Y),ne=F+Z*A,J=0;J<r.outHeight;++J){for(var se=J*a-y,ue=se;ue<0;)ue+=c;for(var ve=Math.min(r.inHeight,p+se),Ee=ne+J*P,ke=0;ke<r.outWidth;++ke){for(var ot=ke*s-w,it=ot;it<0;)it+=f;for(var dt=Math.min(r.inWidth,g+ot),It=Ee+ke*k,yt=b,St=0,En=0,wt=Q;wt<re;wt+=u){for(var Wt=H+wt*e.strides[1],Lt=ue;Lt<ve;Lt+=c){for(var mn=Wt+Lt*e.strides[2],ln=it;ln<dt;ln+=f){var fn=C[mn+ln*e.strides[3]+W];if("max"===o&&fn>yt?yt=fn:"avg"===o&&(St+=fn,En++),isNaN(yt))break}if(isNaN(yt))break}if(isNaN(yt))break}D[It+W]="avg"===o?St/En:yt}}}return _.toTensor()},n.prototype.avgPool3d=function(e,r){return ie(e,"avgPool3d"),this.pool3d(e,r,"avg").toFloat()},n.prototype.avgPool3dBackprop=function(e,r,o){ie([e,r],"avgPool3dBackprop");for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,c=o.filterHeight,f=o.filterWidth,d=o.dilationDepth,p=o.dilationHeight,g=o.dilationWidth,m=o.effectiveFilterDepth,y=o.effectiveFilterHeight,w=o.effectiveFilterWidth,b=m-1-o.padInfo.front,C=w-1-o.padInfo.left,_=y-1-o.padInfo.top,D=Ge(r.shape,"float32"),E=1/(u*c*f),A=this.bufferSync(e),P=0;P<o.batchSize;++P)for(var k=0;k<o.inChannels;++k)for(var N=0;N<o.inDepth;++N)for(var F=0;F<o.inHeight;++F)for(var H=0;H<o.inWidth;++H){for(var W=N-b,Z=F-_,Y=H-C,Q=0,re=0;re<m;re+=d){var ne=(W+re)/i;if(!(ne<0||ne>=o.outDepth||Math.floor(ne)!==ne))for(var J=0;J<y;J+=p){var se=(Z+J)/a;if(!(se<0||se>=o.outHeight||Math.floor(se)!==se))for(var ue=0;ue<w;ue+=g){var ve=(Y+ue)/s;ve<0||ve>=o.outWidth||Math.floor(ve)!==ve||(Q+=A.get(P,ne,se,ve,k))}}}D.set(Q*E,P,N,F,H,k)}return D.toTensor()},n.prototype.maxPool3d=function(e,r){return ie(e,"maxPool3d"),this.pool3d(e,r,"max").toFloat()},n.prototype.maxPool3dPositions=function(e,r){for(var o=Ge(r.outShape,"int32"),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,f=r.dilationWidth,d=r.effectiveFilterDepth,p=r.effectiveFilterHeight,g=r.effectiveFilterWidth,m=r.padInfo.front,y=r.padInfo.top,w=r.padInfo.left,b=this.bufferSync(e),C=0;C<r.batchSize;++C)for(var _=0;_<r.inChannels;++_)for(var D=0;D<r.outDepth;++D){for(var E=D*i-m,A=E;A<0;)A+=u;for(var P=Math.min(r.inDepth,d+E),k=0;k<r.outHeight;++k){for(var N=k*a-y,F=N;F<0;)F+=c;for(var H=Math.min(r.inHeight,p+N),W=0;W<r.outWidth;++W){for(var Z=W*s-w,Y=Z;Y<0;)Y+=f;for(var Q=Math.min(r.inWidth,g+Z),re=Number.NEGATIVE_INFINITY,ne=-1,J=A;J<P;J+=u)for(var se=J-E,ue=F;ue<H;ue+=c)for(var ve=ue-N,Ee=Y;Ee<Q;Ee+=f){var ke=Ee-Z,ot=b.get(C,J,ue,Ee,_);ot>=re&&(re=ot,ne=se*p*g+ve*p+ke)}o.set(ne,C,D,k,W,_)}}}return o.toTensor()},n.prototype.maxPool3dBackprop=function(e,r,o,i){ie([r,o],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,i),s=i.strideDepth,u=i.strideHeight,c=i.strideWidth,f=i.dilationDepth,d=i.dilationHeight,p=i.dilationWidth,g=i.effectiveFilterDepth,m=i.effectiveFilterHeight,y=i.effectiveFilterWidth,w=g-1-i.padInfo.front,b=y-1-i.padInfo.left,C=m-1-i.padInfo.top,_=Ge(r.shape,"float32"),D=this.bufferSync(a),E=this.bufferSync(e),A=0;A<i.batchSize;++A)for(var P=0;P<i.inChannels;++P)for(var k=0;k<i.inDepth;++k)for(var N=0;N<i.inHeight;++N)for(var F=0;F<i.inWidth;++F){for(var H=k-w,W=N-C,Z=F-b,Y=0,Q=0;Q<g;Q+=f){var re=(H+Q)/s;if(!(re<0||re>=i.outDepth||Math.floor(re)!==re))for(var ne=0;ne<m;ne+=d){var J=(W+ne)/u;if(!(J<0||J>=i.outHeight||Math.floor(J)!==J))for(var se=0;se<y;se+=p){var ue=(Z+se)/c;if(!(ue<0||ue>=i.outWidth||Math.floor(ue)!==ue)){var ve=g*m*y-1-D.get(A,re,J,ue,P)===Q*m*y+ne*y+se?1:0;0!==ve&&(Y+=E.get(A,re,J,ue,P)*ve)}}}}_.set(Y,A,k,N,F,P)}return _.toTensor()},n.prototype.cast=function(e,r){return EE(e,r,this)},n.prototype.reshape=function(e,r){return Mw(e,r)},n.prototype.avgPool=function(e,r){return ie(e,"avgPool"),this.pool(e,r,"avg").toFloat()},n.prototype.resizeBilinear=function(e,r,o,i){ie(e,"resizeBilinear");for(var a=e.shape,s=a[0],u=a[1],c=a[2],f=a[3],d=this.readSync(e.dataId),p=new Float32Array(_e([s,r,o,f])),g=[i&&r>1?u-1:u,i&&o>1?c-1:c],m=[i&&r>1?r-1:r,i&&o>1?o-1:o],y=0,w=g[0]/m[0],b=g[1]/m[1],C=0;C<s;C++)for(var _=0;_<r;_++)for(var D=w*_,E=Math.floor(D),A=D-E,P=Math.min(u-1,Math.ceil(D)),k=C*e.strides[0]+E*e.strides[1],N=C*e.strides[0]+P*e.strides[1],F=0;F<o;F++)for(var H=b*F,W=Math.floor(H),Z=H-W,Y=Math.min(c-1,Math.ceil(H)),Q=k+W*e.strides[2],re=N+W*e.strides[2],ne=k+Y*e.strides[2],J=N+Y*e.strides[2],se=0;se<f;se++){var ue=d[Q+se],ve=d[re+se],Ee=ue+(d[ne+se]-ue)*Z;p[y++]=Ee+(ve+(d[J+se]-ve)*Z-Ee)*A}return sr(p,[s,r,o,f])},n.prototype.resizeBilinearBackprop=function(e,r,o){ie([e,r],"resizeBilinearBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],c=i[3],f=e.shape,d=f[1],p=f[2],g=new Float32Array(a*s*u*c),m=[o&&d>1?s-1:s,o&&p>1?u-1:u],y=[o&&d>1?d-1:d,o&&p>1?p-1:p],w=m[0]/y[0],b=m[1]/y[1],C=this.readSync(e.dataId),_=0,D=0;D<a;D++)for(var E=D*r.strides[0],A=0;A<d;A++)for(var P=A*w,k=Math.floor(P),N=Math.min(Math.ceil(P),s-1),F=E+k*r.strides[1],H=E+N*r.strides[1],W=P-k,Z=1-W,Y=0;Y<p;Y++)for(var Q=Y*b,re=Math.floor(Q),ne=Math.min(Math.ceil(Q),u-1),J=Q-re,se=1-J,ue=F+re*r.strides[2],ve=F+ne*r.strides[2],Ee=H+re*r.strides[2],ke=H+ne*r.strides[2],ot=Z*se,it=Z*J,dt=W*se,It=W*J,yt=0;yt<c;yt++){var St=C[_++];g[ue+yt]+=St*ot,g[ve+yt]+=St*it,g[Ee+yt]+=St*dt,g[ke+yt]+=St*It}return ro(g,[a,u,s,c],r.dtype)},n.prototype.resizeNearestNeighbor=function(e,r,o,i){ie(e,"resizeNearestNeighbor");for(var a=e.shape,s=a[0],u=a[1],c=a[2],f=a[3],d=this.readSync(e.dataId),p=new Float32Array(s*r*o*f),g=[i&&r>1?u-1:u,i&&o>1?c-1:c],m=[i&&r>1?r-1:r,i&&o>1?o-1:o],y=g[0]/m[0],w=g[1]/m[1],b=0,C=0;C<s;C++)for(var _=C*e.strides[0],D=0;D<r;D++)for(var E=y*D,A=_+Math.min(u-1,i?Math.round(E):Math.floor(E))*e.strides[1],P=0;P<o;P++)for(var k=w*P,N=A+Math.min(c-1,i?Math.round(k):Math.floor(k))*e.strides[2],F=0;F<f;F++)p[b++]=d[N+F];return sr(p,[s,r,o,f],e.dtype)},n.prototype.resizeNearestNeighborBackprop=function(e,r,o){ie([e,r],"resizeNearestNeighborBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],c=i[3],f=e.shape,d=f[1],p=f[2],g=new Float32Array(a*s*u*c),m=this.readSync(e.dataId),y=[o&&d>1?s-1:s,o&&p>1?u-1:u],w=[o&&d>1?d-1:d,o&&p>1?p-1:p],b=y[0]/w[0],C=y[1]/w[1],_=1/b,D=1/C,E=2*Math.ceil(_)+2,A=2*Math.ceil(D)+2,P=0;P<a;P++)for(var k=P*r.strides[0],N=0;N<s;N++)for(var F=k+N*r.strides[1],H=Math.floor(N*_),W=Math.floor(H-E/2),Z=0;Z<u;Z++)for(var Y=F+Z*r.strides[2],Q=Math.floor(Z*D),re=Math.floor(Q-A/2),ne=0;ne<c;ne++){for(var J=0,se=0;se<E;se++){var ue=se+W;if(!(ue<0||ue>=d)){var ve=k+ue*e.strides[1],Ee=ue*b;if(N===Math.min(s-1,o?Math.round(Ee):Math.floor(Ee)))for(var ke=0;ke<A;ke++){var ot=ke+re;if(!(ot<0||ot>=p)){var it=ve+ot*e.strides[2],dt=ot*C;Z===Math.min(u-1,o?Math.round(dt):Math.floor(dt))&&(J+=m[it+ne])}}}}g[Y+ne]=J}return ro(g,r.shape,r.dtype)},n.prototype.batchNormalization=function(e,r,o,i,a,s){ie([e,r,o,a,s],"batchNorm");for(var u=this.readSync(e.dataId),c=this.readSync(r.dataId),f=this.readSync(o.dataId),d=a?this.readSync(a.dataId):new Float32Array([1]),p=s?this.readSync(s.dataId):new Float32Array([0]),g=new Float32Array(u.length),m=p.length,y=d.length,w=f.length,b=c.length,C=0,_=0,D=0,E=0,A=0;A<u.length;++A)g[A]=p[C++]+(u[A]-c[_++])*d[D++]/Math.sqrt(f[E++]+i),C>=m&&(C=0),_>=b&&(_=0),D>=y&&(D=0),E>=w&&(E=0);return ro(g,e.shape)},n.prototype.localResponseNormalization4D=function(e,r,o,i,a){ie(e,"localResponseNormalization4D");var s=e.shape[3],u=s-1,c=this.readSync(e.dataId),f=e.size,d=new Float32Array(f);function p(w){for(var b=w%s,C=w-b+Math.max(0,b-r),_=w-b+Math.min(b+r,u),D=0;C<=_;C++){var E=c[C];D+=E*E}return D}for(var g=0;g<f;g++){var m=p(g),y=c[g]*Math.pow(o+i*m,-a);d[g]=y}return ro(d,e.shape)},n.prototype.LRNGrad=function(e,r,o,i,a,s,u){ie(e,"LRNGrad");for(var c=e.shape[3],f=this.readSync(e.dataId),d=this.readSync(r.dataId),p=this.readSync(o.dataId),g=new Float32Array(e.size),m=e.size,y=0;y<m;y++){for(var w=y%c,b=y-w+Math.max(0,w-i),C=y-w+Math.min(c,w+i+1),_=0,D=b;D<C;D++)_+=Math.pow(d[D],2);for(_=s*_+a,D=b;D<C;D++){var E=-2*s*u*d[D]*p[y]/_;y===D&&(E+=Math.pow(_,-u)),g[D]+=E*=f[y]}}return ro(g,e.shape)},n.prototype.multinomial=function(e,r,o,i){ie(e,"multinomial");for(var a=r?e:Na(e),s=a.shape[0],u=a.shape[1],c=qt([s,o],"int32"),f=this.readSync(c.dataId),d=this.readSync(a.dataId),p=0;p<s;++p){var g=p*u,m=new Float32Array(u-1);m[0]=d[g];for(var y=1;y<m.length;++y)m[y]=m[y-1]+d[g+y];for(var w=xw(i.toString()),b=p*o,C=0;C<o;++C){var _=w();f[b+C]=m.length;for(var D=0;D<m.length;D++)if(_<m[D]){f[b+C]=D;break}}}return c},n.prototype.oneHot=function(e,r,o,i){ie(e,"oneHot");var a=new Float32Array(e.size*r);a.fill(i);for(var s=this.readSync(e.dataId),u=0;u<e.size;++u)s[u]>=0&&s[u]<r&&(a[u*r+s[u]]=o);return bs(a,[e.size,r],"int32")},n.prototype.nonMaxSuppression=function(e,r,o,i,a){return ie(e,"nonMaxSuppression"),AE(this.readSync(e.dataId),this.readSync(r.dataId),o,i,a)},n.prototype.fft=function(e){return this.fftBatch(e,!1)},n.prototype.ifft=function(e){return this.fftBatch(e,!0)},n.prototype.fftBatch=function(e,r){for(var o=e.shape[0],i=e.shape[1],a=Ge(e.shape,"float32"),s=Ge(e.shape,"float32"),u=Bo(e).as2D(o,i),c=Ki(e).as2D(o,i),f=0;f<o;f++)for(var d=u.slice([f,0],[1,i]),p=c.slice([f,0],[1,i]),g=ar(d,p),m=this.readSync(this.fftImpl(g,r).dataId),y=0;y<i;y++){var w=Uk(m,y);a.values[f*i+y]=w.real,s.values[f*i+y]=w.imag}return ar(a.toTensor(),s.toTensor()).as2D(o,i)},n.prototype.fftImpl=function(e,r){var o=e.as1D(),i=o.size;if(this.isExponentOf2(i)){var a=this.fftRadix2(o,i,r).as2D(e.shape[0],e.shape[1]);return r&&(a=ar(Bo(a).div(le(i)),Ki(a).div(le(i)))),a}var s=this.readSync(e.dataId),u=function(c){for(var f=new Float32Array(c.length/2),d=new Float32Array(c.length/2),p=0;p<c.length;p+=2)f[p/2]=c[p],d[p/2]=c[p+1];return{real:f,imag:d}}(this.fourierTransformByMatmul(s,i,r));return ar(u.real,u.imag).as2D(e.shape[0],e.shape[1])},n.prototype.isExponentOf2=function(e){return 0==(e&e-1)},n.prototype.fftRadix2=function(e,r,o){if(1===r)return e;var i=this.readSync(e.dataId),a=r/2,s=function(b){for(var C=Math.ceil(b.length/4),_=new Float32Array(C),D=new Float32Array(C),E=0;E<b.length;E+=4)_[Math.floor(E/4)]=b[E],D[Math.floor(E/4)]=b[E+1];return{real:_,imag:D}}(i),u=ar(s.real,s.imag).as1D(),c=function(b){for(var C=Math.floor(b.length/4),_=new Float32Array(C),D=new Float32Array(C),E=2;E<b.length;E+=4)_[Math.floor(E/4)]=b[E],D[Math.floor(E/4)]=b[E+1];return{real:_,imag:D}}(i),f=ar(c.real,c.imag).as1D();u=this.fftRadix2(u,a,o),f=this.fftRadix2(f,a,o);var d=function(b,C){for(var _=new Float32Array(b/2),D=new Float32Array(b/2),E=0;E<Math.ceil(b/2);E++){var A=(C?2:-2)*Math.PI*(E/b);_[E]=Math.cos(A),D[E]=Math.sin(A)}return{real:_,imag:D}}(r,o),p=ar(d.real,d.imag).mul(f),g=u.add(p),m=u.sub(p),y=Bo(g).concat(Bo(m)),w=Ki(g).concat(Ki(m));return ar(y,w).as1D()},n.prototype.fourierTransformByMatmul=function(e,r,o){for(var i=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,u=0,c=0;c<r;c++){var f=_5(a*c,r,o),d=Uk(e,c);s+=d.real*f.real-d.imag*f.imag,u+=d.real*f.imag+d.imag*f.real}o&&(s/=r,u/=r),x5(i,s,u,a)}return i},n.prototype.depthToSpace=function(e,r,o){M("NHWC"===o,function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o}),M(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=e.shape[0],a=e.shape[1],s=e.shape[2],u=e.shape[3],c=a*r,f=s*r,d=u/(r*r),p=this.readSync(e.dataId),g=new Float32Array(i*c*f*d),m=0,y=0;y<i;++y)for(var w=0;w<c;++w)for(var b=Math.floor(w/r),C=w%r,_=0;_<f;++_)for(var D=Math.floor(_/r),E=(C*r+_%r)*d,A=0;A<d;++A)g[m++]=p[A+E+u*(D+s*(b+a*y))];return ro(g,[i,c,f,d])},n.prototype.broadcastedBinaryOp=function(e,r,o,i){var a=ct(e.shape,r.shape),s=Ge(a,o),u=this.readSync(e.dataId),c=this.readSync(r.dataId),f=xs(e.shape,a),d=xs(r.shape,a),p=s.values;if(f.length+d.length===0)for(var g=0;g<p.length;++g)p[g]=i(u[g%u.length],c[g%c.length]);else{var m=this.bufferSync(e),y=this.bufferSync(r),w=function(b){var C=s.indexToLoc(b),_=C.slice(-e.rank);f.forEach(function(P){return _[P]=0});var D=m.locToIndex(_),E=C.slice(-r.rank);d.forEach(function(P){return E[P]=0});var A=y.locToIndex(E);p[b]=i(u[D],c[A])};for(g=0;g<p.length;++g)w(g)}return s.toTensor()},n.prototype.broadcastedBinaryComplexOp=function(e,r,o){var i=ct(e.shape,r.shape),a=Ge(i,"float32"),s=Ge(i,"float32"),u=this.readSync(e.dataId),c=this.readSync(r.dataId),f=xs(e.shape,i),d=xs(r.shape,i),p=a.values,g=s.values;if(f.length+d.length===0)for(var m=0;m<p.length;m++){var y=m%u.length,w=m%c.length,b=o(u[2*y],u[2*y+1],c[2*w],c[2*w+1]);p[m]=b.real,g[m]=b.imag}else{var C=this.bufferSync(this.data.get(e.dataId).complexTensors.real),_=this.bufferSync(this.data.get(r.dataId).complexTensors.real),D=function(E){var A=a.indexToLoc(E),P=A.slice(-e.rank);f.forEach(function(W){return P[W]=0});var k=C.locToIndex(P),N=A.slice(-r.rank);d.forEach(function(W){return N[W]=0});var F=_.locToIndex(N),H=o(u[2*k],u[2*k+1],c[2*F],c[2*F+1]);p[E]=H.real,g[E]=H.imag};for(m=0;m<p.length;m++)D(m)}return this.complex(a.toTensor(),s.toTensor())},n.prototype.split=function(e,r,o){return jk(e,r,o)},n.prototype.dispose=function(){},n.prototype.floatPrecision=function(){return 32},n.prototype.epsilon=function(){return 1e-7},n.prototype.cropAndResize=function(e,r,o,i,a,s){for(var u=e.shape,c=u[0],f=u[1],d=u[2],p=u[3],g=r.shape[0],m=i[0],y=i[1],w=Ge([g,m,y,p],"float32"),b=this.readSync(r.dataId),C=this.readSync(o.dataId),_=this.readSync(e.dataId),D=e.strides,E=w.strides,A=0;A<g;A++){var P=4*A,k=b[P],N=b[P+1],F=b[P+2],H=b[P+3],W=C[A];if(!(W>=c))for(var Z=m>1?(F-k)*(f-1)/(m-1):0,Y=y>1?(H-N)*(d-1)/(y-1):0,Q=0;Q<m;Q++){var re=m>1?k*(f-1)+Q*Z:.5*(k+F)*(f-1);if(re<0||re>f-1)for(var ne=0;ne<y;ne++)for(var J=0;J<p;J++){var se=J+ne*E[2]+Q*E[1]+A*E[0];w.values[se]=s}else if("bilinear"===a){var ue=Math.floor(re),ve=Math.ceil(re),Ee=re-ue;for(ne=0;ne<y;ne++)if((wt=y>1?N*(d-1)+ne*Y:.5*(N+H)*(d-1))<0||wt>d-1)for(J=0;J<p;J++)w.values[se=J+ne*E[2]+Q*E[1]+A*E[0]]=s;else{var ke=Math.floor(wt),ot=Math.ceil(wt),it=wt-ke;for(J=0;J<p;J++){var dt=_[se=J+ke*D[2]+ue*D[1]+W*D[0]],It=_[se=J+ot*D[2]+ue*D[1]+W*D[0]],yt=_[se=J+ke*D[2]+ve*D[1]+W*D[0]],St=dt+(It-dt)*it,En=yt+(_[se=J+ot*D[2]+ve*D[1]+W*D[0]]-yt)*it;w.values[se=J+ne*E[2]+Q*E[1]+A*E[0]]=St+(En-St)*Ee}}}else for(ne=0;ne<y;++ne){var wt;if((wt=y>1?N*(d-1)+ne*Y:.5*(N+H)*(d-1))<0||wt>d-1)for(J=0;J<p;J++)w.values[se=J+ne*E[2]+Q*E[1]+A*E[0]]=s;else{var Wt=Math.round(wt),Lt=Math.round(re);for(J=0;J<p;J++)w.values[J+ne*E[2]+Q*E[1]+A*E[0]]=_[J+Wt*D[2]+Lt*D[1]+W*D[0]]}}}}return w.toTensor()},n.prototype.sparseToDense=function(e,r,o,i){var a=Wg(0,e,o);return this.scatter(e,r,o,a.outputSize,a.sliceSize,a.numUpdates,a.sliceRank,a.strides,i,!1)},n.prototype.gatherND=function(e,r){var o=r.shape,i=o[o.length-1],a=vE(e,r),s=a[0],u=a[1],c=a[2],f=a[3];if(0===u)return sr([],s,e.dtype);for(var d=new Gf([u,c],e.dtype),p=this.readSync(r.dataId),g=this.readSync(e.dataId),m=0;m<u;m++){for(var y=[],w=0,b=0;b<i;b++){var C=p[m*i+b];w+=C*f[b],y.push(C)}if(w<0||w>=e.size/c)throw new Error("Invalid indices: "+y+" does not index into "+e.shape);for(var _=0;_<c;_++)d.values[m*c+_]=g[w*c+_]}return d.toTensor().reshape(s)},n.prototype.scatterND=function(e,r,o){var i=Wg(0,e,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,c=i.strides,f=i.outputSize,d=le(0);return this.scatter(e,r,o,f,u,s,a,c,d,!0)},n.prototype.fill=function(e,r,o){var i=Ig(o=o||zf(r),_e(e));return i.fill(r),B.makeTensor(i,e,o,this)},n.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},n.prototype.zerosLike=function(e){var r=Ig(e.dtype,_e(e.shape));return this.makeOutput(r,e.shape,e.dtype)},n.prototype.linspace=function(e,r,o){return IE(e,r,o)},n.prototype.scatter=function(e,r,o,i,a,s,u,c,f,d){var p=[i/a,a],g=this.readSync(e.dataId),m=this.readSync(r.dataId);if(0===i)return sr([],o,r.dtype);var y=new Gf(p,r.dtype);y.values.fill(this.readSync(f.dataId)[0]);for(var w=0;w<s;w++){for(var b=[],C=0,_=0;_<u;_++){var D=g[w*u+_];b.push(D),C+=D*c[_]}if(C<0||C>=i/a)throw new Error("Invalid indices: "+b+" does not index into "+o);for(var E=0;E<a;E++)d?y.values[C*a+E]+=m[w*a+E]:y.values[C*a+E]=0===r.rank?m[0]:m[w*a+E]}return y.toTensor().reshape(o)},n}(_E);B.registerBackend("cpu",function(){return new Iq},1);for(var hI=0,ZL=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(t){var n=t.inputs,r=t.attrs,i=n.boxes,a=n.scores,u=r.maxOutputSize,c=r.iouThreshold,f=r.scoreThreshold,d=r.softNmsSigma,p=t.backend;ie(i,"NonMaxSuppressionWithScore");var g=TE(p.data.get(i.dataId).values,p.data.get(a.dataId).values,u,c,f,d);return[g.selectedIndices,g.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(t){var r=t.inputs.x,o=t.backend;ie(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];a[s]=u*u}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Kg,backendName:"cpu",kernelFunc:function(t){var n=t.inputs,o=n.a,i=n.b,a=t.backend;ie([o,i],Kg);var s=a.data.get(o.dataId).values,u=a.data.get(i.dataId).values,c=function(p,g,m,y,w,b){var C=ct(p,g),_=C.length,D=zi(C),E=jf(w,_e(C)),A=p.length,P=g.length,k=zi(p),N=zi(g),F=xs(p,C),H=xs(g,C);if(F.length+H.length===0)for(var W=0;W<E.length;++W)E[W]=b(m[W%m.length],y[W%y.length]);else{var Z=function(Y){var Q=EF(Y,_,D),re=Q.slice(-A);F.forEach(function(ue){return re[ue]=0});var ne=GD(re,A,k),J=Q.slice(-P);H.forEach(function(ue){return J[ue]=0});var se=GD(J,P,N);E[Y]=b(m[ne],y[se])};for(W=0;W<E.length;++W)Z(W)}return[E,C]}(o.shape,i.shape,s,u,o.dtype,function(p,g){var m=p-g;return m*m}),d=c[1];return{dataId:a.write(c[0],d,o.dtype),shape:d,dtype:o.dtype}}}];hI<ZL.length;hI++)LD(ZL[hI]);for(var td,Sq=function(t){this.variableNames=["A"];var n=Ur(),e=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+e+".0);\n\n        vec4 values = "+n.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},Aq=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=Ur(),e=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+e+".0);\n            vec4 values = "+n.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+n.output+" = result;\n      }\n    "},pI=0,JL=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(t){var e=t.backend,o=t.inputs.pixels,a=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],c=u[0],f=u[1],d=[f,c],p=[f,c,t.attrs.numChannels];(s||a)&&(null==td&&(td=document.createElement("canvas").getContext("2d")),td.canvas.width=c,td.canvas.height=f,td.drawImage(o,0,0,c,f),o=td.canvas);var g=e.makeTensorInfo(d,"int32");e.texData.get(g.dataId).usage=Po.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(g.dataId),o);var m=K().getBool("WEBGL_PACK")?new Aq(p):new Sq(p),y=e.runWebGLProgram(m,[g],"int32");return e.disposeData(g.dataId),y}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(t){var n=t.inputs,e=t.backend,r=t.attrs;mw("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=n.scores,u=r.maxOutputSize,c=r.iouThreshold,f=r.scoreThreshold,d=r.softNmsSigma,p=e,g=TE(p.readSync(n.boxes.dataId),p.readSync(a.dataId),u,c,f,d);return[g.selectedIndices,g.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(t){var r=t.inputs.x,o=t.backend,i=new Je(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:Kg,backendName:"webgl",kernelFunc:function(t){var n=t.inputs,o=n.a,i=n.b,a=t.backend,s=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new _s("return (a - b) * (a - b);",o.shape,i.shape):new vn("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];pI<JL.length;pI++)LD(JL[pI]);for(var gI=0,e3=[{kernelName:"Square",gradFunc:function(t,n){var e=n[0];return{x:function(){return t.mul(e.toFloat().mul(2))}}}},{kernelName:Kg,gradFunc:function(t,n){var e=n[0],r=n[1],o=le(2);return{a:function(){return Sr(t,Sr(o,Bn(e,r)))},b:function(){return Sr(t,Sr(o,Bn(r,e)))}}}}];gI<e3.length;gI++)hF(e3[gI]);var Tq=function(){function t(){}return t.prototype.fetch=function(n,e){return fetch(n,e)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(n,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(n)},t.prototype.decode=function(n,e){return new TextDecoder(e).decode(n)},t}();K().get("IS_BROWSER")&&K().setPlatform("browser",new Tq);var vI,Mq=function(){function t(){this.util=cr(753),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(n,e){return null!=K().global.fetch?K().global.fetch(n,e):(null==vI&&(vI=cr(522)),vI(n,e))},t.prototype.now=function(){var n=process.hrtime();return 1e3*n[0]+n[1]/1e6},t.prototype.encode=function(n,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(n)},t.prototype.decode=function(n,e){return 0===n.length?"":new this.util.TextDecoder(e).decode(n)},t}();K().get("IS_NODE")&&K().setPlatform("node",new Mq);var mI={float32:4,int32:4,uint16:2,uint8:1,bool:1};function t3(t,n){for(var e={},r=0,o=function(s){var u=s.name,c=s.dtype,f=s.shape,d=_e(f),p=void 0;if("quantization"in s){var g=s.quantization;if("uint8"!==g.dtype&&"uint16"!==g.dtype)throw new Error("Weight "+s.name+" has unknown quantization dtype "+g.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var m=mI[g.dtype],y=t.slice(r,r+d*m),w="uint8"===g.dtype?new Uint8Array(y):new Uint16Array(y);if("float32"===c)p=Float32Array.from(w,function(A){return A*g.scale+g.min});else{if("int32"!==c)throw new Error("Unsupported dtype in weight '"+u+"': "+c);p=Int32Array.from(w,function(A){return Math.round(A*g.scale+g.min)})}r+=d*m}else if("string"===c){var b=_e(s.shape);p=[];for(var C=0;C<b;C++){var _=new Uint32Array(t.slice(r,r+4))[0];r+=4;var D=new Uint8Array(t.slice(r,r+_));p.push(D),r+=_}}else{var E=mI[c];if(y=t.slice(r,r+d*E),"float32"===c)p=new Float32Array(y);else if("int32"===c)p=new Int32Array(y);else{if("bool"!==c)throw new Error("Unsupported dtype in weight '"+u+"': "+c);p=new Uint8Array(y)}r+=d*E}e[u]=sr(p,f,c)},i=0,a=n;i<a.length;i++)o(a[i]);return e}function Nq(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));var n=0,e=[];t.forEach(function(i){if(n+=i.byteLength,e.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(n),o=0;return e.forEach(function(i){r.set(new Uint8Array(i.buffer),o),o+=i.byteLength}),r.buffer}var yI=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function n3(t){return yI?Buffer.byteLength(t):new Blob([t]).size}function wI(t){var n=0;t.forEach(function(o){n+=o.byteLength});var e=new Uint8Array(n),r=0;return t.forEach(function(o){e.set(new Uint8Array(o),r),r+=o.byteLength}),e.buffer}function r3(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var n=t.split("/");return n[n.length-1]}function rv(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:n3(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:n3(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}var Wo=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(n){t.getInstance().saveRouters.push(n)},t.registerLoadRouter=function(n){t.getInstance().loadRouters.push(n)},t.getSaveHandlers=function(n){return t.getHandlers(n,"save")},t.getLoadHandlers=function(n,e){return t.getHandlers(n,"load",e)},t.getHandlers=function(n,e,r){var o=[];return("load"===e?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach(function(i){var a=i(n,r);null!==a&&o.push(a)}),o},t}(),nd="://",Iu=function(){function t(){this.managers={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerManager=function(n,e){M(null!=n,function(){return"scheme must not be undefined or null."}),n.endsWith(nd)&&(n=n.slice(0,n.indexOf(nd))),M(n.length>0,function(){return"scheme must not be an empty string."});var r=t.getInstance();M(null==r.managers[n],function(){return"A model store manager is already registered for scheme '"+n+"'."}),r.managers[n]=e},t.getManager=function(n){var e=this.getInstance().managers[n];if(null==e)throw new Error("Cannot find model manager for scheme '"+n+"'");return e},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function Yw(t){if(-1===t.indexOf(nd))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Iu.getSchemes().join(","));return{scheme:t.split(nd)[0],path:t.split(nd)[1]}}function o3(t,n,e){return void 0===e&&(e=!1),be(this,void 0,void 0,function(){var r,o,i,a,s,u,c,f,d;return xe(this,function(p){switch(p.label){case 0:return M(t!==n,function(){return"Old path and new path are the same: '"+t+"'"}),M((r=Wo.getLoadHandlers(t)).length>0,function(){return"Copying failed because no load handler is found for source URL "+t+"."}),M(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."}),o=r[0],M((i=Wo.getSaveHandlers(n)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+n+"."}),M(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+n+"."}),a=i[0],s=Yw(t).scheme,u=Yw(t).path,c=s===Yw(t).scheme,[4,o.load()];case 1:return f=p.sent(),e&&c?[4,Iu.getManager(s).removeModel(u)]:[3,3];case 2:p.sent(),p.label=3;case 3:return[4,a.save(f)];case 4:return d=p.sent(),!e||c?[3,6]:[4,Iu.getManager(s).removeModel(u)];case 5:p.sent(),p.label=6;case 6:return[2,d.modelArtifactsInfo]}})})}var rl="models_store",Su="model_info_store";function i3(){if(!K().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window||self,n=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==n)throw new Error("The current browser does not appear to support IndexedDB.");return n}function bI(t){var n=t.result;n.createObjectStore(rl,{keyPath:"modelPath"}),n.createObjectStore(Su,{keyPath:"modelPath"})}var rd=function(){function t(n){if(this.indexedDB=i3(),null==n||!n)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=n}return t.prototype.save=function(n){return be(this,void 0,void 0,function(){return xe(this,function(e){if(n.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,n)]})})},t.prototype.load=function(){return be(this,void 0,void 0,function(){return xe(this,function(n){return[2,this.databaseAction(this.modelPath)]})})},t.prototype.databaseAction=function(n,e){var r=this;return new Promise(function(o,i){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return bI(a)},a.onsuccess=function(){var s=a.result;if(null==e){var u=s.transaction(rl,"readonly"),c=u.objectStore(rl).get(r.modelPath);c.onsuccess=function(){if(null==c.result)return s.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));o(c.result.modelArtifacts)},c.onerror=function(y){return s.close(),i(c.error)},u.oncomplete=function(){return s.close()}}else{var f,d=rv(e),p=s.transaction(Su,"readwrite"),g=p.objectStore(Su),m=g.put({modelPath:r.modelPath,modelArtifactsInfo:d});m.onsuccess=function(){var y=(f=s.transaction(rl,"readwrite")).objectStore(rl).put({modelPath:r.modelPath,modelArtifacts:e,modelArtifactsInfo:d});y.onsuccess=function(){return o({modelArtifactsInfo:d})},y.onerror=function(w){var b=(g=p.objectStore(Su)).delete(r.modelPath);b.onsuccess=function(){return s.close(),i(y.error)},b.onerror=function(C){return s.close(),i(y.error)}}},m.onerror=function(y){return s.close(),i(m.error)},p.oncomplete=function(){null==f?s.close():f.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return i(a.error)}})},t.URL_SCHEME="indexeddb://",t}(),a3=function(t){return K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(rd.URL_SCHEME)?(n=t.slice(rd.URL_SCHEME.length),new rd(n)):null;var n};Wo.registerSaveRouter(a3),Wo.registerLoadRouter(a3);var Fq=function(){function t(){this.indexedDB=i3()}return t.prototype.listModels=function(){return be(this,void 0,void 0,function(){var n=this;return xe(this,function(e){return[2,new Promise(function(r,o){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return bI(i)},i.onsuccess=function(){var a=i.result,s=a.transaction(Su,"readonly"),u=s.objectStore(Su).getAll();u.onsuccess=function(){for(var c={},f=0,d=u.result;f<d.length;f++){var p=d[f];c[p.modelPath]=p.modelArtifactsInfo}r(c)},u.onerror=function(c){return a.close(),o(u.error)},s.oncomplete=function(){return a.close()}},i.onerror=function(a){return o(i.error)}})]})})},t.prototype.removeModel=function(n){return be(this,void 0,void 0,function(){var e=this;return xe(this,function(r){var o;return n=(o=n).startsWith(rd.URL_SCHEME)?o.slice(rd.URL_SCHEME.length):o,[2,new Promise(function(i,a){var s=e.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return bI(s)},s.onsuccess=function(){var u,c=s.result,f=c.transaction(Su,"readwrite"),d=f.objectStore(Su),p=d.get(n);p.onsuccess=function(){if(null==p.result)return c.close(),a(new Error("Cannot find model with path '"+n+"' in IndexedDB."));var g=d.delete(n),m=function(){var y=(u=c.transaction(rl,"readwrite")).objectStore(rl).delete(n);y.onsuccess=function(){return i(p.result.modelArtifactsInfo)},y.onerror=function(w){return a(p.error)}};g.onsuccess=m,g.onerror=function(y){return m(),c.close(),a(p.error)}},p.onerror=function(g){return c.close(),a(p.error)},f.oncomplete=function(){null==u?c.close():u.oncomplete=function(){return c.close()}}},s.onerror=function(u){return a(s.error)}})]})})},t}();if(K().getBool("IS_BROWSER"))try{Iu.registerManager(rd.URL_SCHEME,new Fq)}catch{}var Es="/",od="tensorflowjs_models",s3="info",kq="model_topology",Pq="weight_specs",Oq="weight_data",Lq="model_metadata";function u3(t){return{info:[od,t,s3].join(Es),topology:[od,t,kq].join(Es),weightSpecs:[od,t,Pq].join(Es),weightData:[od,t,Oq].join(Es),modelMetadata:[od,t,Lq].join(Es)}}function Bq(t){var n=t.split(Es);if(n.length<3)throw new Error("Invalid key format: "+t);return n.slice(1,n.length-1).join(Es)}var id=function(){function t(n){if(!K().getBool("IS_BROWSER")||typeof window>"u"||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==n||!n)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=n,this.keys=u3(this.modelPath)}return t.prototype.save=function(n){return be(this,void 0,void 0,function(){var e,r,o;return xe(this,function(i){if(n.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(n.modelTopology),r=JSON.stringify(n.weightSpecs),o=rv(n);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(a){if(yI)return Buffer.from(a).toString("base64");for(var s=new Uint8Array(a),u="",c=0,f=s.length;c<f;c++)u+=String.fromCharCode(s[c]);return btoa(u)}(n.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,userDefinedMetadata:n.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+o.modelTopologyBytes+", weightSpecsBytes="+o.weightSpecsBytes+", weightDataBytes="+o.weightDataBytes+".")}return[2]})})},t.prototype.load=function(){return be(this,void 0,void 0,function(){var n,e,r,o,i,a,s;return xe(this,function(u){if(null==(n=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==n.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(r=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=r,null==(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=o,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(a=JSON.parse(i),e.format=a.format,e.generatedBy=a.generatedBy,e.convertedBy=a.convertedBy,e.userDefinedMetadata=a.userDefinedMetadata),null==(s=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(c){if(yI){var f=Buffer.from(c,"base64");return f.buffer.slice(f.byteOffset,f.byteOffset+f.byteLength)}for(var d=atob(c),p=new Uint8Array(d.length),g=0;g<d.length;++g)p.set([d.charCodeAt(g)],g);return p.buffer}(s),[2,e]})})},t.URL_SCHEME="localstorage://",t}(),c3=function(t){return K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(id.URL_SCHEME)?(n=t.slice(id.URL_SCHEME.length),new id(n)):null;var n};Wo.registerSaveRouter(c3),Wo.registerLoadRouter(c3);var Vq=function(){function t(){M(K().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),M(typeof window>"u"||void 0!==window.localStorage,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return t.prototype.listModels=function(){return be(this,void 0,void 0,function(){var n,e,r,o,i,a;return xe(this,function(s){for(n={},e=od+Es,r=Es+s3,o=0;o<this.LS.length;++o)(i=this.LS.key(o)).startsWith(e)&&i.endsWith(r)&&(a=Bq(i),n[a]=JSON.parse(this.LS.getItem(i)));return[2,n]})})},t.prototype.removeModel=function(n){return be(this,void 0,void 0,function(){var e,r;return xe(this,function(o){var i;if(n=(i=n).startsWith(id.URL_SCHEME)?i.slice(id.URL_SCHEME.length):i,e=u3(n),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '"+n+"'");return r=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,r]})})},t}();if(K().getBool("IS_BROWSER"))try{Iu.registerManager(id.URL_SCHEME,new Vq)}catch{}function l3(t){return new Promise(function(n){return setTimeout(n)}).then(t)}var xI=function(){function t(n){if(!K().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");n.startsWith(t.URL_SCHEME)&&(n=n.slice(t.URL_SCHEME.length)),null!=n&&0!==n.length||(n="model"),this.modelTopologyFileName=n+".json",this.weightDataFileName=n+".weights.bin"}return t.prototype.save=function(n){return be(this,void 0,void 0,function(){var e,i,a,s;return xe(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([n.weightData],{type:"application/octet-stream"})),!(n.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return i=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:n.weightSpecs}]})],{type:"application/json"})),(a=this.jsonAnchor??document.createElement("a")).download=this.modelTopologyFileName,a.href=i,[4,l3(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),null==n.weightData?[3,4]:((s=this.weightDataAnchor??document.createElement("a")).download=this.weightDataFileName,s.href=e,[4,l3(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:rv(n)}]}})})},t.URL_SCHEME="downloads://",t}(),jq=function(){function t(n){if(null==n||n.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+n);this.files=n}return t.prototype.load=function(){return be(this,void 0,void 0,function(){var n,e,r=this;return xe(this,function(o){return n=this.files[0],e=this.files.slice(1),[2,new Promise(function(i,a){var s=new FileReader;s.onload=function(u){var c=JSON.parse(u.target.result),f=c.modelTopology;if(null!=f){0===e.length&&i({modelTopology:f});var d=c.weightsManifest;if(null!=d){var p;try{p=r.checkManifestAndWeightFiles(d,e)}catch(w){return void a(w)}var g=[],m=[],y=[];d.forEach(function(w){w.paths.forEach(function(b){m.push(b),y.push(null)}),g.push.apply(g,w.weights)}),d.forEach(function(w){w.paths.forEach(function(b){var C=new FileReader;C.onload=function(_){var D=_.target.result,E=m.indexOf(b);y[E]=D,-1===y.indexOf(null)&&i({modelTopology:f,weightSpecs:g,weightData:wI(y),format:c.format,generatedBy:c.generatedBy,convertedBy:c.convertedBy,userDefinedMetadata:c.userDefinedMetadata})},C.onerror=function(_){return a("Failed to weights data from file of path '"+b+"'.")},C.readAsArrayBuffer(p[b])})})}else a(new Error("weightManifest field is missing from file "+n.name))}else a(new Error("modelTopology field is missing from file "+n.name))},s.onerror=function(u){return a("Failed to read model topology and weights manifest JSON from file '"+n.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(n)})]})})},t.prototype.checkManifestAndWeightFiles=function(n,e){for(var r=[],o=e.map(function(u){return r3(u.name)}),i={},a=0,s=n;a<s.length;a++)s[a].paths.forEach(function(u){var c=r3(u);if(-1!==r.indexOf(c))throw new Error("Duplicate file basename found in weights manifest: '"+c+"'");if(r.push(c),-1===o.indexOf(c))throw new Error("Weight file with basename '"+c+"' is not provided.");i[u]=e[o.indexOf(c)]});if(r.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+e.length+").");return i},t}();function f3(t,n,e,r){var i;M(null!=(i=t)&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"}),function(i,a){M(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),M(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),M(a>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+a})}(e=e??0,r=r??1);var o=0;return Promise.all(t.map(function(i){return i.then(function(a){var s=e+ ++o/t.length*(r-e);return n(s),a}),i}))}function d3(t,n){return be(this,void 0,void 0,function(){var e,r,o,i,a,s,u,c,f;return xe(this,function(d){switch(d.label){case 0:return null==n&&(n={}),e=n.fetchFunc??K().platform.fetch,r=t.map(function(p){return e(p,n.requestInit,{isBinary:!0})}),o=0,i=.5,null!=n.onProgress?[3,2]:[4,Promise.all(r)];case 1:return a=d.sent(),[3,4];case 2:return[4,f3(r,n.onProgress,o,i)];case 3:a=d.sent(),d.label=4;case 4:return s=a.map(function(p){return p.arrayBuffer()}),u=.5,c=1,null!=n.onProgress?[3,6]:[4,Promise.all(s)];case 5:return f=d.sent(),[3,8];case 6:return[4,f3(s,n.onProgress,u,c)];case 7:f=d.sent(),d.label=8;case 8:return[2,f]}})})}function h3(t){var n=this;return function(e,r,o){return void 0===r&&(r=""),be(n,void 0,void 0,function(){var i,a,s,u,c,f,d,p,g,m;return xe(this,function(y){switch(y.label){case 0:if(i=e.map(function(){return!1}),a={},s=null!=o?o.map(function(){return!1}):[],u=[],e.forEach(function(w,b){var C=0;w.weights.forEach(function(_){var E=mI["quantization"in _?_.quantization.dtype:_.dtype]*_e(_.shape),A=function(){i[b]=!0,null==a[b]&&(a[b]=[]),a[b].push({manifestEntry:_,groupOffset:C,sizeBytes:E})};null!=o?o.forEach(function(P,k){P===_.name&&(A(),s[k]=!0)}):A(),u.push(_.name),C+=E})}),!s.every(function(w){return w}))throw c=o.filter(function(w,b){return!s[b]}),new Error("Could not find weights in manifest with names: "+c.join(", ")+". \nManifest JSON has weights with names: "+u.join(", ")+".");return f=i.reduce(function(w,b,C){return b&&w.push(C),w},[]),d=[],f.forEach(function(w){e[w].paths.forEach(function(b){var C=r+(r.endsWith("/")?"":"/")+b;d.push(C)})}),[4,t(d)];case 1:return p=y.sent(),g={},m=0,f.forEach(function(w){for(var b=e[w].paths.length,C=0,_=0;_<b;_++)C+=p[m+_].byteLength;for(var D=new ArrayBuffer(C),E=new Uint8Array(D),A=0,P=0;P<b;P++){var k=new Uint8Array(p[m+P]);E.set(k,A),A+=k.byteLength}a[w].forEach(function(N){var F=t3(D.slice(N.groupOffset,N.groupOffset+N.sizeBytes),[N.manifestEntry]);for(var H in F)g[H]=F[H]}),m+=b}),[2,g]}})})}}Wo.registerSaveRouter(function(t){return K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(xI.URL_SCHEME)?(void 0===(n=t.slice(xI.URL_SCHEME.length))&&(n="model"),new xI(n)):null;var n});var p3=function(){function t(n,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(M("function"==typeof e.fetchFunc,function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=e.fetchFunc):this.fetch=K().platform.fetch,M(null!=n&&n.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(n)&&M(2===n.length,function(){return"URL paths for http must have a length of 2, (actual length is "+n.length+")."}),this.path=n,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return t.prototype.save=function(n){return be(this,void 0,void 0,function(){var e,i;return xe(this,function(a){switch(a.label){case 0:if(n.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,e.body.append("model.json",new Blob([JSON.stringify({modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,userDefinedMetadata:n.userDefinedMetadata,weightsManifest:[{paths:["./model.weights.bin"],weights:n.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=n.weightData&&e.body.append("model.weights.bin",new Blob([n.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((i=a.sent()).ok)return[2,{modelArtifactsInfo:rv(n),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},t.prototype.load=function(){return be(this,void 0,void 0,function(){var n,e,r,o,i,a,s,u,c,f,d,p;return xe(this,function(g){switch(g.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(n=g.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+n.status+". Please verify this URL points to the model JSON of the model to load.");g.label=2;case 2:return g.trys.push([2,4,,5]),[4,n.json()];case 3:return e=g.sent(),[3,5];case 4:throw g.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=e.weightsManifest,a=e.generatedBy,s=e.convertedBy,u=e.format,c=e.userDefinedMetadata,null==(o=e.modelTopology)&&null==i)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==i?[3,7]:[4,this.loadWeights(i)];case 6:p=g.sent(),f=p[0],d=p[1],g.label=7;case 7:return[2,{modelTopology:o,weightSpecs:f,weightData:d,userDefinedMetadata:c,generatedBy:a,convertedBy:s,format:u}]}})})},t.prototype.loadWeights=function(n){return be(this,void 0,void 0,function(){var r,o,i,a,s,u,c,d,p;return xe(this,function(g){switch(g.label){case 0:for(void 0,void 0,y=(m=Array.isArray(this.path)?this.path[1]:this.path).lastIndexOf("/"),w=m.lastIndexOf("?"),r=[m.substring(0,y)+"/",w>y?m.substring(w):""],o=r[0],i=r[1],a=this.weightPathPrefix||o,s=[],u=0,c=n;u<c.length;u++)s.push.apply(s,c[u].weights);return d=[],n.forEach(function(m){m.paths.forEach(function(y){d.push(a+y+i)})}),[4,d3(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return p=g.sent(),[2,[s,wI(p)]]}var m,y,w})})},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function _I(t){return null!=t.match(p3.URL_SCHEME_REGEX)}var g3=function(t,n){return typeof fetch>"u"?null:(Array.isArray(t)?t.every(function(e){return _I(e)}):_I(t))?CI(t,{onProgress:n}):null};function CI(t,n){return new p3(t,n)}Wo.registerSaveRouter(g3),Wo.registerLoadRouter(g3);var ad,DI=function(){function t(n){this.modelArtifacts=n}return t.prototype.load=function(){return be(this,void 0,void 0,function(){return xe(this,function(n){return[2,this.modelArtifacts]})})},t}(),zq=function(){function t(n){this.saveHandler=n}return t.prototype.save=function(n){return be(this,void 0,void 0,function(){return xe(this,function(e){return[2,this.saveHandler(n)]})})},t}(),EI=Object.freeze({browserFiles:function(t){return new jq(t)},browserHTTPRequest:function(t,n){return CI(t,n)},concatenateArrayBuffers:wI,decodeWeights:t3,encodeWeights:function(t,n){return be(this,void 0,void 0,function(){var e,r,o,i,a,s=this;return xe(this,function(u){switch(u.label){case 0:for(e=[],r=[],o=Array.isArray(t)?t.map(function(c){return c.name}):Object.keys(t),i=function(c){var f=o[c],d=Array.isArray(t)?t[c].tensor:t[f];if("float32"!==d.dtype&&"int32"!==d.dtype&&"bool"!==d.dtype&&"string"!==d.dtype)throw new Error("Unsupported dtype in weight '"+f+"': "+d.dtype);var p={name:f,shape:d.shape,dtype:d.dtype};if("string"===d.dtype){var g=new Promise(function(m){return be(s,void 0,void 0,function(){var y,w,b,C,_,D,E;return xe(this,function(A){switch(A.label){case 0:return[4,d.bytes()];case 1:for(y=A.sent(),w=y.reduce(function(P,k){return P+k.length},0)+4*y.length,b=new Uint8Array(w),C=0,_=0;_<y.length;_++)D=y[_],E=new Uint8Array(new Uint32Array([D.length]).buffer),b.set(E,C),b.set(D,C+=4),C+=D.length;return m(b),[2]}})})});r.push(g)}else r.push(d.data());null!=n&&(p.group=n),e.push(p)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:Nq(u.sent()),specs:e}]}})})},fromMemory:function(t,n,e,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new DI(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new DI({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new DI({modelTopology:t,weightSpecs:n,weightData:e,trainingConfig:r}))},getLoadHandlers:function(t,n){return Wo.getLoadHandlers(t,n)},getModelArtifactsInfoForJSON:rv,getSaveHandlers:function(t){return Wo.getSaveHandlers(t)},http:CI,isHTTPScheme:_I,loadWeights:function(t,n,e,r){return void 0===n&&(n=""),be(this,void 0,void 0,function(){return xe(this,function(o){return[2,h3(function(i){return d3(i,{requestInit:r})})(t,n,e)]})})},registerLoadRouter:function(t){return Wo.registerLoadRouter(t)},registerSaveRouter:function(t){return Wo.registerSaveRouter(t)},weightsLoaderFactory:h3,withSaveHandler:function(t){return new zq(t)},copyModel:function(t,n){return be(this,void 0,void 0,function(){return xe(this,function(e){return[2,o3(t,n,!1)]})})},listModels:function(){return be(this,void 0,void 0,function(){var t,n,e,r,o,i,a;return xe(this,function(s){switch(s.label){case 0:t=Iu.getSchemes(),n={},e=0,r=t,s.label=1;case 1:return e<r.length?[4,Iu.getManager(o=r[e]).listModels()]:[3,4];case 2:for(a in i=s.sent())n[o+nd+a]=i[a];s.label=3;case 3:return e++,[3,1];case 4:return[2,n]}})})},moveModel:function(t,n){return be(this,void 0,void 0,function(){return xe(this,function(e){return[2,o3(t,n,!0)]})})},removeModel:function(t){return be(this,void 0,void 0,function(){var n;return xe(this,function(e){return n=Yw(t),[2,Iu.getManager(n.scheme).removeModel(n.path)]})})}}),$q=V({confusionMatrix_:function(t,n,e){var r=R(t,"labels","confusionMatrix"),o=R(n,"predictions","confusionMatrix");M(null==e||e>0&&Number.isInteger(e),function(){return"If provided, numClasses must be a positive integer, but got "+e}),M(1===r.rank,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),M(1===o.rank,function(){return"Expected the rank of predictions to be 1, but got "+o.rank}),M(r.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."}),M(e>0&&Number.isInteger(e),function(){return"numClasses is required to be a positive integer, but got "+e});var i=_w(r.asType("int32"),e),a=_w(o.asType("int32"),e);return i.transpose().matMul(a).asType("int32")}}),Gq=Object.freeze({confusionMatrix:$q}),qq=V({fromPixels_:function(t,n){if(void 0===n&&(n=3),n>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var e=!1,r=!1,o=!1,i=!1,a=!1;if(t.data instanceof Uint8Array)e=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else{if(null==t.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);a=!0}if(o&&o&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=PD("FromPixels",B.backendName))return B.runKernel("FromPixels",{pixels:t},{numChannels:n});var s,u,c=o?[t.videoWidth,t.videoHeight]:[t.width,t.height],f=c[0],d=c[1];if(a?s=t.getContext("2d").getImageData(0,0,f,d).data:r||e?s=t.data:(i||o)&&(null==ad&&(ad=document.createElement("canvas").getContext("2d")),ad.canvas.width=f,ad.canvas.height=d,ad.drawImage(t,0,0,f,d),s=ad.getImageData(0,0,f,d).data),4===n)u=new Int32Array(s);else{var p=f*d;u=new Int32Array(p*n);for(var g=0;g<p;g++)for(var m=0;m<n;++m)u[g*n+m]=s[4*g+m]}return ww(u,[d,f,n],"int32")}}),Qw=Object.freeze({toPixels:function(t,n){return be(this,void 0,void 0,function(){var e,r,o,i,a,s,u,c,f,g,m,y,w,b,C,_,D,E,A,P,k;return xe(this,function(N){switch(N.label){case 0:if(e=R(t,"img","toPixels"),t instanceof Ut||(e=e.toInt()),2!==e.rank&&3!==e.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+e.rank+".");if(r=e.shape.slice(0,2),o=r[0],i=r[1],(a=2===e.rank?1:e.shape[2])>4||2===a)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,e.data()];case 1:return s=N.sent(),u=e.min(),c=e.max(),[4,Promise.all([u.data(),c.data()])];case 2:if(f=N.sent(),g=f[0][0],m=f[1][0],u.dispose(),c.dispose(),"float32"===e.dtype){if(g<0||m>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+g+" - "+m+"].")}else{if("int32"!==e.dtype)throw new Error("Unsupported type for toPixels: "+e.dtype+". Please use float32 or int32 tensors.");if(g<0||m>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+g+" - "+m+"].")}for(y="float32"===e.dtype?255:1,w=new Uint8ClampedArray(i*o*4),b=0;b<o*i;++b)C=void 0,_=void 0,D=void 0,E=void 0,1===a?(C=s[b]*y,_=s[b]*y,D=s[b]*y,E=255):3===a?(C=s[3*b]*y,_=s[3*b+1]*y,D=s[3*b+2]*y,E=255):4===a&&(C=s[4*b]*y,_=s[4*b+1]*y,D=s[4*b+2]*y,E=s[4*b+3]*y),w[0+(A=4*b)]=Math.round(C),w[A+1]=Math.round(_),w[A+2]=Math.round(D),w[A+3]=Math.round(E);return null!=n&&(n.width=i,n.height=o,P=n.getContext("2d"),k=new ImageData(w,i,o),P.putImageData(k,0,0)),e!==t&&e.dispose(),[2,w]}})})},fromPixels:qq}),v3=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(n,e){return new n(e)},t}(),m3=function(){function t(){this.classNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(n){t.getMap().classNameMap[n.className]=[n,n.fromConfig]},t}();function Au(t){M(null!=t.className,function(){return"Class being registered does not have the static className property defined."}),M("string"==typeof t.className,function(){return"className is required to be a string, but got type "+typeof t.className}),M(t.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),m3.register(t)}var Kq=Object.freeze({Serializable:v3,SerializationMap:m3,registerClass:Au});function II(){return 32===B.backend.floatPrecision()?.001:.1}function SI(t,n,e){var r=!0;if((Er(t)||Er(n))&&(r=!1),Er(t)&&Er(n)&&(r=!0),r){var o=t.constructor.name,i=n.constructor.name;if(o!==i)throw new Error("Arrays are of different type. Actual: "+o+". Expected: "+i)}if(Array.isArray(t)&&Array.isArray(n)){var a=Ma(t),s=Ma(n);if(!Fn(a,s))throw new Error("Arrays have different shapes. Actual: ["+a+"]. Expected: ["+s+"]")}var u=Er(t)?t:ms(t),c=Er(n)?n:ms(n);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var f=0;f<c.length;++f){var d=u[f],p=c[f];if(!e(d,p))throw new Error("Arrays differ: actual["+f+"] = "+d+", expected["+f+"] = "+p+".\nActual:   "+u+".\nExpected: "+c+".")}}function AI(t,n,e){return!isFinite(t)&&!isFinite(n)||!(isNaN(t)||isNaN(n)||Math.abs(t-n)>e)}var Yq=Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(t,n,e){return null==e&&(e=II()),SI(t,n,function(r,o){return AI(r,o,e)})},testEpsilon:II,expectPromiseToFail:function(t,n){t().then(function(){return n.fail()},function(){return n()})},expectArraysEqual:function(t,n){var e="string"==typeof n||"number"==typeof n||"boolean"==typeof n?[n]:n;return bu(t)||bu(t[0])||bu(n)||bu(n[0])?SI(t,e,function(r,o){return r==o}):SI(t,n,function(r,o){return AI(r,o,0)})},expectNumbersClose:function(t,n,e){if(null==e&&(e=II()),!AI(t,n,e))throw new Error("Numbers differ: actual === "+t+", expected === "+n)},expectValuesInRange:function(t,n,e){for(var r=0;r<t.length;r++)if(t[r]<n||t[r]>e)throw new Error("Value out of range:"+t[r]+" low: "+n+", high: "+e)},expectArrayBuffersEqual:function(t,n){expect(new Float32Array(t)).toEqual(new Float32Array(n))}}),Qq="1.7.0",Zq=Object.freeze({gpgpu_util:g8,webgl_util:WG,forceHalfFloat:function(){K().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:LP,setWebGLContext:NF,GPGPUContext:bP}),Tu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return ji(n,t),n.prototype.minimize=function(e,r,o){void 0===r&&(r=!1);var i=this.computeGradients(e,o),a=i.value,s=i.grads;if(null!=o){var u=o.map(function(c){return{name:c.name,tensor:s[c.name]}});this.applyGradients(u)}else this.applyGradients(s);return to(s),r?a:(a.dispose(),null)},Object.defineProperty(n.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),n.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},n.prototype.computeGradients=function(e,r){return Bk(e,r)},n.prototype.dispose=function(){null!=this.iterations_&&to(this.iterations_)},n.prototype.saveIterations=function(){return be(this,void 0,void 0,function(){return xe(this,function(e){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:le(this.iterations_,"int32")}]})})},n.prototype.getWeights=function(){return be(this,void 0,void 0,function(){return xe(this,function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},n.prototype.setWeights=function(e){return be(this,void 0,void 0,function(){return xe(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},n.prototype.extractIterations=function(e){return be(this,void 0,void 0,function(){var r;return xe(this,function(o){switch(o.label){case 0:return r=this,[4,e[0].tensor.data()];case 1:return r.iterations_=o.sent()[0],[2,e.slice(1)]}})})},n}(v3);Object.defineProperty(Tu,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var TI=function(t){function n(e,r,o){void 0===o&&(o=null);var i=t.call(this)||this;return i.learningRate=e,i.rho=r,i.epsilon=o,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==o&&(i.epsilon=B.backend.epsilon()),i}return ji(n,t),n.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(o){return o.name}):Object.keys(e)).forEach(function(o,i){var a=B.registeredVariables[o];null==r.accumulatedGrads[i]&&(r.accumulatedGrads[i]={originalName:o+"/accum_grad",variable:ge(function(){return vt(a).variable(!1)})}),null==r.accumulatedUpdates[i]&&(r.accumulatedUpdates[i]={originalName:o+"/accum_var",variable:ge(function(){return vt(a).variable(!1)})});var s=Array.isArray(e)?e[i].tensor:e[o];if(null!=s){var u=r.accumulatedGrads[i].variable,c=r.accumulatedUpdates[i].variable;ge(function(){var f=u.mul(r.rho).add(s.square().mul(1-r.rho)),d=c.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),p=c.mul(r.rho).add(d.square().mul(1-r.rho));u.assign(f),c.assign(p);var g=d.mul(-r.learningRate).add(a);a.assign(g)})}}),this.incrementIterations()},n.prototype.dispose=function(){null!=this.accumulatedUpdates&&(to(this.accumulatedGrads.map(function(e){return e.variable})),to(this.accumulatedUpdates.map(function(e){return e.variable})))},n.prototype.getWeights=function(){return be(this,void 0,void 0,function(){var e;return xe(this,function(r){switch(r.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},n.prototype.setWeights=function(e){return be(this,void 0,void 0,function(){var r;return xe(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(e)];case 1:return e=o.sent(),this.accumulatedGrads=e.slice(0,r=e.length/2).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=e.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},n.fromConfig=function(e,r){return new e(r.learningRate,r.rho,r.epsilon)},n.className="Adadelta",n}(Tu);Au(TI);var RI=function(t){function n(e,r){void 0===r&&(r=.1);var o=t.call(this)||this;return o.learningRate=e,o.initialAccumulatorValue=r,o.accumulatedGrads=[],o}return ji(n,t),n.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(o){return o.name}):Object.keys(e)).forEach(function(o,i){var a=B.registeredVariables[o];null==r.accumulatedGrads[i]&&(r.accumulatedGrads[i]={originalName:o+"/accumulator",variable:ge(function(){return Xi(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(e)?e[i].tensor:e[o];if(null!=s){var u=r.accumulatedGrads[i].variable;ge(function(){var c=u.add(s.square());u.assign(c);var f=s.div(c.add(B.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(f)})}}),this.incrementIterations()},n.prototype.dispose=function(){null!=this.accumulatedGrads&&to(this.accumulatedGrads.map(function(e){return e.variable}))},n.prototype.getWeights=function(){return be(this,void 0,void 0,function(){return xe(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},n.prototype.setWeights=function(e){return be(this,void 0,void 0,function(){return xe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),this.accumulatedGrads=e.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},n.fromConfig=function(e,r){return new e(r.learningRate,r.initialAccumulatorValue)},n.className="Adagrad",n}(Tu);Au(RI);var MI=function(t){function n(e,r,o,i){void 0===i&&(i=null);var a=t.call(this)||this;return a.learningRate=e,a.beta1=r,a.beta2=o,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],ge(function(){a.accBeta1=le(r).variable(),a.accBeta2=le(o).variable()}),null==i&&(a.epsilon=B.backend.epsilon()),a}return ji(n,t),n.prototype.applyGradients=function(e){var r=this,o=Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e);ge(function(){var i=Bn(1,r.accBeta1),a=Bn(1,r.accBeta2);o.forEach(function(s,u){var c=B.registeredVariables[s];null==r.accumulatedFirstMoment[u]&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:ge(function(){return vt(c).variable(!1)})}),null==r.accumulatedSecondMoment[u]&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:ge(function(){return vt(c).variable(!1)})});var f=Array.isArray(e)?e[u].tensor:e[s];if(null!=f){var d=r.accumulatedFirstMoment[u].variable,p=r.accumulatedSecondMoment[u].variable,g=d.mul(r.beta1).add(f.mul(1-r.beta1)),m=p.mul(r.beta2).add(f.square().mul(1-r.beta2)),y=g.div(i),w=m.div(a);d.assign(g),p.assign(m);var b=y.div(w.sqrt().add(r.epsilon)).mul(-r.learningRate).add(c);c.assign(b)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},n.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&to(this.accumulatedFirstMoment.map(function(e){return e.variable})),null!=this.accumulatedSecondMoment&&to(this.accumulatedSecondMoment.map(function(e){return e.variable}))},n.prototype.getWeights=function(){return be(this,void 0,void 0,function(){var e;return xe(this,function(r){switch(r.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},n.prototype.setWeights=function(e){return be(this,void 0,void 0,function(){var r,o=this;return xe(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(e)];case 1:return e=i.sent(),ge(function(){o.accBeta1.assign(Zg(o.beta1,o.iterations_+1)),o.accBeta2.assign(Zg(o.beta2,o.iterations_+1))}),this.accumulatedFirstMoment=e.slice(0,r=e.length/2).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=e.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},n.fromConfig=function(e,r){return new e(r.learningRate,r.beta1,r.beta2,r.epsilon)},n.className="Adam",n}(Tu);Au(MI);var NI=function(t){function n(e,r,o,i,a){void 0===i&&(i=null),void 0===a&&(a=0);var s=t.call(this)||this;return s.learningRate=e,s.beta1=r,s.beta2=o,s.epsilon=i,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],ge(function(){s.iteration=le(0).variable(),s.accBeta1=le(r).variable()}),null==i&&(s.epsilon=B.backend.epsilon()),s}return ji(n,t),n.prototype.applyGradients=function(e){var r=this,o=Array.isArray(e)?e.map(function(i){return i.name}):Object.keys(e);ge(function(){var i=Bn(1,r.accBeta1),a=si(-r.learningRate,r.iteration.mul(r.decay).add(1));o.forEach(function(s,u){var c=B.registeredVariables[s];null==r.accumulatedFirstMoment[u]&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:vt(c).variable(!1)}),null==r.accumulatedWeightedInfNorm[u]&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:vt(c).variable(!1)});var f=Array.isArray(e)?e[u].tensor:e[s];if(null!=f){var d=r.accumulatedFirstMoment[u].variable,p=r.accumulatedWeightedInfNorm[u].variable,g=d.mul(r.beta1).add(f.mul(1-r.beta1)),m=p.mul(r.beta2),y=f.abs(),w=m.maximum(y);d.assign(g),p.assign(w);var b=a.div(i).mul(g.div(w.add(r.epsilon))).add(c);c.assign(b)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},n.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&to(this.accumulatedFirstMoment.map(function(e){return e.variable})),null!=this.accumulatedWeightedInfNorm&&to(this.accumulatedWeightedInfNorm.map(function(e){return e.variable}))},n.prototype.getWeights=function(){return be(this,void 0,void 0,function(){return xe(this,function(e){throw new Error("getWeights() is not implemented for Adamax yet.")})})},n.prototype.setWeights=function(e){return be(this,void 0,void 0,function(){return xe(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},n.fromConfig=function(e,r){return new e(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},n.className="Adamax",n}(Tu);Au(NI);var Zw=function(t){function n(e){var r=t.call(this)||this;return r.learningRate=e,r.setLearningRate(e),r}return ji(n,t),n.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(o){return o.name}):Object.keys(e)).forEach(function(o,i){var a=Array.isArray(e)?e[i].tensor:e[o];if(null!=a){var s=B.registeredVariables[o];ge(function(){var u=r.c.mul(a).add(s);s.assign(u)})}}),this.incrementIterations()},n.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=rk(le(-e))},n.prototype.dispose=function(){this.c.dispose()},n.prototype.getWeights=function(){return be(this,void 0,void 0,function(){return xe(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}})})},n.prototype.setWeights=function(e){return be(this,void 0,void 0,function(){return xe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:if(0!==(e=r.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate}},n.fromConfig=function(e,r){return new e(r.learningRate)},n.className="SGD",n}(Tu);Au(Zw);var FI=function(t){function n(e,r,o){void 0===o&&(o=!1);var i=t.call(this,e)||this;return i.learningRate=e,i.momentum=r,i.useNesterov=o,i.accumulations=[],i.m=le(i.momentum),i}return ji(n,t),n.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(o){return o.name}):Object.keys(e)).forEach(function(o,i){var a=B.registeredVariables[o];null==r.accumulations[i]&&(r.accumulations[i]={originalName:o+"/momentum",variable:ge(function(){return vt(a).variable(!1)})});var s=r.accumulations[i].variable,u=Array.isArray(e)?e[i].tensor:e[o];null!=u&&ge(function(){var c,f=r.m.mul(s).add(u);c=r.useNesterov?r.c.mul(u.add(f.mul(r.m))).add(a):r.c.mul(f).add(a),s.assign(f),a.assign(c)})}),this.incrementIterations()},n.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&to(this.accumulations.map(function(e){return e.variable}))},n.prototype.setMomentum=function(e){this.momentum=e},n.prototype.getWeights=function(){return be(this,void 0,void 0,function(){return xe(this,function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},n.prototype.setWeights=function(e){return be(this,void 0,void 0,function(){return xe(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),this.accumulations=e.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},n.fromConfig=function(e,r){return new e(r.learningRate,r.momentum,r.useNesterov)},n.className="Momentum",n}(Zw);Au(FI);var kI=function(t){function n(e,r,o,i,a){void 0===r&&(r=.9),void 0===o&&(o=0),void 0===i&&(i=null),void 0===a&&(a=!1);var s=t.call(this)||this;if(s.learningRate=e,s.decay=r,s.momentum=o,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,null==i&&(s.epsilon=B.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return ji(n,t),n.prototype.applyGradients=function(e){var r=this;(Array.isArray(e)?e.map(function(o){return o.name}):Object.keys(e)).forEach(function(o,i){var a=B.registeredVariables[o];null==r.accumulatedMeanSquares[i]&&(r.accumulatedMeanSquares[i]={originalName:o+"/rms",variable:ge(function(){return vt(a).variable(!1)})}),null==r.accumulatedMoments[i]&&(r.accumulatedMoments[i]={originalName:o+"/momentum",variable:ge(function(){return vt(a).variable(!1)})}),null==r.accumulatedMeanGrads[i]&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:o+"/mg",variable:ge(function(){return vt(a).variable(!1)})});var s=Array.isArray(e)?e[i].tensor:e[o];if(null!=s){var u=r.accumulatedMeanSquares[i].variable,c=r.accumulatedMoments[i].variable;ge(function(){var f=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var d=r.accumulatedMeanGrads[i].variable,p=d.mul(r.decay).add(s.mul(1-r.decay)),g=c.mul(r.momentum).add(s.mul(r.learningRate).div(f.sub(p.square().add(r.epsilon)).sqrt()));u.assign(f),d.assign(p),c.assign(g);var m=a.sub(g);a.assign(m)}else{var y=u.mul(r.decay).add(s.square().mul(1-r.decay));g=c.mul(r.momentum).add(s.mul(r.learningRate).div(y.add(r.epsilon).sqrt())),u.assign(y),c.assign(g),m=a.sub(g),a.assign(m)}})}}),this.incrementIterations()},n.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&to(this.accumulatedMeanSquares.map(function(e){return e.variable})),null!=this.accumulatedMeanGrads&&this.centered&&to(this.accumulatedMeanGrads.map(function(e){return e.variable})),null!=this.accumulatedMoments&&to(this.accumulatedMoments.map(function(e){return e.variable}))},n.prototype.getWeights=function(){return be(this,void 0,void 0,function(){var e;return xe(this,function(r){switch(r.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(e.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},n.prototype.setWeights=function(e){return be(this,void 0,void 0,function(){var r;return xe(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(e)];case 1:return e=o.sent(),this.accumulatedMeanSquares=e.slice(0,r=this.centered?e.length/3:e.length/2).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=e.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=e.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},n.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},n.fromConfig=function(e,r){return new e(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},n.className="RMSProp",n}(Tu);Au(kI);var ol=function(){function t(){}return t.sgd=function(n){return new Zw(n)},t.momentum=function(n,e,r){return void 0===r&&(r=!1),new FI(n,e,r)},t.rmsprop=function(n,e,r,o,i){return void 0===e&&(e=.9),void 0===r&&(r=0),void 0===o&&(o=null),void 0===i&&(i=!1),new kI(n,e,r,o,i)},t.adam=function(n,e,r,o){return void 0===n&&(n=.001),void 0===e&&(e=.9),void 0===r&&(r=.999),void 0===o&&(o=null),new MI(n,e,r,o)},t.adadelta=function(n,e,r){return void 0===n&&(n=.001),void 0===e&&(e=.95),void 0===r&&(r=null),new TI(n,e,r)},t.adamax=function(n,e,r,o,i){return void 0===n&&(n=.002),void 0===e&&(e=.9),void 0===r&&(r=.999),void 0===o&&(o=null),void 0===i&&(i=0),new NI(n,e,r,o,i)},t.adagrad=function(n,e){return void 0===e&&(e=.1),new RI(n,e)},t}(),Jq={sgd:ol.sgd,momentum:ol.momentum,adadelta:ol.adadelta,adagrad:ol.adagrad,rmsprop:ol.rmsprop,adamax:ol.adamax,adam:ol.adam},e7=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:function(t){return t()};function t7(){return new Promise(function(t){return e7(function(){return t()})})}function Ru(t,n,e){if(void 0===e&&(e=!1),t.beginPath(),n.slice(1).forEach(function(i,a){var s=i.x,u=i.y,c=n[a];t.moveTo(c.x,c.y),t.lineTo(s,u)}),e){var r=n[n.length-1],o=n[0];if(!r||!o)return;t.moveTo(r.x,r.y),t.lineTo(o.x,o.y)}t.stroke()}Ut.prototype.squaredDifference=function(t){return UE(this,t)},q=Eq;var PI=function(t,n){return(PI=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o])})(t,n)};function qe(t,n){function e(){this.constructor=t}PI(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var Wr=function(){return Wr=Object.assign||function(n){for(var e,r=1,o=arguments.length;r<o;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n},Wr.apply(this,arguments)};function ye(t,n,e,r){return new(e||(e=Promise))(function(i,a){function s(f){try{c(r.next(f))}catch(d){a(d)}}function u(f){try{c(r.throw(f))}catch(d){a(d)}}function c(f){f.done?i(f.value):function o(i){return i instanceof e?i:new e(function(a){a(i)})}(f.value).then(s,u)}c((r=r.apply(t,n||[])).next())})}function we(t,n){var r,o,i,a,e={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(f){return function u(c){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,o&&(i=2&c[0]?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++,o=c[1],c=[0];continue;case 7:c=e.ops.pop(),e.trys.pop();continue;default:if(!(i=(i=e.trys).length>0&&i[i.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){e.label=c[1];break}if(6===c[0]&&e.label<i[1]){e.label=i[1],i=c;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(c);break}i[2]&&e.ops.pop(),e.trys.pop();continue}c=n.call(t,e)}catch(f){c=[6,f],o=0}finally{r=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,f])}}}function ov(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var Mu=function(){function t(n,e){if(!Nu(n)||!Nu(e))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:n,height:e}));this._width=n,this._height=e}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.reverse=function(){return new t(1/this.width,1/this.height)},t}();function sd(t,n){return t instanceof Ut&&t.shape.length===n}function r7(t){return sd(t,1)}function b3(t){return sd(t,2)}function iv(t){return sd(t,3)}function Is(t){return sd(t,4)}function x3(t){return t%1!=0}function OI(t){return t%2==0}function eb(t,n){void 0===n&&(n=2);var e=Math.pow(10,n);return Math.floor(t*e)/e}function LI(t){return t&&t.width&&t.height}function _3(t,n){var e=t.width,r=t.height,o=n/Math.max(r,e);return new Mu(Math.round(e*o),Math.round(r*o))}function tb(t){return t.reduce(function(n,e){return n.add(e)},new Rt(0,0)).div(new Rt(t.length,t.length))}function ud(t,n,e){return Array(t).fill(0).map(function(r,o){return n+o*e})}function Nu(t){return!!t&&t!==1/0&&t!==-1/0&&!isNaN(t)||0===t}function nb(t){return Nu(t)&&0<=t&&t<=1}var Rt=function(){function t(n,e){this._x=n,this._y=e}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),t.prototype.add=function(n){return new t(this.x+n.x,this.y+n.y)},t.prototype.sub=function(n){return new t(this.x-n.x,this.y-n.y)},t.prototype.mul=function(n){return new t(this.x*n.x,this.y*n.y)},t.prototype.div=function(n){return new t(this.x/n.x,this.y/n.y)},t.prototype.abs=function(){return new t(Math.abs(this.x),Math.abs(this.y))},t.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t}(),Zi=function(){function t(n,e){void 0===e&&(e=!0);var r=n||{},o=[r.left,r.top,r.right,r.bottom].every(Nu),i=[r.x,r.y,r.width,r.height].every(Nu);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],c=a[2],f=a[3];t.assertIsValidBox({x:s,y:u,width:c,height:f},"Box.constructor",e),this._x=s,this._y=u,this._width=c,this._height=f}return t.isRect=function(n){return!!n&&[n.x,n.y,n.width,n.height].every(Nu)},t.assertIsValidBox=function(n,e,r){if(void 0===r&&(r=!1),!t.isRect(n))throw new Error(e+" - invalid box: "+JSON.stringify(n)+", expected object with properties x, y, width, height");if(!r&&(n.width<0||n.height<0))throw new Error(e+" - width ("+n.width+") and height ("+n.height+") must be positive numbers")},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return new Rt(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRight",{get:function(){return new Rt(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeft",{get:function(){return new Rt(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return new Rt(this.right,this.bottom)},enumerable:!0,configurable:!0}),t.prototype.round=function(){var n=[this.x,this.y,this.width,this.height].map(function(a){return Math.round(a)});return new t({x:n[0],y:n[1],width:n[2],height:n[3]})},t.prototype.floor=function(){var n=[this.x,this.y,this.width,this.height].map(function(a){return Math.floor(a)});return new t({x:n[0],y:n[1],width:n[2],height:n[3]})},t.prototype.toSquare=function(){var n=this,e=n.x,r=n.y,o=n.width,i=n.height,a=Math.abs(o-i);return o<i&&(e-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new t({x:e,y:r,width:o,height:i})},t.prototype.rescale=function(n){var e=LI(n)?n.width:n,r=LI(n)?n.height:n;return new t({x:this.x*e,y:this.y*r,width:this.width*e,height:this.height*r})},t.prototype.pad=function(n,e){var r=[this.x-n/2,this.y-e/2,this.width+n,this.height+e];return new t({x:r[0],y:r[1],width:r[2],height:r[3]})},t.prototype.clipAtImageBorders=function(n,e){var r=this,i=r.y,a=r.right,s=r.bottom,u=Math.max(r.x,0),c=Math.max(i,0),d=s-c;return new t({x:u,y:c,width:Math.min(a-u,n-u),height:Math.min(d,e-c)}).floor()},t.prototype.shift=function(n,e){return new t({x:this.x+n,y:this.y+e,width:this.width,height:this.height})},t.prototype.padAtBorders=function(n,e){var r=this.width+1,o=this.height+1,s=r,u=o,c=this.left,f=this.top,d=this.right,p=this.bottom;return d>e&&(s=-d+e+r,d=e),p>n&&(u=-p+n+o,p=n),c<1&&(u=2-c,c=1),f<1&&(u=2-f,f=1),{dy:1,edy:u,dx:1,edx:s,y:f,ey:p,x:c,ex:d,w:r,h:o}},t.prototype.calibrate=function(n){return new t({left:this.left+n.left*this.width,top:this.top+n.top*this.height,right:this.right+n.right*this.width,bottom:this.bottom+n.bottom*this.height}).toSquare().round()},t}(),av=function(t){function n(e,r,o,i,a){return void 0===a&&(a=!1),t.call(this,{left:e,top:r,right:o,bottom:i},a)||this}return qe(n,t),n}(Zi),BI=function(){function t(n,e,r,o,i){this._imageDims=new Mu(i.width,i.height),this._score=n,this._classScore=e,this._className=r,this._box=new Zi(o).rescale(this._imageDims)}return Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeBox",{get:function(){return new Zi(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),t.prototype.forSize=function(n,e){return new t(this.score,this.classScore,this.className,this.relativeBox,{width:n,height:e})},t}(),Eo=function(t){function n(e,r,o){return t.call(this,e,e,"",r,o)||this}return qe(n,t),n.prototype.forSize=function(e,r){var o=t.prototype.forSize.call(this,e,r);return new n(o.score,o.relativeBox,o.imageDims)},n}(BI);function C3(t,n,e){void 0===e&&(e=!0);var i=Math.max(0,Math.min(t.right,n.right)-Math.max(t.left,n.left))*Math.max(0,Math.min(t.bottom,n.bottom)-Math.max(t.top,n.top));return e?i/(t.area+n.area-i):i/Math.min(t.area,n.area)}function D3(t){var n=t.map(function(s){return s.x}),e=t.map(function(s){return s.y}),r=n.reduce(function(s,u){return u<s?u:s},1/0),o=e.reduce(function(s,u){return u<s?u:s},1/0),i=n.reduce(function(s,u){return s<u?u:s},0),a=e.reduce(function(s,u){return s<u?u:s},0);return new av(r,o,i,a)}function cd(t,n,e,r){void 0===r&&(r=!0);for(var o=n.map(function(s,u){return{score:s,boxIndex:u}}).sort(function(s,u){return s.score-u.score}).map(function(s){return s.boxIndex}),i=[],a=function(){var s=o.pop();i.push(s);for(var u=o,c=[],f=0;f<u.length;f++)c.push(C3(t[s],t[u[f]],r));o=o.filter(function(m,y){return c[y]<=e})};o.length>0;)a();return i}function ld(t,n){return ge(function(){var e=n[0],r=n[1],o=n[2],i=Xi(ov(t.shape.slice(0,3),[1]),e),a=Xi(ov(t.shape.slice(0,3),[1]),r),s=Xi(ov(t.shape.slice(0,3),[1]),o),u=Pn([i,a,s],3);return Bn(t,u)})}function E3(t,n){return void 0===n&&(n=!1),ge(function(){var e=t.shape.slice(1),r=e[0],o=e[1];if(r===o)return t;var i=Math.abs(r-o),a=Math.round(i*(n?.5:1)),s=r>o?2:1,u=function(g){var m=t.shape.slice();return m[s]=g,Xi(m,0)},c=u(a),f=i-c.shape[s],p=[n&&f?u(f):null,t,c].filter(function(g){return!!g}).map(function(g){return g.toFloat()});return Pn(p,s)})}function o7(t){for(var n=t.slice(),e=n.length-1;e>0;e--){var r=Math.floor(Math.random()*(e+1)),o=n[e];n[e]=n[r],n[r]=o}return n}function rb(t){return 1/(1+Math.exp(-t))}function i7(t){return Math.log(t/(1-t))}var Xn,ob=function(t){function n(e,r,o,i,a){return void 0===a&&(a=!1),t.call(this,{x:e,y:r,width:o,height:i},a)||this}return qe(n,t),n}(Zi),il=function(){function t(n,e,r){void 0===r&&(r=new Rt(0,0));var o=e.width,i=e.height;this._imgDims=new Mu(o,i),this._shift=r,this._positions=n.map(function(a){return a.mul(new Rt(o,i)).add(r)})}return Object.defineProperty(t.prototype,"shift",{get:function(){return new Rt(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePositions",{get:function(){var n=this;return this._positions.map(function(e){return e.sub(n._shift).div(new Rt(n.imageWidth,n.imageHeight))})},enumerable:!0,configurable:!0}),t.prototype.forSize=function(n,e){return new this.constructor(this.relativePositions,{width:n,height:e})},t.prototype.shiftBy=function(n,e){return new this.constructor(this.relativePositions,this._imgDims,new Rt(n,e))},t.prototype.shiftByPoint=function(n){return this.shiftBy(n.x,n.y)},t.prototype.align=function(n,e){if(void 0===e&&(e={}),n){var r=n instanceof Eo?n.box.floor():new Zi(n);return this.shiftBy(r.x,r.y).align(null,e)}var o=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),a=o.minBoxPadding;return o.useDlibAlignment?this.alignDlib():this.alignMinBbox(a)},t.prototype.alignDlib=function(){var n=this.getRefPointsForAlignment(),r=n[1],o=n[2],i=function(d){return o.sub(d).magnitude()},a=(i(n[0])+i(r))/2,s=Math.floor(a/.45),u=tb(n),c=Math.floor(Math.max(0,u.x-.5*s)),f=Math.floor(Math.max(0,u.y-.43*s));return new ob(c,f,Math.min(s,this.imageWidth+c),Math.min(s,this.imageHeight+f))},t.prototype.alignMinBbox=function(n){var e=D3(this.positions);return e.pad(e.width*n,e.height*n)},t.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},t}(),I3=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],tb([e[3],e[4]])]},n}(il),VI=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.getJawOutline=function(){return this.positions.slice(0,17)},n.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},n.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},n.prototype.getNose=function(){return this.positions.slice(27,36)},n.prototype.getLeftEye=function(){return this.positions.slice(36,42)},n.prototype.getRightEye=function(){return this.positions.slice(42,48)},n.prototype.getMouth=function(){return this.positions.slice(48,68)},n.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(tb)},n}(il),UI=function(){function t(n,e){this._label=n,this._distance=e}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),t.prototype.toString=function(n){return void 0===n&&(n=!0),this.label+(n?" ("+eb(this.distance)+")":"")},t}(),WI=function(t){function n(e,r){var o=t.call(this,e)||this;return o._label=r,o}return qe(n,t),n.assertIsValidLabeledBox=function(e,r){if(Zi.assertIsValidBox(e,r),!Nu(e.label))throw new Error(r+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(n.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),n}(Zi),sv=function(){function t(n,e){if("string"!=typeof n)throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(e)||e.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=n,this._descriptors=e}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(n){return Array.from(n)})}},t.fromJSON=function(n){var e=n.descriptors.map(function(r){return new Float32Array(r)});return new t(n.label,e)},t}(),c7=function(t){function n(e,r,o,i){var a=t.call(this,e,r)||this;return a._score=o,a._classScore=i,a}return qe(n,t),n.assertIsValidPredictedBox=function(e,r){if(WI.assertIsValidLabeledBox(e,r),!nb(e.score)||!nb(e.classScore))throw new Error(r+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(n.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),n}(WI);function fd(t){return t.detection instanceof Eo}function dd(t,n){return Object.assign({},t,{detection:n})}function S3(){var t=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:t,readFile:function(){throw new Error("readFile - filesystem not available for browser environment")}}}function A3(t){var n="";if(!t)try{t=cr(Object(function(){var o=new Error("Cannot find module 'fs'");throw o.code="MODULE_NOT_FOUND",o}()))}catch(r){n=r.toString()}return{readFile:t?function(r){return new Promise(function(o,i){t.readFile(r,function(a,s){return a?i(a):o(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+n)}}}function T3(){var t=global.Canvas||global.HTMLCanvasElement,n=global.Image||global.HTMLImageElement,o=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=A3();return Wr({Canvas:t||function a(){},CanvasRenderingContext2D:global.CanvasRenderingContext2D||function a(){},Image:n||function a(){},ImageData:global.ImageData||function a(){},Video:global.HTMLVideoElement||function a(){},createCanvasElement:function(){if(t)return new t;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:function(){if(n)return new n;throw new Error("createImageElement - missing Image implementation for nodejs environment")},fetch:o},i)}function R3(){return"object"==typeof window&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function M3(){return"object"==typeof global&&typeof process<"u"&&!!process.version}function HI(t){Xn=t}function jI(){R3()&&HI(S3()),M3()&&HI(T3())}var ur={getEnv:function l7(){if(!Xn)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Xn},setEnv:HI,initialize:jI,createBrowserEnv:S3,createFileSystem:A3,createNodejsEnv:T3,monkeyPatch:function f7(t){if(Xn||jI(),!Xn)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var n=t.Canvas,e=void 0===n?Xn.Canvas:n,r=t.Image,o=void 0===r?Xn.Image:r;Xn.Canvas=e,Xn.Image=o,Xn.createCanvasElement=t.createCanvasElement||function(){return new e},Xn.createImageElement=t.createImageElement||function(){return new o},Xn.ImageData=t.ImageData||Xn.ImageData,Xn.Video=t.Video||Xn.Video,Xn.fetch=t.fetch||Xn.fetch,Xn.readFile=t.readFile||Xn.readFile},isBrowser:R3,isNodejs:M3};function ib(t){return ur.isNodejs()||"string"!=typeof t?t:document.getElementById(t)}function Ji(t){var n=ur.getEnv(),e=n.Canvas;if(t instanceof n.CanvasRenderingContext2D)return t;var o=ib(t);if(!(o instanceof e))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=o.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}jI();var Fa=(()=>(function(t){t.TOP_LEFT="TOP_LEFT",t.TOP_RIGHT="TOP_RIGHT",t.BOTTOM_LEFT="BOTTOM_LEFT",t.BOTTOM_RIGHT="BOTTOM_RIGHT"}(Fa||(Fa={})),Fa))(),zI=function t(n){void 0===n&&(n={});var r=n.backgroundColor,o=n.fontColor,i=n.fontSize,a=n.fontStyle,s=n.padding;this.anchorPosition=n.anchorPosition||Fa.TOP_LEFT,this.backgroundColor=r||"rgba(0, 0, 0, 0.5)",this.fontColor=o||"rgba(255, 255, 255, 1)",this.fontSize=i||14,this.fontStyle=a||"Georgia",this.padding=s||4},$I=function(){function t(n,e,r){void 0===r&&(r={}),this.text="string"==typeof n?[n]:n instanceof t?n.text:n,this.anchor=e,this.options=new zI(r)}return t.prototype.measureWidth=function(n){var e=this.options.padding;return this.text.map(function(r){return n.measureText(r).width}).reduce(function(r,o){return r<o?o:r},0)+2*e},t.prototype.measureHeight=function(){var n=this.options;return this.text.length*n.fontSize+2*n.padding},t.prototype.getUpperLeft=function(n,e){var r=this.options.anchorPosition,o=r===Fa.BOTTOM_RIGHT||r===Fa.TOP_RIGHT,i=r===Fa.BOTTOM_LEFT||r===Fa.BOTTOM_RIGHT,a=this.measureWidth(n),s=this.measureHeight(),u=o?this.anchor.x-a:this.anchor.x,c=i?this.anchor.y-s:this.anchor.y;if(e){var d=e.height;return{x:Math.max(Math.min(u,e.width-a),0),y:Math.max(Math.min(c,d-s),0)}}return{x:u,y:c}},t.prototype.draw=function(n){var e=ib(n),r=Ji(e),o=this.options,i=o.backgroundColor,a=o.fontColor,s=o.fontSize,c=o.padding;r.font=s+"px "+o.fontStyle;var f=this.measureWidth(r),d=this.measureHeight();r.fillStyle=i;var p=this.getUpperLeft(r,e);r.fillRect(p.x,p.y,f,d),r.fillStyle=a,this.text.forEach(function(g,m){r.fillText(g,c+p.x,c+p.y+(m+1)*s)})},t}(),N3=function t(n){void 0===n&&(n={});var r=n.lineWidth,o=n.label,i=n.drawLabelOptions;this.boxColor=n.boxColor||"rgba(0, 0, 255, 1)",this.lineWidth=r||2,this.label=o,this.drawLabelOptions=new zI(Object.assign({},{anchorPosition:Fa.BOTTOM_LEFT,backgroundColor:this.boxColor},i))},F3=function(){function t(n,e){void 0===e&&(e={}),this.box=new Zi(n),this.options=new N3(e)}return t.prototype.draw=function(n){var e=Ji(n),r=this.options,i=r.lineWidth,a=this.box,s=a.x,u=a.y,c=a.width,f=a.height;e.strokeStyle=r.boxColor,e.lineWidth=i,e.strokeRect(s,u,c,f);var d=this.options.label;d&&new $I([d],{x:s-i/2,y:u},this.options.drawLabelOptions).draw(n)},t}();function d7(t,n){(Array.isArray(n)?n:[n]).forEach(function(r){var o=r instanceof Eo?r.score:fd(r)?r.detection.score:void 0,i=r instanceof Eo?r.box:fd(r)?r.detection.box:new Zi(r),a=o?""+eb(o):void 0;new F3(i,{label:a}).draw(t)})}function GI(t){var n=ur.getEnv();return t instanceof n.Image&&t.complete||t instanceof n.Video&&t.readyState>=3}function k3(t){return new Promise(function(n,e){if(t instanceof ur.getEnv().Canvas||GI(t))return n();function r(i){!i.currentTarget||(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),n(i))}function o(i){!i.currentTarget||(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),e(i))}t.addEventListener("load",r),t.addEventListener("error",o)})}function P3(t){return new Promise(function(n,e){if(!(t instanceof Blob))return e("bufferToImage - expected buf to be of type: Blob");var r=new FileReader;r.onload=function(){if("string"!=typeof r.result)return e("bufferToImage - expected reader.result to be a string, in onload");var o=ur.getEnv().createImageElement();o.onload=function(){return n(o)},o.onerror=e,o.src=r.result},r.onerror=e,r.readAsDataURL(t)})}function ab(t){var n=ur.getEnv(),r=n.Video;return t instanceof n.Image?new Mu(t.naturalWidth,t.naturalHeight):t instanceof r?new Mu(t.videoWidth,t.videoHeight):new Mu(t.width,t.height)}function uv(t){var n=t.width,e=t.height,o=(0,ur.getEnv().createCanvasElement)();return o.width=n,o.height=e,o}function sb(t,n){var e=ur.getEnv().ImageData;if(!(t instanceof e||GI(t)))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=n||ab(t),o=r.width,i=r.height,a=uv({width:o,height:i});return t instanceof e?Ji(a).putImageData(t,0,0):Ji(a).drawImage(t,0,0,o,i),a}function O3(t,n){return ye(this,void 0,void 0,function(){var e,r,o,i,a,s;return we(this,function(u){switch(u.label){case 0:return e=n||ur.getEnv().createCanvasElement(),r=t.shape.slice(Is(t)?1:0),o=r[0],i=r[1],a=r[2],s=ge(function(){return t.as3D(o,i,a).toInt()}),[4,Qw.toPixels(s,e)];case 1:return u.sent(),s.dispose(),[2,e]}})})}function qI(t){var n=ur.getEnv();return t instanceof n.Image||t instanceof n.Canvas||t instanceof n.Video}function L3(t,n,e){void 0===e&&(e=!1);var r=ur.getEnv(),i=r.Canvas;if(!(t instanceof r.Image||t instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=ab(t),s=n/Math.max(a.height,a.width),u=s*a.width,c=s*a.height,f=uv({width:n,height:n}),d=t instanceof i?t:sb(t),p=Math.abs(u-c)/2,g=e&&u<c?p:0,m=e&&c<u?p:0;return Ji(f).drawImage(d,g,m,u,c),f}var cv=function(){function t(n,e){var r=this;if(void 0===e&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(n))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+n);this._treatAsBatchInput=e,this._batchSize=n.length,n.forEach(function(o,i){if(iv(o))return r._imageTensors[i]=o,void(r._inputDimensions[i]=o.shape);if(Is(o)){var a=o.shape[0];if(1!==a)throw new Error("NetInput - tf.Tensor4D with batchSize "+a+" passed, but not supported in input array");return r._imageTensors[i]=o,void(r._inputDimensions[i]=o.shape.slice(1))}var s=o instanceof ur.getEnv().Canvas?o:sb(o);r._canvases[i]=s,r._inputDimensions[i]=[s.height,s.width,3]})}return Object.defineProperty(t.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reshapedInputDimensions",{get:function(){var n=this;return ud(this.batchSize,0,1).map(function(e,r){return n.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),t.prototype.getInput=function(n){return this.canvases[n]||this.imageTensors[n]},t.prototype.getInputDimensions=function(n){return this._inputDimensions[n]},t.prototype.getInputHeight=function(n){return this._inputDimensions[n][0]},t.prototype.getInputWidth=function(n){return this._inputDimensions[n][1]},t.prototype.getReshapedInputDimensions=function(n){if("number"!=typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return _3({width:this.getInputWidth(n),height:this.getInputHeight(n)},this.inputSize)},t.prototype.toBatchTensor=function(n,e){var r=this;return void 0===e&&(e=!0),this._inputSize=n,ge(function(){var o=ud(r.batchSize,0,1).map(function(a){var s=r.getInput(a);if(s instanceof Ut){var u=Is(s)?s:s.expandDims();return((u=E3(u,e)).shape[1]!==n||u.shape[2]!==n)&&(u=Kw.resizeBilinear(u,[n,n])),u.as3D(n,n,3)}if(s instanceof ur.getEnv().Canvas)return Qw.fromPixels(L3(s,n,e));throw new Error("toBatchTensor - at batchIdx "+a+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)});return Co(o.map(function(a){return a.toFloat()})).as4D(r.batchSize,n,n,3)})},t}();function Yn(t){return ye(this,void 0,void 0,function(){var n,e,r;return we(this,function(o){switch(o.label){case 0:if(t instanceof cv)return[2,t];if(!(n=Array.isArray(t)?t:[t]).length)throw new Error("toNetInput - empty array passed as input");return e=function(i){return Array.isArray(t)?" at input index "+i+":":""},(r=n.map(ib)).forEach(function(i,a){if(!qI(i)&&!iv(i)&&!Is(i))throw"string"==typeof n[a]?new Error("toNetInput -"+e(a)+" string passed, but could not resolve HTMLElement for element id "+n[a]):new Error("toNetInput -"+e(a)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Is(i)){var s=i.shape[0];if(1!==s)throw new Error("toNetInput -"+e(a)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return qI(i)&&k3(i)}))];case 1:return o.sent(),[2,new cv(r,Array.isArray(t))]}})})}function ub(t,n){return ye(this,void 0,void 0,function(){var e,r,o,i,a,s;return we(this,function(c){switch(c.label){case 0:return e=ur.getEnv().Canvas,r=t,t instanceof e?[3,5]:[4,Yn(t)];case 1:if((o=c.sent()).batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return(i=o.getInput(0))instanceof e?(a=i,[3,4]):[3,2];case 2:return[4,O3(i)];case 3:a=c.sent(),c.label=4;case 4:r=a,c.label=5;case 5:return s=Ji(r),[2,n.map(function(f){return f instanceof Eo?f.forSize(r.width,r.height).box.floor():f}).map(function(f){return f.clipAtImageBorders(r.width,r.height)}).map(function(f){var d=f.x,p=f.y,g=f.width,m=f.height,y=uv({width:g,height:m});return Ji(y).putImageData(s.getImageData(d,p,g,m),0,0),y})]}})})}function cb(t,n){return ye(this,void 0,void 0,function(){return we(this,function(e){if(!iv(t)&&!Is(t))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Is(t)&&t.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,ge(function(){var r=t.shape.slice(Is(t)?1:0),o=r[0],i=r[1],a=r[2];return n.map(function(c){return c instanceof Eo?c.forSize(i,o).box:c}).map(function(c){return c.clipAtImageBorders(i,o)}).map(function(c){var f=c.x,d=c.y,p=c.width,g=c.height;return JE(t.as3D(o,i,a),[d,f,0],[g,p,a])})})]})})}function lb(t,n){return ye(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return[4,(0,ur.getEnv().fetch)(t,n)];case 1:if(!((r=o.sent()).status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function h7(t){return ye(this,void 0,void 0,function(){var n,e;return we(this,function(r){switch(r.label){case 0:return[4,lb(t)];case 1:return[4,(n=r.sent()).blob()];case 2:if(!(e=r.sent()).type.startsWith("image/"))throw new Error("fetchImage - expected blob type to be of type image/*, instead have: "+e.type+", for url: "+n.url);return[2,P3(e)]}})})}function B3(t){return ye(this,void 0,void 0,function(){return we(this,function(n){switch(n.label){case 0:return[4,lb(t)];case 1:return[2,n.sent().json()]}})})}function p7(t){return ye(this,void 0,void 0,function(){var n;return we(this,function(e){switch(e.label){case 0:return n=Float32Array.bind,[4,lb(t)];case 1:return[4,e.sent().arrayBuffer()];case 2:return[2,new(n.apply(Float32Array,[void 0,e.sent()]))]}})})}function V3(t,n){var e=n+"-weights_manifest.json";if(!t)return{modelBaseUri:"",manifestUri:e};if("/"===t)return{modelBaseUri:"/",manifestUri:"/"+e};var r=t.startsWith("http://")?"http://":t.startsWith("https://")?"https://":"",o=(t=t.replace(r,"")).split("/").filter(function(s){return s}),i=t.endsWith(".json")?o[o.length-1]:e,a=r+(t.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return{modelBaseUri:a=t.startsWith("/")?"/"+a:a,manifestUri:"/"===a?"/"+i:a+"/"+i}}function U3(t,n){return ye(this,void 0,void 0,function(){var e,o,i;return we(this,function(a){switch(a.label){case 0:return e=V3(t,n),o=e.modelBaseUri,[4,B3(e.manifestUri)];case 1:return i=a.sent(),[2,EI.loadWeights(i,o)]}})})}function g7(t,n,e){void 0===e&&(e=!1);var r=e?ab(n):n,o=r.width,i=r.height;return t.width=o,t.height=i,{width:o,height:i}}var ka=function(){function t(n){this._name=n,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(t.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),t.prototype.getParamFromPath=function(n){var e=this.traversePropertyPath(n);return e.obj[e.objProp]},t.prototype.reassignParamFromPath=function(n,e){var r=this.traversePropertyPath(n),o=r.obj,i=r.objProp;o[i].dispose(),o[i]=e},t.prototype.getParamList=function(){var n=this;return this._paramMappings.map(function(e){var r=e.paramPath;return{path:r,tensor:n.getParamFromPath(r)}})},t.prototype.getTrainableParams=function(){return this.getParamList().filter(function(n){return n.tensor instanceof qc})},t.prototype.getFrozenParams=function(){return this.getParamList().filter(function(n){return!(n.tensor instanceof qc)})},t.prototype.variable=function(){var n=this;this.getFrozenParams().forEach(function(e){n.reassignParamFromPath(e.path,e.tensor.variable())})},t.prototype.freeze=function(){var n=this;this.getTrainableParams().forEach(function(e){var r=e.path,o=e.tensor,i=sr(o.dataSync());o.dispose(),n.reassignParamFromPath(r,i)})},t.prototype.dispose=function(n){void 0===n&&(n=!0),this.getParamList().forEach(function(e){if(n&&e.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()}),this._params=void 0},t.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(n){return Array.from(n.tensor.dataSync())}).reduce(function(n,e){return n.concat(e)}))},t.prototype.load=function(n){return ye(this,void 0,void 0,function(){return we(this,function(e){switch(e.label){case 0:return n instanceof Float32Array?(this.extractWeights(n),[2]):[4,this.loadFromUri(n)];case 1:return e.sent(),[2]}})})},t.prototype.loadFromUri=function(n){return ye(this,void 0,void 0,function(){var e;return we(this,function(r){switch(r.label){case 0:if(n&&"string"!=typeof n)throw new Error(this._name+".loadFromUri - expected model uri");return[4,U3(n,this.getDefaultModelName())];case 1:return e=r.sent(),this.loadFromWeightMap(e),[2]}})})},t.prototype.loadFromDisk=function(n){return ye(this,void 0,void 0,function(){var e,r,o,i,s,u,c,f,d;return we(this,function(p){switch(p.label){case 0:if(n&&"string"!=typeof n)throw new Error(this._name+".loadFromDisk - expected model file path");return e=ur.getEnv().readFile,r=V3(n,this.getDefaultModelName()),o=r.manifestUri,i=r.modelBaseUri,s=EI.weightsLoaderFactory(function(g){return Promise.all(g.map(function(m){return e(m).then(function(y){return y.buffer})}))}),f=(c=JSON).parse,[4,e(o)];case 1:return u=f.apply(c,[p.sent().toString()]),[4,s(u,i)];case 2:return d=p.sent(),this.loadFromWeightMap(d),[2]}})})},t.prototype.loadFromWeightMap=function(n){var e=this.extractParamsFromWeigthMap(n),o=e.params;this._paramMappings=e.paramMappings,this._params=o},t.prototype.extractWeights=function(n){var e=this.extractParams(n),o=e.params;this._paramMappings=e.paramMappings,this._params=o},t.prototype.traversePropertyPath=function(n){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var e=n.split("/").reduce(function(i,a){if(!i.nextObj.hasOwnProperty(a))throw new Error("traversePropertyPath - object does not have property "+a+", for path "+n);return{obj:i.nextObj,objProp:a,nextObj:i.nextObj[a]}},{nextObj:this.params}),r=e.obj,o=e.objProp;if(!(r&&o&&r[o]instanceof Ut))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+n);return{obj:r,objProp:o}},t}();function Ho(t,n,e){return ge(function(){var r=Hw(t,n.depthwise_filter,n.pointwise_filter,e,"same");return rt(r,n.bias)})}function KI(t,n,e){return void 0===e&&(e=!1),ge(function(){var r=nn(e?rt(Uo(t,n.conv0.filters,[2,2],"same"),n.conv0.bias):Ho(t,n.conv0,[2,2])),o=Ho(r,n.conv1,[1,1]),a=Ho(nn(rt(r,o)),n.conv2,[1,1]);return nn(rt(r,rt(o,a)))})}function fb(t,n,e,r){return void 0===e&&(e=!1),void 0===r&&(r=!0),ge(function(){var o=nn(e?rt(Uo(t,n.conv0.filters,r?[2,2]:[1,1],"same"),n.conv0.bias):Ho(t,n.conv0,r?[2,2]:[1,1])),i=Ho(o,n.conv1,[1,1]),s=Ho(nn(rt(o,i)),n.conv2,[1,1]),c=Ho(nn(rt(o,rt(i,s))),n.conv3,[1,1]);return nn(rt(o,rt(i,rt(s,c))))})}function ea(t,n,e,r){return void 0===e&&(e="same"),void 0===r&&(r=!1),ge(function(){var o=rt(Uo(t,n.filters,[1,1],e),n.bias);return r?nn(o):o})}function Ss(t,n){Object.keys(t).forEach(function(e){n.some(function(r){return r.originalPath===e})||t[e].dispose()})}function db(t,n){return function(e,r,o,i){var a=ro(t(e*r*o*o),[o,o,e,r]),s=Dn(t(r));return n.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function XI(t,n){return function(e,r,o){var i=bs(t(e*r),[e,r]),a=Dn(t(r));return n.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var W3=function t(n,e,r){this.depthwise_filter=n,this.pointwise_filter=e,this.bias=r};function YI(t,n){return function(e,r,o){var i=ro(t(9*e),[3,3,e,1]),a=ro(t(e*r),[1,1,e,r]),s=Dn(t(r));return n.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new W3(i,a,s)}}function QI(t){return function(n){var e=t(n+"/depthwise_filter",4),r=t(n+"/pointwise_filter",4),o=t(n+"/bias",1);return new W3(e,r,o)}}function Fu(t,n){return function(e,r,o){var i=t[e];if(!sd(i,r))throw new Error("expected weightMap["+e+"] to be a Tensor"+r+"D, instead have "+i);return n.push({originalPath:e,paramPath:o||e}),i}}function As(t){var n=t;return{extractWeights:function e(o){var i=n.slice(0,o);return n=n.slice(o),i},getRemainingWeights:function r(){return n}}}function H3(t,n){var e=db(t,n),r=YI(t,n);function o(a,s,u,c){return void 0===c&&(c=!1),{conv0:c?e(a,s,3,u+"/conv0"):r(a,s,u+"/conv0"),conv1:r(s,s,u+"/conv1"),conv2:r(s,s,u+"/conv2")}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:function i(a,s,u,c){void 0===c&&(c=!1);var f=o(a,s,u,c);return{conv0:f.conv0,conv1:f.conv1,conv2:f.conv2,conv3:r(s,s,u+"/conv3")}}}}function j3(t){return function(n){return{filters:t(n+"/filters",4),bias:t(n+"/bias",1)}}}function z3(t,n){var e=Fu(t,n),r=j3(e),o=QI(e);return{extractDenseBlock3Params:function i(s,u){return void 0===u&&(u=!1),{conv0:u?r(s+"/conv0"):o(s+"/conv0"),conv1:o(s+"/conv1"),conv2:o(s+"/conv2")}},extractDenseBlock4Params:function a(s,u){return void 0===u&&(u=!1),{conv0:u?r(s+"/conv0"):o(s+"/conv0"),conv1:o(s+"/conv1"),conv2:o(s+"/conv2"),conv3:o(s+"/conv3")}}}}var $3=function(t){function n(){return t.call(this,"FaceFeatureExtractor")||this}return qe(n,t),n.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return ge(function(){var s=fb(ld(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(le(255)),r.dense0,!0);return s=fb(s,r.dense1),s=fb(s,r.dense2),s=fb(s,r.dense3),ed(s,[7,7],[2,2],"valid")})},n.prototype.forward=function(e){return ye(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Yn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},n.prototype.extractParamsFromWeigthMap=function(e){return function m7(t){var n=[],e=z3(t,n).extractDenseBlock4Params,r={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2"),dense3:e("dense3")};return Ss(t,n),{params:r,paramMappings:n}}(e)},n.prototype.extractParams=function(e){return function v7(t){var n=[],e=As(t),o=e.getRemainingWeights,i=H3(e.extractWeights,n).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),c=i(128,256,"dense3");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:n,params:{dense0:a,dense1:s,dense2:u,dense3:c}}}(e)},n}(ka);function Pa(t,n){return ge(function(){return rt(ev(t,n.weights),n.bias)})}function G3(t){var n={},e={};return Object.keys(t).forEach(function(r){(r.startsWith("fc")?e:n)[r]=t[r]}),{featureExtractorMap:n,classifierMap:e}}var q3=function(t){function n(e,r){var o=t.call(this,e)||this;return o._faceFeatureExtractor=r,o}return qe(n,t),Object.defineProperty(n.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),n.prototype.runNet=function(e){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return ge(function(){var i=e instanceof cv?r.faceFeatureExtractor.forwardInput(e):e;return Pa(i.as2D(i.shape[0],-1),o.fc)})},n.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),t.prototype.dispose.call(this,e)},n.prototype.loadClassifierParams=function(e){var r=this.extractClassifierParams(e),i=r.paramMappings;this._params=r.params,this._paramMappings=i},n.prototype.extractClassifierParams=function(e){return function y7(t,n,e){var r=[],o=As(t),a=o.getRemainingWeights,u=XI(o.extractWeights,r)(n,e,"fc");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:u}}}(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},n.prototype.extractParamsFromWeigthMap=function(e){var r=G3(e),i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(r.featureExtractorMap),function w7(t){var n=[],e=Fu(t,n),o={fc:function r(i){return{weights:e(i+"/weights",2),bias:e(i+"/bias",1)}}("fc")};return Ss(t,n),{params:o,paramMappings:n}}(i)},n.prototype.extractParams=function(e){var r=this.getClassifierChannelsIn(),o=this.getClassifierChannelsOut(),i=o*r+o,a=e.slice(0,e.length-i),s=e.slice(e.length-i);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)},n}(ka),ZI=["neutral","happy","sad","angry","fearful","disgusted","surprised"],hb=function(){function t(n){var e=this;if(7!==n.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+n.length);ZI.forEach(function(r,o){e[r]=n[o]})}return t.prototype.asSortedArray=function(){var n=this;return ZI.map(function(e){return{expression:e,probability:n[e]}}).sort(function(e,r){return r.probability-e.probability})},t}(),K3=function(t){function n(e){return void 0===e&&(e=new $3),t.call(this,"FaceExpressionNet",e)||this}return qe(n,t),n.prototype.forwardInput=function(e){var r=this;return ge(function(){return Na(r.runNet(e))})},n.prototype.forward=function(e){return ye(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Yn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.predictExpressions=function(e){return ye(this,void 0,void 0,function(){var r,o,i,a,s=this;return we(this,function(u){switch(u.label){case 0:return[4,Yn(e)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return o=u.sent(),[4,Promise.all(On(o).map(function(c){return ye(s,void 0,void 0,function(){var f;return we(this,function(d){switch(d.label){case 0:return[4,c.data()];case 1:return f=d.sent(),c.dispose(),[2,f]}})})}))];case 3:return i=u.sent(),o.dispose(),a=i.map(function(c){return new hb(c)}),[2,r.isBatchInput?a:a[0]]}})})},n.prototype.getDefaultModelName=function(){return"face_expression_model"},n.prototype.getClassifierChannelsIn=function(){return 256},n.prototype.getClassifierChannelsOut=function(){return 7},n}(q3);function X3(t){return t.expressions instanceof hb}function JI(t,n){return Object.assign({},t,{expressions:n})}function b7(t,n,e,r){void 0===e&&(e=.1),(Array.isArray(n)?n:[n]).forEach(function(i){var a=i instanceof hb?i:X3(i)?i.expressions:void 0;if(!a)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");var u=a.asSortedArray().filter(function(d){return d.probability>e}),c=fd(i)?i.detection.box.bottomLeft:r||new Rt(0,0);new $I(u.map(function(d){return d.expression+" ("+eb(d.probability)+")"}),c).draw(t)})}function pb(t){return fd(t)&&t.landmarks instanceof il&&t.unshiftedLandmarks instanceof il&&t.alignedRect instanceof Eo}function lv(t,n){var e=t.detection.box,r=n.shiftBy(e.x,e.y),o=r.align(),i=t.detection.imageDims,a=new Eo(t.detection.score,o.rescale(i.reverse()),i);return Object.assign({},t,{landmarks:r,unshiftedLandmarks:n,alignedRect:a})}var Y3=function t(n){void 0===n&&(n={});var e=n.drawLines,o=n.drawPoints,i=void 0===o||o,a=n.lineWidth,s=n.lineColor,u=n.pointSize,c=n.pointColor;this.drawLines=void 0===e||e,this.drawPoints=i,this.lineWidth=a||1,this.pointSize=u||2,this.lineColor=s||"rgba(0, 255, 255, 1)",this.pointColor=c||"rgba(255, 0, 255, 1)"},Q3=function(){function t(n,e){void 0===e&&(e={}),this.faceLandmarks=n,this.options=new Y3(e)}return t.prototype.draw=function(n){var e=Ji(n),r=this.options,i=r.drawPoints,a=r.lineWidth,u=r.pointSize,c=r.pointColor;r.drawLines&&this.faceLandmarks instanceof VI&&(e.strokeStyle=r.lineColor,e.lineWidth=a,Ru(e,this.faceLandmarks.getJawOutline()),Ru(e,this.faceLandmarks.getLeftEyeBrow()),Ru(e,this.faceLandmarks.getRightEyeBrow()),Ru(e,this.faceLandmarks.getNose()),Ru(e,this.faceLandmarks.getLeftEye(),!0),Ru(e,this.faceLandmarks.getRightEye(),!0),Ru(e,this.faceLandmarks.getMouth(),!0)),i&&(e.strokeStyle=c,e.fillStyle=c,this.faceLandmarks.positions.forEach(function(d){e.beginPath(),e.arc(d.x,d.y,u,0,2*Math.PI),e.fill()}))},t}();function x7(t,n){(Array.isArray(n)?n:[n]).forEach(function(r){var o=r instanceof il?r:pb(r)?r.landmarks:void 0;if(!o)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new Q3(o).draw(t)})}function Z3(t,n,e){return rt(Uo(t,n.filters,e,"same"),n.bias)}function eS(t,n,e){void 0===e&&(e=!0);var r=e?nn(t):t;return r=Ho(r,n.separable_conv0,[1,1]),r=Ho(nn(r),n.separable_conv1,[1,1]),r=Kn(r,[3,3],[2,2],"same"),rt(r,Z3(t,n.expansion_conv,[2,2]))}var S7=function(t){function n(e){var r=t.call(this,"TinyXception")||this;return r._numMainBlocks=e,r}return qe(n,t),n.prototype.forwardInput=function(e){var r=this,o=this.params;if(!o)throw new Error("TinyXception - load model before inference");return ge(function(){var s=ld(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(le(256)),u=nn(Z3(s,o.entry_flow.conv_in,[2,2]));return u=eS(u,o.entry_flow.reduction_block_0,!1),u=eS(u,o.entry_flow.reduction_block_1),ud(r._numMainBlocks,0,1).forEach(function(c){u=function I7(t,n){var e=Ho(nn(t),n.separable_conv0,[1,1]);return e=Ho(nn(e),n.separable_conv1,[1,1]),e=Ho(nn(e),n.separable_conv2,[1,1]),rt(e,t)}(u,o.middle_flow["main_block_"+c])}),u=eS(u,o.exit_flow.reduction_block),u=nn(Ho(u,o.exit_flow.separable_conv,[1,1]))})},n.prototype.forward=function(e){return ye(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Yn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.getDefaultModelName=function(){return"tiny_xception_model"},n.prototype.extractParamsFromWeigthMap=function(e){return function E7(t,n){var e=[],r=function D7(t,n){var e=Fu(t,n),r=j3(e),o=QI(e);return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:function i(s){return{separable_conv0:o(s+"/separable_conv0"),separable_conv1:o(s+"/separable_conv1"),expansion_conv:r(s+"/expansion_conv")}},extractMainBlockParams:function a(s){return{separable_conv0:o(s+"/separable_conv0"),separable_conv1:o(s+"/separable_conv1"),separable_conv2:o(s+"/separable_conv2")}}}}(t,e),i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,d={conv_in:(0,r.extractConvParams)("entry_flow/conv_in"),reduction_block_0:a("entry_flow/reduction_block_0"),reduction_block_1:a("entry_flow/reduction_block_1")},p={};ud(n,0,1).forEach(function(w){p["main_block_"+w]=s("middle_flow/main_block_"+w)});var y={reduction_block:a("exit_flow/reduction_block"),separable_conv:i("exit_flow/separable_conv")};return Ss(t,e),{params:{entry_flow:d,middle_flow:p,exit_flow:y},paramMappings:e}}(e,this._numMainBlocks)},n.prototype.extractParams=function(e){return function C7(t,n){var e=[],r=As(t),i=r.getRemainingWeights,a=function _7(t,n){var e=db(t,n),r=YI(t,n);return{extractConvParams:e,extractSeparableConvParams:r,extractReductionBlockParams:function o(a,s,u){return{separable_conv0:r(a,s,u+"/separable_conv0"),separable_conv1:r(s,s,u+"/separable_conv1"),expansion_conv:e(a,s,1,u+"/expansion_conv")}},extractMainBlockParams:function i(a,s){return{separable_conv0:r(a,a,s+"/separable_conv0"),separable_conv1:r(a,a,s+"/separable_conv1"),separable_conv2:r(a,a,s+"/separable_conv2")}}}}(r.extractWeights,e),u=a.extractSeparableConvParams,c=a.extractReductionBlockParams,f=a.extractMainBlockParams,m={conv_in:(0,a.extractConvParams)(3,32,3,"entry_flow/conv_in"),reduction_block_0:c(32,64,"entry_flow/reduction_block_0"),reduction_block_1:c(64,128,"entry_flow/reduction_block_1")},y={};ud(n,0,1).forEach(function(_){y["main_block_"+_]=f(128,"middle_flow/main_block_"+_)});var C={reduction_block:c(128,256,"exit_flow/reduction_block"),separable_conv:u(256,512,"exit_flow/separable_conv")};if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{entry_flow:m,middle_flow:y,exit_flow:C}}}(e,this._numMainBlocks)},n}(ka),ku=(()=>(function(t){t.FEMALE="female",t.MALE="male"}(ku||(ku={})),ku))(),J3=function(t){function n(e){void 0===e&&(e=new S7(2));var r=t.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=e,r}return qe(n,t),Object.defineProperty(n.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),n.prototype.runNet=function(e){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return ge(function(){var i=e instanceof cv?r.faceFeatureExtractor.forwardInput(e):e,a=ed(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1);return{age:Pa(a,o.fc.age).as1D(),gender:Pa(a,o.fc.gender)}})},n.prototype.forwardInput=function(e){var r=this;return ge(function(){var o=r.runNet(e);return{age:o.age,gender:Na(o.gender)}})},n.prototype.forward=function(e){return ye(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Yn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.predictAgeAndGender=function(e){return ye(this,void 0,void 0,function(){var r,o,i,a,s,u,c=this;return we(this,function(f){switch(f.label){case 0:return[4,Yn(e)];case 1:return r=f.sent(),[4,this.forwardInput(r)];case 2:return o=f.sent(),i=On(o.age),a=On(o.gender),s=i.map(function(d,p){return{ageTensor:d,genderTensor:a[p]}}),[4,Promise.all(s.map(function(d){var p=d.ageTensor,g=d.genderTensor;return ye(c,void 0,void 0,function(){var m,y,w,b,C;return we(this,function(_){switch(_.label){case 0:return[4,p.data()];case 1:return m=_.sent()[0],[4,g.data()];case 2:return y=_.sent()[0],b=(w=y>.5)?ku.MALE:ku.FEMALE,C=w?y:1-y,p.dispose(),g.dispose(),[2,{age:m,gender:b,genderProbability:C}]}})})}))];case 3:return u=f.sent(),o.age.dispose(),o.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},n.prototype.getDefaultModelName=function(){return"age_gender_model"},n.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),t.prototype.dispose.call(this,e)},n.prototype.loadClassifierParams=function(e){var r=this.extractClassifierParams(e),i=r.paramMappings;this._params=r.params,this._paramMappings=i},n.prototype.extractClassifierParams=function(e){return function A7(t){var n=[],e=As(t),o=e.getRemainingWeights,i=XI(e.extractWeights,n),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:n,params:{fc:{age:a,gender:s}}}}(e)},n.prototype.extractParamsFromWeigthMap=function(e){var r=G3(e),i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(r.featureExtractorMap),function T7(t){var n=[],e=Fu(t,n);function r(i){return{weights:e(i+"/weights",2),bias:e(i+"/bias",1)}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Ss(t,n),{params:o,paramMappings:n}}(i)},n.prototype.extractParams=function(e){var o=e.slice(0,e.length-1539),i=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},n}(ka),eB=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.postProcess=function(e,r,o){var i=o.map(function(s){var u=s.width,c=s.height,f=r/Math.max(c,u);return{width:u*f,height:c*f}}),a=i.length;return ge(function(){var s=function(p,g){return Co([Xi([68],p),Xi([68],g)],1).as2D(1,136).as1D()},u=function(p,g){var m=i[p],y=m.width,w=m.height;return g(y,w)?Math.abs(y-w)/2:0};return e.mul(Xi([a,136],r)).sub(Co(Array.from(Array(a),function(p,g){return s(function(p){return u(p,function(g,m){return g<m})}(g),function(p){return u(p,function(g,m){return m<g})}(g))}))).div(Co(Array.from(Array(a),function(p,g){return s(i[g].width,i[g].height)})))})},n.prototype.forwardInput=function(e){var r=this;return ge(function(){var o=r.runNet(e);return r.postProcess(o,e.inputSize,e.inputDimensions.map(function(i){return{height:i[0],width:i[1]}}))})},n.prototype.forward=function(e){return ye(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Yn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.detectLandmarks=function(e){return ye(this,void 0,void 0,function(){var r,o,i,a=this;return we(this,function(s){switch(s.label){case 0:return[4,Yn(e)];case 1:return r=s.sent(),o=ge(function(){return On(a.forwardInput(r))}),[4,Promise.all(o.map(function(u,c){return ye(a,void 0,void 0,function(){var f,d,p,g,m;return we(this,function(y){switch(y.label){case 0:return p=(d=Array).from,[4,u.data()];case 1:return f=p.apply(d,[y.sent()]),g=f.filter(function(w,b){return OI(b)}),m=f.filter(function(w,b){return!OI(b)}),[2,new VI(Array(68).fill(0).map(function(w,b){return new Rt(g[b],m[b])}),{height:r.getInputHeight(c),width:r.getInputWidth(c)})]}})})}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},n.prototype.getClassifierChannelsOut=function(){return 136},n}(q3),tS=function(t){function n(e){return void 0===e&&(e=new $3),t.call(this,"FaceLandmark68Net",e)||this}return qe(n,t),n.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},n.prototype.getClassifierChannelsIn=function(){return 256},n}(eB),N7=function(t){function n(){return t.call(this,"TinyFaceFeatureExtractor")||this}return qe(n,t),n.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return ge(function(){var s=KI(ld(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(le(255)),r.dense0,!0);return s=KI(s,r.dense1),s=KI(s,r.dense2),ed(s,[14,14],[2,2],"valid")})},n.prototype.forward=function(e){return ye(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Yn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},n.prototype.extractParamsFromWeigthMap=function(e){return function R7(t){var n=[],e=z3(t,n).extractDenseBlock3Params,r={dense0:e("dense0",!0),dense1:e("dense1"),dense2:e("dense2")};return Ss(t,n),{params:r,paramMappings:n}}(e)},n.prototype.extractParams=function(e){return function M7(t){var n=[],e=As(t),o=e.getRemainingWeights,i=H3(e.extractWeights,n).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:n,params:{dense0:a,dense1:s,dense2:u}}}(e)},n}(ka),tB=function(t){function n(e){return void 0===e&&(e=new N7),t.call(this,"FaceLandmark68TinyNet",e)||this}return qe(n,t),n.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},n.prototype.getClassifierChannelsIn=function(){return 128},n}(eB),F7=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n}(tS);function nS(t,n,e,r,o){void 0===o&&(o="same");var i=n.conv,s=i.bias,u=Uo(t,i.filters,e,o);return u=function k7(t,n){return rt(Sr(t,n.weights),n.biases)}(u=rt(u,s),n.scale),r?nn(u):u}function nB(t,n){return nS(t,n,[1,1],!1)}function rB(t,n){return nS(t,n,[2,2],!0,"valid")}function O7(t,n){function i(s,u,c,f){var d=function r(s,u,c,f){var d=function e(s,u,c){var f=t(s),d=f.length/(u*c*c);if(x3(d))throw new Error("depth has to be an integer: "+d+", weights.length: "+f.length+", numFilters: "+u+", filterSize: "+c);return ge(function(){return Cs(ro(f,[u,d,c,c]),[2,3,1,0])})}(s,u,c),p=Dn(t(u));return n.push({paramPath:f+"/filters"},{paramPath:f+"/bias"}),{filters:d,bias:p}}(s,u,c,f+"/conv"),p=function o(s,u){var c=Dn(t(s)),f=Dn(t(s));return n.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:c,biases:f}}(u,f+"/scale");return{conv:d,scale:p}}return{extractConvLayerParams:i,extractResidualLayerParams:function a(s,u,c,f,d){return void 0===d&&(d=!1),{conv1:i((d?.5:1)*s,u,c,f+"/conv1"),conv2:i(s,u,c,f+"/conv2")}}}}function Oa(t,n){var e=function P7(t,n){return nS(t,n,[1,1],!0)}(t,n.conv1);return e=nB(e,n.conv2),e=rt(e,t),nn(e)}function gb(t,n){var e=rB(t,n.conv1);e=nB(e,n.conv2);var r=ed(t,2,2,"valid"),o=qt(r.shape),i=r.shape[3]!==e.shape[3];if(r.shape[1]!==e.shape[1]||r.shape[2]!==e.shape[2]){var s=ov(e.shape);s[1]=1;var u=qt(s),c=ov((e=Pn([e,u],1)).shape);c[2]=1;var f=qt(c);e=Pn([e,f],2)}return r=i?Pn([r,o],3):r,e=rt(r,e),nn(e)}var rS=function(t){function n(){return t.call(this,"FaceRecognitionNet")||this}return qe(n,t),n.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return ge(function(){var s=rB(ld(e.toBatchTensor(150,!0).toFloat(),[122.782,117.001,104.298]).div(le(256)),r.conv32_down);s=Oa(s=Kn(s,3,2,"valid"),r.conv32_1),s=Oa(s,r.conv32_2),s=Oa(s,r.conv32_3),s=Oa(s=gb(s,r.conv64_down),r.conv64_1),s=Oa(s,r.conv64_2),s=Oa(s,r.conv64_3),s=Oa(s=gb(s,r.conv128_down),r.conv128_1),s=Oa(s,r.conv128_2),s=Oa(s=gb(s,r.conv256_down),r.conv256_1);var u=(s=gb(s=Oa(s,r.conv256_2),r.conv256_down_out)).mean([1,2]);return ev(u,r.fc)})},n.prototype.forward=function(e){return ye(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Yn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.computeFaceDescriptor=function(e){return ye(this,void 0,void 0,function(){var r,o,i,a=this;return we(this,function(s){switch(s.label){case 0:return[4,Yn(e)];case 1:return r=s.sent(),o=ge(function(){return On(a.forwardInput(r))}),[4,Promise.all(o.map(function(u){return u.data()}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},n.prototype.getDefaultModelName=function(){return"face_recognition_model"},n.prototype.extractParamsFromWeigthMap=function(e){return function V7(t){var n=[],e=function B7(t,n){var e=Fu(t,n);function o(a){var s=e(a+"/conv/filters",4),u=e(a+"/conv/bias",1),c=function r(a){return{weights:e(a+"/scale/weights",1),biases:e(a+"/scale/biases",1)}}(a);return{conv:{filters:s,bias:u},scale:c}}return{extractConvLayerParams:o,extractResidualLayerParams:function i(a){return{conv1:o(a+"/conv1"),conv2:o(a+"/conv2")}}}}(t,n),o=e.extractResidualLayerParams,i=(0,e.extractConvLayerParams)("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),c=o("conv64_down"),f=o("conv64_1"),d=o("conv64_2"),p=o("conv64_3"),g=o("conv128_down"),m=o("conv128_1"),y=o("conv128_2"),w=o("conv256_down"),b=o("conv256_1"),C=o("conv256_2"),_=o("conv256_down_out"),D=t.fc;if(n.push({originalPath:"fc",paramPath:"fc"}),!b3(D))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+D);var E={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:c,conv64_1:f,conv64_2:d,conv64_3:p,conv128_down:g,conv128_1:m,conv128_2:y,conv256_down:w,conv256_1:b,conv256_2:C,conv256_down_out:_,fc:D};return Ss(t,n),{params:E,paramMappings:n}}(e)},n.prototype.extractParams=function(e){return function L7(t){var n=As(t),e=n.extractWeights,r=n.getRemainingWeights,o=[],i=O7(e,o),s=i.extractResidualLayerParams,u=(0,i.extractConvLayerParams)(4704,32,7,"conv32_down"),c=s(9216,32,3,"conv32_1"),f=s(9216,32,3,"conv32_2"),d=s(9216,32,3,"conv32_3"),p=s(36864,64,3,"conv64_down",!0),g=s(36864,64,3,"conv64_1"),m=s(36864,64,3,"conv64_2"),y=s(36864,64,3,"conv64_3"),w=s(147456,128,3,"conv128_down",!0),b=s(147456,128,3,"conv128_1"),C=s(147456,128,3,"conv128_2"),_=s(589824,256,3,"conv256_down",!0),D=s(589824,256,3,"conv256_1"),E=s(589824,256,3,"conv256_2"),A=s(589824,256,3,"conv256_down_out"),P=ge(function(){return Cs(bs(e(32768),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{conv32_down:u,conv32_1:c,conv32_2:f,conv32_3:d,conv64_down:p,conv64_1:g,conv64_2:m,conv64_3:y,conv128_down:w,conv128_1:b,conv128_2:C,conv256_down:_,conv256_1:D,conv256_2:E,conv256_down_out:A,fc:P},paramMappings:o}}(e)},n}(ka);function U7(t){var n=new rS;return n.extractWeights(t),n}function oS(t,n){return Object.assign({},t,{descriptor:n})}function W7(t){return"number"==typeof t.age}function iS(t,n){return Object.assign({},t,{age:n})}function H7(t){return(t.gender===ku.MALE||t.gender===ku.FEMALE)&&nb(t.genderProbability)}function aS(t,n,e){return Object.assign({},t,{gender:n,genderProbability:e})}var vb=function(){function t(n){var e=void 0===n?{}:n,r=e.minFaceSize,o=e.scaleFactor,i=e.maxNumScales,a=e.scoreThresholds,s=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=o||.709,this._maxNumScales=i||10,this._scoreThresholds=a||[.6,.7,.7],this._scaleSteps=s,"number"!=typeof this._minFaceSize||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!=typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!=typeof this._maxNumScales||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some(function(u){return"number"!=typeof u}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return"number"!=typeof u})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(t.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),t}();function La(t,n,e){return ge(function(){var r=Uo(t,n.filters,e,"same");return r=rt(r,n.batch_norm_offset),Ow(r,0,6)})}function Z7(t,n,e){var r=t.arraySync(),o=Math.min(r[n][0],r[n][2]),i=Math.min(r[n][1],r[n][3]),a=Math.max(r[n][0],r[n][2]),s=Math.max(r[n][1],r[n][3]),u=Math.min(r[e][0],r[e][2]),c=Math.min(r[e][1],r[e][3]),f=Math.max(r[e][0],r[e][2]),d=Math.max(r[e][1],r[e][3]),p=(a-o)*(s-i),g=(f-u)*(d-c);if(p<=0||g<=0)return 0;var m=Math.max(o,u),y=Math.max(i,c),w=Math.min(a,f),b=Math.min(s,d),C=Math.max(w-m,0)*Math.max(b-y,0);return C/(p+g-C)}function hd(t,n){return ge(function(){var e=t.shape[0];return{boxPredictionEncoding:ai(ea(t,n.box_encoding_predictor),[e,-1,1,4]),classPrediction:ai(ea(t,n.class_predictor),[e,-1,3])}})}var al=function(){function t(n){var e=void 0===n?{}:n,r=e.minConfidence,o=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=o||100,"number"!=typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!=typeof this._maxResults)throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(t.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),t}(),mb=function(t){function n(){return t.call(this,"SsdMobilenetv1")||this}return qe(n,t),n.prototype.forwardInput=function(e){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return ge(function(){var o=e.toBatchTensor(512,!1).toFloat(),a=function Y7(t,n){return ge(function(){var e=null,r=La(t,n.conv_0,[2,2]);if([n.conv_1,n.conv_2,n.conv_3,n.conv_4,n.conv_5,n.conv_6,n.conv_7,n.conv_8,n.conv_9,n.conv_10,n.conv_11,n.conv_12,n.conv_13].forEach(function(i,a){var s=a+1,u=function X7(t){return[2,4,6,12].some(function(n){return n===t})?[2,2]:[1,1]}(s);r=function K7(t,n,e){return ge(function(){var r=Jg(t,n.filters,e,"same");return r=jE(r,n.batch_norm_mean,n.batch_norm_variance,n.batch_norm_offset,n.batch_norm_scale,.0010000000474974513),Ow(r,0,6)})}(r,i.depthwise_conv,u),r=La(r,i.pointwise_conv,[1,1]),11===s&&(e=r)}),null===e)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:e}})}(Bn(Sr(o,le(.007843137718737125)),le(1)),r.mobilenetv1),s=function n9(t,n,e){return ge(function(){var r=La(t,e.conv_0,[1,1]),o=La(r,e.conv_1,[2,2]),i=La(o,e.conv_2,[1,1]),a=La(i,e.conv_3,[2,2]),s=La(a,e.conv_4,[1,1]),u=La(s,e.conv_5,[2,2]),c=La(u,e.conv_6,[1,1]),f=La(c,e.conv_7,[2,2]),d=hd(n,e.box_predictor_0),p=hd(t,e.box_predictor_1),g=hd(o,e.box_predictor_2),m=hd(a,e.box_predictor_3),y=hd(u,e.box_predictor_4),w=hd(f,e.box_predictor_5);return{boxPredictions:Pn([d.boxPredictionEncoding,p.boxPredictionEncoding,g.boxPredictionEncoding,m.boxPredictionEncoding,y.boxPredictionEncoding,w.boxPredictionEncoding],1),classPredictions:Pn([d.classPrediction,p.classPrediction,g.classPrediction,m.classPrediction,y.classPrediction,w.classPrediction],1)}})}(a.out,a.conv11,r.prediction_layer);return function t9(t,n,e){return ge(function(){var r=t.shape[0],o=function e9(t,n){var e=function J7(t){var n=On(Cs(t,[1,0])),e=[Bn(n[2],n[0]),Bn(n[3],n[1])];return{sizes:e,centers:[rt(n[0],si(e[0],le(2))),rt(n[1],si(e[1],le(2)))]}}(t),r=e.sizes,o=e.centers,i=On(Cs(n,[1,0])),a=si(Sr(Lw(si(i[2],le(5))),r[0]),le(2)),s=rt(Sr(si(i[0],le(10)),r[0]),o[0]),u=si(Sr(Lw(si(i[3],le(5))),r[1]),le(2)),c=rt(Sr(si(i[1],le(10)),r[1]),o[1]);return Cs(Co([Bn(s,a),Bn(c,u),rt(s,a),rt(c,u)]),[1,0])}(ai(Jc(e.extra_dim,[r,1,1]),[-1,4]),ai(t,[-1,4]));o=ai(o,[r,o.shape[0]/r,4]);var i=HE(Qi(n,[0,0,1],[-1,-1,-1])),a=Qi(i,[0,0,0],[-1,-1,1]);return a=ai(a,[r,a.shape[1]]),{boxes:On(o),scores:On(a)}})}(s.boxPredictions,s.classPredictions,r.output_layer)})},n.prototype.forward=function(e){return ye(this,void 0,void 0,function(){var r;return we(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Yn(e)];case 1:return[2,r.apply(this,[o.sent()])]}})})},n.prototype.locateFaces=function(e,r){return void 0===r&&(r={}),ye(this,void 0,void 0,function(){var o,i,a,s,u,c,f,d,p,g,m,y,w,C,_,D,E,A,P,k;return we(this,function(N){switch(N.label){case 0:return o=new al(r),i=o.maxResults,a=o.minConfidence,[4,Yn(e)];case 1:for(s=N.sent(),u=this.forwardInput(s),d=(c=u.boxes)[0],p=(f=u.scores)[0],g=1;g<c.length;g++)c[g].dispose(),f[g].dispose();return w=(y=Array).from,[4,p.data()];case 2:return m=w.apply(y,[N.sent()]),C=function Q7(t,n,e,r,o){var a=Math.min(e,t.shape[0]),s=n.map(function(f,d){return{score:f,boxIndex:d}}).filter(function(f){return f.score>o}).sort(function(f,d){return d.score-f.score}),u=function(f){return f<=r?1:0},c=[];return s.forEach(function(f){if(!(c.length>=a)){for(var d=f.score,p=c.length-1;p>=0;--p){var g=Z7(t,f.boxIndex,c[p]);if(0!==g&&(f.score*=u(g),f.score<=o))break}d===f.score&&c.push(f.boxIndex)}}),c}(d,m,i,.5,a),_=s.getReshapedInputDimensions(0),E=(D=s.inputSize)/_.width,A=D/_.height,P=d.arraySync(),k=C.map(function(F){var H=[Math.max(0,P[F][0]),Math.min(1,P[F][2])].map(function(ne){return ne*A}),W=H[0],Z=H[1],Y=[Math.max(0,P[F][1]),Math.min(1,P[F][3])].map(function(ne){return ne*E}),Q=Y[0];return new Eo(m[F],new ob(Q,W,Y[1]-Q,Z-W),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),d.dispose(),p.dispose(),[2,k]}})})},n.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},n.prototype.extractParamsFromWeigthMap=function(e){return function G7(t){var n=[],e=function $7(t,n){var e=Fu(t,n);function r(c,f,d){return{filters:e(c+"/Conv2d_"+f+"_pointwise/weights",4,d+"/filters"),batch_norm_offset:e(c+"/Conv2d_"+f+"_pointwise/convolution_bn_offset",1,d+"/batch_norm_offset")}}function o(c){var f="mobilenetv1/conv_"+c,d="MobilenetV1/Conv2d_"+c+"_depthwise",p=f+"/depthwise_conv",g=f+"/pointwise_conv";return{depthwise_conv:{filters:e(d+"/depthwise_weights",4,p+"/filters"),batch_norm_scale:e(d+"/BatchNorm/gamma",1,p+"/batch_norm_scale"),batch_norm_offset:e(d+"/BatchNorm/beta",1,p+"/batch_norm_offset"),batch_norm_mean:e(d+"/BatchNorm/moving_mean",1,p+"/batch_norm_mean"),batch_norm_variance:e(d+"/BatchNorm/moving_variance",1,p+"/batch_norm_variance")},pointwise_conv:r("MobilenetV1",c,g)}}function a(c,f){return{filters:e(c+"/weights",4,f+"/filters"),bias:e(c+"/biases",1,f+"/bias")}}function s(c){return{box_encoding_predictor:a("Prediction/BoxPredictor_"+c+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+c+"/box_encoding_predictor"),class_predictor:a("Prediction/BoxPredictor_"+c+"/ClassPredictor","prediction_layer/box_predictor_"+c+"/class_predictor")}}return{extractMobilenetV1Params:function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}},extractPredictionLayerParams:function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}}}(t,n),r=e.extractMobilenetV1Params,o=e.extractPredictionLayerParams,i=t["Output/extra_dim"];if(n.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!iv(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return Ss(t,n),{params:a,paramMappings:n}}(e)},n.prototype.extractParams=function(e){return function z7(t){var n=[],e=As(t),r=e.extractWeights,o=e.getRemainingWeights,i=function j7(t,n){function r(u,c,f,d,p){var g=ro(t(u*c*f*f),[f,f,u,c]),m=Dn(t(c));return n.push({paramPath:d+"/filters"},{paramPath:d+"/"+(p?"batch_norm_offset":"bias")}),{filters:g,bias:m}}function o(u,c,f,d){var p=r(u,c,f,d,!0);return{filters:p.filters,batch_norm_offset:p.bias}}function i(u,c,f){var d=function e(u,c){var f=ro(t(9*u),[3,3,u,1]),d=Dn(t(u)),p=Dn(t(u)),g=Dn(t(u)),m=Dn(t(u));return n.push({paramPath:c+"/filters"},{paramPath:c+"/batch_norm_scale"},{paramPath:c+"/batch_norm_offset"},{paramPath:c+"/batch_norm_mean"},{paramPath:c+"/batch_norm_variance"}),{filters:f,batch_norm_scale:d,batch_norm_offset:p,batch_norm_mean:g,batch_norm_variance:m}}(u,f+"/depthwise_conv");return{depthwise_conv:d,pointwise_conv:o(u,c,1,f+"/pointwise_conv")}}return{extractMobilenetV1Params:function a(){return{conv_0:o(3,32,3,"mobilenetv1/conv_0"),conv_1:i(32,64,"mobilenetv1/conv_1"),conv_2:i(64,128,"mobilenetv1/conv_2"),conv_3:i(128,128,"mobilenetv1/conv_3"),conv_4:i(128,256,"mobilenetv1/conv_4"),conv_5:i(256,256,"mobilenetv1/conv_5"),conv_6:i(256,512,"mobilenetv1/conv_6"),conv_7:i(512,512,"mobilenetv1/conv_7"),conv_8:i(512,512,"mobilenetv1/conv_8"),conv_9:i(512,512,"mobilenetv1/conv_9"),conv_10:i(512,512,"mobilenetv1/conv_10"),conv_11:i(512,512,"mobilenetv1/conv_11"),conv_12:i(512,1024,"mobilenetv1/conv_12"),conv_13:i(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function s(){return{conv_0:o(1024,256,1,"prediction_layer/conv_0"),conv_1:o(256,512,3,"prediction_layer/conv_1"),conv_2:o(512,128,1,"prediction_layer/conv_2"),conv_3:o(128,256,3,"prediction_layer/conv_3"),conv_4:o(256,128,1,"prediction_layer/conv_4"),conv_5:o(128,256,3,"prediction_layer/conv_5"),conv_6:o(256,64,1,"prediction_layer/conv_6"),conv_7:o(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:r(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:r(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:r(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:r(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:r(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}(r,n),s=i.extractPredictionLayerParams,u=(0,i.extractMobilenetV1Params)(),c=s(),d={extra_dim:ww(r(20472),[1,5118,4])};if(n.push({paramPath:"output_layer/extra_dim"}),0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:c,output_layer:d},paramMappings:n}}(e)},n}(ka);function oB(t){var n=new mb;return n.extractWeights(t),n}function r9(t){return oB(t)}var o9=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n}(mb),a9=[new Rt(.738768,.874946),new Rt(2.42204,2.65704),new Rt(4.30971,7.04493),new Rt(10.246,4.59428),new Rt(12.6868,11.8741)],s9=[new Rt(1.603231,2.094468),new Rt(6.041143,7.080126),new Rt(2.882459,3.518061),new Rt(4.266906,5.178857),new Rt(9.041765,10.66308)],u9=[117.001,114.697,97.404],yb=function(t){return"number"==typeof t};function iB(t){if(!t)throw new Error("invalid config: "+t);if("boolean"!=typeof t.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: "+t.withSeparableConvs);if(!yb(t.iouThreshold)||t.iouThreshold<0||t.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+t.iouThreshold);if(!Array.isArray(t.classes)||!t.classes.length||!t.classes.every(function(n){return"string"==typeof n}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(t.classes));if(!Array.isArray(t.anchors)||!t.anchors.length||!t.anchors.map(function(n){return n||{}}).every(function(n){return yb(n.x)&&yb(n.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(t.anchors));if(t.meanRgb&&(!Array.isArray(t.meanRgb)||3!==t.meanRgb.length||!t.meanRgb.every(yb)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(t.meanRgb))}function sS(t){return ge(function(){var n=Sr(t,le(.10000000149011612));return rt(nn(Bn(t,n)),n)})}function Pu(t,n){return ge(function(){var e=Cu(t,[[0,0],[1,1],[1,1],[0,0]]);return e=Uo(e,n.conv.filters,[1,1],"valid"),e=Bn(e,n.bn.sub),e=Sr(e,n.bn.truediv),sS(e=rt(e,n.conv.bias))})}function Ou(t,n){return ge(function(){var e=Cu(t,[[0,0],[1,1],[1,1],[0,0]]);return e=Hw(e,n.depthwise_filter,n.pointwise_filter,[1,1],"valid"),sS(e=rt(e,n.bias))})}var wb=(()=>(function(t){t[t.XS=224]="XS",t[t.SM=320]="SM",t[t.MD=416]="MD",t[t.LG=608]="LG"}(wb||(wb={})),wb))(),fv=function(){function t(n){var e=void 0===n?{}:n,r=e.inputSize,o=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=o||.5,"number"!=typeof this._inputSize||this._inputSize%32!=0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!=typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),t}(),aB=function(t){function n(e){var r=t.call(this,"TinyYolov2")||this;return iB(e),r._config=e,r}return qe(n,t),Object.defineProperty(n.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),n.prototype.runTinyYolov2=function(e,r){var o=Pu(e,r.conv0);return o=Pu(o=Kn(o,[2,2],[2,2],"same"),r.conv1),o=Pu(o=Kn(o,[2,2],[2,2],"same"),r.conv2),o=Pu(o=Kn(o,[2,2],[2,2],"same"),r.conv3),o=Pu(o=Kn(o,[2,2],[2,2],"same"),r.conv4),o=Pu(o=Kn(o,[2,2],[2,2],"same"),r.conv5),o=Pu(o=Kn(o,[2,2],[1,1],"same"),r.conv6),ea(o=Pu(o,r.conv7),r.conv8,"valid",!1)},n.prototype.runMobilenet=function(e,r){var o=this.config.isFirstLayerConv2d?sS(ea(e,r.conv0,"valid",!1)):Ou(e,r.conv0);return o=Ou(o=Kn(o,[2,2],[2,2],"same"),r.conv1),o=Ou(o=Kn(o,[2,2],[2,2],"same"),r.conv2),o=Ou(o=Kn(o,[2,2],[2,2],"same"),r.conv3),o=Ou(o=Kn(o,[2,2],[2,2],"same"),r.conv4),o=Ou(o=Kn(o,[2,2],[2,2],"same"),r.conv5),o=Kn(o,[2,2],[1,1],"same"),o=r.conv6?Ou(o,r.conv6):o,ea(o=r.conv7?Ou(o,r.conv7):o,r.conv8,"valid",!1)},n.prototype.forwardInput=function(e,r){var o=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return ge(function(){var a=e.toBatchTensor(r,!1).toFloat();return a=(a=o.config.meanRgb?ld(a,o.config.meanRgb):a).div(le(256)),o.config.withSeparableConvs?o.runMobilenet(a,i):o.runTinyYolov2(a,i)})},n.prototype.forward=function(e,r){return ye(this,void 0,void 0,function(){var o;return we(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Yn(e)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},n.prototype.detect=function(e,r){return void 0===r&&(r={}),ye(this,void 0,void 0,function(){var o,i,a,s,u,c,f,d,p,g,m,y,C=this;return we(this,function(_){switch(_.label){case 0:return o=new fv(r),i=o.inputSize,a=o.scoreThreshold,[4,Yn(e)];case 1:return s=_.sent(),[4,this.forwardInput(s,i)];case 2:return u=_.sent(),c=ge(function(){return On(u)[0].expandDims()}),f={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(c,s.getReshapedInputDimensions(0),a)];case 3:return d=_.sent(),u.dispose(),c.dispose(),p=d.map(function(D){return D.box}),g=d.map(function(D){return D.score}),m=d.map(function(D){return D.classScore}),y=d.map(function(D){return C.config.classes[D.label]}),[2,cd(p.map(function(D){return D.rescale(i)}),g,this.config.iouThreshold,!0).map(function(D){return new BI(g[D],m[D],y[D],p[D],f)})]}})})},n.prototype.getDefaultModelName=function(){return""},n.prototype.extractParamsFromWeigthMap=function(e){return function p9(t,n){var s,e=[],r=function h9(t,n){var e=Fu(t,n);function o(s){return{filters:e(s+"/filters",4),bias:e(s+"/bias",1)}}return{extractConvParams:o,extractConvWithBatchNormParams:function i(s){var u=o(s+"/conv"),c=function r(s){return{sub:e(s+"/sub",1),truediv:e(s+"/truediv",1)}}(s+"/bn");return{conv:u,bn:c}},extractSeparableConvParams:QI(e)}}(t,e),o=r.extractConvParams,i=r.extractConvWithBatchNormParams,a=r.extractSeparableConvParams;if(n.withSeparableConvs){var u=n.filterSizes&&n.filterSizes.length||9;s={conv0:n.isFirstLayerConv2d?o("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:u>7?a("conv6"):void 0,conv7:u>8?a("conv7"):void 0,conv8:o("conv8")}}else s={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:o("conv8")};return Ss(t,e),{params:s,paramMappings:e}}(e,this.config)},n.prototype.extractParams=function(e){var r=this.config.filterSizes||n.DEFAULT_FILTER_SIZES,o=r?r.length:void 0;if(7!==o&&8!==o&&9!==o)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+o+" filterSizes in config");return function d9(t,n,e,r){var p,o=As(t),a=o.getRemainingWeights,s=[],u=function f9(t,n){var e=db(t,n),i=YI(t,n);return{extractConvParams:e,extractConvWithBatchNormParams:function o(a,s,u){var c=e(a,s,3,u+"/conv"),f=function r(a,s){var u=Dn(t(a)),c=Dn(t(a));return n.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:u,truediv:c}}(s,u+"/bn");return{conv:c,bn:f}},extractSeparableConvParams:i}}(o.extractWeights,s),c=u.extractConvParams,f=u.extractConvWithBatchNormParams,d=u.extractSeparableConvParams;if(n.withSeparableConvs){var g=r[0],m=r[1],y=r[2],w=r[3],b=r[4],C=r[5],_=r[6],D=r[7],E=r[8];p={conv0:n.isFirstLayerConv2d?c(g,m,3,"conv0"):d(g,m,"conv0"),conv1:d(m,y,"conv1"),conv2:d(y,w,"conv2"),conv3:d(w,b,"conv3"),conv4:d(b,C,"conv4"),conv5:d(C,_,"conv5"),conv6:D?d(_,D,"conv6"):void 0,conv7:E?d(D,E,"conv7"):void 0,conv8:c(E||D||_,5*e,1,"conv8")}}else y=r[2],w=r[3],b=r[4],C=r[5],_=r[6],D=r[7],E=r[8],p={conv0:f(g=r[0],m=r[1],"conv0"),conv1:f(m,y,"conv1"),conv2:f(y,w,"conv2"),conv3:f(w,b,"conv3"),conv4:f(b,C,"conv4"),conv5:f(C,_,"conv5"),conv6:f(_,D,"conv6"),conv7:f(D,E,"conv7"),conv8:c(E,5*e,1,"conv8")};if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{params:p,paramMappings:s}}(e,this.config,this.boxEncodingSize,r)},n.prototype.extractBoxes=function(e,r,o){return ye(this,void 0,void 0,function(){var i,a,s,u,c,f,d,p,g,m,y,w,b,C,_,D,E,A,P,k,N,F,H,W,Z,Y,Q,re,ne,J=this;return we(this,function(se){switch(se.label){case 0:return i=r.width,a=r.height,s=Math.max(i,a),u=s/i,c=s/a,f=e.shape[1],d=this.config.anchors.length,p=ge(function(){var ue=e.reshape([f,f,d,J.boxEncodingSize]);return[ue.slice([0,0,0,0],[f,f,d,4]),ue.slice([0,0,0,4],[f,f,d,1]),J.withClassScores?Na(ue.slice([0,0,0,5],[f,f,d,J.config.classes.length]),3):le(0)]}),g=p[0],y=p[2],w=[],[4,(m=p[1]).array()];case 1:return b=se.sent(),[4,g.array()];case 2:C=se.sent(),_=0,se.label=3;case 3:if(!(_<f))return[3,12];D=0,se.label=4;case 4:if(!(D<f))return[3,11];E=0,se.label=5;case 5:return E<d?(A=rb(b[_][D][E][0]),!o||A>o?(P=(D+rb(C[_][D][E][0]))/f*u,k=(_+rb(C[_][D][E][1]))/f*c,N=Math.exp(C[_][D][E][2])*this.config.anchors[E].x/f*u,F=Math.exp(C[_][D][E][3])*this.config.anchors[E].y/f*c,H=P-N/2,W=k-F/2,Z={row:_,col:D,anchor:E},this.withClassScores?[4,this.extractPredictedClass(y,Z)]:[3,7]):[3,9]):[3,10];case 6:return ne=se.sent(),[3,8];case 7:ne={classScore:1,label:0},se.label=8;case 8:Q=(Y=ne).classScore,re=Y.label,w.push(Wr({box:new av(H,W,H+N,W+F),score:A,classScore:A*Q,label:re},Z)),se.label=9;case 9:return E++,[3,5];case 10:return D++,[3,4];case 11:return _++,[3,3];case 12:return g.dispose(),m.dispose(),y.dispose(),[2,w]}})})},n.prototype.extractPredictedClass=function(e,r){return ye(this,void 0,void 0,function(){var o,i,a,s;return we(this,function(u){switch(u.label){case 0:return o=r.row,i=r.col,a=r.anchor,[4,e.array()];case 1:return s=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(c,f){return s[o][i][a][f]}).map(function(c,f){return{classScore:c,label:f}}).reduce(function(c,f){return c.classScore>f.classScore?c:f})]}})})},n.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],n}(ka),uS=function(t){function n(e){void 0===e&&(e=!0);var o=Object.assign({},{withSeparableConvs:e,iouThreshold:.4,classes:["face"]},e?{anchors:s9,meanRgb:u9}:{anchors:a9,withClassScores:!0});return t.call(this,o)||this}return qe(n,t),Object.defineProperty(n.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),n.prototype.locateFaces=function(e,r){return ye(this,void 0,void 0,function(){return we(this,function(i){switch(i.label){case 0:return[4,this.detect(e,r)];case 1:return[2,i.sent().map(function(a){return new Eo(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},n.prototype.getDefaultModelName=function(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"},n.prototype.extractParamsFromWeigthMap=function(e){return t.prototype.extractParamsFromWeigthMap.call(this,e)},n}(aB);function g9(t,n){void 0===n&&(n=!0);var e=new uS(n);return e.extractWeights(t),e}var sB=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return qe(n,t),n}(fv),pd=function(){function t(){}return t.prototype.then=function(n){return ye(this,void 0,void 0,function(){var e;return we(this,function(r){switch(r.label){case 0:return e=n,[4,this.run()];case 1:return[2,e.apply(void 0,[r.sent()])]}})})},t.prototype.run=function(){return ye(this,void 0,void 0,function(){return we(this,function(n){throw new Error("ComposableTask - run is not implemented")})})},t}();function bb(t,n,e,r,o){return void 0===o&&(o=function(i){return i.alignedRect}),ye(this,void 0,void 0,function(){var i,a,s,u,c;return we(this,function(f){switch(f.label){case 0:return i=t.map(function(d){return pb(d)?o(d):d.detection}),(s=r)?[3,5]:n instanceof Ut?[4,cb(n,i)]:[3,2];case 1:return u=f.sent(),[3,4];case 2:return[4,ub(n,i)];case 3:u=f.sent(),f.label=4;case 4:s=u,f.label=5;case 5:return[4,e(a=s)];case 6:return c=f.sent(),a.forEach(function(d){return d instanceof Ut&&d.dispose()}),[2,c]}})})}function cS(t,n,e,r,o){return ye(this,void 0,void 0,function(){var i=this;return we(this,function(a){return[2,bb([t],n,function(s){return ye(i,void 0,void 0,function(){return we(this,function(u){return[2,e(s[0])]})})},r,o)]})})}function lS(t,n){var r=n[1];return{height:Math.floor(n[0]*t),width:Math.floor(r*t)}}var fS=function(t){function n(e,r,o,i){return t.call(this,{left:e,top:r,right:o,bottom:i},!0)||this}return qe(n,t),n}(Zi);function uB(t){return ge(function(){return Sr(Bn(t,le(127.5)),le(.0078125))})}function gd(t,n){return ge(function(){return rt(nn(t),Sr(n,Xg(nn(Xg(t)))))})}function dS(t,n,e){return void 0===e&&(e=!1),ge(function(){var r=ea(t,n.conv1,"valid");return r=gd(r,n.prelu1_alpha),r=gd(r=ea(r=Kn(r,e?[2,2]:[3,3],[2,2],"same"),n.conv2,"valid"),n.prelu2_alpha),gd(r=ea(r=e?r:Kn(r,[3,3],[2,2],"valid"),n.conv3,"valid"),n.prelu3_alpha)})}function E9(t,n,e,r,o){o.stage1=[];var i=n.map(function(p){return ge(function(){var g={scale:p},m=function C9(t,n){return ge(function(){var e=lS(n,t.shape.slice(1)),a=uB(Kw.resizeBilinear(t,[e.height,e.width]));return Cs(a,[0,2,1,3])})}(t,p),y=Date.now(),w=function _9(t,n){return ge(function(){var e=dS(t,n,!0),r=ea(e,n.conv4_1,"valid"),o=Vo(tv(r,3),3);return{prob:Na(Bn(r,o),3),regions:ea(e,n.conv4_2,"valid")}})}(m,r),b=w.prob,C=w.regions;return g.pnet=Date.now()-y,{scoresTensor:On(On(b,3)[1])[0],regionsTensor:On(C)[0],scale:p,statsForScale:g}})}),a=i.map(function(p){var g=p.scoresTensor,m=p.regionsTensor,w=p.statsForScale,b=function D9(t,n,e,r){for(var o=[],i=t.arraySync(),a=0;a<t.shape[0];a++)for(var s=0;s<t.shape[1];s++)i[a][s]>=r&&o.push(new Rt(s,a));return o.map(function(c){var f=new av(Math.round((2*c.y+1)/e),Math.round((2*c.x+1)/e),Math.round((2*c.y+12)/e),Math.round((2*c.x+12)/e)),d=i[c.y][c.x],p=n.arraySync();return{cell:f,score:d,region:new fS(p[c.y][c.x][0],p[c.y][c.x][1],p[c.y][c.x][2],p[c.y][c.x][3])}})}(g,m,p.scale,e);if(g.dispose(),m.dispose(),!b.length)return o.stage1.push(w),[];var C=Date.now(),_=cd(b.map(function(D){return D.cell}),b.map(function(D){return D.score}),.5);return w.nms=Date.now()-C,w.numBoxes=_.length,o.stage1.push(w),_.map(function(D){return b[D]})}),s=a.reduce(function(p,g){return p.concat(g)},[]),u=[],c=[];if(s.length>0){var f=Date.now(),d=cd(s.map(function(p){return p.cell}),s.map(function(p){return p.score}),.7);o.stage1_nms=Date.now()-f,c=d.map(function(p){return s[p].score}),u=d.map(function(p){return s[p]}).map(function(p){var g=p.cell,m=p.region;return new av(g.left+m.left*g.width,g.top+m.top*g.height,g.right+m.right*g.width,g.bottom+m.bottom*g.height).toSquare().round()})}return{boxes:u,scores:c}}function cB(t,n,e){var r=e.width,o=e.height;return ye(this,void 0,void 0,function(){var i,a,s,u=this;return we(this,function(c){switch(c.label){case 0:return i=Ji(t),[4,Promise.all(n.map(function(f){return ye(u,void 0,void 0,function(){var d,w,b,C;return we(this,function(_){return d=f.padAtBorders(t.height,t.width),C=i.getImageData(w=d.x-1,b=d.y-1,d.ex-w,d.ey-b),[2,ur.isNodejs()?sb(C):createImageBitmap(C)]})})}))];case 1:return a=c.sent(),s=[],a.forEach(function(f){var p=Ji(uv({width:r,height:o}));p.drawImage(f,0,0,r,o);for(var g=p.getImageData(0,0,r,o).data,m=[],y=0;y<g.length;y+=4)m.push(g[y+2]),m.push(g[y+1]),m.push(g[y]);s.push(m)}),[2,s.map(function(f){return ge(function(){return uB(Cs(ro(f,[1,r,o,3]),[0,2,1,3]).toFloat())})})]}})})}function S9(t,n,e,r,o){return ye(this,void 0,void 0,function(){var i,a,s,u,c,f,d,p,g,m,y,w,b,C;return we(this,function(_){switch(_.label){case 0:return i=Date.now(),[4,cB(t,n,{width:24,height:24})];case 1:return a=_.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(D){var E=function I9(t,n){return ge(function(){var e=dS(t,n),i=gd(Pa(ai(e,[e.shape[0],n.fc1.weights.shape[0]]),n.fc1),n.prelu4_alpha),a=Pa(i,n.fc2_1),s=Vo(tv(a,1),1),u=Na(Bn(a,s),1),c=Pa(i,n.fc2_2);return{scores:On(u,1)[1],regions:c}})}(D,r);return D.dispose(),E}),o.stage2_rnet=Date.now()-i,u=s.length>1?Pn(s.map(function(D){return D.scores})):s[0].scores,d=(f=Array).from,[4,u.data()];case 2:return c=d.apply(f,[_.sent()]),u.dispose(),p=c.map(function(D,E){return{score:D,idx:E}}).filter(function(D){return D.score>e}).map(function(D){return D.idx}),g=p.map(function(D){return n[D]}),m=p.map(function(D){return c[D]}),y=[],w=[],g.length>0&&(i=Date.now(),b=cd(g,m,.7),o.stage2_nms=Date.now()-i,C=b.map(function(D){var E=s[p[D]].regions.arraySync();return new fS(E[0][0],E[0][1],E[0][2],E[0][3])}),w=b.map(function(D){return m[D]}),y=b.map(function(D,E){return g[D].calibrate(C[E])})),s.forEach(function(D){D.regions.dispose(),D.scores.dispose()}),[2,{boxes:y,scores:w}]}})})}function T9(t,n,e,r,o){return ye(this,void 0,void 0,function(){var i,a,s,u,c,f,d,p,g,m,y,w,b,C,_;return we(this,function(D){switch(D.label){case 0:return i=Date.now(),[4,cB(t,n,{width:48,height:48})];case 1:return a=D.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(E){var A=function A9(t,n){return ge(function(){var e=dS(t,n);e=gd(e=ea(e=Kn(e,[2,2],[2,2],"same"),n.conv4,"valid"),n.prelu4_alpha);var i=gd(Pa(ai(e,[e.shape[0],n.fc1.weights.shape[0]]),n.fc1),n.prelu5_alpha),a=Pa(i,n.fc2_1),s=Vo(tv(a,1),1),u=Na(Bn(a,s),1),c=Pa(i,n.fc2_2),f=Pa(i,n.fc2_3);return{scores:On(u,1)[1],regions:c,points:f}})}(E,r);return E.dispose(),A}),o.stage3_onet=Date.now()-i,u=s.length>1?Pn(s.map(function(E){return E.scores})):s[0].scores,d=(f=Array).from,[4,u.data()];case 2:return c=d.apply(f,[D.sent()]),u.dispose(),p=c.map(function(E,A){return{score:E,idx:A}}).filter(function(E){return E.score>e}).map(function(E){return E.idx}),g=p.map(function(E){var A=s[E].regions.arraySync();return new fS(A[0][0],A[0][1],A[0][2],A[0][3])}),m=p.map(function(E,A){return n[E].calibrate(g[A])}),y=p.map(function(E){return c[E]}),w=[],b=[],C=[],m.length>0&&(i=Date.now(),_=cd(m,y,.7,!1),o.stage3_nms=Date.now()-i,w=_.map(function(E){return m[E]}),b=_.map(function(E){return y[E]}),C=_.map(function(E,A){return Array(5).fill(0).map(function(P,k){var N=s[E].points.arraySync();return new Rt(N[0][k]*(w[A].width+1)+w[A].left,N[0][k+5]*(w[A].height+1)+w[A].top)})})),s.forEach(function(E){E.regions.dispose(),E.scores.dispose(),E.points.dispose()}),[2,{boxes:w,scores:b,points:C}]}})})}var hS=function(t){function n(){return t.call(this,"Mtcnn")||this}return qe(n,t),n.prototype.load=function(e){return ye(this,void 0,void 0,function(){return we(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.load.call(this,e)]})})},n.prototype.loadFromDisk=function(e){return ye(this,void 0,void 0,function(){return we(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.loadFromDisk.call(this,e)]})})},n.prototype.forwardInput=function(e,r){return void 0===r&&(r={}),ye(this,void 0,void 0,function(){var o,i,a,s,u,c,f,d,p,g,m,y,w,b,_,D,E,A,P,k;return we(this,function(N){switch(N.label){case 0:if(!(o=this.params))throw new Error("Mtcnn - load model before inference");if(!(i=e.canvases[0]))throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},s=Date.now(),u=ge(function(){return function v9(t){return ge(function(){return Co(On(t,3).reverse(),3)})}(Vo(Qw.fromPixels(i)).toFloat())}),c=function(F){return u.dispose(),a.total=Date.now()-s,F},f=u.shape.slice(1),d=f[0],p=f[1],g=new vb(r),m=g.minFaceSize,y=g.scaleFactor,w=g.maxNumScales,b=g.scoreThresholds,_=(g.scaleSteps||function x9(t,n,e){for(var i=12/t,a=[],s=Math.min(e[0],e[1])*i,u=0;s>=12;)a.push(i*Math.pow(n,u)),s*=n,u+=1;return a}(m,y,[d,p])).filter(function(F){var H=lS(F,[d,p]);return Math.min(H.width,H.height)>12}).slice(0,w),a.scales=_,a.pyramid=_.map(function(F){return lS(F,[d,p])}),D=Date.now(),[4,E9(u,_,b[0],o.pnet,a)];case 1:return E=N.sent(),a.total_stage1=Date.now()-D,E.boxes.length?(a.stage2_numInputBoxes=E.boxes.length,D=Date.now(),[4,S9(i,E.boxes,b[1],o.rnet,a)]):[2,c({results:[],stats:a})];case 2:return A=N.sent(),a.total_stage2=Date.now()-D,A.boxes.length?(a.stage3_numInputBoxes=A.boxes.length,D=Date.now(),[4,T9(i,A.boxes,b[2],o.onet,a)]):[2,c({results:[],stats:a})];case 3:return P=N.sent(),a.total_stage3=Date.now()-D,k=P.boxes.map(function(F,H){return lv(dd({},new Eo(P.scores[H],new ob(F.left/p,F.top/d,F.width/p,F.height/d),{height:d,width:p})),new I3(P.points[H].map(function(W){return W.sub(new Rt(F.left,F.top)).div(new Rt(F.width,F.height))}),{width:F.width,height:F.height}))}),[2,c({results:k,stats:a})]}})})},n.prototype.forward=function(e,r){return void 0===r&&(r={}),ye(this,void 0,void 0,function(){var o;return we(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Yn(e)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},n.prototype.forwardWithStats=function(e,r){return void 0===r&&(r={}),ye(this,void 0,void 0,function(){var o;return we(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Yn(e)];case 1:return[2,o.apply(this,[i.sent(),r])]}})})},n.prototype.getDefaultModelName=function(){return"mtcnn_model"},n.prototype.extractParamsFromWeigthMap=function(e){return function b9(t){var n=[],e=function w9(t,n){var e=Fu(t,n);function r(f){return{filters:e(f+"/weights",4,f+"/filters"),bias:e(f+"/bias",1)}}function o(f){return{weights:e(f+"/weights",2),bias:e(f+"/bias",1)}}function i(f){return e(f,1)}function a(f){return{conv1:r(f+"/conv1"),prelu1_alpha:i(f+"/prelu1_alpha"),conv2:r(f+"/conv2"),prelu2_alpha:i(f+"/prelu2_alpha"),conv3:r(f+"/conv3"),prelu3_alpha:i(f+"/prelu3_alpha")}}return{extractPNetParams:function s(){var f=a("pnet"),d=r("pnet/conv4_1"),p=r("pnet/conv4_2");return Wr(Wr({},f),{conv4_1:d,conv4_2:p})},extractRNetParams:function u(){var f=a("rnet"),d=o("rnet/fc1"),p=i("rnet/prelu4_alpha"),g=o("rnet/fc2_1"),m=o("rnet/fc2_2");return Wr(Wr({},f),{fc1:d,prelu4_alpha:p,fc2_1:g,fc2_2:m})},extractONetParams:function c(){var f=a("onet"),d=r("onet/conv4"),p=i("onet/prelu4_alpha"),g=o("onet/fc1"),m=i("onet/prelu5_alpha"),y=o("onet/fc2_1"),w=o("onet/fc2_2"),b=o("onet/fc2_3");return Wr(Wr({},f),{conv4:d,prelu4_alpha:p,fc1:g,prelu5_alpha:m,fc2_1:y,fc2_2:w,fc2_3:b})}}}(t,n),o=e.extractRNetParams,i=e.extractONetParams,a=(0,e.extractPNetParams)(),s=o(),u=i();return Ss(t,n),{params:{pnet:a,rnet:s,onet:u},paramMappings:n}}(e)},n.prototype.extractParams=function(e){return function y9(t){var n=As(t),r=n.getRemainingWeights,o=[],i=function m9(t,n){var e=db(t,n),r=XI(t,n);function o(c,f){var d=Dn(t(c));return n.push({paramPath:f}),d}function i(c,f,d){return void 0===d&&(d=!1),{conv1:e(c[0],c[1],3,f+"/conv1"),prelu1_alpha:o(c[1],f+"/prelu1_alpha"),conv2:e(c[1],c[2],3,f+"/conv2"),prelu2_alpha:o(c[2],f+"/prelu2_alpha"),conv3:e(c[2],c[3],d?2:3,f+"/conv3"),prelu3_alpha:o(c[3],f+"/prelu3_alpha")}}return{extractPNetParams:function a(){var c=i([3,10,16,32],"pnet"),f=e(32,2,1,"pnet/conv4_1"),d=e(32,4,1,"pnet/conv4_2");return Wr(Wr({},c),{conv4_1:f,conv4_2:d})},extractRNetParams:function s(){var c=i([3,28,48,64],"rnet",!0),f=r(576,128,"rnet/fc1"),d=o(128,"rnet/prelu4_alpha"),p=r(128,2,"rnet/fc2_1"),g=r(128,4,"rnet/fc2_2");return Wr(Wr({},c),{fc1:f,prelu4_alpha:d,fc2_1:p,fc2_2:g})},extractONetParams:function u(){var c=i([3,32,64,64],"onet"),f=e(64,128,2,"onet/conv4"),d=o(128,"onet/prelu4_alpha"),p=r(1152,256,"onet/fc1"),g=o(256,"onet/prelu5_alpha"),m=r(256,2,"onet/fc2_1"),y=r(256,4,"onet/fc2_2"),w=r(256,10,"onet/fc2_3");return Wr(Wr({},c),{conv4:f,prelu4_alpha:d,fc1:p,prelu5_alpha:g,fc2_1:m,fc2_2:y,fc2_3:w})}}}(n.extractWeights,o),s=i.extractRNetParams,u=i.extractONetParams,c=(0,i.extractPNetParams)(),f=s(),d=u();if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:c,rnet:f,onet:d},paramMappings:o}}(e)},n}(ka),M9=[new Rt(1.603231,2.094468),new Rt(6.041143,7.080126),new Rt(2.882459,3.518061),new Rt(4.266906,5.178857),new Rt(9.041765,10.66308)],N9=[117.001,114.697,97.404],pS=function(t){function n(){return t.call(this,{withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:M9,meanRgb:N9,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]})||this}return qe(n,t),Object.defineProperty(n.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),n.prototype.locateFaces=function(e,r){return ye(this,void 0,void 0,function(){return we(this,function(i){switch(i.label){case 0:return[4,this.detect(e,r)];case 1:return[2,i.sent().map(function(a){return new Eo(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},n.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},n.prototype.extractParamsFromWeigthMap=function(e){return t.prototype.extractParamsFromWeigthMap.call(this,e)},n}(aB),mt={ssdMobilenetv1:new mb,tinyFaceDetector:new pS,tinyYolov2:new uS,mtcnn:new hS,faceLandmark68Net:new tS,faceLandmark68TinyNet:new tB,faceRecognitionNet:new rS,faceExpressionNet:new K3,ageGenderNet:new J3},lB=function(t,n){return mt.ssdMobilenetv1.locateFaces(t,n)},F9=function(t,n){return mt.tinyFaceDetector.locateFaces(t,n)},k9=function(t,n){return mt.tinyYolov2.locateFaces(t,n)},P9=function(t,n){return mt.mtcnn.forward(t,n)},fB=function(t){return mt.faceLandmark68Net.detectLandmarks(t)},O9=function(t){return mt.faceLandmark68TinyNet.detectLandmarks(t)},L9=function(t){return mt.faceRecognitionNet.computeFaceDescriptor(t)},B9=function(t){return mt.faceExpressionNet.predictExpressions(t)},V9=function(t){return mt.ageGenderNet.predictAgeAndGender(t)},dB=function(t){return mt.ssdMobilenetv1.load(t)},U9=function(t){return mt.tinyFaceDetector.load(t)},W9=function(t){return mt.mtcnn.load(t)},H9=function(t){return mt.tinyYolov2.load(t)},j9=function(t){return mt.faceLandmark68Net.load(t)},z9=function(t){return mt.faceLandmark68TinyNet.load(t)},$9=function(t){return mt.faceRecognitionNet.load(t)},G9=function(t){return mt.faceExpressionNet.load(t)},q9=function(t){return mt.ageGenderNet.load(t)},K9=dB,X9=lB,Y9=fB,hB=function(t){function n(e,r,o){var i=t.call(this)||this;return i.parentTask=e,i.input=r,i.extractedFaces=o,i}return qe(n,t),n}(pd),gS=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.run=function(){return ye(this,void 0,void 0,function(){var e,r,o=this;return we(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return[4,bb(e=i.sent(),this.input,function(a){return ye(o,void 0,void 0,function(){return we(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return mt.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,e.map(function(a,s){return JI(a,r[s])})]}})})},n.prototype.withAgeAndGender=function(){return new wS(this,this.input)},n}(hB),vS=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.run=function(){return ye(this,void 0,void 0,function(){var e,r;return we(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return(e=o.sent())?[4,cS(e,this.input,function(i){return mt.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=o.sent(),[2,JI(e,r)]}})})},n.prototype.withAgeAndGender=function(){return new bS(this,this.input)},n}(hB),mS=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.withAgeAndGender=function(){return new xS(this,this.input)},n.prototype.withFaceDescriptors=function(){return new Cb(this,this.input)},n}(gS),yS=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.withAgeAndGender=function(){return new _S(this,this.input)},n.prototype.withFaceDescriptor=function(){return new Db(this,this.input)},n}(vS),pB=function(t){function n(e,r,o){var i=t.call(this)||this;return i.parentTask=e,i.input=r,i.extractedFaces=o,i}return qe(n,t),n}(pd),wS=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.run=function(){return ye(this,void 0,void 0,function(){var e,r,o=this;return we(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return[4,bb(e=i.sent(),this.input,function(a){return ye(o,void 0,void 0,function(){return we(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return mt.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,e.map(function(a,s){var u=r[s],c=u.age;return iS(aS(a,u.gender,u.genderProbability),c)})]}})})},n.prototype.withFaceExpressions=function(){return new gS(this,this.input)},n}(pB),bS=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.run=function(){return ye(this,void 0,void 0,function(){var e,r,o;return we(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return(e=s.sent())?[4,cS(e,this.input,function(u){return mt.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=s.sent(),o=r.age,[2,iS(aS(e,r.gender,r.genderProbability),o)]}})})},n.prototype.withFaceExpressions=function(){return new vS(this,this.input)},n}(pB),xS=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.withFaceExpressions=function(){return new mS(this,this.input)},n.prototype.withFaceDescriptors=function(){return new Cb(this,this.input)},n}(wS),_S=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.withFaceExpressions=function(){return new yS(this,this.input)},n.prototype.withFaceDescriptor=function(){return new Db(this,this.input)},n}(bS),CS=function(t){function n(e,r){var o=t.call(this)||this;return o.parentTask=e,o.input=r,o}return qe(n,t),n}(pd),Cb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.run=function(){return ye(this,void 0,void 0,function(){var e;return we(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return[4,bb(e=o.sent(),this.input,function(i){return Promise.all(i.map(function(a){return mt.faceRecognitionNet.computeFaceDescriptor(a)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return[2,o.sent().map(function(i,a){return oS(e[a],i)})]}})})},n.prototype.withFaceExpressions=function(){return new mS(this,this.input)},n.prototype.withAgeAndGender=function(){return new xS(this,this.input)},n}(CS),Db=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.run=function(){return ye(this,void 0,void 0,function(){var e,r;return we(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return(e=o.sent())?[4,cS(e,this.input,function(i){return mt.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=o.sent(),[2,oS(e,r)]}})})},n.prototype.withFaceExpressions=function(){return new yS(this,this.input)},n.prototype.withAgeAndGender=function(){return new _S(this,this.input)},n}(CS),DS=function(t){function n(e,r,o){var i=t.call(this)||this;return i.parentTask=e,i.input=r,i.useTinyLandmarkNet=o,i}return qe(n,t),Object.defineProperty(n.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?mt.faceLandmark68TinyNet:mt.faceLandmark68Net},enumerable:!0,configurable:!0}),n}(pd),gB=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.run=function(){return ye(this,void 0,void 0,function(){var e,r,o,i,a,s=this;return we(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return e=u.sent(),r=e.map(function(c){return c.detection}),this.input instanceof Ut?[4,cb(this.input,r)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,ub(this.input,r)];case 4:i=u.sent(),u.label=5;case 5:return o=i,[4,Promise.all(o.map(function(c){return s.landmarkNet.detectLandmarks(c)}))];case 6:return a=u.sent(),o.forEach(function(c){return c instanceof Ut&&c.dispose()}),[2,e.map(function(c,f){return lv(c,a[f])})]}})})},n.prototype.withFaceExpressions=function(){return new mS(this,this.input)},n.prototype.withAgeAndGender=function(){return new xS(this,this.input)},n.prototype.withFaceDescriptors=function(){return new Cb(this,this.input)},n}(DS),vB=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.run=function(){return ye(this,void 0,void 0,function(){var e,r,o,i,a;return we(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return(e=s.sent())?(r=e.detection,this.input instanceof Ut?[4,cb(this.input,[r])]:[3,3]):[2];case 2:return i=s.sent(),[3,5];case 3:return[4,ub(this.input,[r])];case 4:i=s.sent(),s.label=5;case 5:return[4,this.landmarkNet.detectLandmarks((o=i)[0])];case 6:return a=s.sent(),o.forEach(function(u){return u instanceof Ut&&u.dispose()}),[2,lv(e,a)]}})})},n.prototype.withFaceExpressions=function(){return new yS(this,this.input)},n.prototype.withAgeAndGender=function(){return new _S(this,this.input)},n.prototype.withFaceDescriptor=function(){return new Db(this,this.input)},n}(DS),ES=function(t){function n(e,r){void 0===r&&(r=new al);var o=t.call(this)||this;return o.input=e,o.options=r,o}return qe(n,t),n}(pd),IS=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.run=function(){return ye(this,void 0,void 0,function(){var e,r,o,i;return we(this,function(a){switch(a.label){case 0:return r=(e=this).input,(o=e.options)instanceof vb?[4,mt.mtcnn.forward(r,o)]:[3,2];case 1:return[2,a.sent().map(function(s){return s.detection})];case 2:if(!(i=o instanceof sB?function(s){return mt.tinyFaceDetector.locateFaces(s,o)}:o instanceof al?function(s){return mt.ssdMobilenetv1.locateFaces(s,o)}:o instanceof fv?function(s){return mt.tinyYolov2.locateFaces(s,o)}:null))throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},n.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise(function(r){return ye(e,void 0,void 0,function(){var o;return we(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o.map(function(a){return dd({},a)}))]}})})})},n.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new gB(this.runAndExtendWithFaceDetections(),this.input,e)},n.prototype.withFaceExpressions=function(){return new gS(this.runAndExtendWithFaceDetections(),this.input)},n.prototype.withAgeAndGender=function(){return new wS(this.runAndExtendWithFaceDetections(),this.input)},n}(ES),mB=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return qe(n,t),n.prototype.run=function(){return ye(this,void 0,void 0,function(){var e,r;return we(this,function(o){switch(o.label){case 0:return[4,new IS(this.input,this.options)];case 1:return e=o.sent(),r=e[0],e.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},n.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise(function(r){return ye(e,void 0,void 0,function(){var o;return we(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o?dd({},o):void 0)]}})})})},n.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new vB(this.runAndExtendWithFaceDetection(),this.input,e)},n.prototype.withFaceExpressions=function(){return new vS(this.runAndExtendWithFaceDetection(),this.input)},n.prototype.withAgeAndGender=function(){return new bS(this.runAndExtendWithFaceDetection(),this.input)},n}(ES);function Q9(t,n){return void 0===n&&(n=new al),new mB(t,n)}function Eb(t,n){return void 0===n&&(n=new al),new IS(t,n)}function yB(t,n){return ye(this,void 0,void 0,function(){return we(this,function(e){switch(e.label){case 0:return console.warn("allFacesSsdMobilenetv1 is deprecated and will be removed soon, use the high level api instead"),[4,Eb(t,new al(n?{minConfidence:n}:{})).withFaceLandmarks().withFaceDescriptors()];case 1:return[2,e.sent()]}})})}function Z9(t,n){return void 0===n&&(n={}),ye(this,void 0,void 0,function(){return we(this,function(e){switch(e.label){case 0:return console.warn("allFacesTinyYolov2 is deprecated and will be removed soon, use the high level api instead"),[4,Eb(t,new fv(n)).withFaceLandmarks().withFaceDescriptors()];case 1:return[2,e.sent()]}})})}function J9(t,n){return void 0===n&&(n={}),ye(this,void 0,void 0,function(){return we(this,function(e){switch(e.label){case 0:return console.warn("allFacesMtcnn is deprecated and will be removed soon, use the high level api instead"),[4,Eb(t,new vb(n)).withFaceLandmarks().withFaceDescriptors()];case 1:return[2,e.sent()]}})})}var eK=yB;function wB(t,n){if(t.length!==n.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var e=Array.from(t),r=Array.from(n);return Math.sqrt(e.map(function(o,i){return o-r[i]}).reduce(function(o,i){return o+Math.pow(i,2)},0))}var tK=function(){function t(n,e){void 0===e&&(e=.6),this._distanceThreshold=e;var r=Array.isArray(n)?n:[n];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var o=1,i=function(){return"person "+o++};this._labeledDescriptors=r.map(function(a){if(a instanceof sv)return a;if(a instanceof Float32Array)return new sv(i(),[a]);if(a.descriptor&&a.descriptor instanceof Float32Array)return new sv(i(),[a.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(t.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),t.prototype.computeMeanDistance=function(n,e){return e.map(function(r){return wB(r,n)}).reduce(function(r,o){return r+o},0)/(e.length||1)},t.prototype.matchDescriptor=function(n){var e=this;return this.labeledDescriptors.map(function(r){return new UI(r.label,e.computeMeanDistance(n,r.descriptors))}).reduce(function(r,o){return r.distance<o.distance?r:o})},t.prototype.findBestMatch=function(n){var e=this.matchDescriptor(n);return e.distance<this.distanceThreshold?e:new UI("unknown",e.distance)},t.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(n){return n.toJSON()})}},t.fromJSON=function(n){return new t(n.labeledDescriptors.map(function(r){return sv.fromJSON(r)}),n.distanceThreshold)},t}();function nK(t){var n=new hS;return n.extractWeights(t),n}function rK(t){var n=new pS;return n.extractWeights(t),n}function bB(t,n){var e=new Mu(n.width,n.height),r=e.width,o=e.height;if(r<=0||o<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:r,height:o}));if(Array.isArray(t))return t.map(function(s){return bB(s,{width:r,height:o})});if(pb(t)){var i=t.detection.forSize(r,o),a=t.unshiftedLandmarks.forSize(i.box.width,i.box.height);return lv(dd(t,i),a)}return fd(t)?dd(t,t.detection.forSize(r,o)):t instanceof il||t instanceof Eo?t.forSize(r,o):t}class sl{constructor(){this.modelosForLoad=[mt.ssdMobilenetv1.loadFromUri("/assets/models"),mt.faceLandmark68Net.loadFromUri("/assets/models"),mt.faceRecognitionNet.loadFromUri("/assets/models"),mt.faceExpressionNet.loadFromUri("/assets/models")],this.cbModels=new _r,this.LoadModels=()=>{Promise.all(this.modelosForLoad).then(n=>{console.log("Modelos Cargados!!"),this.cbModels.emit(!0)})},this.globalFace=Vu,this.LoadModels()}static#e=this.\u0275fac=function(e){return new(e||sl)};static#t=this.\u0275prov=He({token:sl,factory:sl.\u0275fac,providedIn:"root"})}function xB(t,n,e,r,o,i,a){try{var s=t[i](a),u=s.value}catch(c){return void e(c)}s.done?n(u):Promise.resolve(u).then(r,o)}function _B(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(u){xB(i,r,o,a,s,"next",u)}function s(u){xB(i,r,o,a,s,"throw",u)}a(void 0)})}}class vd{constructor(n){var e=this;this.faceApiService=n,this.cbAi=new _r,this.getLandMark=function(){var r=_B(function*(o){const{globalFace:i}=e.faceApiService,{videoWidth:a,videoHeight:s}=o.nativeElement,u={width:a,height:s},c=yield i.detectAllFaces(o.nativeElement).withFaceLandmarks().withFaceExpressions(),f=c[0].expressions||null,d=i.resizeResults(c,u);e.cbAi.emit({resizedDetections:d,displaySize:u,expressions:f,videoElement:o})});return function(o){return r.apply(this,arguments)}}()}static#e=this.\u0275fac=function(e){return new(e||vd)(Ie(sl))};static#t=this.\u0275prov=He({token:vd,factory:vd.\u0275fac,providedIn:"root"})}const oK=["videoElement"];function iK(t,n){if(1&t){const e=function hA(){return oe()}();Fo(0,"video",2,3),o0("loadedmetadata",function(){return ah(e),yi($p(2).loadedMetaData())})("play",function(){return ah(e),yi($p(2).listenerPlay())}),ni()}if(2&t){const e=$p(2);q_("width",e.width+"px")("height",e.height+"px"),Pc("srcObject",e.stream)}}function aK(t,n){if(1&t&&(Fo(0,"div"),n0(1,iK,2,5,"video",1),ni()),2&t){const e=$p();fu(1),Pc("ngIf",e.stream)}}class Ib{constructor(n,e,r,o){var i=this;this.renderer2=n,this.elementRef=e,this.faceApiService=r,this.videoPlayerService=o,this.listEvents=[],this.listenerEvents=()=>{const a=this.faceApiService.cbModels.subscribe(s=>{this.modelsReady=!0,this.checkFace()});this.listEvents=[a]},this.checkFace=()=>{setInterval(_B(function*(){yield i.videoPlayerService.getLandMark(i.videoElement)}),100)}}ngOnInit(){this.listenerEvents()}ngOnDestroy(){this.listEvents.forEach(n=>n.unsubscribe())}loadedMetaData(){this.videoElement?.nativeElement.play()}listenerPlay(){}static#e=this.\u0275fac=function(e){return new(e||Ib)(Se(su),Se(Fi),Se(sl),Se(vd))};static#t=this.\u0275cmp=Hs({type:Ib,selectors:[["app-video-player"]],viewQuery:function(e,r){if(1&e&&rR(oK,5),2&e){let o;dC(o=function hC(){return function sW(t,n){return t[19].queries[n].queryList}(oe(),Gr())}())&&(r.videoElement=o.first)}},inputs:{stream:"stream",width:"width",height:"height"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"width","height","srcObject","loadedmetadata","play",4,"ngIf"],[3,"srcObject","loadedmetadata","play"],["videoElement",""]],template:function(e,r){1&e&&n0(0,aK,2,1,"div",0),2&e&&Pc("ngIf",r.modelsReady)},dependencies:[yM],styles:["[_nghost-%COMP%]{position:relative;display:block}.overlay-cam[_ngcontent-%COMP%]{background-position:center;background-repeat:no-repeat;background-size:cover;position:absolute;z-index:1}.btn[_ngcontent-%COMP%]{cursor:pointer;color:#fff;font-weight:300;font-size:2.2rem;background-color:#89c2d9;width:75px;height:75px;border-radius:100px;display:flex;justify-content:center;align-items:center;align-content:center;border:0}.section-buttons[_ngcontent-%COMP%]{display:flex;padding-top:1rem;padding-bottom:1rem;justify-content:space-around}  video,   canvas{width:478px;height:360px;object-fit:cover;border:solid 0px transparent}  video{background-color:#fff;border:solid 0px white;display:block;width:478px}  canvas{top:0;position:absolute}.btn-filter[_ngcontent-%COMP%]{position:absolute;bottom:0;display:flex;justify-content:space-evenly;width:100%;z-index:1;padding:2rem}.btn-filter[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer;font-size:1.4rem;border:0;padding:.5rem;background-color:#fff;display:flex;justify-content:center;align-content:center;align-items:center;border-radius:10rem;width:3.5rem;height:3.5rem;box-shadow:0 0 80px #0000002b}.filters[_ngcontent-%COMP%]{position:absolute;top:0;left:0}.filters[_ngcontent-%COMP%]   .filter-eye[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;align-content:center;justify-content:center;font-size:1.75rem;color:#fff}.filters[_ngcontent-%COMP%]   .filter-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:300px;margin-left:-80px;margin-top:25px}.filters[_ngcontent-%COMP%]   .filter-question[_ngcontent-%COMP%]{font-size:1.3rem;width:350px;height:80px;padding:.5rem;background-color:red;border:solid 5px white;margin-left:-5.5vw;margin-top:-90px;text-align:center}ul[_ngcontent-%COMP%]{position:absolute;top:0;display:flex;margin:0;list-style:none;padding:0}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:0;font-size:4rem}"]})}function sK(t,n){if(1&t&&(Fo(0,"div")(1,"span"),If(2),ni(),Fo(3,"span",13),If(4),function YT(t,n){const e=pt();let r;const o=t+22;e.firstCreatePass?(r=function jU(t,n){if(n)for(let e=n.length-1;e>=0;e--){const r=n[e];if(t===r.name)return r}}(n,e.pipeRegistry),e.data[o]=r,r.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(o,r.onDestroy)):r=e.data[o];const i=r.factory||(r.factory=la(r.type)),a=Xt(Se);try{const s=hc(!1),u=i();return hc(s),function M4(t,n,e,r){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=r}(e,oe(),o,u),u}finally{Xt(a)}}(5,"number"),ni()()),2&t){const e=n.$implicit;fu(2),s0("",e.name,": "),fu(2),X_(QT(5,2,e.value))}}class Sb{constructor(n,e,r){this.faceApiService=n,this.videoPlayerService=e,this.renderer2=r,this.listEvents=[],this.listExpressions=[],this.checkMediaSource=()=>{navigator&&navigator.mediaDevices?navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then(o=>{this.currentStream=o}).catch(()=>{console.log("**** ERROR NOT PERMISSIONS *****")}):console.log("******* ERROR NOT FOUND MEDIA DEVICES")},this.getSizeCam=()=>{const o=document.querySelector(".cam"),{width:i,height:a}=o.getBoundingClientRect();this.dimensionVideo={width:i,height:a}},this.listenerEvents=()=>{const o=this.videoPlayerService.cbAi.subscribe(({resizedDetections:i,expressions:s})=>{(i=i[0]||null)&&(this.listExpressions=SG.map(s,(c,f)=>({name:f,value:c})))});this.listEvents=[o]}}ngOnInit(){this.listenerEvents(),this.checkMediaSource(),this.getSizeCam()}ngOnDestroy(){this.listEvents.forEach(n=>n.unsuscribe())}static#e=this.\u0275fac=function(e){return new(e||Sb)(Se(sl),Se(vd),Se(su))};static#t=this.\u0275cmp=Hs({type:Sb,selectors:[["app-root"]],decls:20,vars:4,consts:[[1,"wrapper"],[1,"header"],[1,"in-header"],[1,"uil","uil-video"],[1,"title"],[1,"block-main"],[1,"cam"],[3,"width","height","stream"],[1,"sidebar"],[1,"zone-body"],[1,"block"],[1,"block-expression"],[4,"ngFor","ngForOf"],[1,"value-number"]],template:function(e,r){1&e&&(Fo(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),zp(4,"i",3),ni(),Fo(5,"div",4),If(6," Reconocimiento facial "),Fo(7,"b"),If(8,"ANGULAR 2021"),ni()()()(),Fo(9,"div",5)(10,"div",6),zp(11,"app-video-player",7),ni(),Fo(12,"div",8)(13,"div",9)(14,"div",10)(15,"div")(16,"b"),If(17,"Estado de \xe1nimo"),ni()(),Fo(18,"div",11),n0(19,sK,6,4,"div",12),ni()()()()()()),2&e&&(fu(11),Pc("width",r.dimensionVideo.width)("height",r.dimensionVideo.height)("stream",r.currentStream),fu(8),Pc("ngForOf",r.listExpressions))},dependencies:[vM,Ib,_M],styles:["[_nghost-%COMP%]{display:flex;justify-content:center}  .space-preview canvas{position:relative;width:100%;height:25rem}  .canvas-preview{position:relative}  .canvas-preview canvas{width:100%}.block-expression[_ngcontent-%COMP%]{padding:.5rem}.block-expression[_ngcontent-%COMP%]   .value-number[_ngcontent-%COMP%]{color:#00f}.wrapper[_ngcontent-%COMP%]{margin:3%;width:70vw;height:75vh;background-color:#fff;box-shadow:0 0 80px #0000002b}.wrapper[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-content:center;align-items:center;padding:.25rem 1.5rem;height:3rem;border-bottom:solid 1px #f1f1f1;justify-content:space-between}.wrapper[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .in-header[_ngcontent-%COMP%]{display:flex;align-content:center;align-items:center}.wrapper[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:500;padding:0 .75rem}.wrapper[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .uil[_ngcontent-%COMP%]{font-size:1.5rem}.wrapper[_ngcontent-%COMP%]   .block-main[_ngcontent-%COMP%]{display:grid;height:calc(100% - 3.5rem);grid-template-columns:2fr 1fr}.wrapper[_ngcontent-%COMP%]   .block-main[_ngcontent-%COMP%]   .cam[_ngcontent-%COMP%]{position:relative}.wrapper[_ngcontent-%COMP%]   .block-main[_ngcontent-%COMP%]   .cam[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{display:none;width:100%;height:100%;position:absolute}.wrapper[_ngcontent-%COMP%]   .block-main[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{border-left:solid 1px #f1f1f1;display:grid;grid-template-columns:6fr 1fr}.wrapper[_ngcontent-%COMP%]   .block-main[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]   .zone-body[_ngcontent-%COMP%]{padding:0;display:grid;grid-template-rows:1fr 2fr}.wrapper[_ngcontent-%COMP%]   .block-main[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]   .zone-body[_ngcontent-%COMP%]   .block[_ngcontent-%COMP%]{padding:1rem;border-top:solid 1px #f1f1f1}.wrapper[_ngcontent-%COMP%]   .block-main[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]   .zone-body[_ngcontent-%COMP%]   .block[_ngcontent-%COMP%]:first-child{border-top:0}.wrapper[_ngcontent-%COMP%]   .block-main[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]   .zone-btn[_ngcontent-%COMP%]{border-left:solid 1px #f1f1f1}.wrapper[_ngcontent-%COMP%]   .block-main[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]   .list-btn[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;font-size:1.5rem}.wrapper[_ngcontent-%COMP%]   .block-main[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]   .list-btn[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{height:5rem;display:flex;align-items:center;justify-content:center}.link-github[_ngcontent-%COMP%]{cursor:pointer;text-decoration:none;color:#222}"]})}const uK=["addListener","removeListener"],cK=["addEventListener","removeEventListener"],lK=["on","off"];function Ab(t,n,e,r){if(bt(e)&&(r=e,e=void 0),r)return Ab(t,n,e).pipe(XM(r));const[o,i]=function hK(t){return bt(t.addEventListener)&&bt(t.removeEventListener)}(t)?cK.map(a=>s=>t[a](n,s,e)):function fK(t){return bt(t.addListener)&&bt(t.removeListener)}(t)?uK.map(CB(t,n)):function dK(t){return bt(t.on)&&bt(t.off)}(t)?lK.map(CB(t,n)):[];if(!o&&Rd(t))return wn(a=>Ab(a,n,e))(ao(t));if(!o)throw new TypeError("Invalid event target");return new xt(a=>{const s=(...u)=>a.next(1<u.length?u:u[0]);return o(s),()=>i(s)})}function CB(t,n){return e=>r=>t[e](n,r)}const Lu=new xt(lr),gK={connector:()=>new fr};function DB(t,n=gK){const{connector:e}=n;return Ht((r,o)=>{const i=e();ao(t(function pK(t){return new xt(n=>t.subscribe(n))}(i))).subscribe(o),o.add(r.subscribe(i))})}class yK extends Hr{constructor(n,e){super()}schedule(n,e=0){return this}}const Tb={setInterval(t,n,...e){const{delegate:r}=Tb;return r?.setInterval?r.setInterval(t,n,...e):setInterval(t,n,...e)},clearInterval(t){const{delegate:n}=Tb;return(n?.clearInterval||clearInterval)(t)},delegate:void 0},EB={now:()=>(EB.delegate||Date).now(),delegate:void 0};class dv{constructor(n,e=dv.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,r){return new this.schedulerActionCtor(this,n).schedule(r,e)}}dv.now=EB.now;const IB=new class bK extends dv{constructor(n,e=dv.now){super(n,e),this.actions=[],this._active=!1}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let r;this._active=!0;do{if(r=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,r){for(;n=e.shift();)n.unsubscribe();throw r}}}(class wK extends yK{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var r;if(this.closed)return this;this.state=n;const o=this.id,i=this.scheduler;return null!=o&&(this.id=this.recycleAsyncId(i,o,e)),this.pending=!0,this.delay=e,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,e),this}requestAsyncId(n,e,r=0){return Tb.setInterval(n.flush.bind(n,this),r)}recycleAsyncId(n,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;null!=e&&Tb.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(n,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let o,r=!1;try{this.work(n)}catch(i){r=!0,o=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Fs(r,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}}),xK=IB;function SB(t,n){return n?e=>lg(n.pipe(ko(1),function _K(){return Ht((t,n)=>{t.subscribe(yn(n,lr))})}()),e.pipe(SB(t))):wn((e,r)=>t(e,r).pipe(ko(1),tN(e)))}const hv="Service workers are disabled or not supported by this browser";class Rb{constructor(n){if(this.serviceWorker=n,n){const r=Ab(n,"controllerchange").pipe(Ve(()=>n.controller)),i=lg(V0(()=>Re(n.controller)),r);this.worker=i.pipe(xo(f=>!!f)),this.registration=this.worker.pipe(bo(()=>n.getRegistration()));const c=Ab(n,"message").pipe(Ve(f=>f.data)).pipe(xo(f=>f&&f.type)).pipe(function mK(t){return t?n=>DB(t)(n):n=>function vK(t,n){const e=bt(t)?t:()=>t;return bt(n)?DB(n,{connector:e}):r=>new aD(r,e)}(new fr)(n)}());c.connect(),this.events=c}else this.worker=this.events=this.registration=function IK(t){return V0(()=>Mf(new Error(t)))}(hv)}postMessage(n,e){return this.worker.pipe(ko(1),Cr(r=>{r.postMessage({action:n,...e})})).toPromise().then(()=>{})}postMessageWithOperation(n,e,r){const o=this.waitForOperationCompleted(r),i=this.postMessage(n,e);return Promise.all([i,o]).then(([,a])=>a)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(n){let e;return e="string"==typeof n?r=>r.type===n:r=>n.includes(r.type),this.events.pipe(xo(e))}nextEventOfType(n){return this.eventsOfType(n).pipe(ko(1))}waitForOperationCompleted(n){return this.eventsOfType("OPERATION_COMPLETED").pipe(xo(e=>e.nonce===n),ko(1),Ve(e=>{if(void 0!==e.result)return e.result;throw new Error(e.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let SK=(()=>{class t{constructor(e){if(this.sw=e,this.subscriptionChanges=new fr,!e.isEnabled)return this.messages=Lu,this.notificationClicks=Lu,void(this.subscription=Lu);this.messages=this.sw.eventsOfType("PUSH").pipe(Ve(o=>o.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(Ve(o=>o.data)),this.pushManager=this.sw.registration.pipe(Ve(o=>o.pushManager));const r=this.pushManager.pipe(bo(o=>o.getSubscription()));this.subscription=Bd(r,this.subscriptionChanges)}get isEnabled(){return this.sw.isEnabled}requestSubscription(e){if(!this.sw.isEnabled)return Promise.reject(new Error(hv));const r={userVisibleOnly:!0};let o=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),i=new Uint8Array(new ArrayBuffer(o.length));for(let a=0;a<o.length;a++)i[a]=o.charCodeAt(a);return r.applicationServerKey=i,this.pushManager.pipe(bo(a=>a.subscribe(r)),ko(1)).toPromise().then(a=>(this.subscriptionChanges.next(a),a))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(ko(1),bo(r=>{if(null===r)throw new Error("Not subscribed to push notifications.");return r.unsubscribe().then(o=>{if(!o)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(hv))}decodeBase64(e){return atob(e)}}return t.\u0275fac=function(e){return new(e||t)(Ie(Rb))},t.\u0275prov=He({token:t,factory:t.\u0275fac}),t})(),AK=(()=>{class t{constructor(e){if(this.sw=e,!e.isEnabled)return this.versionUpdates=Lu,this.available=Lu,this.activated=Lu,void(this.unrecoverable=Lu);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.available=this.versionUpdates.pipe(xo(r=>"VERSION_READY"===r.type),Ve(r=>({type:"UPDATE_AVAILABLE",current:r.currentVersion,available:r.latestVersion}))),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}get isEnabled(){return this.sw.isEnabled}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(hv));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(hv));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}}return t.\u0275fac=function(e){return new(e||t)(Ie(Rb))},t.\u0275prov=He({token:t,factory:t.\u0275fac}),t})();class SS{}const AB=new Me("NGSW_REGISTER_SCRIPT");function TK(t,n,e,r){return()=>{if(!DM(r)||!("serviceWorker"in navigator)||!1===e.enabled)return;let o;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof e.registrationStrategy)o=e.registrationStrategy();else{const[a,...s]=(e.registrationStrategy||"registerWhenStable:30000").split(":");switch(a){case"registerImmediately":o=Re(null);break;case"registerWithDelay":o=TB(+s[0]||0);break;case"registerWhenStable":o=s[0]?Bd(RB(t),TB(+s[0])):RB(t);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`)}}t.get(_n).runOutsideAngular(()=>o.pipe(ko(1)).subscribe(()=>navigator.serviceWorker.register(n,{scope:e.scope}).catch(a=>console.error("Service worker registration failed with:",a))))}}function TB(t){return Re(null).pipe(function EK(t,n=IB){const e=function DK(t=0,n,e=xK){let r=-1;return null!=n&&(Rv(n)?e=n:r=n),new xt(o=>{let i=function CK(t){return t instanceof Date&&!isNaN(t)}(t)?+t-e.now():t;i<0&&(i=0);let a=0;return e.schedule(function(){o.closed||(o.next(a++),0<=r?this.schedule(void 0,r):o.complete())},i)})}(t,n);return SB(()=>e)}(t))}function RB(t){return t.get(rg).isStable.pipe(xo(e=>e))}function RK(t,n){return new Rb(DM(n)&&!1!==t.enabled?navigator.serviceWorker:void 0)}let MK=(()=>{class t{static register(e,r={}){return{ngModule:t,providers:[{provide:AB,useValue:e},{provide:SS,useValue:r},{provide:Rb,useFactory:RK,deps:[SS,m0]},{provide:tg,useFactory:TK,deps:[mo,AB,SS,m0],multi:!0}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=aa({type:t}),t.\u0275inj=ht({providers:[SK,AK]}),t})();class Mb{static#e=this.\u0275fac=function(e){return new(e||Mb)};static#t=this.\u0275mod=aa({type:Mb,bootstrap:[Sb]});static#n=this.\u0275inj=ht({imports:[Lz,iw,MK.register("ngsw-worker.js",{enabled:!0,registrationStrategy:"registerWhenStable:30000"})]})}Oz().bootstrapModule(Mb).catch(t=>console.error(t))},489:function(ui,Ns,cr){var Wa;ui=cr.nmd(ui),function(){var L,Tr="Expected a function",Fs="__lodash_hash_undefined__",Uu="__lodash_placeholder__",hi=1/0,Rr=9007199254740991,xt=4294967295,Ob=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],ks="[object Arguments]",fr="[object Array]",Ps="[object Boolean]",Ht="[object Date]",cl="[object Error]",Ve="[object Function]",ll="[object GeneratorFunction]",$o="[object Map]",Os="[object Number]",na="[object Object]",Lb="[object Promise]",zu="[object RegExp]",Go="[object Set]",Ls="[object String]",Id="[object Symbol]",$u="[object WeakMap]",fl="[object ArrayBuffer]",Gu="[object DataView]",pi="[object Float32Array]",Sd="[object Float64Array]",wv="[object Int8Array]",Ad="[object Int16Array]",bv="[object Int32Array]",Td="[object Uint8Array]",xv="[object Uint8ClampedArray]",_v="[object Uint16Array]",Cv="[object Uint32Array]",OS=/\b__p \+= '';/g,LS=/\b(__p \+=) '' \+/g,Rd=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Md=/&(?:amp|lt|gt|quot|#39);/g,Nd=/[&<>"']/g,Dv=RegExp(Md.source),Ev=RegExp(Nd.source),Bb=/<%-([\s\S]+?)%>/g,Iv=/<%([\s\S]+?)%>/g,Fd=/<%=([\s\S]+?)%>/g,Sv=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Av=/^\w*$/,ao=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kd=/[\\^$.*+?()[\]{}|]/g,Vb=RegExp(kd.source),Pd=/^\s+/,Ub=/\s/,Tv=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Wb=/\{\n\/\* \[wrapped with (.+)\] \*/,Hb=/,? & /,gi=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,jb=/[()=,{}\[\]\/\s]/,wn=/\\(\\)?/g,Bs=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qo=/\w*$/,BS=/^[-+]0x[0-9a-f]+$/i,zb=/^0b[01]+$/i,Rv=/^\[object .+?Constructor\]$/,Od=/^0o[0-7]+$/i,$b=/^(?:0|[1-9]\d*)$/,qu=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,dl=/($^)/,Mv=/['\n\r\u2028\u2029\\]/g,Ku="\\ud800-\\udfff",Nv="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ld="\\u2700-\\u27bf",Fv="a-z\\xdf-\\xf6\\xf8-\\xff",hl="A-Z\\xc0-\\xd6\\xd8-\\xde",Bt="\\ufe0e\\ufe0f",pl="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Vd="["+Ku+"]",kv="["+pl+"]",Vs="["+Nv+"]",Ne="\\d+",Ud="["+Ld+"]",gl="["+Fv+"]",Qb="[^"+Ku+pl+Ne+Ld+Fv+hl+"]",ce="\\ud83c[\\udffb-\\udfff]",Ue="[^"+Ku+"]",_t="(?:\\ud83c[\\udde6-\\uddff]){2}",Wd="[\\ud800-\\udbff][\\udc00-\\udfff]",Xu="["+hl+"]",Yu="(?:"+gl+"|"+Qb+")",jr="(?:"+Xu+"|"+Qb+")",Zb="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Ov="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Jb="(?:"+Vs+"|"+ce+")?",Ko="["+Bt+"]?",ex=Ko+Jb+"(?:\\u200d(?:"+[Ue,_t,Wd].join("|")+")"+Ko+Jb+")*",tx="(?:"+[Ud,_t,Wd].join("|")+")"+ex,HS="(?:"+[Ue+Vs+"?",Vs,_t,Wd,Vd].join("|")+")",nx=RegExp("['\u2019]","g"),jS=RegExp(Vs,"g"),dr=RegExp(ce+"(?="+ce+")|"+HS+ex,"g"),Mt=RegExp([Xu+"?"+gl+"+"+Zb+"(?="+[kv,Xu,"$"].join("|")+")",jr+"+"+Ov+"(?="+[kv,Xu+Yu,"$"].join("|")+")",Xu+"?"+Yu+"+"+Zb,Xu+"+"+Ov,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ne,tx].join("|"),"g"),zS=RegExp("[\\u200d"+Ku+Nv+Bt+"]"),$S=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,GS=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],He=-1,jt={};jt[pi]=jt[Sd]=jt[wv]=jt[Ad]=jt[bv]=jt[Td]=jt[xv]=jt[_v]=jt[Cv]=!0,jt[ks]=jt[fr]=jt[fl]=jt[Ps]=jt[Gu]=jt[Ht]=jt[cl]=jt[Ve]=jt[$o]=jt[Os]=jt[na]=jt[zu]=jt[Go]=jt[Ls]=jt[$u]=!1;var ht={};ht[ks]=ht[fr]=ht[fl]=ht[Gu]=ht[Ps]=ht[Ht]=ht[pi]=ht[Sd]=ht[wv]=ht[Ad]=ht[bv]=ht[$o]=ht[Os]=ht[na]=ht[zu]=ht[Go]=ht[Ls]=ht[Id]=ht[Td]=ht[xv]=ht[_v]=ht[Cv]=!0,ht[cl]=ht[Ve]=ht[$u]=!1;var ox={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ix=parseFloat,Bv=parseInt,Qu="object"==typeof global&&global&&global.Object===Object&&global,Hd="object"==typeof self&&self&&self.Object===Object&&self,In=Qu||Hd||Function("return this")(),Vv=Ns&&!Ns.nodeType&&Ns,Ae=Vv&&ui&&!ui.nodeType&&ui,yl=Ae&&Ae.exports===Vv,jd=yl&&Qu.process,Xt=function(){try{return Ae&&Ae.require&&Ae.require("util").types||jd&&jd.binding&&jd.binding("util")}catch{}}(),zd=Xt&&Xt.isArrayBuffer,ax=Xt&&Xt.isDate,Vt=Xt&&Xt.isMap,sx=Xt&&Xt.isRegExp,ux=Xt&&Xt.isSet,cx=Xt&&Xt.isTypedArray;function Vn(j,X,G){switch(G.length){case 0:return j.call(X);case 1:return j.call(X,G[0]);case 2:return j.call(X,G[0],G[1]);case 3:return j.call(X,G[0],G[1],G[2])}return j.apply(X,G)}function $d(j,X,G,he){for(var Ce=-1,lt=null==j?0:j.length;++Ce<lt;){var zt=j[Ce];X(he,zt,G(zt),j)}return he}function hr(j,X){for(var G=-1,he=null==j?0:j.length;++G<he&&!1!==X(j[G],G,j););return j}function lx(j,X){for(var G=null==j?0:j.length;G--&&!1!==X(j[G],G,j););return j}function Uv(j,X){for(var G=-1,he=null==j?0:j.length;++G<he;)if(!X(j[G],G,j))return!1;return!0}function ra(j,X){for(var G=-1,he=null==j?0:j.length,Ce=0,lt=[];++G<he;){var zt=j[G];X(zt,G,j)&&(lt[Ce++]=zt)}return lt}function Zu(j,X){return!(null==j||!j.length)&&Us(j,X,0)>-1}function za(j,X,G){for(var he=-1,Ce=null==j?0:j.length;++he<Ce;)if(G(X,j[he]))return!0;return!1}function kt(j,X){for(var G=-1,he=null==j?0:j.length,Ce=Array(he);++G<he;)Ce[G]=X(j[G],G,j);return Ce}function oa(j,X){for(var G=-1,he=X.length,Ce=j.length;++G<he;)j[Ce+G]=X[G];return j}function Ie(j,X,G,he){var Ce=-1,lt=null==j?0:j.length;for(he&&lt&&(G=j[++Ce]);++Ce<lt;)G=X(G,j[Ce],Ce,j);return G}function Wv(j,X,G,he){var Ce=null==j?0:j.length;for(he&&Ce&&(G=j[--Ce]);Ce--;)G=X(G,j[Ce],Ce,j);return G}function Pt(j,X){for(var G=-1,he=null==j?0:j.length;++G<he;)if(X(j[G],G,j))return!0;return!1}var wl=jv("length");function Hv(j,X,G){var he;return G(j,function(Ce,lt,zt){if(X(Ce,lt,zt))return he=lt,!1}),he}function bl(j,X,G,he){for(var Ce=j.length,lt=G+(he?1:-1);he?lt--:++lt<Ce;)if(X(j[lt],lt,j))return lt;return-1}function Us(j,X,G){return X==X?function de(j,X,G){for(var he=G-1,Ce=j.length;++he<Ce;)if(j[he]===X)return he;return-1}(j,X,G):bl(j,so,G)}function ia(j,X,G,he){for(var Ce=G-1,lt=j.length;++Ce<lt;)if(he(j[Ce],X))return Ce;return-1}function so(j){return j!=j}function fx(j,X){var G=null==j?0:j.length;return G?Ws(j,X)/G:NaN}function jv(j){return function(X){return null==X?L:X[j]}}function uo(j){return function(X){return null==j?L:j[X]}}function Xo(j,X,G,he,Ce){return Ce(j,function(lt,zt,et){G=he?(he=!1,lt):X(G,lt,zt,et)}),G}function Ws(j,X){for(var G,he=-1,Ce=j.length;++he<Ce;){var lt=X(j[he]);lt!==L&&(G=G===L?lt:G+lt)}return G}function ec(j,X){for(var G=-1,he=Array(j);++G<j;)he[G]=X(G);return he}function Kd(j){return j&&j.slice(0,sa(j)+1).replace(Pd,"")}function rn(j){return function(X){return j(X)}}function $a(j,X){return kt(X,function(G){return j[G]})}function tc(j,X){return j.has(X)}function Hs(j,X){for(var G=-1,he=j.length;++G<he&&Us(X,j[G],0)>-1;);return G}function zv(j,X){for(var G=j.length;G--&&Us(X,j[G],0)>-1;);return G}function $v(j,X){for(var G=j.length,he=0;G--;)j[G]===X&&++he;return he}var Gv=uo({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),aa=uo({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function dx(j){return"\\"+ox[j]}function dn(j){return zS.test(j)}function Sn(j){var X=-1,G=Array(j.size);return j.forEach(function(he,Ce){G[++X]=[Ce,he]}),G}function Zn(j,X){return function(G){return j(X(G))}}function zr(j,X){for(var G=-1,he=j.length,Ce=0,lt=[];++G<he;){var zt=j[G];(zt===X||zt===Uu)&&(j[G]=Uu,lt[Ce++]=G)}return lt}function Jn(j){var X=-1,G=Array(j.size);return j.forEach(function(he){G[++X]=he}),G}function Ot(j){return dn(j)?function Ga(j){for(var X=dr.lastIndex=0;dr.test(j);)++X;return X}(j):wl(j)}function Yt(j){return dn(j)?function Jt(j){return j.match(dr)||[]}(j):function Gd(j){return j.split("")}(j)}function sa(j){for(var X=j.length;X--&&Ub.test(j.charAt(X)););return X}var An=uo({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),je=function j(X){var l,G=(X=null==X?In:je.defaults(In.Object(),X,je.pick(In,GS))).Array,he=X.Date,Ce=X.Error,lt=X.Function,zt=X.Math,et=X.Object,ua=X.RegExp,Kv=X.String,tt=X.TypeError,xl=G.prototype,vi=et.prototype,js=X["__core-js_shared__"],ca=lt.prototype.toString,Ct=vi.hasOwnProperty,qa=0,Un=(l=/[^.]+$/.exec(js&&js.keys&&js.keys.IE_PROTO||""))?"Symbol(src)_1."+l:"",_l=vi.toString,Nr=ca.call(et),Io=In._,Xd=ua("^"+ca.call(Ct).replace(kd,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ka=yl?X.Buffer:L,So=X.Symbol,Fr=X.Uint8Array,Xv=Ka?Ka.allocUnsafe:L,Yd=Zn(et.getPrototypeOf,et),Yv=et.create,Qv=vi.propertyIsEnumerable,Qd=xl.splice,px=So?So.isConcatSpreadable:L,Cl=So?So.iterator:L,zs=So?So.toStringTag:L,Zd=function(){try{var l=Ao(et,"defineProperty");return l({},"",{}),l}catch{}}(),qS=X.clearTimeout!==In.clearTimeout&&X.clearTimeout,KS=he&&he.now!==In.Date.now&&he.now,XS=X.setTimeout!==In.setTimeout&&X.setTimeout,Jd=zt.ceil,eh=zt.floor,Zv=et.getOwnPropertySymbols,YS=Ka?Ka.isBuffer:L,gx=X.isFinite,QS=xl.join,Jv=Zn(et.keys,et),on=zt.max,pr=zt.min,ZS=he.now,JS=X.parseInt,la=zt.random,vx=xl.reverse,mi=Ao(X,"DataView"),$s=Ao(X,"Map"),th=Ao(X,"Promise"),Gs=Ao(X,"Set"),qs=Ao(X,"WeakMap"),Ks=Ao(et,"create"),Dl=qs&&new qs,fa={},mx=is(mi),lo=is($s),nh=is(th),yx=is(Gs),rh=is(qs),El=So?So.prototype:L,Il=El?El.valueOf:L,an=El?El.toString:L;function S(l){if(Zt(l)&&!$e(l)&&!(l instanceof at)){if(l instanceof $t)return l;if(Ct.call(l,"__wrapped__"))return Mm(l)}return new $t(l)}var oc=function(){function l(){}return function(h){if(!Qt(h))return{};if(Yv)return Yv(h);l.prototype=h;var v=new l;return l.prototype=L,v}}();function Xa(){}function $t(l,h){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!h,this.__index__=0,this.__values__=L}function at(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=xt,this.__views__=[]}function Ya(l){var h=-1,v=null==l?0:l.length;for(this.clear();++h<v;){var x=l[h];this.set(x[0],x[1])}}function Te(l){var h=-1,v=null==l?0:l.length;for(this.clear();++h<v;){var x=l[h];this.set(x[0],x[1])}}function Yo(l){var h=-1,v=null==l?0:l.length;for(this.clear();++h<v;){var x=l[h];this.set(x[0],x[1])}}function yi(l){var h=-1,v=null==l?0:l.length;for(this.__data__=new Yo;++h<v;)this.add(l[h])}function gr(l){var h=this.__data__=new Te(l);this.size=h.size}function Ix(l,h){var v=$e(l),x=!v&&us(l),I=!v&&!x&&xa(l),T=!v&&!x&&!I&&Ni(l),O=v||x||I||T,U=O?ec(l.length,Kv):[],z=U.length;for(var ee in l)(h||Ct.call(l,ee))&&(!O||!("length"==ee||I&&("offset"==ee||"parent"==ee)||T&&("buffer"==ee||"byteLength"==ee||"byteOffset"==ee)||wa(ee,z)))&&U.push(ee);return U}function ch(l){var h=l.length;return h?l[Ys(0,h-1)]:L}function vr(l,h){return Gl(Kr(l),xi(h,0,l.length))}function wi(l){return Gl(Kr(l))}function Al(l,h,v){(v!==L&&!Yr(l[h],v)||v===L&&!(h in l))&&bi(l,h,v)}function Zo(l,h,v){var x=l[h];(!Ct.call(l,h)||!Yr(x,v)||v===L&&!(h in l))&&bi(l,h,v)}function fo(l,h){for(var v=l.length;v--;)if(Yr(l[v][0],h))return v;return-1}function Sx(l,h,v,x){return _i(l,function(I,T,O){h(x,I,v(I),O)}),x}function lh(l,h){return l&&Si(h,Rn(h),l)}function bi(l,h,v){"__proto__"==h&&Zd?Zd(l,h,{configurable:!0,enumerable:!0,value:v,writable:!0}):l[h]=v}function ic(l,h){for(var v=-1,x=h.length,I=G(x),T=null==l;++v<x;)I[v]=T?L:Mc(l,h[v]);return I}function xi(l,h,v){return l==l&&(v!==L&&(l=l<=v?l:v),h!==L&&(l=l>=h?l:h)),l}function Gr(l,h,v,x,I,T){var O,U=1&h,z=2&h,ee=4&h;if(v&&(O=I?v(l,x,I,T):v(l)),O!==L)return O;if(!Qt(l))return l;var te=$e(l);if(te){if(O=function Hx(l){var h=l.length,v=new l.constructor(h);return h&&"string"==typeof l[0]&&Ct.call(l,"index")&&(v.index=l.index,v.input=l.input),v}(l),!U)return Kr(l,O)}else{var ae=er(l),fe=ae==Ve||ae==ll;if(xa(l))return pm(l,U);if(ae==na||ae==ks||fe&&!I){if(O=z||fe?{}:wc(l),!U)return z?function Fh(l,h){return Si(l,Bh(l),h)}(l,function Ax(l,h){return l&&Si(h,Or(h),l)}(O,l)):function xn(l,h){return Si(l,Cm(l),h)}(l,lh(O,l))}else{if(!ht[ae])return I?l:{};O=function Em(l,h,v){var x=l.constructor;switch(h){case fl:return Me(l);case Ps:case Ht:return new x(+l);case Gu:return function o2(l,h){var v=h?Me(l.buffer):l.buffer;return new l.constructor(v,l.byteOffset,l.byteLength)}(l,v);case pi:case Sd:case wv:case Ad:case bv:case Td:case xv:case _v:case Cv:return kx(l,v);case $o:return new x;case Os:case Ls:return new x(l);case zu:return function i2(l){var h=new l.constructor(l.source,qo.exec(l));return h.lastIndex=l.lastIndex,h}(l);case Go:return new x;case Id:return function a2(l){return Il?et(Il.call(l)):{}}(l)}}(l,ae,U)}}T||(T=new gr);var De=T.get(l);if(De)return De;T.set(l,O),Tc(l)?l.forEach(function(Oe){O.add(Gr(Oe,h,v,Oe,l,T))}):hp(l)&&l.forEach(function(Oe,st){O.set(st,Gr(Oe,h,v,st,l,T))});var Qe=te?L:(ee?z?Wl:Lh:z?Or:Rn)(l);return hr(Qe||l,function(Oe,st){Qe&&(Oe=l[st=Oe]),Zo(O,st,Gr(Oe,h,v,st,l,T))}),O}function rm(l,h,v){var x=v.length;if(null==l)return!x;for(l=et(l);x--;){var I=v[x],O=l[I];if(O===L&&!(I in l)||!(0,h[I])(O))return!1}return!0}function dh(l,h,v){if("function"!=typeof l)throw new tt(Tr);return nu(function(){l.apply(L,v)},h)}function Qa(l,h,v,x){var I=-1,T=Zu,O=!0,U=l.length,z=[],ee=h.length;if(!U)return z;v&&(h=kt(h,rn(v))),x?(T=za,O=!1):h.length>=200&&(T=tc,O=!1,h=new yi(h));e:for(;++I<U;){var te=l[I],ae=null==v?te:v(te);if(te=x||0!==te?te:0,O&&ae==ae){for(var fe=ee;fe--;)if(h[fe]===ae)continue e;z.push(te)}else T(h,ae,x)||z.push(te)}return z}S.templateSettings={escape:Bb,evaluate:Iv,interpolate:Fd,variable:"",imports:{_:S}},(S.prototype=Xa.prototype).constructor=S,($t.prototype=oc(Xa.prototype)).constructor=$t,(at.prototype=oc(Xa.prototype)).constructor=at,Ya.prototype.clear=function Sl(){this.__data__=Ks?Ks(null):{},this.size=0},Ya.prototype.delete=function wx(l){var h=this.has(l)&&delete this.__data__[l];return this.size-=h?1:0,h},Ya.prototype.get=function da(l){var h=this.__data__;if(Ks){var v=h[l];return v===Fs?L:v}return Ct.call(h,l)?h[l]:L},Ya.prototype.has=function em(l){var h=this.__data__;return Ks?h[l]!==L:Ct.call(h,l)},Ya.prototype.set=function ih(l,h){var v=this.__data__;return this.size+=this.has(l)?0:1,v[l]=Ks&&h===L?Fs:h,this},Te.prototype.clear=function tm(){this.__data__=[],this.size=0},Te.prototype.delete=function e2(l){var h=this.__data__,v=fo(h,l);return!(v<0||(v==h.length-1?h.pop():Qd.call(h,v,1),--this.size,0))},Te.prototype.get=function bx(l){var h=this.__data__,v=fo(h,l);return v<0?L:h[v][1]},Te.prototype.has=function xx(l){return fo(this.__data__,l)>-1},Te.prototype.set=function _x(l,h){var v=this.__data__,x=fo(v,l);return x<0?(++this.size,v.push([l,h])):v[x][1]=h,this},Yo.prototype.clear=function Cx(){this.size=0,this.__data__={hash:new Ya,map:new($s||Te),string:new Ya}},Yo.prototype.delete=function Dx(l){var h=Hl(this,l).delete(l);return this.size-=h?1:0,h},Yo.prototype.get=function oe(l){return Hl(this,l).get(l)},Yo.prototype.has=function pt(l){return Hl(this,l).has(l)},Yo.prototype.set=function ah(l,h){var v=Hl(this,l),x=v.size;return v.set(l,h),this.size+=v.size==x?0:1,this},yi.prototype.add=yi.prototype.push=function Wn(l){return this.__data__.set(l,Fs),this},yi.prototype.has=function nm(l){return this.__data__.has(l)},gr.prototype.clear=function Qo(){this.__data__=new Te,this.size=0},gr.prototype.delete=function sh(l){var h=this.__data__,v=h.delete(l);return this.size=h.size,v},gr.prototype.get=function uh(l){return this.__data__.get(l)},gr.prototype.has=function t2(l){return this.__data__.has(l)},gr.prototype.set=function Ex(l,h){var v=this.__data__;if(v instanceof Te){var x=v.__data__;if(!$s||x.length<199)return x.push([l,h]),this.size=++v.size,this;v=this.__data__=new Yo(x)}return v.set(l,h),this.size=v.size,this};var _i=gm(Dt),hh=gm(gh,!0);function om(l,h){var v=!0;return _i(l,function(x,I,T){return v=!!h(x,I,T)}),v}function ac(l,h,v){for(var x=-1,I=l.length;++x<I;){var T=l[x],O=h(T);if(null!=O&&(U===L?O==O&&!xr(O):v(O,U)))var U=O,z=T}return z}function im(l,h){var v=[];return _i(l,function(x,I,T){h(x,I,T)&&v.push(x)}),v}function Hn(l,h,v,x,I){var T=-1,O=l.length;for(v||(v=Im),I||(I=[]);++T<O;){var U=l[T];h>0&&v(U)?h>1?Hn(U,h-1,v,x,I):oa(I,U):x||(I[I.length]=U)}return I}var jn=kr(),ha=kr(!0);function Dt(l,h){return l&&jn(l,h,Rn)}function gh(l,h){return l&&ha(l,h,Rn)}function Tl(l,h){return ra(h,function(v){return Jo(l[v])})}function Za(l,h){for(var v=0,x=(h=Ii(h,l)).length;null!=l&&v<x;)l=l[go(h[v++])];return v&&v==x?l:L}function am(l,h,v){var x=h(l);return $e(l)?x:oa(x,v(l))}function mr(l){return null==l?l===L?"[object Undefined]":"[object Null]":zs&&zs in et(l)?function Ux(l){var h=Ct.call(l,zs),v=l[zs];try{l[zs]=L;var x=!0}catch{}var I=_l.call(l);return x&&(h?l[zs]=v:delete l[zs]),I}(l):function h2(l){return _l.call(l)}(l)}function vh(l,h){return l>h}function Rl(l,h){return null!=l&&Ct.call(l,h)}function Ml(l,h){return null!=l&&h in et(l)}function sc(l,h,v){for(var x=v?za:Zu,I=l[0].length,T=l.length,O=T,U=G(T),z=1/0,ee=[];O--;){var te=l[O];O&&h&&(te=kt(te,rn(h))),z=pr(te.length,z),U[O]=!v&&(h||I>=120&&te.length>=120)?new yi(O&&te):L}te=l[0];var ae=-1,fe=U[0];e:for(;++ae<I&&ee.length<z;){var De=te[ae],Pe=h?h(De):De;if(De=v||0!==De?De:0,!(fe?tc(fe,Pe):x(ee,Pe,v))){for(O=T;--O;){var Qe=U[O];if(!(Qe?tc(Qe,Pe):x(l[O],Pe,v)))continue e}fe&&fe.push(Pe),ee.push(De)}}return ee}function uc(l,h,v){var x=null==(l=Wh(l,h=Ii(h,l)))?l:l[go(or(h))];return null==x?L:Vn(x,l,v)}function Ci(l){return Zt(l)&&mr(l)==ks}function lc(l,h,v,x,I){return l===h||(null==l||null==h||!Zt(l)&&!Zt(h)?l!=l&&h!=h:function fc(l,h,v,x,I,T){var O=$e(l),U=$e(h),z=O?fr:er(l),ee=U?fr:er(h),te=(z=z==ks?na:z)==na,ae=(ee=ee==ks?na:ee)==na,fe=z==ee;if(fe&&xa(l)){if(!xa(h))return!1;O=!0,te=!1}if(fe&&!te)return T||(T=new gr),O||Ni(l)?Ul(l,h,v,x,I,T):function yc(l,h,v,x,I,T,O){switch(v){case Gu:if(l.byteLength!=h.byteLength||l.byteOffset!=h.byteOffset)return!1;l=l.buffer,h=h.buffer;case fl:return!(l.byteLength!=h.byteLength||!T(new Fr(l),new Fr(h)));case Ps:case Ht:case Os:return Yr(+l,+h);case cl:return l.name==h.name&&l.message==h.message;case zu:case Ls:return l==h+"";case $o:var U=Sn;case Go:if(U||(U=Jn),l.size!=h.size&&!(1&x))return!1;var ee=O.get(l);if(ee)return ee==h;x|=2,O.set(l,h);var te=Ul(U(l),U(h),x,I,T,O);return O.delete(l),te;case Id:if(Il)return Il.call(l)==Il.call(h)}return!1}(l,h,z,v,x,I,T);if(!(1&v)){var De=te&&Ct.call(l,"__wrapped__"),Pe=ae&&Ct.call(h,"__wrapped__");if(De||Pe){var Qe=De?l.value():l,Oe=Pe?h.value():h;return T||(T=new gr),I(Qe,Oe,v,x,T)}}return!!fe&&(T||(T=new gr),function _m(l,h,v,x,I,T){var O=1&v,U=Lh(l),z=U.length;if(z!=Lh(h).length&&!O)return!1;for(var ae=z;ae--;){var fe=U[ae];if(!(O?fe in h:Ct.call(h,fe)))return!1}var De=T.get(l),Pe=T.get(h);if(De&&Pe)return De==h&&Pe==l;var Qe=!0;T.set(l,h),T.set(h,l);for(var Oe=O;++ae<z;){var st=l[fe=U[ae]],gt=h[fe];if(x)var pn=O?x(gt,st,fe,h,l,T):x(st,gt,fe,l,h,T);if(!(pn===L?st===gt||I(st,gt,v,x,T):pn)){Qe=!1;break}Oe||(Oe="constructor"==fe)}if(Qe&&!Oe){var zn=l.constructor,Qr=h.constructor;zn!=Qr&&"constructor"in l&&"constructor"in h&&!("function"==typeof zn&&zn instanceof zn&&"function"==typeof Qr&&Qr instanceof Qr)&&(Qe=!1)}return T.delete(l),T.delete(h),Qe}(l,h,v,x,I,T))}(l,h,v,x,lc,I))}function yh(l,h,v,x){var I=v.length,T=I,O=!x;if(null==l)return!T;for(l=et(l);I--;){var U=v[I];if(O&&U[2]?U[1]!==l[U[0]]:!(U[0]in l))return!1}for(;++I<T;){var z=(U=v[I])[0],ee=l[z],te=U[1];if(O&&U[2]){if(ee===L&&!(z in l))return!1}else{var ae=new gr;if(x)var fe=x(ee,te,z,l,h,ae);if(!(fe===L?lc(te,ee,3,x,ae):fe))return!1}}return!0}function um(l){return!(!Qt(l)||function Uh(l){return!!Un&&Un in l}(l))&&(Jo(l)?Xd:Rv).test(is(l))}function bh(l){return"function"==typeof l?l:null==l?Lr:"object"==typeof l?$e(l)?cm(l[0],l[1]):Ja(l):cf(l)}function Fl(l){if(!jl(l))return Jv(l);var h=[];for(var v in et(l))Ct.call(l,v)&&"constructor"!=v&&h.push(v);return h}function kl(l,h){return l<h}function xh(l,h){var v=-1,x=br(l)?G(l.length):[];return _i(l,function(I,T,O){x[++v]=h(I,T,O)}),x}function Ja(l){var h=ya(l);return 1==h.length&&h[0][2]?$x(h[0][0],h[0][1]):function(v){return v===l||yh(v,l,h)}}function cm(l,h){return Sm(l)&&zl(h)?$x(go(l),h):function(v){var x=Mc(v,l);return x===L&&x===h?Ep(v,l):lc(h,x,3)}}function Di(l,h,v,x,I){l!==h&&jn(h,function(T,O){if(I||(I=new gr),Qt(T))!function _h(l,h,v,x,I,T,O){var U=$l(l,v),z=$l(h,v),ee=O.get(z);if(ee)Al(l,v,ee);else{var te=T?T(U,z,v+"",l,h,O):L,ae=te===L;if(ae){var fe=$e(z),De=!fe&&xa(z),Pe=!fe&&!De&&Ni(z);te=z,fe||De||Pe?$e(U)?te=U:sn(U)?te=Kr(U):De?(ae=!1,te=pm(z,!0)):Pe?(ae=!1,te=kx(z,!0)):te=[]:To(z)||us(z)?(te=U,us(U)?te=rf(U):(!Qt(U)||Jo(U))&&(te=wc(z))):ae=!1}ae&&(O.set(z,te),I(te,z,x,T,O),O.delete(z)),Al(l,v,te)}}(l,h,O,v,Di,x,I);else{var U=x?x($l(l,O),T,O+"",l,h,I):L;U===L&&(U=T),Al(l,O,U)}},Or)}function hc(l,h){var v=l.length;if(v)return wa(h+=h<0?v:0,v)?l[h]:L}function Rx(l,h,v){h=h.length?kt(h,function(T){return $e(T)?function(O){return Za(O,1===T.length?T[0]:T)}:T}):[Lr];var x=-1;return h=kt(h,rn(Fe())),function At(j,X){var G=j.length;for(j.sort(X);G--;)j[G]=j[G].value;return j}(xh(l,function(T,O,U){return{criteria:kt(h,function(ee){return ee(T)}),index:++x,value:T}}),function(T,O){return function s2(l,h,v){for(var x=-1,I=l.criteria,T=h.criteria,O=I.length,U=v.length;++x<O;){var z=Px(I[x],T[x]);if(z)return x>=U?z:z*("desc"==v[x]?-1:1)}return l.index-h.index}(T,O,v)})}function Ch(l,h,v){for(var x=-1,I=h.length,T={};++x<I;){var O=h[x],U=Za(l,O);v(U,O)&&Qs(T,Ii(O,l),U)}return T}function ho(l,h,v,x){var I=x?ia:Us,T=-1,O=h.length,U=l;for(l===h&&(h=Kr(h)),v&&(U=kt(l,rn(v)));++T<O;)for(var z=0,ee=h[T],te=v?v(ee):ee;(z=I(U,te,z,x))>-1;)U!==l&&Qd.call(U,z,1),Qd.call(l,z,1);return l}function fm(l,h){for(var v=l?h.length:0,x=v-1;v--;){var I=h[v];if(v==x||I!==T){var T=I;wa(I)?Qd.call(l,I,1):Rh(l,I)}}return l}function Ys(l,h){return l+eh(la()*(h-l+1))}function pc(l,h){var v="";if(!l||h<1||h>Rr)return v;do{h%2&&(v+=l),(h=eh(h/2))&&(l+=l)}while(h);return v}function Xe(l,h){return nr(Am(l,h,Lr),l+"")}function Eh(l){return ch(lu(l))}function Nx(l,h){var v=lu(l);return Gl(v,xi(h,0,v.length))}function Qs(l,h,v,x){if(!Qt(l))return l;for(var I=-1,T=(h=Ii(h,l)).length,O=T-1,U=l;null!=U&&++I<T;){var z=go(h[I]),ee=v;if("__proto__"===z||"constructor"===z||"prototype"===z)return l;if(I!=O){var te=U[z];(ee=x?x(te,z,U):L)===L&&(ee=Qt(te)?te:wa(h[I+1])?[]:{})}Zo(U,z,ee),U=U[z]}return l}var Ih=Dl?function(l,h){return Dl.set(l,h),l}:Lr,dm=Zd?function(l,h){return Zd(l,"toString",{configurable:!0,enumerable:!1,value:Ca(h),writable:!0})}:Lr;function hm(l){return Gl(lu(l))}function po(l,h,v){var x=-1,I=l.length;h<0&&(h=-h>I?0:I+h),(v=v>I?I:v)<0&&(v+=I),I=h>v?0:v-h>>>0,h>>>=0;for(var T=G(I);++x<I;)T[x]=l[x+h];return T}function Pl(l,h){var v;return _i(l,function(x,I,T){return!(v=h(x,I,T))}),!!v}function Ei(l,h,v){var x=0,I=null==l?x:l.length;if("number"==typeof h&&h==h&&I<=2147483647){for(;x<I;){var T=x+I>>>1,O=l[T];null!==O&&!xr(O)&&(v?O<=h:O<h)?x=T+1:I=T}return I}return Sh(l,h,Lr,v)}function Sh(l,h,v,x){var I=0,T=null==l?0:l.length;if(0===T)return 0;for(var O=(h=v(h))!=h,U=null===h,z=xr(h),ee=h===L;I<T;){var te=eh((I+T)/2),ae=v(l[te]),fe=ae!==L,De=null===ae,Pe=ae==ae,Qe=xr(ae);if(O)var Oe=x||Pe;else Oe=ee?Pe&&(x||fe):U?Pe&&fe&&(x||!De):z?Pe&&fe&&!De&&(x||!Qe):!De&&!Qe&&(x?ae<=h:ae<h);Oe?I=te+1:T=te}return pr(T,4294967294)}function Ah(l,h){for(var v=-1,x=l.length,I=0,T=[];++v<x;){var O=l[v],U=h?h(O):O;if(!v||!Yr(U,z)){var z=U;T[I++]=0===O?0:O}}return T}function Th(l){return"number"==typeof l?l:xr(l)?NaN:+l}function Tn(l){if("string"==typeof l)return l;if($e(l))return kt(l,Tn)+"";if(xr(l))return an?an.call(l):"";var h=l+"";return"0"==h&&1/l==-hi?"-0":h}function pa(l,h,v){var x=-1,I=Zu,T=l.length,O=!0,U=[],z=U;if(v)O=!1,I=za;else if(T>=200){var ee=h?null:Vx(l);if(ee)return Jn(ee);O=!1,I=tc,z=new yi}else z=h?[]:U;e:for(;++x<T;){var te=l[x],ae=h?h(te):te;if(te=v||0!==te?te:0,O&&ae==ae){for(var fe=z.length;fe--;)if(z[fe]===ae)continue e;h&&z.push(ae),U.push(te)}else I(z,ae,v)||(z!==U&&z.push(ae),U.push(te))}return U}function Rh(l,h){return null==(l=Wh(l,h=Ii(h,l)))||delete l[go(or(h))]}function Ol(l,h,v,x){return Qs(l,h,v(Za(l,h)),x)}function Ll(l,h,v,x){for(var I=l.length,T=x?I:-1;(x?T--:++T<I)&&h(l[T],T,l););return v?po(l,x?0:T,x?T+1:I):po(l,x?T+1:0,x?I:T)}function Mh(l,h){var v=l;return v instanceof at&&(v=v.value()),Ie(h,function(x,I){return I.func.apply(I.thisArg,oa([x],I.args))},v)}function Zs(l,h,v){var x=l.length;if(x<2)return x?pa(l[0]):[];for(var I=-1,T=G(x);++I<x;)for(var O=l[I],U=-1;++U<x;)U!=I&&(T[I]=Qa(T[I]||O,l[U],h,v));return pa(Hn(T,1),h,v)}function es(l,h,v){for(var x=-1,I=l.length,T=h.length,O={};++x<I;)v(O,l[x],x<T?h[x]:L);return O}function ga(l){return sn(l)?l:[]}function va(l){return"function"==typeof l?l:Lr}function Ii(l,h){return $e(l)?l:Sm(l,h)?[l]:zh(Tt(l))}var Nh=Xe;function qr(l,h,v){var x=l.length;return v=v===L?x:v,!h&&v>=x?l:po(l,h,v)}var Fx=qS||function(l){return In.clearTimeout(l)};function pm(l,h){if(h)return l.slice();var v=l.length,x=Xv?Xv(v):new l.constructor(v);return l.copy(x),x}function Me(l){var h=new l.constructor(l.byteLength);return new Fr(h).set(new Fr(l)),h}function kx(l,h){var v=h?Me(l.buffer):l.buffer;return new l.constructor(v,l.byteOffset,l.length)}function Px(l,h){if(l!==h){var v=l!==L,x=null===l,I=l==l,T=xr(l),O=h!==L,U=null===h,z=h==h,ee=xr(h);if(!U&&!ee&&!T&&l>h||T&&O&&z&&!U&&!ee||x&&O&&z||!v&&z||!I)return 1;if(!x&&!T&&!ee&&l<h||ee&&v&&I&&!x&&!T||U&&v&&I||!O&&I||!z)return-1}return 0}function Ox(l,h,v,x){for(var I=-1,T=l.length,O=v.length,U=-1,z=h.length,ee=on(T-O,0),te=G(z+ee),ae=!x;++U<z;)te[U]=h[U];for(;++I<O;)(ae||I<T)&&(te[v[I]]=l[I]);for(;ee--;)te[U++]=l[I++];return te}function Js(l,h,v,x){for(var I=-1,T=l.length,O=-1,U=v.length,z=-1,ee=h.length,te=on(T-U,0),ae=G(te+ee),fe=!x;++I<te;)ae[I]=l[I];for(var De=I;++z<ee;)ae[De+z]=h[z];for(;++O<U;)(fe||I<T)&&(ae[De+v[O]]=l[I++]);return ae}function Kr(l,h){var v=-1,x=l.length;for(h||(h=G(x));++v<x;)h[v]=l[v];return h}function Si(l,h,v,x){var I=!v;v||(v={});for(var T=-1,O=h.length;++T<O;){var U=h[T],z=x?x(v[U],l[U],U,v,l):L;z===L&&(z=l[U]),I?bi(v,U,z):Zo(v,U,z)}return v}function ma(l,h){return function(v,x){var I=$e(v)?$d:Sx,T=h?h():{};return I(v,l,Fe(x,2),T)}}function gc(l){return Xe(function(h,v){var x=-1,I=v.length,T=I>1?v[I-1]:L,O=I>2?v[2]:L;for(T=l.length>3&&"function"==typeof T?(I--,T):L,O&&tr(v[0],v[1],O)&&(T=I<3?L:T,I=1),h=et(h);++x<I;){var U=v[x];U&&l(h,U,x,T)}return h})}function gm(l,h){return function(v,x){if(null==v)return v;if(!br(v))return l(v,x);for(var I=v.length,T=h?I:-1,O=et(v);(h?T--:++T<I)&&!1!==x(O[T],T,O););return v}}function kr(l){return function(h,v,x){for(var I=-1,T=et(h),O=x(h),U=O.length;U--;){var z=O[l?U:++I];if(!1===v(T[z],z,T))break}return h}}function kh(l){return function(h){var v=dn(h=Tt(h))?Yt(h):L,x=v?v[0]:h.charAt(0),I=v?qr(v,1).join(""):h.slice(1);return x[l]()+I}}function Ai(l){return function(h){return Ie(p_(Ry(h).replace(nx,"")),l,"")}}function Ti(l){return function(){var h=arguments;switch(h.length){case 0:return new l;case 1:return new l(h[0]);case 2:return new l(h[0],h[1]);case 3:return new l(h[0],h[1],h[2]);case 4:return new l(h[0],h[1],h[2],h[3]);case 5:return new l(h[0],h[1],h[2],h[3],h[4]);case 6:return new l(h[0],h[1],h[2],h[3],h[4],h[5]);case 7:return new l(h[0],h[1],h[2],h[3],h[4],h[5],h[6])}var v=oc(l.prototype),x=l.apply(v,h);return Qt(x)?x:v}}function mm(l){return function(h,v,x){var I=et(h);if(!br(h)){var T=Fe(v,3);h=Rn(h),v=function(U){return T(I[U],U,I)}}var O=l(h,v,x);return O>-1?I[T?h[O]:O]:L}}function ym(l){return Xr(function(h){var v=h.length,x=v,I=$t.prototype.thru;for(l&&h.reverse();x--;){var T=h[x];if("function"!=typeof T)throw new tt(Tr);if(I&&!O&&"wrapper"==rs(T))var O=new $t([],!0)}for(x=O?x:v;++x<v;){var U=rs(T=h[x]),z="wrapper"==U?ns(T):L;O=z&&Vh(z[0])&&424==z[1]&&!z[4].length&&1==z[9]?O[rs(z[0])].apply(O,z[3]):1==T.length&&Vh(T)?O[U]():O.thru(T)}return function(){var ee=arguments,te=ee[0];if(O&&1==ee.length&&$e(te))return O.plant(te).value();for(var ae=0,fe=v?h[ae].apply(this,ee):te;++ae<v;)fe=h[ae].call(this,fe);return fe}})}function Ph(l,h,v,x,I,T,O,U,z,ee){var te=128&h,ae=1&h,fe=2&h,De=24&h,Pe=512&h,Qe=fe?L:Ti(l);return function Oe(){for(var st=arguments.length,gt=G(st),pn=st;pn--;)gt[pn]=arguments[pn];if(De)var zn=os(Oe),Qr=$v(gt,zn);if(x&&(gt=Ox(gt,x,I,De)),T&&(gt=Js(gt,T,O,De)),st-=Qr,De&&st<ee){var en=zr(gt,zn);return wm(l,h,Ph,Oe.placeholder,v,gt,en,U,z,ee-st)}var Zr=ae?v:this,ei=fe?Zr[l]:l;return st=gt.length,U?gt=Hh(gt,U):Pe&&st>1&&gt.reverse(),te&&z<st&&(gt.length=z),this&&this!==In&&this instanceof Oe&&(ei=Qe||Ti(ei)),ei.apply(Zr,gt)}}function Lx(l,h){return function(v,x){return function sm(l,h,v,x){return Dt(l,function(I,T,O){h(x,v(I),T,O)}),x}(v,l,h(x),{})}}function vc(l,h){return function(v,x){var I;if(v===L&&x===L)return h;if(v!==L&&(I=v),x!==L){if(I===L)return x;"string"==typeof v||"string"==typeof x?(v=Tn(v),x=Tn(x)):(v=Th(v),x=Th(x)),I=l(v,x)}return I}}function yr(l){return Xr(function(h){return h=kt(h,rn(Fe())),Xe(function(v){var x=this;return l(h,function(I){return Vn(I,x,v)})})})}function eu(l,h){var v=(h=h===L?" ":Tn(h)).length;if(v<2)return v?pc(h,l):h;var x=pc(h,Jd(l/Ot(h)));return dn(h)?qr(Yt(x),0,l).join(""):x.slice(0,l)}function Bx(l){return function(h,v,x){return x&&"number"!=typeof x&&tr(h,v,x)&&(v=x=L),h=Pr(h),v===L?(v=h,h=0):v=Pr(v),function Dh(l,h,v,x){for(var I=-1,T=on(Jd((h-l)/(v||1)),0),O=G(T);T--;)O[x?T:++I]=l,l+=v;return O}(h,v,x=x===L?h<v?1:-1:Pr(x),l)}}function mc(l){return function(h,v){return"string"==typeof h&&"string"==typeof v||(h=vo(h),v=vo(v)),l(h,v)}}function wm(l,h,v,x,I,T,O,U,z,ee){var te=8&h;h|=te?32:64,4&(h&=~(te?64:32))||(h&=-4);var Qe=[l,h,I,te?T:L,te?O:L,te?L:T,te?L:O,U,z,ee],Oe=v.apply(L,Qe);return Vh(l)&&jh(Oe,Qe),Oe.placeholder=x,Tm(Oe,l,h)}function Oh(l){var h=zt[l];return function(v,x){if(v=vo(v),(x=null==x?0:pr(Ye(x),292))&&gx(v)){var I=(Tt(v)+"e").split("e");return+((I=(Tt(h(I[0]+"e"+(+I[1]+x)))+"e").split("e"))[0]+"e"+(+I[1]-x))}return h(v)}}var Vx=Gs&&1/Jn(new Gs([,-0]))[1]==hi?function(l){return new Gs(l)}:Mp;function bm(l){return function(h){var v=er(h);return v==$o?Sn(h):v==Go?function co(j){var X=-1,G=Array(j.size);return j.forEach(function(he){G[++X]=[he,he]}),G}(h):function qd(j,X){return kt(X,function(G){return[G,j[G]]})}(h,l(h))}}function Ri(l,h,v,x,I,T,O,U){var z=2&h;if(!z&&"function"!=typeof l)throw new tt(Tr);var ee=x?x.length:0;if(ee||(h&=-97,x=I=L),O=O===L?O:on(Ye(O),0),U=U===L?U:Ye(U),ee-=I?I.length:0,64&h){var te=x,ae=I;x=I=L}var fe=z?L:ns(l),De=[l,h,v,x,I,te,ae,T,O,U];if(fe&&function f2(l,h){var v=l[1],x=h[1],I=v|x;if(!(I<131||(128==x&&8==v||128==x&&256==v&&l[7].length<=h[8]||384==x&&h[7].length<=h[8]&&8==v)))return l;1&x&&(l[2]=h[2],I|=1&v?0:4);var U=h[3];if(U){var z=l[3];l[3]=z?Ox(z,U,h[4]):U,l[4]=z?zr(l[3],Uu):h[4]}(U=h[5])&&(l[5]=(z=l[5])?Js(z,U,h[6]):U,l[6]=z?zr(l[5],Uu):h[6]),(U=h[7])&&(l[7]=U),128&x&&(l[8]=null==l[8]?h[8]:pr(l[8],h[8])),null==l[9]&&(l[9]=h[9]),l[0]=h[0],l[1]=I}(De,fe),l=De[0],h=De[1],v=De[2],x=De[3],I=De[4],!(U=De[9]=De[9]===L?z?0:l.length:on(De[9]-ee,0))&&24&h&&(h&=-25),h&&1!=h)Pe=8==h||16==h?function vm(l,h,v){var x=Ti(l);return function I(){for(var T=arguments.length,O=G(T),U=T,z=os(I);U--;)O[U]=arguments[U];var ee=T<3&&O[0]!==z&&O[T-1]!==z?[]:zr(O,z);return(T-=ee.length)<v?wm(l,h,Ph,I.placeholder,L,O,ee,L,L,v-T):Vn(this&&this!==In&&this instanceof I?x:l,this,O)}}(l,h,U):32!=h&&33!=h||I.length?Ph.apply(L,De):function tu(l,h,v,x){var I=1&h,T=Ti(l);return function O(){for(var U=-1,z=arguments.length,ee=-1,te=x.length,ae=G(te+z),fe=this&&this!==In&&this instanceof O?T:l;++ee<te;)ae[ee]=x[ee];for(;z--;)ae[ee++]=arguments[++U];return Vn(fe,I?v:this,ae)}}(l,h,v,x);else var Pe=function ts(l,h,v){var x=1&h,I=Ti(l);return function T(){return(this&&this!==In&&this instanceof T?I:l).apply(x?v:this,arguments)}}(l,h,v);return Tm((fe?Ih:jh)(Pe,De),l,h)}function xm(l,h,v,x){return l===L||Yr(l,vi[v])&&!Ct.call(x,v)?h:l}function Bl(l,h,v,x,I,T){return Qt(l)&&Qt(h)&&(T.set(h,l),Di(l,h,L,Bl,T),T.delete(h)),l}function Vl(l){return To(l)?L:l}function Ul(l,h,v,x,I,T){var O=1&v,U=l.length,z=h.length;if(U!=z&&!(O&&z>U))return!1;var ee=T.get(l),te=T.get(h);if(ee&&te)return ee==h&&te==l;var ae=-1,fe=!0,De=2&v?new yi:L;for(T.set(l,h),T.set(h,l);++ae<U;){var Pe=l[ae],Qe=h[ae];if(x)var Oe=O?x(Qe,Pe,ae,h,l,T):x(Pe,Qe,ae,l,h,T);if(Oe!==L){if(Oe)continue;fe=!1;break}if(De){if(!Pt(h,function(st,gt){if(!tc(De,gt)&&(Pe===st||I(Pe,st,v,x,T)))return De.push(gt)})){fe=!1;break}}else if(Pe!==Qe&&!I(Pe,Qe,v,x,T)){fe=!1;break}}return T.delete(l),T.delete(h),fe}function Xr(l){return nr(Am(l,L,Lm),l+"")}function Lh(l){return am(l,Rn,Cm)}function Wl(l){return am(l,Or,Bh)}var ns=Dl?function(l){return Dl.get(l)}:Mp;function rs(l){for(var h=l.name+"",v=fa[h],x=Ct.call(fa,h)?v.length:0;x--;){var I=v[x],T=I.func;if(null==T||T==l)return I.name}return h}function os(l){return(Ct.call(S,"placeholder")?S:l).placeholder}function Fe(){var l=S.iteratee||uf;return l=l===uf?bh:l,arguments.length?l(arguments[0],arguments[1]):l}function Hl(l,h){var v=l.__data__;return function zx(l){var h=typeof l;return"string"==h||"number"==h||"symbol"==h||"boolean"==h?"__proto__"!==l:null===l}(h)?v["string"==typeof h?"string":"hash"]:v.map}function ya(l){for(var h=Rn(l),v=h.length;v--;){var x=h[v],I=l[x];h[v]=[x,I,zl(I)]}return h}function Ao(l,h){var v=function qv(j,X){return null==j?L:j[X]}(l,h);return um(v)?v:L}var Cm=Zv?function(l){return null==l?[]:(l=et(l),ra(Zv(l),function(h){return Qv.call(l,h)}))}:Nc,Bh=Zv?function(l){for(var h=[];l;)oa(h,Cm(l)),l=Yd(l);return h}:Nc,er=mr;function Dm(l,h,v){for(var x=-1,I=(h=Ii(h,l)).length,T=!1;++x<I;){var O=go(h[x]);if(!(T=null!=l&&v(l,O)))break;l=l[O]}return T||++x!=I?T:!!(I=null==l?0:l.length)&&dp(I)&&wa(O,I)&&($e(l)||us(l))}function wc(l){return"function"!=typeof l.constructor||jl(l)?{}:oc(Yd(l))}function Im(l){return $e(l)||us(l)||!!(px&&l&&l[px])}function wa(l,h){var v=typeof l;return!!(h=h??Rr)&&("number"==v||"symbol"!=v&&$b.test(l))&&l>-1&&l%1==0&&l<h}function tr(l,h,v){if(!Qt(v))return!1;var x=typeof h;return!!("number"==x?br(v)&&wa(h,v.length):"string"==x&&h in v)&&Yr(v[h],l)}function Sm(l,h){if($e(l))return!1;var v=typeof l;return!("number"!=v&&"symbol"!=v&&"boolean"!=v&&null!=l&&!xr(l))||Av.test(l)||!Sv.test(l)||null!=h&&l in et(h)}function Vh(l){var h=rs(l),v=S[h];if("function"!=typeof v||!(h in at.prototype))return!1;if(l===v)return!0;var x=ns(v);return!!x&&l===x[0]}(mi&&er(new mi(new ArrayBuffer(1)))!=Gu||$s&&er(new $s)!=$o||th&&er(th.resolve())!=Lb||Gs&&er(new Gs)!=Go||qs&&er(new qs)!=$u)&&(er=function(l){var h=mr(l),v=h==na?l.constructor:L,x=v?is(v):"";if(x)switch(x){case mx:return Gu;case lo:return $o;case nh:return Lb;case yx:return Go;case rh:return $u}return h});var c2=js?Jo:lf;function jl(l){var h=l&&l.constructor;return l===("function"==typeof h&&h.prototype||vi)}function zl(l){return l==l&&!Qt(l)}function $x(l,h){return function(v){return null!=v&&v[l]===h&&(h!==L||l in et(v))}}function Am(l,h,v){return h=on(h===L?l.length-1:h,0),function(){for(var x=arguments,I=-1,T=on(x.length-h,0),O=G(T);++I<T;)O[I]=x[h+I];I=-1;for(var U=G(h+1);++I<h;)U[I]=x[I];return U[h]=v(O),Vn(l,this,U)}}function Wh(l,h){return h.length<2?l:Za(l,po(h,0,-1))}function Hh(l,h){for(var v=l.length,x=pr(h.length,v),I=Kr(l);x--;){var T=h[x];l[x]=wa(T,v)?I[T]:L}return l}function $l(l,h){if(("constructor"!==h||"function"!=typeof l[h])&&"__proto__"!=h)return l[h]}var jh=Rm(Ih),nu=XS||function(l,h){return In.setTimeout(l,h)},nr=Rm(dm);function Tm(l,h,v){var x=h+"";return nr(l,function jx(l,h){var v=h.length;if(!v)return l;var x=v-1;return h[x]=(v>1?"& ":"")+h[x],h=h.join(v>2?", ":" "),l.replace(Tv,"{\n/* [wrapped with "+h+"] */\n")}(x,function Gx(l,h){return hr(Ob,function(v){var x="_."+v[0];h&v[1]&&!Zu(l,x)&&l.push(x)}),l.sort()}(function Wx(l){var h=l.match(Wb);return h?h[1].split(Hb):[]}(x),v)))}function Rm(l){var h=0,v=0;return function(){var x=ZS(),I=16-(x-v);if(v=x,I>0){if(++h>=800)return arguments[0]}else h=0;return l.apply(L,arguments)}}function Gl(l,h){var v=-1,x=l.length,I=x-1;for(h=h===L?x:h;++v<h;){var T=Ys(v,I),O=l[T];l[T]=l[v],l[v]=O}return l.length=h,l}var zh=function l2(l){var h=Ic(l,function(x){return 500===v.size&&v.clear(),x}),v=h.cache;return h}(function(l){var h=[];return 46===l.charCodeAt(0)&&h.push(""),l.replace(ao,function(v,x,I,T){h.push(I?T.replace(wn,"$1"):x||v)}),h});function go(l){if("string"==typeof l||xr(l))return l;var h=l+"";return"0"==h&&1/l==-hi?"-0":h}function is(l){if(null!=l){try{return ca.call(l)}catch{}try{return l+""}catch{}}return""}function Mm(l){if(l instanceof at)return l.clone();var h=new $t(l.__wrapped__,l.__chain__);return h.__actions__=Kr(l.__actions__),h.__index__=l.__index__,h.__values__=l.__values__,h}var wr=Xe(function(l,h){return sn(l)?Qa(l,Hn(h,1,sn,!0)):[]}),$h=Xe(function(l,h){var v=or(h);return sn(v)&&(v=L),sn(l)?Qa(l,Hn(h,1,sn,!0),Fe(v,2)):[]}),Fm=Xe(function(l,h){var v=or(h);return sn(v)&&(v=L),sn(l)?Qa(l,Hn(h,1,sn,!0),L,v):[]});function Om(l,h,v){var x=null==l?0:l.length;if(!x)return-1;var I=null==v?0:Ye(v);return I<0&&(I=on(x+I,0)),bl(l,Fe(h,3),I)}function qh(l,h,v){var x=null==l?0:l.length;if(!x)return-1;var I=x-1;return v!==L&&(I=Ye(v),I=v<0?on(x+I,0):pr(I,x-1)),bl(l,Fe(h,3),I,!0)}function Lm(l){return null!=l&&l.length?Hn(l,1):[]}function Um(l){return l&&l.length?l[0]:L}var Xh=Xe(function(l){var h=kt(l,ga);return h.length&&h[0]===l[0]?sc(h):[]}),Qx=Xe(function(l){var h=or(l),v=kt(l,ga);return h===or(v)?h=L:v.pop(),v.length&&v[0]===l[0]?sc(v,Fe(h,2)):[]}),Wm=Xe(function(l){var h=or(l),v=kt(l,ga);return(h="function"==typeof h?h:L)&&v.pop(),v.length&&v[0]===l[0]?sc(v,L,h):[]});function or(l){var h=null==l?0:l.length;return h?l[h-1]:L}var Yh=Xe(ql);function ql(l,h){return l&&l.length&&h&&h.length?ho(l,h):l}var ru=Xr(function(l,h){var v=null==l?0:l.length,x=ic(l,h);return fm(l,kt(h,function(I){return wa(I,v)?+I:I}).sort(Px)),x});function Kl(l){return null==l?l:vx.call(l)}var $m=Xe(function(l){return pa(Hn(l,1,sn,!0))}),Gm=Xe(function(l){var h=or(l);return sn(h)&&(h=L),pa(Hn(l,1,sn,!0),Fe(h,2))}),as=Xe(function(l){var h=or(l);return h="function"==typeof h?h:L,pa(Hn(l,1,sn,!0),L,h)});function Xm(l){if(!l||!l.length)return[];var h=0;return l=ra(l,function(v){if(sn(v))return h=on(v.length,h),!0}),ec(h,function(v){return kt(l,jv(v))})}function xc(l,h){if(!l||!l.length)return[];var v=Xm(l);return null==h?v:kt(v,function(x){return Vn(h,L,x)})}var f1=Xe(function(l,h){return sn(l)?Qa(l,h):[]}),Ym=Xe(function(l){return Zs(ra(l,sn))}),Qm=Xe(function(l){var h=or(l);return sn(h)&&(h=L),Zs(ra(l,sn),Fe(h,2))}),Zm=Xe(function(l){var h=or(l);return h="function"==typeof h?h:L,Zs(ra(l,sn),L,h)}),tp=Xe(Xm),Yl=Xe(function(l){var h=l.length,v=h>1?l[h-1]:L;return v="function"==typeof v?(l.pop(),v):L,xc(l,v)});function np(l){var h=S(l);return h.__chain__=!0,h}function ou(l,h){return h(l)}var op=Xr(function(l){var h=l.length,v=h?l[0]:0,x=this.__wrapped__,I=function(T){return ic(T,l)};return!(h>1||this.__actions__.length)&&x instanceof at&&wa(v)?((x=x.slice(v,+v+(h?1:0))).__actions__.push({func:ou,args:[I],thisArg:L}),new $t(x,this.__chain__).thru(function(T){return h&&!T.length&&T.push(L),T})):this.thru(I)}),ny=ma(function(l,h,v){Ct.call(l,v)?++l[v]:bi(l,v,1)}),ss=mm(Om),v1=mm(qh);function Zl(l,h){return($e(l)?hr:_i)(l,Fe(h,3))}function ry(l,h){return($e(l)?lx:hh)(l,Fe(h,3))}var oy=ma(function(l,h,v){Ct.call(l,v)?l[v].push(h):bi(l,v,[h])}),ap=Xe(function(l,h,v){var x=-1,I="function"==typeof h,T=br(l)?G(l.length):[];return _i(l,function(O){T[++x]=I?Vn(h,O,v):uc(O,h,v)}),T}),iy=ma(function(l,h,v){bi(l,v,h)});function Cc(l,h){return($e(l)?kt:xh)(l,Fe(h,3))}var sy=ma(function(l,h,v){l[v?0:1].push(h)},function(){return[[],[]]}),v2=Xe(function(l,h){if(null==l)return[];var v=h.length;return v>1&&tr(l,h[0],h[1])?h=[]:v>2&&tr(h[0],h[1],h[2])&&(h=[h[0]]),Rx(l,Hn(h,1),[])}),sp=KS||function(){return In.Date.now()};function E1(l,h,v){return h=v?L:h,Ri(l,128,L,L,L,L,h=l&&null==h?l.length:h)}function I1(l,h){var v;if("function"!=typeof h)throw new tt(Tr);return l=Ye(l),function(){return--l>0&&(v=h.apply(this,arguments)),l<=1&&(h=L),v}}var ef=Xe(function(l,h,v){var x=1;if(v.length){var I=zr(v,os(ef));x|=32}return Ri(l,x,h,v,I)}),uy=Xe(function(l,h,v){var x=3;if(v.length){var I=zr(v,os(uy));x|=32}return Ri(h,x,l,v,I)});function fy(l,h,v){var x,I,T,O,U,z,ee=0,te=!1,ae=!1,fe=!0;if("function"!=typeof l)throw new tt(Tr);function De(en){var Zr=x,ei=I;return x=I=L,ee=en,O=l.apply(ei,Zr)}function Pe(en){return ee=en,U=nu(st,h),te?De(en):O}function Oe(en){var Zr=en-z;return z===L||Zr>=h||Zr<0||ae&&en-ee>=T}function st(){var en=sp();if(Oe(en))return gt(en);U=nu(st,function Qe(en){var pf=h-(en-z);return ae?pr(pf,T-(en-ee)):pf}(en))}function gt(en){return U=L,fe&&x?De(en):(x=I=L,O)}function Qr(){var en=sp(),Zr=Oe(en);if(x=arguments,I=this,z=en,Zr){if(U===L)return Pe(z);if(ae)return Fx(U),U=nu(st,h),De(z)}return U===L&&(U=nu(st,h)),O}return h=vo(h)||0,Qt(v)&&(te=!!v.leading,T=(ae="maxWait"in v)?on(vo(v.maxWait)||0,h):T,fe="trailing"in v?!!v.trailing:fe),Qr.cancel=function pn(){U!==L&&Fx(U),ee=0,x=z=I=U=L},Qr.flush=function zn(){return U===L?O:gt(sp())},Qr}var up=Xe(function(l,h){return dh(l,1,h)}),Mi=Xe(function(l,h,v){return dh(l,vo(h)||0,v)});function Ic(l,h){if("function"!=typeof l||null!=h&&"function"!=typeof h)throw new tt(Tr);var v=function(){var x=arguments,I=h?h.apply(this,x):x[0],T=v.cache;if(T.has(I))return T.get(I);var O=l.apply(this,x);return v.cache=T.set(I,O)||T,O};return v.cache=new(Ic.Cache||Yo),v}function Sc(l){if("function"!=typeof l)throw new tt(Tr);return function(){var h=arguments;switch(h.length){case 0:return!l.call(this);case 1:return!l.call(this,h[0]);case 2:return!l.call(this,h[0],h[1]);case 3:return!l.call(this,h[0],h[1],h[2])}return!l.apply(this,h)}}Ic.Cache=Yo;var y2=Nh(function(l,h){var v=(h=1==h.length&&$e(h[0])?kt(h[0],rn(Fe())):kt(Hn(h,1),rn(Fe()))).length;return Xe(function(x){for(var I=-1,T=pr(x.length,v);++I<T;)x[I]=h[I].call(this,x[I]);return Vn(l,this,x)})}),hy=Xe(function(l,h){var v=zr(h,os(hy));return Ri(l,32,L,h,v)}),S1=Xe(function(l,h){var v=zr(h,os(S1));return Ri(l,64,L,h,v)}),cp=Xr(function(l,h){return Ri(l,256,L,L,L,h)});function Yr(l,h){return l===h||l!=l&&h!=h}var F1=mc(vh),hn=mc(function(l,h){return l>=h}),us=Ci(function(){return arguments}())?Ci:function(l){return Zt(l)&&Ct.call(l,"callee")&&!Qv.call(l,"callee")},$e=G.isArray,vy=zd?rn(zd):function cc(l){return Zt(l)&&mr(l)==fl};function br(l){return null!=l&&dp(l.length)&&!Jo(l)}function sn(l){return Zt(l)&&br(l)}var xa=YS||lf,P1=ax?rn(ax):function Tx(l){return Zt(l)&&mr(l)==Ht};function iu(l){if(!Zt(l))return!1;var h=mr(l);return h==cl||"[object DOMException]"==h||"string"==typeof l.message&&"string"==typeof l.name&&!To(l)}function Jo(l){if(!Qt(l))return!1;var h=mr(l);return h==Ve||h==ll||"[object AsyncFunction]"==h||"[object Proxy]"==h}function fp(l){return"number"==typeof l&&l==Ye(l)}function dp(l){return"number"==typeof l&&l>-1&&l%1==0&&l<=Rr}function Qt(l){var h=typeof l;return null!=l&&("object"==h||"function"==h)}function Zt(l){return null!=l&&"object"==typeof l}var hp=Vt?rn(Vt):function mh(l){return Zt(l)&&er(l)==$o};function mp(l){return"number"==typeof l||Zt(l)&&mr(l)==Os}function To(l){if(!Zt(l)||mr(l)!=na)return!1;var h=Yd(l);if(null===h)return!0;var v=Ct.call(h,"constructor")&&h.constructor;return"function"==typeof v&&v instanceof v&&ca.call(v)==Nr}var yp=sx?rn(sx):function n2(l){return Zt(l)&&mr(l)==zu},Tc=ux?rn(ux):function r2(l){return Zt(l)&&er(l)==Go};function nf(l){return"string"==typeof l||!$e(l)&&Zt(l)&&mr(l)==Ls}function xr(l){return"symbol"==typeof l||Zt(l)&&mr(l)==Id}var Ni=cx?rn(cx):function wh(l){return Zt(l)&&dp(l.length)&&!!jt[mr(l)]},L1=mc(kl),B1=mc(function(l,h){return l<=h});function xp(l){if(!l)return[];if(br(l))return nf(l)?Yt(l):Kr(l);if(Cl&&l[Cl])return function Nt(j){for(var X,G=[];!(X=j.next()).done;)G.push(X.value);return G}(l[Cl]());var h=er(l);return(h==$o?Sn:h==Go?Jn:lu)(l)}function Pr(l){return l?(l=vo(l))===hi||l===-hi?17976931348623157e292*(l<0?-1:1):l==l?l:0:0===l?l:0}function Ye(l){var h=Pr(l),v=h%1;return h==h?v?h-v:h:0}function xy(l){return l?xi(Ye(l),0,xt):0}function vo(l){if("number"==typeof l)return l;if(xr(l))return NaN;if(Qt(l)){var h="function"==typeof l.valueOf?l.valueOf():l;l=Qt(h)?h+"":h}if("string"!=typeof l)return 0===l?l:+l;l=Kd(l);var v=zb.test(l);return v||Od.test(l)?Bv(l.slice(2),v?2:8):BS.test(l)?NaN:+l}function rf(l){return Si(l,Or(l))}function Tt(l){return null==l?"":Tn(l)}var U1=gc(function(l,h){if(jl(h)||br(h))Si(h,Rn(h),l);else for(var v in h)Ct.call(h,v)&&Zo(l,v,h[v])}),_p=gc(function(l,h){Si(h,Or(h),l)}),Cp=gc(function(l,h,v,x){Si(h,Or(h),l,x)}),W1=gc(function(l,h,v,x){Si(h,Rn(h),l,x)}),Rc=Xr(ic),au=Xe(function(l,h){l=et(l);var v=-1,x=h.length,I=x>2?h[2]:L;for(I&&tr(h[0],h[1],I)&&(x=1);++v<x;)for(var T=h[v],O=Or(T),U=-1,z=O.length;++U<z;){var ee=O[U],te=l[ee];(te===L||Yr(te,vi[ee])&&!Ct.call(l,ee))&&(l[ee]=T[ee])}return l}),Fi=Xe(function(l){return l.push(L,Bl),Vn(Cy,L,l)});function Mc(l,h,v){var x=null==l?L:Za(l,h);return x===L?v:x}function Ep(l,h){return null!=l&&Dm(l,h,Ml)}var Ip=Lx(function(l,h,v){null!=h&&"function"!=typeof h.toString&&(h=_l.call(h)),l[h]=v},Ca(Lr)),uu=Lx(function(l,h,v){null!=h&&"function"!=typeof h.toString&&(h=_l.call(h)),Ct.call(l,h)?l[h].push(v):l[h]=[v]},Fe),q1=Xe(uc);function Rn(l){return br(l)?Ix(l):Fl(l)}function Or(l){return br(l)?Ix(l,!0):function dc(l){if(!Qt(l))return function d2(l){var h=[];if(null!=l)for(var v in et(l))h.push(v);return h}(l);var h=jl(l),v=[];for(var x in l)"constructor"==x&&(h||!Ct.call(l,x))||v.push(x);return v}(l)}var Y1=gc(function(l,h,v){Di(l,h,v)}),Cy=gc(function(l,h,v,x){Di(l,h,v,x)}),cu=Xr(function(l,h){var v={};if(null==l)return v;var x=!1;h=kt(h,function(T){return T=Ii(T,l),x||(x=T.length>1),T}),Si(l,Wl(l),v),x&&(v=Gr(v,7,Vl));for(var I=h.length;I--;)Rh(v,h[I]);return v}),Q1=Xr(function(l,h){return null==l?{}:function lm(l,h){return Ch(l,h,function(v,x){return Ep(l,x)})}(l,h)});function Dy(l,h){if(null==l)return{};var v=kt(Wl(l),function(x){return[x]});return h=Fe(h),Ch(l,v,function(x,I){return h(x,I[0])})}var Z1=bm(Rn),Sp=bm(Or);function lu(l){return null==l?[]:$a(l,Rn(l))}var n_=Ai(function(l,h,v){return h=h.toLowerCase(),l+(v?Ty(h):h)});function Ty(l){return By(Tt(l).toLowerCase())}function Ry(l){return(l=Tt(l))&&l.replace(qu,Gv).replace(jS,"")}var i_=Ai(function(l,h,v){return l+(v?"-":"")+h.toLowerCase()}),a_=Ai(function(l,h,v){return l+(v?" ":"")+h.toLowerCase()}),ze=kh("toLowerCase"),c_=Ai(function(l,h,v){return l+(v?"_":"")+h.toLowerCase()}),l_=Ai(function(l,h,v){return l+(v?" ":"")+By(h)}),T2=Ai(function(l,h,v){return l+(v?" ":"")+h.toUpperCase()}),By=kh("toUpperCase");function p_(l,h,v){return l=Tt(l),(h=v?L:h)===L?function Mr(j){return $S.test(j)}(l)?function nc(j){return j.match(Mt)||[]}(l):function Ju(j){return j.match(gi)||[]}(l):l.match(h)||[]}var Vy=Xe(function(l,h){try{return Vn(l,L,h)}catch(v){return iu(v)?v:new Ce(v)}}),Uy=Xr(function(l,h){return hr(h,function(v){v=go(v),bi(l,v,ef(l[v],l))}),l});function Ca(l){return function(){return l}}var Wy=ym(),sf=ym(!0);function Lr(l){return l}function uf(l){return bh("function"==typeof l?l:Gr(l,1))}var w_=Xe(function(l,h){return function(v){return uc(v,l,h)}}),b_=Xe(function(l,h){return function(v){return uc(l,v,h)}});function Rp(l,h,v){var x=Rn(h),I=Tl(h,x);null==v&&(!Qt(h)||!I.length&&x.length)&&(v=h,h=l,l=this,I=Tl(h,Rn(h)));var T=!(Qt(v)&&"chain"in v&&!v.chain),O=Jo(l);return hr(I,function(U){var z=h[U];l[U]=z,O&&(l.prototype[U]=function(){var ee=this.__chain__;if(T||ee){var te=l(this.__wrapped__),ae=te.__actions__=Kr(this.__actions__);return ae.push({func:z,args:arguments,thisArg:l}),te.__chain__=ee,te}return z.apply(l,oa([this.value()],arguments))})}),l}function Mp(){}var zy=yr(kt),Np=yr(Uv),M2=yr(Pt);function cf(l){return Sm(l)?jv(go(l)):function Mx(l){return function(h){return Za(h,l)}}(l)}var N2=Bx(),Se=Bx(!0);function Nc(){return[]}function lf(){return!1}var kp=vc(function(l,h){return l+h},0),Gy=Oh("ceil"),Pp=vc(function(l,h){return l/h},1),F2=Oh("floor"),Bp=vc(function(l,h){return l*h},1),P2=Oh("round"),C_=vc(function(l,h){return l-h},0);return S.after=function m2(l,h){if("function"!=typeof h)throw new tt(Tr);return l=Ye(l),function(){if(--l<1)return h.apply(this,arguments)}},S.ary=E1,S.assign=U1,S.assignIn=_p,S.assignInWith=Cp,S.assignWith=W1,S.at=Rc,S.before=I1,S.bind=ef,S.bindAll=Uy,S.bindKey=uy,S.castArray=function T1(){if(!arguments.length)return[];var l=arguments[0];return $e(l)?l:[l]},S.chain=np,S.chunk=function Nm(l,h,v){h=(v?tr(l,h,v):h===L)?1:on(Ye(h),0);var x=null==l?0:l.length;if(!x||h<1)return[];for(var I=0,T=0,O=G(Jd(x/h));I<x;)O[T++]=po(l,I,I+=h);return O},S.compact=function qx(l){for(var h=-1,v=null==l?0:l.length,x=0,I=[];++h<v;){var T=l[h];T&&(I[x++]=T)}return I},S.concat=function Kx(){var l=arguments.length;if(!l)return[];for(var h=G(l-1),v=arguments[0],x=l;x--;)h[x-1]=arguments[x];return oa($e(v)?Kr(v):[v],Hn(h,1))},S.cond=function R2(l){var h=null==l?0:l.length,v=Fe();return l=h?kt(l,function(x){if("function"!=typeof x[1])throw new tt(Tr);return[v(x[0]),x[1]]}):[],Xe(function(x){for(var I=-1;++I<h;){var T=l[I];if(Vn(T[0],this,x))return Vn(T[1],this,x)}})},S.conforms=function g_(l){return function fh(l){var h=Rn(l);return function(v){return rm(v,l,h)}}(Gr(l,1))},S.constant=Ca,S.countBy=ny,S.create=function H1(l,h){var v=oc(l);return null==h?v:lh(v,h)},S.curry=function cy(l,h,v){var x=Ri(l,8,L,L,L,L,L,h=v?L:h);return x.placeholder=cy.placeholder,x},S.curryRight=function ly(l,h,v){var x=Ri(l,16,L,L,L,L,L,h=v?L:h);return x.placeholder=ly.placeholder,x},S.debounce=fy,S.defaults=au,S.defaultsDeep=Fi,S.defer=up,S.delay=Mi,S.difference=wr,S.differenceBy=$h,S.differenceWith=Fm,S.drop=function Gh(l,h,v){var x=null==l?0:l.length;return x?po(l,(h=v||h===L?1:Ye(h))<0?0:h,x):[]},S.dropRight=function rr(l,h,v){var x=null==l?0:l.length;return x?po(l,0,(h=x-(h=v||h===L?1:Ye(h)))<0?0:h):[]},S.dropRightWhile=function bc(l,h){return l&&l.length?Ll(l,Fe(h,3),!0,!0):[]},S.dropWhile=function km(l,h){return l&&l.length?Ll(l,Fe(h,3),!0):[]},S.fill=function Pm(l,h,v,x){var I=null==l?0:l.length;return I?(v&&"number"!=typeof v&&tr(l,h,v)&&(v=0,x=I),function ph(l,h,v,x){var I=l.length;for((v=Ye(v))<0&&(v=-v>I?0:I+v),(x=x===L||x>I?I:Ye(x))<0&&(x+=I),x=v>x?0:xy(x);v<x;)l[v++]=h;return l}(l,h,v,x)):[]},S.filter=function ip(l,h){return($e(l)?ra:im)(l,Fe(h,3))},S.flatMap=function m1(l,h){return Hn(Cc(l,h),1)},S.flatMapDeep=function g2(l,h){return Hn(Cc(l,h),hi)},S.flatMapDepth=function y1(l,h,v){return v=v===L?1:Ye(v),Hn(Cc(l,h),v)},S.flatten=Lm,S.flattenDeep=function Bm(l){return null!=l&&l.length?Hn(l,hi):[]},S.flattenDepth=function Xx(l,h){return null!=l&&l.length?Hn(l,h=h===L?1:Ye(h)):[]},S.flip=function Ec(l){return Ri(l,512)},S.flow=Wy,S.flowRight=sf,S.fromPairs=function Vm(l){for(var h=-1,v=null==l?0:l.length,x={};++h<v;){var I=l[h];x[I[0]]=I[1]}return x},S.functions=function af(l){return null==l?[]:Tl(l,Rn(l))},S.functionsIn=function G1(l){return null==l?[]:Tl(l,Or(l))},S.groupBy=oy,S.initial=function Kh(l){return null!=l&&l.length?po(l,0,-1):[]},S.intersection=Xh,S.intersectionBy=Qx,S.intersectionWith=Wm,S.invert=Ip,S.invertBy=uu,S.invokeMap=ap,S.iteratee=uf,S.keyBy=iy,S.keys=Rn,S.keysIn=Or,S.map=Cc,S.mapKeys=function K1(l,h){var v={};return h=Fe(h,3),Dt(l,function(x,I,T){bi(v,h(x,I,T),x)}),v},S.mapValues=function X1(l,h){var v={};return h=Fe(h,3),Dt(l,function(x,I,T){bi(v,I,h(x,I,T))}),v},S.matches=function m_(l){return Ja(Gr(l,1))},S.matchesProperty=function y_(l,h){return cm(l,Gr(h,1))},S.memoize=Ic,S.merge=Y1,S.mergeWith=Cy,S.method=w_,S.methodOf=b_,S.mixin=Rp,S.negate=Sc,S.nthArg=function jy(l){return l=Ye(l),Xe(function(h){return hc(h,l)})},S.omit=cu,S.omitBy=function ki(l,h){return Dy(l,Sc(Fe(h)))},S.once=function dy(l){return I1(2,l)},S.orderBy=function ay(l,h,v,x){return null==l?[]:($e(h)||(h=null==h?[]:[h]),$e(v=x?L:v)||(v=null==v?[]:[v]),Rx(l,h,v))},S.over=zy,S.overArgs=y2,S.overEvery=Np,S.overSome=M2,S.partial=hy,S.partialRight=S1,S.partition=sy,S.pick=Q1,S.pickBy=Dy,S.property=cf,S.propertyOf=function x_(l){return function(h){return null==l?L:Za(l,h)}},S.pull=Yh,S.pullAll=ql,S.pullAllBy=function Hm(l,h,v){return l&&l.length&&h&&h.length?ho(l,h,Fe(v,2)):l},S.pullAllWith=function p2(l,h,v){return l&&l.length&&h&&h.length?ho(l,h,L,v):l},S.pullAt=ru,S.range=N2,S.rangeRight=Se,S.rearg=cp,S.reject=function x1(l,h){return($e(l)?ra:im)(l,Sc(Fe(h,3)))},S.remove=function Qh(l,h){var v=[];if(!l||!l.length)return v;var x=-1,I=[],T=l.length;for(h=Fe(h,3);++x<T;){var O=l[x];h(O,x,l)&&(v.push(O),I.push(x))}return fm(l,I),v},S.rest=function lp(l,h){if("function"!=typeof l)throw new tt(Tr);return Xe(l,h=h===L?h:Ye(h))},S.reverse=Kl,S.sampleSize=function C1(l,h,v){return h=(v?tr(l,h,v):h===L)?1:Ye(h),($e(l)?vr:Nx)(l,h)},S.set=function I2(l,h,v){return null==l?l:Qs(l,h,v)},S.setWith=function Ey(l,h,v,x){return x="function"==typeof x?x:L,null==l?l:Qs(l,h,v,x)},S.shuffle=function ba(l){return($e(l)?wi:hm)(l)},S.slice=function t1(l,h,v){var x=null==l?0:l.length;return x?(v&&"number"!=typeof v&&tr(l,h,v)?(h=0,v=x):(h=null==h?0:Ye(h),v=v===L?x:Ye(v)),po(l,h,v)):[]},S.sortBy=v2,S.sortedUniq=function s1(l){return l&&l.length?Ah(l):[]},S.sortedUniqBy=function jm(l,h){return l&&l.length?Ah(l,Fe(h,2)):[]},S.split=function Py(l,h,v){return v&&"number"!=typeof v&&tr(l,h,v)&&(h=v=L),(v=v===L?xt:v>>>0)?(l=Tt(l))&&("string"==typeof h||null!=h&&!yp(h))&&!(h=Tn(h))&&dn(l)?qr(Yt(l),0,v):l.split(h,v):[]},S.spread=function w2(l,h){if("function"!=typeof l)throw new tt(Tr);return h=null==h?0:on(Ye(h),0),Xe(function(v){var x=v[h],I=qr(v,0,h);return x&&oa(I,x),Vn(l,this,I)})},S.tail=function Jh(l){var h=null==l?0:l.length;return h?po(l,1,h):[]},S.take=function zm(l,h,v){return l&&l.length?po(l,0,(h=v||h===L?1:Ye(h))<0?0:h):[]},S.takeRight=function ep(l,h,v){var x=null==l?0:l.length;return x?po(l,(h=x-(h=v||h===L?1:Ye(h)))<0?0:h,x):[]},S.takeRightWhile=function u1(l,h){return l&&l.length?Ll(l,Fe(h,3),!1,!0):[]},S.takeWhile=function c1(l,h){return l&&l.length?Ll(l,Fe(h,3)):[]},S.tap=function rp(l,h){return h(l),l},S.throttle=function b2(l,h,v){var x=!0,I=!0;if("function"!=typeof l)throw new tt(Tr);return Qt(v)&&(x="leading"in v?!!v.leading:x,I="trailing"in v?!!v.trailing:I),fy(l,h,{leading:x,maxWait:h,trailing:I})},S.thru=ou,S.toArray=xp,S.toPairs=Z1,S.toPairsIn=Sp,S.toPath=function Fp(l){return $e(l)?kt(l,go):xr(l)?[l]:Kr(zh(Tt(l)))},S.toPlainObject=rf,S.transform=function S2(l,h,v){var x=$e(l),I=x||xa(l)||Ni(l);if(h=Fe(h,4),null==v){var T=l&&l.constructor;v=I?x?new T:[]:Qt(l)&&Jo(T)?oc(Yd(l)):{}}return(I?hr:Dt)(l,function(O,U,z){return h(v,O,U,z)}),v},S.unary=function py(l){return E1(l,1)},S.union=$m,S.unionBy=Gm,S.unionWith=as,S.uniq=function qm(l){return l&&l.length?pa(l):[]},S.uniqBy=function Km(l,h){return l&&l.length?pa(l,Fe(h,2)):[]},S.uniqWith=function l1(l,h){return h="function"==typeof h?h:L,l&&l.length?pa(l,L,h):[]},S.unset=function Iy(l,h){return null==l||Rh(l,h)},S.unzip=Xm,S.unzipWith=xc,S.update=function J1(l,h,v){return null==l?l:Ol(l,h,va(v))},S.updateWith=function Sy(l,h,v,x){return x="function"==typeof x?x:L,null==l?l:Ol(l,h,va(v),x)},S.values=lu,S.valuesIn=function e_(l){return null==l?[]:$a(l,Or(l))},S.without=f1,S.words=p_,S.wrap=function A1(l,h){return hy(va(h),l)},S.xor=Ym,S.xorBy=Qm,S.xorWith=Zm,S.zip=tp,S.zipObject=function Jm(l,h){return es(l||[],h||[],Zo)},S.zipObjectDeep=function Xl(l,h){return es(l||[],h||[],Qs)},S.zipWith=Yl,S.entries=Z1,S.entriesIn=Sp,S.extend=_p,S.extendWith=Cp,Rp(S,S),S.add=kp,S.attempt=Vy,S.camelCase=n_,S.capitalize=Ty,S.ceil=Gy,S.clamp=function Ro(l,h,v){return v===L&&(v=h,h=L),v!==L&&(v=(v=vo(v))==v?v:0),h!==L&&(h=(h=vo(h))==h?h:0),xi(vo(l),h,v)},S.clone=function R1(l){return Gr(l,4)},S.cloneDeep=function gy(l){return Gr(l,5)},S.cloneDeepWith=function tf(l,h){return Gr(l,5,h="function"==typeof h?h:L)},S.cloneWith=function M1(l,h){return Gr(l,4,h="function"==typeof h?h:L)},S.conformsTo=function N1(l,h){return null==h||rm(l,h,Rn(h))},S.deburr=Ry,S.defaultTo=function v_(l,h){return null==l||l!=l?h:l},S.divide=Pp,S.endsWith=function r_(l,h,v){l=Tt(l),h=Tn(h);var x=l.length,I=v=v===L?x:xi(Ye(v),0,x);return(v-=h.length)>=0&&l.slice(v,I)==h},S.eq=Yr,S.escape=function My(l){return(l=Tt(l))&&Ev.test(l)?l.replace(Nd,aa):l},S.escapeRegExp=function o_(l){return(l=Tt(l))&&Vb.test(l)?l.replace(kd,"\\$&"):l},S.every=function Ql(l,h,v){var x=$e(l)?Uv:om;return v&&tr(l,h,v)&&(h=L),x(l,Fe(h,3))},S.find=ss,S.findIndex=Om,S.findKey=function j1(l,h){return Hv(l,Fe(h,3),Dt)},S.findLast=v1,S.findLastIndex=qh,S.findLastKey=function D2(l,h){return Hv(l,Fe(h,3),gh)},S.floor=F2,S.forEach=Zl,S.forEachRight=ry,S.forIn=function _y(l,h){return null==l?l:jn(l,Fe(h,3),Or)},S.forInRight=function su(l,h){return null==l?l:ha(l,Fe(h,3),Or)},S.forOwn=function z1(l,h){return l&&Dt(l,Fe(h,3))},S.forOwnRight=function $1(l,h){return l&&gh(l,Fe(h,3))},S.get=Mc,S.gt=F1,S.gte=hn,S.has=function Dp(l,h){return null!=l&&Dm(l,h,Rl)},S.hasIn=Ep,S.head=Um,S.identity=Lr,S.includes=function Jl(l,h,v,x){l=br(l)?l:lu(l),v=v&&!x?Ye(v):0;var I=l.length;return v<0&&(v=on(I+v,0)),nf(l)?v<=I&&l.indexOf(h,v)>-1:!!I&&Us(l,h,v)>-1},S.indexOf=function Yx(l,h,v){var x=null==l?0:l.length;if(!x)return-1;var I=null==v?0:Ye(v);return I<0&&(I=on(x+I,0)),Us(l,h,I)},S.inRange=function t_(l,h,v){return h=Pr(h),v===L?(v=h,h=0):v=Pr(v),function Nl(l,h,v){return l>=pr(h,v)&&l<on(h,v)}(l=vo(l),h,v)},S.invoke=q1,S.isArguments=us,S.isArray=$e,S.isArrayBuffer=vy,S.isArrayLike=br,S.isArrayLikeObject=sn,S.isBoolean=function k1(l){return!0===l||!1===l||Zt(l)&&mr(l)==Ps},S.isBuffer=xa,S.isDate=P1,S.isElement=function my(l){return Zt(l)&&1===l.nodeType&&!To(l)},S.isEmpty=function x2(l){if(null==l)return!0;if(br(l)&&($e(l)||"string"==typeof l||"function"==typeof l.splice||xa(l)||Ni(l)||us(l)))return!l.length;var h=er(l);if(h==$o||h==Go)return!l.size;if(jl(l))return!Fl(l).length;for(var v in l)if(Ct.call(l,v))return!1;return!0},S.isEqual=function _2(l,h){return lc(l,h)},S.isEqualWith=function Ac(l,h,v){var x=(v="function"==typeof v?v:L)?v(l,h):L;return x===L?lc(l,h,L,v):!!x},S.isError=iu,S.isFinite=function yy(l){return"number"==typeof l&&gx(l)},S.isFunction=Jo,S.isInteger=fp,S.isLength=dp,S.isMap=hp,S.isMatch=function pp(l,h){return l===h||yh(l,h,ya(h))},S.isMatchWith=function C2(l,h,v){return v="function"==typeof v?v:L,yh(l,h,ya(h),v)},S.isNaN=function gp(l){return mp(l)&&l!=+l},S.isNative=function O1(l){if(c2(l))throw new Ce("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return um(l)},S.isNil=function wy(l){return null==l},S.isNull=function vp(l){return null===l},S.isNumber=mp,S.isObject=Qt,S.isObjectLike=Zt,S.isPlainObject=To,S.isRegExp=yp,S.isSafeInteger=function wp(l){return fp(l)&&l>=-Rr&&l<=Rr},S.isSet=Tc,S.isString=nf,S.isSymbol=xr,S.isTypedArray=Ni,S.isUndefined=function _a(l){return l===L},S.isWeakMap=function by(l){return Zt(l)&&er(l)==$u},S.isWeakSet=function bp(l){return Zt(l)&&"[object WeakSet]"==mr(l)},S.join=function Zx(l,h){return null==l?"":QS.call(l,h)},S.kebabCase=i_,S.last=or,S.lastIndexOf=function Jx(l,h,v){var x=null==l?0:l.length;if(!x)return-1;var I=x;return v!==L&&(I=(I=Ye(v))<0?on(x+I,0):pr(I,x-1)),h==h?function Ke(j,X,G){for(var he=G+1;he--;)if(j[he]===X)return he;return he}(l,h,I):bl(l,so,I,!0)},S.lowerCase=a_,S.lowerFirst=ze,S.lt=L1,S.lte=B1,S.max=function qy(l){return l&&l.length?ac(l,Lr,vh):L},S.maxBy=function k2(l,h){return l&&l.length?ac(l,Fe(h,2),vh):L},S.mean=function df(l){return fx(l,Lr)},S.meanBy=function hf(l,h){return fx(l,Fe(h,2))},S.min=function Op(l){return l&&l.length?ac(l,Lr,kl):L},S.minBy=function Lp(l,h){return l&&l.length?ac(l,Fe(h,2),kl):L},S.stubArray=Nc,S.stubFalse=lf,S.stubObject=function ff(){return{}},S.stubString=function Mo(){return""},S.stubTrue=function $y(){return!0},S.multiply=Bp,S.nth=function e1(l,h){return l&&l.length?hc(l,Ye(h)):L},S.noConflict=function Hy(){return In._===this&&(In._=Io),this},S.noop=Mp,S.now=sp,S.pad=function fu(l,h,v){l=Tt(l);var x=(h=Ye(h))?Ot(l):0;if(!h||x>=h)return l;var I=(h-x)/2;return eu(eh(I),v)+l+eu(Jd(I),v)},S.padEnd=function Ny(l,h,v){l=Tt(l);var x=(h=Ye(h))?Ot(l):0;return h&&x<h?l+eu(h-x,v):l},S.padStart=function Fy(l,h,v){l=Tt(l);var x=(h=Ye(h))?Ot(l):0;return h&&x<h?eu(h-x,v)+l:l},S.parseInt=function s_(l,h,v){return v||null==h?h=0:h&&(h=+h),JS(Tt(l).replace(Pd,""),h||0)},S.random=function Ay(l,h,v){if(v&&"boolean"!=typeof v&&tr(l,h,v)&&(h=v=L),v===L&&("boolean"==typeof h?(v=h,h=L):"boolean"==typeof l&&(v=l,l=L)),l===L&&h===L?(l=0,h=1):(l=Pr(l),h===L?(h=l,l=0):h=Pr(h)),l>h){var x=l;l=h,h=x}if(v||l%1||h%1){var I=la();return pr(l+I*(h-l+ix("1e-"+((I+"").length-1))),h)}return Ys(l,h)},S.reduce=function w1(l,h,v){var x=$e(l)?Ie:Xo,I=arguments.length<3;return x(l,Fe(h,4),v,I,_i)},S.reduceRight=function b1(l,h,v){var x=$e(l)?Wv:Xo,I=arguments.length<3;return x(l,Fe(h,4),v,I,hh)},S.repeat=function u_(l,h,v){return h=(v?tr(l,h,v):h===L)?1:Ye(h),pc(Tt(l),h)},S.replace=function ky(){var l=arguments,h=Tt(l[0]);return l.length<3?h:h.replace(l[1],l[2])},S.result=function E2(l,h,v){var x=-1,I=(h=Ii(h,l)).length;for(I||(I=1,l=L);++x<I;){var T=null==l?L:l[go(h[x])];T===L&&(x=I,T=v),l=Jo(T)?T.call(l):T}return l},S.round=P2,S.runInContext=j,S.sample=function _1(l){return($e(l)?ch:Eh)(l)},S.size=function Dc(l){if(null==l)return 0;if(br(l))return nf(l)?Ot(l):l.length;var h=er(l);return h==$o||h==Go?l.size:Fl(l).length},S.snakeCase=c_,S.some=function D1(l,h,v){var x=$e(l)?Pt:Pl;return v&&tr(l,h,v)&&(h=L),x(l,Fe(h,3))},S.sortedIndex=function Zh(l,h){return Ei(l,h)},S.sortedIndexBy=function n1(l,h,v){return Sh(l,h,Fe(v,2))},S.sortedIndexOf=function r1(l,h){var v=null==l?0:l.length;if(v){var x=Ei(l,h);if(x<v&&Yr(l[x],h))return x}return-1},S.sortedLastIndex=function o1(l,h){return Ei(l,h,!0)},S.sortedLastIndexBy=function i1(l,h,v){return Sh(l,h,Fe(v,2),!0)},S.sortedLastIndexOf=function a1(l,h){if(null!=l&&l.length){var x=Ei(l,h,!0)-1;if(Yr(l[x],h))return x}return-1},S.startCase=l_,S.startsWith=function f_(l,h,v){return l=Tt(l),v=null==v?0:xi(Ye(v),0,l.length),h=Tn(h),l.slice(v,v+h.length)==h},S.subtract=C_,S.sum=function D_(l){return l&&l.length?Ws(l,Lr):0},S.sumBy=function E_(l,h){return l&&l.length?Ws(l,Fe(h,2)):0},S.template=function A2(l,h,v){var x=S.templateSettings;v&&tr(l,h,v)&&(h=L),l=Tt(l),h=Cp({},h,x,xm);var U,z,I=Cp({},h.imports,x.imports,xm),T=Rn(I),O=$a(I,T),ee=0,te=h.interpolate||dl,ae="__p += '",fe=ua((h.escape||dl).source+"|"+te.source+"|"+(te===Fd?Bs:dl).source+"|"+(h.evaluate||dl).source+"|$","g"),De="//# sourceURL="+(Ct.call(h,"sourceURL")?(h.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++He+"]")+"\n";l.replace(fe,function(Oe,st,gt,pn,zn,Qr){return gt||(gt=pn),ae+=l.slice(ee,Qr).replace(Mv,dx),st&&(U=!0,ae+="' +\n__e("+st+") +\n'"),zn&&(z=!0,ae+="';\n"+zn+";\n__p += '"),gt&&(ae+="' +\n((__t = ("+gt+")) == null ? '' : __t) +\n'"),ee=Qr+Oe.length,Oe}),ae+="';\n";var Pe=Ct.call(h,"variable")&&h.variable;if(Pe){if(jb.test(Pe))throw new Ce("Invalid `variable` option passed into `_.template`")}else ae="with (obj) {\n"+ae+"\n}\n";ae=(z?ae.replace(OS,""):ae).replace(LS,"$1").replace(Rd,"$1;"),ae="function("+(Pe||"obj")+") {\n"+(Pe?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(U?", __e = _.escape":"")+(z?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+ae+"return __p\n}";var Qe=Vy(function(){return lt(T,De+"return "+ae).apply(L,O)});if(Qe.source=ae,iu(Qe))throw Qe;return Qe},S.times=function __(l,h){if((l=Ye(l))<1||l>Rr)return[];var v=xt,x=pr(l,xt);h=Fe(h),l-=xt;for(var I=ec(x,h);++v<l;)h(v);return I},S.toFinite=Pr,S.toInteger=Ye,S.toLength=xy,S.toLower=function Oy(l){return Tt(l).toLowerCase()},S.toNumber=vo,S.toSafeInteger=function V1(l){return l?xi(Ye(l),-Rr,Rr):0===l?l:0},S.toString=Tt,S.toUpper=function Ly(l){return Tt(l).toUpperCase()},S.trim=function mo(l,h,v){if((l=Tt(l))&&(v||h===L))return Kd(l);if(!l||!(h=Tn(h)))return l;var x=Yt(l),I=Yt(h);return qr(x,Hs(x,I),zv(x,I)+1).join("")},S.trimEnd=function d_(l,h,v){if((l=Tt(l))&&(v||h===L))return l.slice(0,sa(l)+1);if(!l||!(h=Tn(h)))return l;var x=Yt(l);return qr(x,0,zv(x,Yt(h))+1).join("")},S.trimStart=function Ap(l,h,v){if((l=Tt(l))&&(v||h===L))return l.replace(Pd,"");if(!l||!(h=Tn(h)))return l;var x=Yt(l);return qr(x,Hs(x,Yt(h))).join("")},S.truncate=function Tp(l,h){var v=30,x="...";if(Qt(h)){var I="separator"in h?h.separator:I;v="length"in h?Ye(h.length):v,x="omission"in h?Tn(h.omission):x}var T=(l=Tt(l)).length;if(dn(l)){var O=Yt(l);T=O.length}if(v>=T)return l;var U=v-Ot(x);if(U<1)return x;var z=O?qr(O,0,U).join(""):l.slice(0,U);if(I===L)return z+x;if(O&&(U+=z.length-U),yp(I)){if(l.slice(U).search(I)){var ee,te=z;for(I.global||(I=ua(I.source,Tt(qo.exec(I))+"g")),I.lastIndex=0;ee=I.exec(te);)var ae=ee.index;z=z.slice(0,ae===L?U:ae)}}else if(l.indexOf(Tn(I),U)!=U){var fe=z.lastIndexOf(I);fe>-1&&(z=z.slice(0,fe))}return z+x},S.unescape=function h_(l){return(l=Tt(l))&&Dv.test(l)?l.replace(Md,An):l},S.uniqueId=function Pi(l){var h=++qa;return Tt(l)+h},S.upperCase=T2,S.upperFirst=By,S.each=Zl,S.eachRight=ry,S.first=Um,Rp(S,function(){var l={};return Dt(S,function(h,v){Ct.call(S.prototype,v)||(l[v]=h)}),l}(),{chain:!1}),S.VERSION="4.17.21",hr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){S[l].placeholder=S}),hr(["drop","take"],function(l,h){at.prototype[l]=function(v){v=v===L?1:on(Ye(v),0);var x=this.__filtered__&&!h?new at(this):this.clone();return x.__filtered__?x.__takeCount__=pr(v,x.__takeCount__):x.__views__.push({size:pr(v,xt),type:l+(x.__dir__<0?"Right":"")}),x},at.prototype[l+"Right"]=function(v){return this.reverse()[l](v).reverse()}}),hr(["filter","map","takeWhile"],function(l,h){var v=h+1,x=1==v||3==v;at.prototype[l]=function(I){var T=this.clone();return T.__iteratees__.push({iteratee:Fe(I,3),type:v}),T.__filtered__=T.__filtered__||x,T}}),hr(["head","last"],function(l,h){var v="take"+(h?"Right":"");at.prototype[l]=function(){return this[v](1).value()[0]}}),hr(["initial","tail"],function(l,h){var v="drop"+(h?"":"Right");at.prototype[l]=function(){return this.__filtered__?new at(this):this[v](1)}}),at.prototype.compact=function(){return this.filter(Lr)},at.prototype.find=function(l){return this.filter(l).head()},at.prototype.findLast=function(l){return this.reverse().find(l)},at.prototype.invokeMap=Xe(function(l,h){return"function"==typeof l?new at(this):this.map(function(v){return uc(v,l,h)})}),at.prototype.reject=function(l){return this.filter(Sc(Fe(l)))},at.prototype.slice=function(l,h){l=Ye(l);var v=this;return v.__filtered__&&(l>0||h<0)?new at(v):(l<0?v=v.takeRight(-l):l&&(v=v.drop(l)),h!==L&&(v=(h=Ye(h))<0?v.dropRight(-h):v.take(h-l)),v)},at.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},at.prototype.toArray=function(){return this.take(xt)},Dt(at.prototype,function(l,h){var v=/^(?:filter|find|map|reject)|While$/.test(h),x=/^(?:head|last)$/.test(h),I=S[x?"take"+("last"==h?"Right":""):h],T=x||/^find/.test(h);!I||(S.prototype[h]=function(){var O=this.__wrapped__,U=x?[1]:arguments,z=O instanceof at,ee=U[0],te=z||$e(O),ae=function(st){var gt=I.apply(S,oa([st],U));return x&&fe?gt[0]:gt};te&&v&&"function"==typeof ee&&1!=ee.length&&(z=te=!1);var fe=this.__chain__,De=!!this.__actions__.length,Pe=T&&!fe,Qe=z&&!De;if(!T&&te){O=Qe?O:new at(this);var Oe=l.apply(O,U);return Oe.__actions__.push({func:ou,args:[ae],thisArg:L}),new $t(Oe,fe)}return Pe&&Qe?l.apply(this,U):(Oe=this.thru(ae),Pe?x?Oe.value()[0]:Oe.value():Oe)})}),hr(["pop","push","shift","sort","splice","unshift"],function(l){var h=xl[l],v=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",x=/^(?:pop|shift)$/.test(l);S.prototype[l]=function(){var I=arguments;if(x&&!this.__chain__){var T=this.value();return h.apply($e(T)?T:[],I)}return this[v](function(O){return h.apply($e(O)?O:[],I)})}}),Dt(at.prototype,function(l,h){var v=S[h];if(v){var x=v.name+"";Ct.call(fa,x)||(fa[x]=[]),fa[x].push({name:h,func:v})}}),fa[Ph(L,2).name]=[{name:"wrapper",func:L}],at.prototype.clone=function oh(){var l=new at(this.__wrapped__);return l.__actions__=Kr(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=Kr(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=Kr(this.__views__),l},at.prototype.reverse=function Xs(){if(this.__filtered__){var l=new at(this);l.__dir__=-1,l.__filtered__=!0}else(l=this.clone()).__dir__*=-1;return l},at.prototype.value=function $r(){var l=this.__wrapped__.value(),h=this.__dir__,v=$e(l),x=h<0,I=v?l.length:0,T=function u2(l,h,v){for(var x=-1,I=v.length;++x<I;){var T=v[x],O=T.size;switch(T.type){case"drop":l+=O;break;case"dropRight":h-=O;break;case"take":h=pr(h,l+O);break;case"takeRight":l=on(l,h-O)}}return{start:l,end:h}}(0,I,this.__views__),O=T.start,U=T.end,z=U-O,ee=x?U:O-1,te=this.__iteratees__,ae=te.length,fe=0,De=pr(z,this.__takeCount__);if(!v||!x&&I==z&&De==z)return Mh(l,this.__actions__);var Pe=[];e:for(;z--&&fe<De;){for(var Qe=-1,Oe=l[ee+=h];++Qe<ae;){var st=te[Qe],pn=st.type,zn=(0,st.iteratee)(Oe);if(2==pn)Oe=zn;else if(!zn){if(1==pn)continue e;break e}}Pe[fe++]=Oe}return Pe},S.prototype.at=op,S.prototype.chain=function _c(){return np(this)},S.prototype.commit=function d1(){return new $t(this.value(),this.__chain__)},S.prototype.next=function ey(){this.__values__===L&&(this.__values__=xp(this.value()));var l=this.__index__>=this.__values__.length;return{done:l,value:l?L:this.__values__[this.__index__++]}},S.prototype.plant=function p1(l){for(var h,v=this;v instanceof Xa;){var x=Mm(v);x.__index__=0,x.__values__=L,h?I.__wrapped__=x:h=x;var I=x;v=v.__wrapped__}return I.__wrapped__=l,h},S.prototype.reverse=function g1(){var l=this.__wrapped__;if(l instanceof at){var h=l;return this.__actions__.length&&(h=new at(this)),(h=h.reverse()).__actions__.push({func:ou,args:[Kl],thisArg:L}),new $t(h,this.__chain__)}return this.thru(Kl)},S.prototype.toJSON=S.prototype.valueOf=S.prototype.value=function ty(){return Mh(this.__wrapped__,this.__actions__)},S.prototype.first=S.prototype.head,Cl&&(S.prototype[Cl]=function h1(){return this}),S}();In._=je,(Wa=function(){return je}.call(Ns,cr,Ns,ui))!==L&&(ui.exports=Wa)}.call(this)},902:()=>{},522:()=>{},753:()=>{}},ui=>{ui(ui.s=776)}]);